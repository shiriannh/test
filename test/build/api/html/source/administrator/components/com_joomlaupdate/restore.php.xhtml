<?xml version="1.0"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:pu="http://schema.phpunit.de/coverage/1.0" lang="en"><head><title>phpDox - Source of restore.php</title><link rel="stylesheet" type="text/css" href="../../../../css/style.css" media="screen"/><link rel="stylesheet" href="../../../../css/source.css"/><meta http-equiv="content-type" content="text/html; charset=utf-8"/></head><body><nav class="topnav"><ul><li><div class="logo"><span>/**</span>phpDox</div></li><li class="separator"><a href="../../../../index.xhtml">Overview</a></li><li class="separator"><a href="../../../../namespaces.xhtml">Namespaces</a></li><li><a href="../../../../interfaces.xhtml">Interfaces</a></li><li><a href="../../../../classes.xhtml">Classes</a></li><li><a href="../../../../traits.xhtml">Traits</a></li><li class="separator"><a href="../../../../source/index.xhtml">Source</a></li></ul></nav><div id="mainstage"><div class="box"><ul class="breadcrumb"><li><a href="../../../../index.xhtml">Overview</a></li><li class="separator"><a href="../../../../source/index.xhtml">Source</a></li></ul></div><h1>Source of file restore.php</h1><p>
                        Size: 220,555 Bytes - Last Modified: 2016-08-13T21:27:20+00:00</p><section><h2><small>/home/codeur/git/test/test/administrator/components/com_joomlaupdate/</small>restore.php</h2><table class="source"><tr><td class="no"><a class="anker" href="#line1">1</a><a class="anker" href="#line2">2</a><a class="anker" href="#line3">3</a><a class="anker" href="#line4">4</a><a class="anker" href="#line5">5</a><a class="anker" href="#line6">6</a><a class="anker" href="#line7">7</a><a class="anker" href="#line8">8</a><a class="anker" href="#line9">9</a><a class="anker" href="#line10">10</a><a class="anker" href="#line11">11</a><a class="anker" href="#line12">12</a><a class="anker" href="#line13">13</a><a class="anker" href="#line14">14</a><a class="anker" href="#line15">15</a><a class="anker" href="#line16">16</a><a class="anker" href="#line17">17</a><a class="anker" href="#line18">18</a><a class="anker" href="#line19">19</a><a class="anker" href="#line20">20</a><a class="anker" href="#line21">21</a><a class="anker" href="#line22">22</a><a class="anker" href="#line23">23</a><a class="anker" href="#line24">24</a><a class="anker" href="#line25">25</a><a class="anker" href="#line26">26</a><a class="anker" href="#line27">27</a><a class="anker" href="#line28">28</a><a class="anker" href="#line29">29</a><a class="anker" href="#line30">30</a><a class="anker" href="#line31">31</a><a class="anker" href="#line32">32</a><a class="anker" href="#line33">33</a><a class="anker" href="#line34">34</a><a class="anker" href="#line35">35</a><a class="anker" href="#line36">36</a><a class="anker" href="#line37">37</a><a class="anker" href="#line38">38</a><a class="anker" href="#line39">39</a><a class="anker" href="#line40">40</a><a class="anker" href="#line41">41</a><a class="anker" href="#line42">42</a><a class="anker" href="#line43">43</a><a class="anker" href="#line44">44</a><a class="anker" href="#line45">45</a><a class="anker" href="#line46">46</a><a class="anker" href="#line47">47</a><a class="anker" href="#line48">48</a><a class="anker" href="#line49">49</a><a class="anker" href="#line50">50</a><a class="anker" href="#line51">51</a><a class="anker" href="#line52">52</a><a class="anker" href="#line53">53</a><a class="anker" href="#line54">54</a><a class="anker" href="#line55">55</a><a class="anker" href="#line56">56</a><a class="anker" href="#line57">57</a><a class="anker" href="#line58">58</a><a class="anker" href="#line59">59</a><a class="anker" href="#line60">60</a><a class="anker" href="#line61">61</a><a class="anker" href="#line62">62</a><a class="anker" href="#line63">63</a><a class="anker" href="#line64">64</a><a class="anker" href="#line65">65</a><a class="anker" href="#line66">66</a><a class="anker" href="#line67">67</a><a class="anker" href="#line68">68</a><a class="anker" href="#line69">69</a><a class="anker" href="#line70">70</a><a class="anker" href="#line71">71</a><a class="anker" href="#line72">72</a><a class="anker" href="#line73">73</a><a class="anker" href="#line74">74</a><a class="anker" href="#line75">75</a><a class="anker" href="#line76">76</a><a class="anker" href="#line77">77</a><a class="anker" href="#line78">78</a><a class="anker" href="#line79">79</a><a class="anker" href="#line80">80</a><a class="anker" href="#line81">81</a><a class="anker" href="#line82">82</a><a class="anker" href="#line83">83</a><a class="anker" href="#line84">84</a><a class="anker" href="#line85">85</a><a class="anker" href="#line86">86</a><a class="anker" href="#line87">87</a><a class="anker" href="#line88">88</a><a class="anker" href="#line89">89</a><a class="anker" href="#line90">90</a><a class="anker" href="#line91">91</a><a class="anker" href="#line92">92</a><a class="anker" href="#line93">93</a><a class="anker" href="#line94">94</a><a class="anker" href="#line95">95</a><a class="anker" href="#line96">96</a><a class="anker" href="#line97">97</a><a class="anker" href="#line98">98</a><a class="anker" href="#line99">99</a><a class="anker" href="#line100">100</a><a class="anker" href="#line101">101</a><a class="anker" href="#line102">102</a><a class="anker" href="#line103">103</a><a class="anker" href="#line104">104</a><a class="anker" href="#line105">105</a><a class="anker" href="#line106">106</a><a class="anker" href="#line107">107</a><a class="anker" href="#line108">108</a><a class="anker" href="#line109">109</a><a class="anker" href="#line110">110</a><a class="anker" href="#line111">111</a><a class="anker" href="#line112">112</a><a class="anker" href="#line113">113</a><a class="anker" href="#line114">114</a><a class="anker" href="#line115">115</a><a class="anker" href="#line116">116</a><a class="anker" href="#line117">117</a><a class="anker" href="#line118">118</a><a class="anker" href="#line119">119</a><a class="anker" href="#line120">120</a><a class="anker" href="#line121">121</a><a class="anker" href="#line122">122</a><a class="anker" href="#line123">123</a><a class="anker" href="#line124">124</a><a class="anker" href="#line125">125</a><a class="anker" href="#line126">126</a><a class="anker" href="#line127">127</a><a class="anker" href="#line128">128</a><a class="anker" href="#line129">129</a><a class="anker" href="#line130">130</a><a class="anker" href="#line131">131</a><a class="anker" href="#line132">132</a><a class="anker" href="#line133">133</a><a class="anker" href="#line134">134</a><a class="anker" href="#line135">135</a><a class="anker" href="#line136">136</a><a class="anker" href="#line137">137</a><a class="anker" href="#line138">138</a><a class="anker" href="#line139">139</a><a class="anker" href="#line140">140</a><a class="anker" href="#line141">141</a><a class="anker" href="#line142">142</a><a class="anker" href="#line143">143</a><a class="anker" href="#line144">144</a><a class="anker" href="#line145">145</a><a class="anker" href="#line146">146</a><a class="anker" href="#line147">147</a><a class="anker" href="#line148">148</a><a class="anker" href="#line149">149</a><a class="anker" href="#line150">150</a><a class="anker" href="#line151">151</a><a class="anker" href="#line152">152</a><a class="anker" href="#line153">153</a><a class="anker" href="#line154">154</a><a class="anker" href="#line155">155</a><a class="anker" href="#line156">156</a><a class="anker" href="#line157">157</a><a class="anker" href="#line158">158</a><a class="anker" href="#line159">159</a><a class="anker" href="#line160">160</a><a class="anker" href="#line161">161</a><a class="anker" href="#line162">162</a><a class="anker" href="#line163">163</a><a class="anker" href="#line164">164</a><a class="anker" href="#line165">165</a><a class="anker" href="#line166">166</a><a class="anker" href="#line167">167</a><a class="anker" href="#line168">168</a><a class="anker" href="#line169">169</a><a class="anker" href="#line170">170</a><a class="anker" href="#line171">171</a><a class="anker" href="#line172">172</a><a class="anker" href="#line173">173</a><a class="anker" href="#line174">174</a><a class="anker" href="#line175">175</a><a class="anker" href="#line176">176</a><a class="anker" href="#line177">177</a><a class="anker" href="#line178">178</a><a class="anker" href="#line179">179</a><a class="anker" href="#line180">180</a><a class="anker" href="#line181">181</a><a class="anker" href="#line182">182</a><a class="anker" href="#line183">183</a><a class="anker" href="#line184">184</a><a class="anker" href="#line185">185</a><a class="anker" href="#line186">186</a><a class="anker" href="#line187">187</a><a class="anker" href="#line188">188</a><a class="anker" href="#line189">189</a><a class="anker" href="#line190">190</a><a class="anker" href="#line191">191</a><a class="anker" href="#line192">192</a><a class="anker" href="#line193">193</a><a class="anker" href="#line194">194</a><a class="anker" href="#line195">195</a><a class="anker" href="#line196">196</a><a class="anker" href="#line197">197</a><a class="anker" href="#line198">198</a><a class="anker" href="#line199">199</a><a class="anker" href="#line200">200</a><a class="anker" href="#line201">201</a><a class="anker" href="#line202">202</a><a class="anker" href="#line203">203</a><a class="anker" href="#line204">204</a><a class="anker" href="#line205">205</a><a class="anker" href="#line206">206</a><a class="anker" href="#line207">207</a><a class="anker" href="#line208">208</a><a class="anker" href="#line209">209</a><a class="anker" href="#line210">210</a><a class="anker" href="#line211">211</a><a class="anker" href="#line212">212</a><a class="anker" href="#line213">213</a><a class="anker" href="#line214">214</a><a class="anker" href="#line215">215</a><a class="anker" href="#line216">216</a><a class="anker" href="#line217">217</a><a class="anker" href="#line218">218</a><a class="anker" href="#line219">219</a><a class="anker" href="#line220">220</a><a class="anker" href="#line221">221</a><a class="anker" href="#line222">222</a><a class="anker" href="#line223">223</a><a class="anker" href="#line224">224</a><a class="anker" href="#line225">225</a><a class="anker" href="#line226">226</a><a class="anker" href="#line227">227</a><a class="anker" href="#line228">228</a><a class="anker" href="#line229">229</a><a class="anker" href="#line230">230</a><a class="anker" href="#line231">231</a><a class="anker" href="#line232">232</a><a class="anker" href="#line233">233</a><a class="anker" href="#line234">234</a><a class="anker" href="#line235">235</a><a class="anker" href="#line236">236</a><a class="anker" href="#line237">237</a><a class="anker" href="#line238">238</a><a class="anker" href="#line239">239</a><a class="anker" href="#line240">240</a><a class="anker" href="#line241">241</a><a class="anker" href="#line242">242</a><a class="anker" href="#line243">243</a><a class="anker" href="#line244">244</a><a class="anker" href="#line245">245</a><a class="anker" href="#line246">246</a><a class="anker" href="#line247">247</a><a class="anker" href="#line248">248</a><a class="anker" href="#line249">249</a><a class="anker" href="#line250">250</a><a class="anker" href="#line251">251</a><a class="anker" href="#line252">252</a><a class="anker" href="#line253">253</a><a class="anker" href="#line254">254</a><a class="anker" href="#line255">255</a><a class="anker" href="#line256">256</a><a class="anker" href="#line257">257</a><a class="anker" href="#line258">258</a><a class="anker" href="#line259">259</a><a class="anker" href="#line260">260</a><a class="anker" href="#line261">261</a><a class="anker" href="#line262">262</a><a class="anker" href="#line263">263</a><a class="anker" href="#line264">264</a><a class="anker" href="#line265">265</a><a class="anker" href="#line266">266</a><a class="anker" href="#line267">267</a><a class="anker" href="#line268">268</a><a class="anker" href="#line269">269</a><a class="anker" href="#line270">270</a><a class="anker" href="#line271">271</a><a class="anker" href="#line272">272</a><a class="anker" href="#line273">273</a><a class="anker" href="#line274">274</a><a class="anker" href="#line275">275</a><a class="anker" href="#line276">276</a><a class="anker" href="#line277">277</a><a class="anker" href="#line278">278</a><a class="anker" href="#line279">279</a><a class="anker" href="#line280">280</a><a class="anker" href="#line281">281</a><a class="anker" href="#line282">282</a><a class="anker" href="#line283">283</a><a class="anker" href="#line284">284</a><a class="anker" href="#line285">285</a><a class="anker" href="#line286">286</a><a class="anker" href="#line287">287</a><a class="anker" href="#line288">288</a><a class="anker" href="#line289">289</a><a class="anker" href="#line290">290</a><a class="anker" href="#line291">291</a><a class="anker" href="#line292">292</a><a class="anker" href="#line293">293</a><a class="anker" href="#line294">294</a><a class="anker" href="#line295">295</a><a class="anker" href="#line296">296</a><a class="anker" href="#line297">297</a><a class="anker" href="#line298">298</a><a class="anker" href="#line299">299</a><a class="anker" href="#line300">300</a><a class="anker" href="#line301">301</a><a class="anker" href="#line302">302</a><a class="anker" href="#line303">303</a><a class="anker" href="#line304">304</a><a class="anker" href="#line305">305</a><a class="anker" href="#line306">306</a><a class="anker" href="#line307">307</a><a class="anker" href="#line308">308</a><a class="anker" href="#line309">309</a><a class="anker" href="#line310">310</a><a class="anker" href="#line311">311</a><a class="anker" href="#line312">312</a><a class="anker" href="#line313">313</a><a class="anker" href="#line314">314</a><a class="anker" href="#line315">315</a><a class="anker" href="#line316">316</a><a class="anker" href="#line317">317</a><a class="anker" href="#line318">318</a><a class="anker" href="#line319">319</a><a class="anker" href="#line320">320</a><a class="anker" href="#line321">321</a><a class="anker" href="#line322">322</a><a class="anker" href="#line323">323</a><a class="anker" href="#line324">324</a><a class="anker" href="#line325">325</a><a class="anker" href="#line326">326</a><a class="anker" href="#line327">327</a><a class="anker" href="#line328">328</a><a class="anker" href="#line329">329</a><a class="anker" href="#line330">330</a><a class="anker" href="#line331">331</a><a class="anker" href="#line332">332</a><a class="anker" href="#line333">333</a><a class="anker" href="#line334">334</a><a class="anker" href="#line335">335</a><a class="anker" href="#line336">336</a><a class="anker" href="#line337">337</a><a class="anker" href="#line338">338</a><a class="anker" href="#line339">339</a><a class="anker" href="#line340">340</a><a class="anker" href="#line341">341</a><a class="anker" href="#line342">342</a><a class="anker" href="#line343">343</a><a class="anker" href="#line344">344</a><a class="anker" href="#line345">345</a><a class="anker" href="#line346">346</a><a class="anker" href="#line347">347</a><a class="anker" href="#line348">348</a><a class="anker" href="#line349">349</a><a class="anker" href="#line350">350</a><a class="anker" href="#line351">351</a><a class="anker" href="#line352">352</a><a class="anker" href="#line353">353</a><a class="anker" href="#line354">354</a><a class="anker" href="#line355">355</a><a class="anker" href="#line356">356</a><a class="anker" href="#line357">357</a><a class="anker" href="#line358">358</a><a class="anker" href="#line359">359</a><a class="anker" href="#line360">360</a><a class="anker" href="#line361">361</a><a class="anker" href="#line362">362</a><a class="anker" href="#line363">363</a><a class="anker" href="#line364">364</a><a class="anker" href="#line365">365</a><a class="anker" href="#line366">366</a><a class="anker" href="#line367">367</a><a class="anker" href="#line368">368</a><a class="anker" href="#line369">369</a><a class="anker" href="#line370">370</a><a class="anker" href="#line371">371</a><a class="anker" href="#line372">372</a><a class="anker" href="#line373">373</a><a class="anker" href="#line374">374</a><a class="anker" href="#line375">375</a><a class="anker" href="#line376">376</a><a class="anker" href="#line377">377</a><a class="anker" href="#line378">378</a><a class="anker" href="#line379">379</a><a class="anker" href="#line380">380</a><a class="anker" href="#line381">381</a><a class="anker" href="#line382">382</a><a class="anker" href="#line383">383</a><a class="anker" href="#line384">384</a><a class="anker" href="#line385">385</a><a class="anker" href="#line386">386</a><a class="anker" href="#line387">387</a><a class="anker" href="#line388">388</a><a class="anker" href="#line389">389</a><a class="anker" href="#line390">390</a><a class="anker" href="#line391">391</a><a class="anker" href="#line392">392</a><a class="anker" href="#line393">393</a><a class="anker" href="#line394">394</a><a class="anker" href="#line395">395</a><a class="anker" href="#line396">396</a><a class="anker" href="#line397">397</a><a class="anker" href="#line398">398</a><a class="anker" href="#line399">399</a><a class="anker" href="#line400">400</a><a class="anker" href="#line401">401</a><a class="anker" href="#line402">402</a><a class="anker" href="#line403">403</a><a class="anker" href="#line404">404</a><a class="anker" href="#line405">405</a><a class="anker" href="#line406">406</a><a class="anker" href="#line407">407</a><a class="anker" href="#line408">408</a><a class="anker" href="#line409">409</a><a class="anker" href="#line410">410</a><a class="anker" href="#line411">411</a><a class="anker" href="#line412">412</a><a class="anker" href="#line413">413</a><a class="anker" href="#line414">414</a><a class="anker" href="#line415">415</a><a class="anker" href="#line416">416</a><a class="anker" href="#line417">417</a><a class="anker" href="#line418">418</a><a class="anker" href="#line419">419</a><a class="anker" href="#line420">420</a><a class="anker" href="#line421">421</a><a class="anker" href="#line422">422</a><a class="anker" href="#line423">423</a><a class="anker" href="#line424">424</a><a class="anker" href="#line425">425</a><a class="anker" href="#line426">426</a><a class="anker" href="#line427">427</a><a class="anker" href="#line428">428</a><a class="anker" href="#line429">429</a><a class="anker" href="#line430">430</a><a class="anker" href="#line431">431</a><a class="anker" href="#line432">432</a><a class="anker" href="#line433">433</a><a class="anker" href="#line434">434</a><a class="anker" href="#line435">435</a><a class="anker" href="#line436">436</a><a class="anker" href="#line437">437</a><a class="anker" href="#line438">438</a><a class="anker" href="#line439">439</a><a class="anker" href="#line440">440</a><a class="anker" href="#line441">441</a><a class="anker" href="#line442">442</a><a class="anker" href="#line443">443</a><a class="anker" href="#line444">444</a><a class="anker" href="#line445">445</a><a class="anker" href="#line446">446</a><a class="anker" href="#line447">447</a><a class="anker" href="#line448">448</a><a class="anker" href="#line449">449</a><a class="anker" href="#line450">450</a><a class="anker" href="#line451">451</a><a class="anker" href="#line452">452</a><a class="anker" href="#line453">453</a><a class="anker" href="#line454">454</a><a class="anker" href="#line455">455</a><a class="anker" href="#line456">456</a><a class="anker" href="#line457">457</a><a class="anker" href="#line458">458</a><a class="anker" href="#line459">459</a><a class="anker" href="#line460">460</a><a class="anker" href="#line461">461</a><a class="anker" href="#line462">462</a><a class="anker" href="#line463">463</a><a class="anker" href="#line464">464</a><a class="anker" href="#line465">465</a><a class="anker" href="#line466">466</a><a class="anker" href="#line467">467</a><a class="anker" href="#line468">468</a><a class="anker" href="#line469">469</a><a class="anker" href="#line470">470</a><a class="anker" href="#line471">471</a><a class="anker" href="#line472">472</a><a class="anker" href="#line473">473</a><a class="anker" href="#line474">474</a><a class="anker" href="#line475">475</a><a class="anker" href="#line476">476</a><a class="anker" href="#line477">477</a><a class="anker" href="#line478">478</a><a class="anker" href="#line479">479</a><a class="anker" href="#line480">480</a><a class="anker" href="#line481">481</a><a class="anker" href="#line482">482</a><a class="anker" href="#line483">483</a><a class="anker" href="#line484">484</a><a class="anker" href="#line485">485</a><a class="anker" href="#line486">486</a><a class="anker" href="#line487">487</a><a class="anker" href="#line488">488</a><a class="anker" href="#line489">489</a><a class="anker" href="#line490">490</a><a class="anker" href="#line491">491</a><a class="anker" href="#line492">492</a><a class="anker" href="#line493">493</a><a class="anker" href="#line494">494</a><a class="anker" href="#line495">495</a><a class="anker" href="#line496">496</a><a class="anker" href="#line497">497</a><a class="anker" href="#line498">498</a><a class="anker" href="#line499">499</a><a class="anker" href="#line500">500</a><a class="anker" href="#line501">501</a><a class="anker" href="#line502">502</a><a class="anker" href="#line503">503</a><a class="anker" href="#line504">504</a><a class="anker" href="#line505">505</a><a class="anker" href="#line506">506</a><a class="anker" href="#line507">507</a><a class="anker" href="#line508">508</a><a class="anker" href="#line509">509</a><a class="anker" href="#line510">510</a><a class="anker" href="#line511">511</a><a class="anker" href="#line512">512</a><a class="anker" href="#line513">513</a><a class="anker" href="#line514">514</a><a class="anker" href="#line515">515</a><a class="anker" href="#line516">516</a><a class="anker" href="#line517">517</a><a class="anker" href="#line518">518</a><a class="anker" href="#line519">519</a><a class="anker" href="#line520">520</a><a class="anker" href="#line521">521</a><a class="anker" href="#line522">522</a><a class="anker" href="#line523">523</a><a class="anker" href="#line524">524</a><a class="anker" href="#line525">525</a><a class="anker" href="#line526">526</a><a class="anker" href="#line527">527</a><a class="anker" href="#line528">528</a><a class="anker" href="#line529">529</a><a class="anker" href="#line530">530</a><a class="anker" href="#line531">531</a><a class="anker" href="#line532">532</a><a class="anker" href="#line533">533</a><a class="anker" href="#line534">534</a><a class="anker" href="#line535">535</a><a class="anker" href="#line536">536</a><a class="anker" href="#line537">537</a><a class="anker" href="#line538">538</a><a class="anker" href="#line539">539</a><a class="anker" href="#line540">540</a><a class="anker" href="#line541">541</a><a class="anker" href="#line542">542</a><a class="anker" href="#line543">543</a><a class="anker" href="#line544">544</a><a class="anker" href="#line545">545</a><a class="anker" href="#line546">546</a><a class="anker" href="#line547">547</a><a class="anker" href="#line548">548</a><a class="anker" href="#line549">549</a><a class="anker" href="#line550">550</a><a class="anker" href="#line551">551</a><a class="anker" href="#line552">552</a><a class="anker" href="#line553">553</a><a class="anker" href="#line554">554</a><a class="anker" href="#line555">555</a><a class="anker" href="#line556">556</a><a class="anker" href="#line557">557</a><a class="anker" href="#line558">558</a><a class="anker" href="#line559">559</a><a class="anker" href="#line560">560</a><a class="anker" href="#line561">561</a><a class="anker" href="#line562">562</a><a class="anker" href="#line563">563</a><a class="anker" href="#line564">564</a><a class="anker" href="#line565">565</a><a class="anker" href="#line566">566</a><a class="anker" href="#line567">567</a><a class="anker" href="#line568">568</a><a class="anker" href="#line569">569</a><a class="anker" href="#line570">570</a><a class="anker" href="#line571">571</a><a class="anker" href="#line572">572</a><a class="anker" href="#line573">573</a><a class="anker" href="#line574">574</a><a class="anker" href="#line575">575</a><a class="anker" href="#line576">576</a><a class="anker" href="#line577">577</a><a class="anker" href="#line578">578</a><a class="anker" href="#line579">579</a><a class="anker" href="#line580">580</a><a class="anker" href="#line581">581</a><a class="anker" href="#line582">582</a><a class="anker" href="#line583">583</a><a class="anker" href="#line584">584</a><a class="anker" href="#line585">585</a><a class="anker" href="#line586">586</a><a class="anker" href="#line587">587</a><a class="anker" href="#line588">588</a><a class="anker" href="#line589">589</a><a class="anker" href="#line590">590</a><a class="anker" href="#line591">591</a><a class="anker" href="#line592">592</a><a class="anker" href="#line593">593</a><a class="anker" href="#line594">594</a><a class="anker" href="#line595">595</a><a class="anker" href="#line596">596</a><a class="anker" href="#line597">597</a><a class="anker" href="#line598">598</a><a class="anker" href="#line599">599</a><a class="anker" href="#line600">600</a><a class="anker" href="#line601">601</a><a class="anker" href="#line602">602</a><a class="anker" href="#line603">603</a><a class="anker" href="#line604">604</a><a class="anker" href="#line605">605</a><a class="anker" href="#line606">606</a><a class="anker" href="#line607">607</a><a class="anker" href="#line608">608</a><a class="anker" href="#line609">609</a><a class="anker" href="#line610">610</a><a class="anker" href="#line611">611</a><a class="anker" href="#line612">612</a><a class="anker" href="#line613">613</a><a class="anker" href="#line614">614</a><a class="anker" href="#line615">615</a><a class="anker" href="#line616">616</a><a class="anker" href="#line617">617</a><a class="anker" href="#line618">618</a><a class="anker" href="#line619">619</a><a class="anker" href="#line620">620</a><a class="anker" href="#line621">621</a><a class="anker" href="#line622">622</a><a class="anker" href="#line623">623</a><a class="anker" href="#line624">624</a><a class="anker" href="#line625">625</a><a class="anker" href="#line626">626</a><a class="anker" href="#line627">627</a><a class="anker" href="#line628">628</a><a class="anker" href="#line629">629</a><a class="anker" href="#line630">630</a><a class="anker" href="#line631">631</a><a class="anker" href="#line632">632</a><a class="anker" href="#line633">633</a><a class="anker" href="#line634">634</a><a class="anker" href="#line635">635</a><a class="anker" href="#line636">636</a><a class="anker" href="#line637">637</a><a class="anker" href="#line638">638</a><a class="anker" href="#line639">639</a><a class="anker" href="#line640">640</a><a class="anker" href="#line641">641</a><a class="anker" href="#line642">642</a><a class="anker" href="#line643">643</a><a class="anker" href="#line644">644</a><a class="anker" href="#line645">645</a><a class="anker" href="#line646">646</a><a class="anker" href="#line647">647</a><a class="anker" href="#line648">648</a><a class="anker" href="#line649">649</a><a class="anker" href="#line650">650</a><a class="anker" href="#line651">651</a><a class="anker" href="#line652">652</a><a class="anker" href="#line653">653</a><a class="anker" href="#line654">654</a><a class="anker" href="#line655">655</a><a class="anker" href="#line656">656</a><a class="anker" href="#line657">657</a><a class="anker" href="#line658">658</a><a class="anker" href="#line659">659</a><a class="anker" href="#line660">660</a><a class="anker" href="#line661">661</a><a class="anker" href="#line662">662</a><a class="anker" href="#line663">663</a><a class="anker" href="#line664">664</a><a class="anker" href="#line665">665</a><a class="anker" href="#line666">666</a><a class="anker" href="#line667">667</a><a class="anker" href="#line668">668</a><a class="anker" href="#line669">669</a><a class="anker" href="#line670">670</a><a class="anker" href="#line671">671</a><a class="anker" href="#line672">672</a><a class="anker" href="#line673">673</a><a class="anker" href="#line674">674</a><a class="anker" href="#line675">675</a><a class="anker" href="#line676">676</a><a class="anker" href="#line677">677</a><a class="anker" href="#line678">678</a><a class="anker" href="#line679">679</a><a class="anker" href="#line680">680</a><a class="anker" href="#line681">681</a><a class="anker" href="#line682">682</a><a class="anker" href="#line683">683</a><a class="anker" href="#line684">684</a><a class="anker" href="#line685">685</a><a class="anker" href="#line686">686</a><a class="anker" href="#line687">687</a><a class="anker" href="#line688">688</a><a class="anker" href="#line689">689</a><a class="anker" href="#line690">690</a><a class="anker" href="#line691">691</a><a class="anker" href="#line692">692</a><a class="anker" href="#line693">693</a><a class="anker" href="#line694">694</a><a class="anker" href="#line695">695</a><a class="anker" href="#line696">696</a><a class="anker" href="#line697">697</a><a class="anker" href="#line698">698</a><a class="anker" href="#line699">699</a><a class="anker" href="#line700">700</a><a class="anker" href="#line701">701</a><a class="anker" href="#line702">702</a><a class="anker" href="#line703">703</a><a class="anker" href="#line704">704</a><a class="anker" href="#line705">705</a><a class="anker" href="#line706">706</a><a class="anker" href="#line707">707</a><a class="anker" href="#line708">708</a><a class="anker" href="#line709">709</a><a class="anker" href="#line710">710</a><a class="anker" href="#line711">711</a><a class="anker" href="#line712">712</a><a class="anker" href="#line713">713</a><a class="anker" href="#line714">714</a><a class="anker" href="#line715">715</a><a class="anker" href="#line716">716</a><a class="anker" href="#line717">717</a><a class="anker" href="#line718">718</a><a class="anker" href="#line719">719</a><a class="anker" href="#line720">720</a><a class="anker" href="#line721">721</a><a class="anker" href="#line722">722</a><a class="anker" href="#line723">723</a><a class="anker" href="#line724">724</a><a class="anker" href="#line725">725</a><a class="anker" href="#line726">726</a><a class="anker" href="#line727">727</a><a class="anker" href="#line728">728</a><a class="anker" href="#line729">729</a><a class="anker" href="#line730">730</a><a class="anker" href="#line731">731</a><a class="anker" href="#line732">732</a><a class="anker" href="#line733">733</a><a class="anker" href="#line734">734</a><a class="anker" href="#line735">735</a><a class="anker" href="#line736">736</a><a class="anker" href="#line737">737</a><a class="anker" href="#line738">738</a><a class="anker" href="#line739">739</a><a class="anker" href="#line740">740</a><a class="anker" href="#line741">741</a><a class="anker" href="#line742">742</a><a class="anker" href="#line743">743</a><a class="anker" href="#line744">744</a><a class="anker" href="#line745">745</a><a class="anker" href="#line746">746</a><a class="anker" href="#line747">747</a><a class="anker" href="#line748">748</a><a class="anker" href="#line749">749</a><a class="anker" href="#line750">750</a><a class="anker" href="#line751">751</a><a class="anker" href="#line752">752</a><a class="anker" href="#line753">753</a><a class="anker" href="#line754">754</a><a class="anker" href="#line755">755</a><a class="anker" href="#line756">756</a><a class="anker" href="#line757">757</a><a class="anker" href="#line758">758</a><a class="anker" href="#line759">759</a><a class="anker" href="#line760">760</a><a class="anker" href="#line761">761</a><a class="anker" href="#line762">762</a><a class="anker" href="#line763">763</a><a class="anker" href="#line764">764</a><a class="anker" href="#line765">765</a><a class="anker" href="#line766">766</a><a class="anker" href="#line767">767</a><a class="anker" href="#line768">768</a><a class="anker" href="#line769">769</a><a class="anker" href="#line770">770</a><a class="anker" href="#line771">771</a><a class="anker" href="#line772">772</a><a class="anker" href="#line773">773</a><a class="anker" href="#line774">774</a><a class="anker" href="#line775">775</a><a class="anker" href="#line776">776</a><a class="anker" href="#line777">777</a><a class="anker" href="#line778">778</a><a class="anker" href="#line779">779</a><a class="anker" href="#line780">780</a><a class="anker" href="#line781">781</a><a class="anker" href="#line782">782</a><a class="anker" href="#line783">783</a><a class="anker" href="#line784">784</a><a class="anker" href="#line785">785</a><a class="anker" href="#line786">786</a><a class="anker" href="#line787">787</a><a class="anker" href="#line788">788</a><a class="anker" href="#line789">789</a><a class="anker" href="#line790">790</a><a class="anker" href="#line791">791</a><a class="anker" href="#line792">792</a><a class="anker" href="#line793">793</a><a class="anker" href="#line794">794</a><a class="anker" href="#line795">795</a><a class="anker" href="#line796">796</a><a class="anker" href="#line797">797</a><a class="anker" href="#line798">798</a><a class="anker" href="#line799">799</a><a class="anker" href="#line800">800</a><a class="anker" href="#line801">801</a><a class="anker" href="#line802">802</a><a class="anker" href="#line803">803</a><a class="anker" href="#line804">804</a><a class="anker" href="#line805">805</a><a class="anker" href="#line806">806</a><a class="anker" href="#line807">807</a><a class="anker" href="#line808">808</a><a class="anker" href="#line809">809</a><a class="anker" href="#line810">810</a><a class="anker" href="#line811">811</a><a class="anker" href="#line812">812</a><a class="anker" href="#line813">813</a><a class="anker" href="#line814">814</a><a class="anker" href="#line815">815</a><a class="anker" href="#line816">816</a><a class="anker" href="#line817">817</a><a class="anker" href="#line818">818</a><a class="anker" href="#line819">819</a><a class="anker" href="#line820">820</a><a class="anker" href="#line821">821</a><a class="anker" href="#line822">822</a><a class="anker" href="#line823">823</a><a class="anker" href="#line824">824</a><a class="anker" href="#line825">825</a><a class="anker" href="#line826">826</a><a class="anker" href="#line827">827</a><a class="anker" href="#line828">828</a><a class="anker" href="#line829">829</a><a class="anker" href="#line830">830</a><a class="anker" href="#line831">831</a><a class="anker" href="#line832">832</a><a class="anker" href="#line833">833</a><a class="anker" href="#line834">834</a><a class="anker" href="#line835">835</a><a class="anker" href="#line836">836</a><a class="anker" href="#line837">837</a><a class="anker" href="#line838">838</a><a class="anker" href="#line839">839</a><a class="anker" href="#line840">840</a><a class="anker" href="#line841">841</a><a class="anker" href="#line842">842</a><a class="anker" href="#line843">843</a><a class="anker" href="#line844">844</a><a class="anker" href="#line845">845</a><a class="anker" href="#line846">846</a><a class="anker" href="#line847">847</a><a class="anker" href="#line848">848</a><a class="anker" href="#line849">849</a><a class="anker" href="#line850">850</a><a class="anker" href="#line851">851</a><a class="anker" href="#line852">852</a><a class="anker" href="#line853">853</a><a class="anker" href="#line854">854</a><a class="anker" href="#line855">855</a><a class="anker" href="#line856">856</a><a class="anker" href="#line857">857</a><a class="anker" href="#line858">858</a><a class="anker" href="#line859">859</a><a class="anker" href="#line860">860</a><a class="anker" href="#line861">861</a><a class="anker" href="#line862">862</a><a class="anker" href="#line863">863</a><a class="anker" href="#line864">864</a><a class="anker" href="#line865">865</a><a class="anker" href="#line866">866</a><a class="anker" href="#line867">867</a><a class="anker" href="#line868">868</a><a class="anker" href="#line869">869</a><a class="anker" href="#line870">870</a><a class="anker" href="#line871">871</a><a class="anker" href="#line872">872</a><a class="anker" href="#line873">873</a><a class="anker" href="#line874">874</a><a class="anker" href="#line875">875</a><a class="anker" href="#line876">876</a><a class="anker" href="#line877">877</a><a class="anker" href="#line878">878</a><a class="anker" href="#line879">879</a><a class="anker" href="#line880">880</a><a class="anker" href="#line881">881</a><a class="anker" href="#line882">882</a><a class="anker" href="#line883">883</a><a class="anker" href="#line884">884</a><a class="anker" href="#line885">885</a><a class="anker" href="#line886">886</a><a class="anker" href="#line887">887</a><a class="anker" href="#line888">888</a><a class="anker" href="#line889">889</a><a class="anker" href="#line890">890</a><a class="anker" href="#line891">891</a><a class="anker" href="#line892">892</a><a class="anker" href="#line893">893</a><a class="anker" href="#line894">894</a><a class="anker" href="#line895">895</a><a class="anker" href="#line896">896</a><a class="anker" href="#line897">897</a><a class="anker" href="#line898">898</a><a class="anker" href="#line899">899</a><a class="anker" href="#line900">900</a><a class="anker" href="#line901">901</a><a class="anker" href="#line902">902</a><a class="anker" href="#line903">903</a><a class="anker" href="#line904">904</a><a class="anker" href="#line905">905</a><a class="anker" href="#line906">906</a><a class="anker" href="#line907">907</a><a class="anker" href="#line908">908</a><a class="anker" href="#line909">909</a><a class="anker" href="#line910">910</a><a class="anker" href="#line911">911</a><a class="anker" href="#line912">912</a><a class="anker" href="#line913">913</a><a class="anker" href="#line914">914</a><a class="anker" href="#line915">915</a><a class="anker" href="#line916">916</a><a class="anker" href="#line917">917</a><a class="anker" href="#line918">918</a><a class="anker" href="#line919">919</a><a class="anker" href="#line920">920</a><a class="anker" href="#line921">921</a><a class="anker" href="#line922">922</a><a class="anker" href="#line923">923</a><a class="anker" href="#line924">924</a><a class="anker" href="#line925">925</a><a class="anker" href="#line926">926</a><a class="anker" href="#line927">927</a><a class="anker" href="#line928">928</a><a class="anker" href="#line929">929</a><a class="anker" href="#line930">930</a><a class="anker" href="#line931">931</a><a class="anker" href="#line932">932</a><a class="anker" href="#line933">933</a><a class="anker" href="#line934">934</a><a class="anker" href="#line935">935</a><a class="anker" href="#line936">936</a><a class="anker" href="#line937">937</a><a class="anker" href="#line938">938</a><a class="anker" href="#line939">939</a><a class="anker" href="#line940">940</a><a class="anker" href="#line941">941</a><a class="anker" href="#line942">942</a><a class="anker" href="#line943">943</a><a class="anker" href="#line944">944</a><a class="anker" href="#line945">945</a><a class="anker" href="#line946">946</a><a class="anker" href="#line947">947</a><a class="anker" href="#line948">948</a><a class="anker" href="#line949">949</a><a class="anker" href="#line950">950</a><a class="anker" href="#line951">951</a><a class="anker" href="#line952">952</a><a class="anker" href="#line953">953</a><a class="anker" href="#line954">954</a><a class="anker" href="#line955">955</a><a class="anker" href="#line956">956</a><a class="anker" href="#line957">957</a><a class="anker" href="#line958">958</a><a class="anker" href="#line959">959</a><a class="anker" href="#line960">960</a><a class="anker" href="#line961">961</a><a class="anker" href="#line962">962</a><a class="anker" href="#line963">963</a><a class="anker" href="#line964">964</a><a class="anker" href="#line965">965</a><a class="anker" href="#line966">966</a><a class="anker" href="#line967">967</a><a class="anker" href="#line968">968</a><a class="anker" href="#line969">969</a><a class="anker" href="#line970">970</a><a class="anker" href="#line971">971</a><a class="anker" href="#line972">972</a><a class="anker" href="#line973">973</a><a class="anker" href="#line974">974</a><a class="anker" href="#line975">975</a><a class="anker" href="#line976">976</a><a class="anker" href="#line977">977</a><a class="anker" href="#line978">978</a><a class="anker" href="#line979">979</a><a class="anker" href="#line980">980</a><a class="anker" href="#line981">981</a><a class="anker" href="#line982">982</a><a class="anker" href="#line983">983</a><a class="anker" href="#line984">984</a><a class="anker" href="#line985">985</a><a class="anker" href="#line986">986</a><a class="anker" href="#line987">987</a><a class="anker" href="#line988">988</a><a class="anker" href="#line989">989</a><a class="anker" href="#line990">990</a><a class="anker" href="#line991">991</a><a class="anker" href="#line992">992</a><a class="anker" href="#line993">993</a><a class="anker" href="#line994">994</a><a class="anker" href="#line995">995</a><a class="anker" href="#line996">996</a><a class="anker" href="#line997">997</a><a class="anker" href="#line998">998</a><a class="anker" href="#line999">999</a><a class="anker" href="#line1000">1000</a><a class="anker" href="#line1001">1001</a><a class="anker" href="#line1002">1002</a><a class="anker" href="#line1003">1003</a><a class="anker" href="#line1004">1004</a><a class="anker" href="#line1005">1005</a><a class="anker" href="#line1006">1006</a><a class="anker" href="#line1007">1007</a><a class="anker" href="#line1008">1008</a><a class="anker" href="#line1009">1009</a><a class="anker" href="#line1010">1010</a><a class="anker" href="#line1011">1011</a><a class="anker" href="#line1012">1012</a><a class="anker" href="#line1013">1013</a><a class="anker" href="#line1014">1014</a><a class="anker" href="#line1015">1015</a><a class="anker" href="#line1016">1016</a><a class="anker" href="#line1017">1017</a><a class="anker" href="#line1018">1018</a><a class="anker" href="#line1019">1019</a><a class="anker" href="#line1020">1020</a><a class="anker" href="#line1021">1021</a><a class="anker" href="#line1022">1022</a><a class="anker" href="#line1023">1023</a><a class="anker" href="#line1024">1024</a><a class="anker" href="#line1025">1025</a><a class="anker" href="#line1026">1026</a><a class="anker" href="#line1027">1027</a><a class="anker" href="#line1028">1028</a><a class="anker" href="#line1029">1029</a><a class="anker" href="#line1030">1030</a><a class="anker" href="#line1031">1031</a><a class="anker" href="#line1032">1032</a><a class="anker" href="#line1033">1033</a><a class="anker" href="#line1034">1034</a><a class="anker" href="#line1035">1035</a><a class="anker" href="#line1036">1036</a><a class="anker" href="#line1037">1037</a><a class="anker" href="#line1038">1038</a><a class="anker" href="#line1039">1039</a><a class="anker" href="#line1040">1040</a><a class="anker" href="#line1041">1041</a><a class="anker" href="#line1042">1042</a><a class="anker" href="#line1043">1043</a><a class="anker" href="#line1044">1044</a><a class="anker" href="#line1045">1045</a><a class="anker" href="#line1046">1046</a><a class="anker" href="#line1047">1047</a><a class="anker" href="#line1048">1048</a><a class="anker" href="#line1049">1049</a><a class="anker" href="#line1050">1050</a><a class="anker" href="#line1051">1051</a><a class="anker" href="#line1052">1052</a><a class="anker" href="#line1053">1053</a><a class="anker" href="#line1054">1054</a><a class="anker" href="#line1055">1055</a><a class="anker" href="#line1056">1056</a><a class="anker" href="#line1057">1057</a><a class="anker" href="#line1058">1058</a><a class="anker" href="#line1059">1059</a><a class="anker" href="#line1060">1060</a><a class="anker" href="#line1061">1061</a><a class="anker" href="#line1062">1062</a><a class="anker" href="#line1063">1063</a><a class="anker" href="#line1064">1064</a><a class="anker" href="#line1065">1065</a><a class="anker" href="#line1066">1066</a><a class="anker" href="#line1067">1067</a><a class="anker" href="#line1068">1068</a><a class="anker" href="#line1069">1069</a><a class="anker" href="#line1070">1070</a><a class="anker" href="#line1071">1071</a><a class="anker" href="#line1072">1072</a><a class="anker" href="#line1073">1073</a><a class="anker" href="#line1074">1074</a><a class="anker" href="#line1075">1075</a><a class="anker" href="#line1076">1076</a><a class="anker" href="#line1077">1077</a><a class="anker" href="#line1078">1078</a><a class="anker" href="#line1079">1079</a><a class="anker" href="#line1080">1080</a><a class="anker" href="#line1081">1081</a><a class="anker" href="#line1082">1082</a><a class="anker" href="#line1083">1083</a><a class="anker" href="#line1084">1084</a><a class="anker" href="#line1085">1085</a><a class="anker" href="#line1086">1086</a><a class="anker" href="#line1087">1087</a><a class="anker" href="#line1088">1088</a><a class="anker" href="#line1089">1089</a><a class="anker" href="#line1090">1090</a><a class="anker" href="#line1091">1091</a><a class="anker" href="#line1092">1092</a><a class="anker" href="#line1093">1093</a><a class="anker" href="#line1094">1094</a><a class="anker" href="#line1095">1095</a><a class="anker" href="#line1096">1096</a><a class="anker" href="#line1097">1097</a><a class="anker" href="#line1098">1098</a><a class="anker" href="#line1099">1099</a><a class="anker" href="#line1100">1100</a><a class="anker" href="#line1101">1101</a><a class="anker" href="#line1102">1102</a><a class="anker" href="#line1103">1103</a><a class="anker" href="#line1104">1104</a><a class="anker" href="#line1105">1105</a><a class="anker" href="#line1106">1106</a><a class="anker" href="#line1107">1107</a><a class="anker" href="#line1108">1108</a><a class="anker" href="#line1109">1109</a><a class="anker" href="#line1110">1110</a><a class="anker" href="#line1111">1111</a><a class="anker" href="#line1112">1112</a><a class="anker" href="#line1113">1113</a><a class="anker" href="#line1114">1114</a><a class="anker" href="#line1115">1115</a><a class="anker" href="#line1116">1116</a><a class="anker" href="#line1117">1117</a><a class="anker" href="#line1118">1118</a><a class="anker" href="#line1119">1119</a><a class="anker" href="#line1120">1120</a><a class="anker" href="#line1121">1121</a><a class="anker" href="#line1122">1122</a><a class="anker" href="#line1123">1123</a><a class="anker" href="#line1124">1124</a><a class="anker" href="#line1125">1125</a><a class="anker" href="#line1126">1126</a><a class="anker" href="#line1127">1127</a><a class="anker" href="#line1128">1128</a><a class="anker" href="#line1129">1129</a><a class="anker" href="#line1130">1130</a><a class="anker" href="#line1131">1131</a><a class="anker" href="#line1132">1132</a><a class="anker" href="#line1133">1133</a><a class="anker" href="#line1134">1134</a><a class="anker" href="#line1135">1135</a><a class="anker" href="#line1136">1136</a><a class="anker" href="#line1137">1137</a><a class="anker" href="#line1138">1138</a><a class="anker" href="#line1139">1139</a><a class="anker" href="#line1140">1140</a><a class="anker" href="#line1141">1141</a><a class="anker" href="#line1142">1142</a><a class="anker" href="#line1143">1143</a><a class="anker" href="#line1144">1144</a><a class="anker" href="#line1145">1145</a><a class="anker" href="#line1146">1146</a><a class="anker" href="#line1147">1147</a><a class="anker" href="#line1148">1148</a><a class="anker" href="#line1149">1149</a><a class="anker" href="#line1150">1150</a><a class="anker" href="#line1151">1151</a><a class="anker" href="#line1152">1152</a><a class="anker" href="#line1153">1153</a><a class="anker" href="#line1154">1154</a><a class="anker" href="#line1155">1155</a><a class="anker" href="#line1156">1156</a><a class="anker" href="#line1157">1157</a><a class="anker" href="#line1158">1158</a><a class="anker" href="#line1159">1159</a><a class="anker" href="#line1160">1160</a><a class="anker" href="#line1161">1161</a><a class="anker" href="#line1162">1162</a><a class="anker" href="#line1163">1163</a><a class="anker" href="#line1164">1164</a><a class="anker" href="#line1165">1165</a><a class="anker" href="#line1166">1166</a><a class="anker" href="#line1167">1167</a><a class="anker" href="#line1168">1168</a><a class="anker" href="#line1169">1169</a><a class="anker" href="#line1170">1170</a><a class="anker" href="#line1171">1171</a><a class="anker" href="#line1172">1172</a><a class="anker" href="#line1173">1173</a><a class="anker" href="#line1174">1174</a><a class="anker" href="#line1175">1175</a><a class="anker" href="#line1176">1176</a><a class="anker" href="#line1177">1177</a><a class="anker" href="#line1178">1178</a><a class="anker" href="#line1179">1179</a><a class="anker" href="#line1180">1180</a><a class="anker" href="#line1181">1181</a><a class="anker" href="#line1182">1182</a><a class="anker" href="#line1183">1183</a><a class="anker" href="#line1184">1184</a><a class="anker" href="#line1185">1185</a><a class="anker" href="#line1186">1186</a><a class="anker" href="#line1187">1187</a><a class="anker" href="#line1188">1188</a><a class="anker" href="#line1189">1189</a><a class="anker" href="#line1190">1190</a><a class="anker" href="#line1191">1191</a><a class="anker" href="#line1192">1192</a><a class="anker" href="#line1193">1193</a><a class="anker" href="#line1194">1194</a><a class="anker" href="#line1195">1195</a><a class="anker" href="#line1196">1196</a><a class="anker" href="#line1197">1197</a><a class="anker" href="#line1198">1198</a><a class="anker" href="#line1199">1199</a><a class="anker" href="#line1200">1200</a><a class="anker" href="#line1201">1201</a><a class="anker" href="#line1202">1202</a><a class="anker" href="#line1203">1203</a><a class="anker" href="#line1204">1204</a><a class="anker" href="#line1205">1205</a><a class="anker" href="#line1206">1206</a><a class="anker" href="#line1207">1207</a><a class="anker" href="#line1208">1208</a><a class="anker" href="#line1209">1209</a><a class="anker" href="#line1210">1210</a><a class="anker" href="#line1211">1211</a><a class="anker" href="#line1212">1212</a><a class="anker" href="#line1213">1213</a><a class="anker" href="#line1214">1214</a><a class="anker" href="#line1215">1215</a><a class="anker" href="#line1216">1216</a><a class="anker" href="#line1217">1217</a><a class="anker" href="#line1218">1218</a><a class="anker" href="#line1219">1219</a><a class="anker" href="#line1220">1220</a><a class="anker" href="#line1221">1221</a><a class="anker" href="#line1222">1222</a><a class="anker" href="#line1223">1223</a><a class="anker" href="#line1224">1224</a><a class="anker" href="#line1225">1225</a><a class="anker" href="#line1226">1226</a><a class="anker" href="#line1227">1227</a><a class="anker" href="#line1228">1228</a><a class="anker" href="#line1229">1229</a><a class="anker" href="#line1230">1230</a><a class="anker" href="#line1231">1231</a><a class="anker" href="#line1232">1232</a><a class="anker" href="#line1233">1233</a><a class="anker" href="#line1234">1234</a><a class="anker" href="#line1235">1235</a><a class="anker" href="#line1236">1236</a><a class="anker" href="#line1237">1237</a><a class="anker" href="#line1238">1238</a><a class="anker" href="#line1239">1239</a><a class="anker" href="#line1240">1240</a><a class="anker" href="#line1241">1241</a><a class="anker" href="#line1242">1242</a><a class="anker" href="#line1243">1243</a><a class="anker" href="#line1244">1244</a><a class="anker" href="#line1245">1245</a><a class="anker" href="#line1246">1246</a><a class="anker" href="#line1247">1247</a><a class="anker" href="#line1248">1248</a><a class="anker" href="#line1249">1249</a><a class="anker" href="#line1250">1250</a><a class="anker" href="#line1251">1251</a><a class="anker" href="#line1252">1252</a><a class="anker" href="#line1253">1253</a><a class="anker" href="#line1254">1254</a><a class="anker" href="#line1255">1255</a><a class="anker" href="#line1256">1256</a><a class="anker" href="#line1257">1257</a><a class="anker" href="#line1258">1258</a><a class="anker" href="#line1259">1259</a><a class="anker" href="#line1260">1260</a><a class="anker" href="#line1261">1261</a><a class="anker" href="#line1262">1262</a><a class="anker" href="#line1263">1263</a><a class="anker" href="#line1264">1264</a><a class="anker" href="#line1265">1265</a><a class="anker" href="#line1266">1266</a><a class="anker" href="#line1267">1267</a><a class="anker" href="#line1268">1268</a><a class="anker" href="#line1269">1269</a><a class="anker" href="#line1270">1270</a><a class="anker" href="#line1271">1271</a><a class="anker" href="#line1272">1272</a><a class="anker" href="#line1273">1273</a><a class="anker" href="#line1274">1274</a><a class="anker" href="#line1275">1275</a><a class="anker" href="#line1276">1276</a><a class="anker" href="#line1277">1277</a><a class="anker" href="#line1278">1278</a><a class="anker" href="#line1279">1279</a><a class="anker" href="#line1280">1280</a><a class="anker" href="#line1281">1281</a><a class="anker" href="#line1282">1282</a><a class="anker" href="#line1283">1283</a><a class="anker" href="#line1284">1284</a><a class="anker" href="#line1285">1285</a><a class="anker" href="#line1286">1286</a><a class="anker" href="#line1287">1287</a><a class="anker" href="#line1288">1288</a><a class="anker" href="#line1289">1289</a><a class="anker" href="#line1290">1290</a><a class="anker" href="#line1291">1291</a><a class="anker" href="#line1292">1292</a><a class="anker" href="#line1293">1293</a><a class="anker" href="#line1294">1294</a><a class="anker" href="#line1295">1295</a><a class="anker" href="#line1296">1296</a><a class="anker" href="#line1297">1297</a><a class="anker" href="#line1298">1298</a><a class="anker" href="#line1299">1299</a><a class="anker" href="#line1300">1300</a><a class="anker" href="#line1301">1301</a><a class="anker" href="#line1302">1302</a><a class="anker" href="#line1303">1303</a><a class="anker" href="#line1304">1304</a><a class="anker" href="#line1305">1305</a><a class="anker" href="#line1306">1306</a><a class="anker" href="#line1307">1307</a><a class="anker" href="#line1308">1308</a><a class="anker" href="#line1309">1309</a><a class="anker" href="#line1310">1310</a><a class="anker" href="#line1311">1311</a><a class="anker" href="#line1312">1312</a><a class="anker" href="#line1313">1313</a><a class="anker" href="#line1314">1314</a><a class="anker" href="#line1315">1315</a><a class="anker" href="#line1316">1316</a><a class="anker" href="#line1317">1317</a><a class="anker" href="#line1318">1318</a><a class="anker" href="#line1319">1319</a><a class="anker" href="#line1320">1320</a><a class="anker" href="#line1321">1321</a><a class="anker" href="#line1322">1322</a><a class="anker" href="#line1323">1323</a><a class="anker" href="#line1324">1324</a><a class="anker" href="#line1325">1325</a><a class="anker" href="#line1326">1326</a><a class="anker" href="#line1327">1327</a><a class="anker" href="#line1328">1328</a><a class="anker" href="#line1329">1329</a><a class="anker" href="#line1330">1330</a><a class="anker" href="#line1331">1331</a><a class="anker" href="#line1332">1332</a><a class="anker" href="#line1333">1333</a><a class="anker" href="#line1334">1334</a><a class="anker" href="#line1335">1335</a><a class="anker" href="#line1336">1336</a><a class="anker" href="#line1337">1337</a><a class="anker" href="#line1338">1338</a><a class="anker" href="#line1339">1339</a><a class="anker" href="#line1340">1340</a><a class="anker" href="#line1341">1341</a><a class="anker" href="#line1342">1342</a><a class="anker" href="#line1343">1343</a><a class="anker" href="#line1344">1344</a><a class="anker" href="#line1345">1345</a><a class="anker" href="#line1346">1346</a><a class="anker" href="#line1347">1347</a><a class="anker" href="#line1348">1348</a><a class="anker" href="#line1349">1349</a><a class="anker" href="#line1350">1350</a><a class="anker" href="#line1351">1351</a><a class="anker" href="#line1352">1352</a><a class="anker" href="#line1353">1353</a><a class="anker" href="#line1354">1354</a><a class="anker" href="#line1355">1355</a><a class="anker" href="#line1356">1356</a><a class="anker" href="#line1357">1357</a><a class="anker" href="#line1358">1358</a><a class="anker" href="#line1359">1359</a><a class="anker" href="#line1360">1360</a><a class="anker" href="#line1361">1361</a><a class="anker" href="#line1362">1362</a><a class="anker" href="#line1363">1363</a><a class="anker" href="#line1364">1364</a><a class="anker" href="#line1365">1365</a><a class="anker" href="#line1366">1366</a><a class="anker" href="#line1367">1367</a><a class="anker" href="#line1368">1368</a><a class="anker" href="#line1369">1369</a><a class="anker" href="#line1370">1370</a><a class="anker" href="#line1371">1371</a><a class="anker" href="#line1372">1372</a><a class="anker" href="#line1373">1373</a><a class="anker" href="#line1374">1374</a><a class="anker" href="#line1375">1375</a><a class="anker" href="#line1376">1376</a><a class="anker" href="#line1377">1377</a><a class="anker" href="#line1378">1378</a><a class="anker" href="#line1379">1379</a><a class="anker" href="#line1380">1380</a><a class="anker" href="#line1381">1381</a><a class="anker" href="#line1382">1382</a><a class="anker" href="#line1383">1383</a><a class="anker" href="#line1384">1384</a><a class="anker" href="#line1385">1385</a><a class="anker" href="#line1386">1386</a><a class="anker" href="#line1387">1387</a><a class="anker" href="#line1388">1388</a><a class="anker" href="#line1389">1389</a><a class="anker" href="#line1390">1390</a><a class="anker" href="#line1391">1391</a><a class="anker" href="#line1392">1392</a><a class="anker" href="#line1393">1393</a><a class="anker" href="#line1394">1394</a><a class="anker" href="#line1395">1395</a><a class="anker" href="#line1396">1396</a><a class="anker" href="#line1397">1397</a><a class="anker" href="#line1398">1398</a><a class="anker" href="#line1399">1399</a><a class="anker" href="#line1400">1400</a><a class="anker" href="#line1401">1401</a><a class="anker" href="#line1402">1402</a><a class="anker" href="#line1403">1403</a><a class="anker" href="#line1404">1404</a><a class="anker" href="#line1405">1405</a><a class="anker" href="#line1406">1406</a><a class="anker" href="#line1407">1407</a><a class="anker" href="#line1408">1408</a><a class="anker" href="#line1409">1409</a><a class="anker" href="#line1410">1410</a><a class="anker" href="#line1411">1411</a><a class="anker" href="#line1412">1412</a><a class="anker" href="#line1413">1413</a><a class="anker" href="#line1414">1414</a><a class="anker" href="#line1415">1415</a><a class="anker" href="#line1416">1416</a><a class="anker" href="#line1417">1417</a><a class="anker" href="#line1418">1418</a><a class="anker" href="#line1419">1419</a><a class="anker" href="#line1420">1420</a><a class="anker" href="#line1421">1421</a><a class="anker" href="#line1422">1422</a><a class="anker" href="#line1423">1423</a><a class="anker" href="#line1424">1424</a><a class="anker" href="#line1425">1425</a><a class="anker" href="#line1426">1426</a><a class="anker" href="#line1427">1427</a><a class="anker" href="#line1428">1428</a><a class="anker" href="#line1429">1429</a><a class="anker" href="#line1430">1430</a><a class="anker" href="#line1431">1431</a><a class="anker" href="#line1432">1432</a><a class="anker" href="#line1433">1433</a><a class="anker" href="#line1434">1434</a><a class="anker" href="#line1435">1435</a><a class="anker" href="#line1436">1436</a><a class="anker" href="#line1437">1437</a><a class="anker" href="#line1438">1438</a><a class="anker" href="#line1439">1439</a><a class="anker" href="#line1440">1440</a><a class="anker" href="#line1441">1441</a><a class="anker" href="#line1442">1442</a><a class="anker" href="#line1443">1443</a><a class="anker" href="#line1444">1444</a><a class="anker" href="#line1445">1445</a><a class="anker" href="#line1446">1446</a><a class="anker" href="#line1447">1447</a><a class="anker" href="#line1448">1448</a><a class="anker" href="#line1449">1449</a><a class="anker" href="#line1450">1450</a><a class="anker" href="#line1451">1451</a><a class="anker" href="#line1452">1452</a><a class="anker" href="#line1453">1453</a><a class="anker" href="#line1454">1454</a><a class="anker" href="#line1455">1455</a><a class="anker" href="#line1456">1456</a><a class="anker" href="#line1457">1457</a><a class="anker" href="#line1458">1458</a><a class="anker" href="#line1459">1459</a><a class="anker" href="#line1460">1460</a><a class="anker" href="#line1461">1461</a><a class="anker" href="#line1462">1462</a><a class="anker" href="#line1463">1463</a><a class="anker" href="#line1464">1464</a><a class="anker" href="#line1465">1465</a><a class="anker" href="#line1466">1466</a><a class="anker" href="#line1467">1467</a><a class="anker" href="#line1468">1468</a><a class="anker" href="#line1469">1469</a><a class="anker" href="#line1470">1470</a><a class="anker" href="#line1471">1471</a><a class="anker" href="#line1472">1472</a><a class="anker" href="#line1473">1473</a><a class="anker" href="#line1474">1474</a><a class="anker" href="#line1475">1475</a><a class="anker" href="#line1476">1476</a><a class="anker" href="#line1477">1477</a><a class="anker" href="#line1478">1478</a><a class="anker" href="#line1479">1479</a><a class="anker" href="#line1480">1480</a><a class="anker" href="#line1481">1481</a><a class="anker" href="#line1482">1482</a><a class="anker" href="#line1483">1483</a><a class="anker" href="#line1484">1484</a><a class="anker" href="#line1485">1485</a><a class="anker" href="#line1486">1486</a><a class="anker" href="#line1487">1487</a><a class="anker" href="#line1488">1488</a><a class="anker" href="#line1489">1489</a><a class="anker" href="#line1490">1490</a><a class="anker" href="#line1491">1491</a><a class="anker" href="#line1492">1492</a><a class="anker" href="#line1493">1493</a><a class="anker" href="#line1494">1494</a><a class="anker" href="#line1495">1495</a><a class="anker" href="#line1496">1496</a><a class="anker" href="#line1497">1497</a><a class="anker" href="#line1498">1498</a><a class="anker" href="#line1499">1499</a><a class="anker" href="#line1500">1500</a><a class="anker" href="#line1501">1501</a><a class="anker" href="#line1502">1502</a><a class="anker" href="#line1503">1503</a><a class="anker" href="#line1504">1504</a><a class="anker" href="#line1505">1505</a><a class="anker" href="#line1506">1506</a><a class="anker" href="#line1507">1507</a><a class="anker" href="#line1508">1508</a><a class="anker" href="#line1509">1509</a><a class="anker" href="#line1510">1510</a><a class="anker" href="#line1511">1511</a><a class="anker" href="#line1512">1512</a><a class="anker" href="#line1513">1513</a><a class="anker" href="#line1514">1514</a><a class="anker" href="#line1515">1515</a><a class="anker" href="#line1516">1516</a><a class="anker" href="#line1517">1517</a><a class="anker" href="#line1518">1518</a><a class="anker" href="#line1519">1519</a><a class="anker" href="#line1520">1520</a><a class="anker" href="#line1521">1521</a><a class="anker" href="#line1522">1522</a><a class="anker" href="#line1523">1523</a><a class="anker" href="#line1524">1524</a><a class="anker" href="#line1525">1525</a><a class="anker" href="#line1526">1526</a><a class="anker" href="#line1527">1527</a><a class="anker" href="#line1528">1528</a><a class="anker" href="#line1529">1529</a><a class="anker" href="#line1530">1530</a><a class="anker" href="#line1531">1531</a><a class="anker" href="#line1532">1532</a><a class="anker" href="#line1533">1533</a><a class="anker" href="#line1534">1534</a><a class="anker" href="#line1535">1535</a><a class="anker" href="#line1536">1536</a><a class="anker" href="#line1537">1537</a><a class="anker" href="#line1538">1538</a><a class="anker" href="#line1539">1539</a><a class="anker" href="#line1540">1540</a><a class="anker" href="#line1541">1541</a><a class="anker" href="#line1542">1542</a><a class="anker" href="#line1543">1543</a><a class="anker" href="#line1544">1544</a><a class="anker" href="#line1545">1545</a><a class="anker" href="#line1546">1546</a><a class="anker" href="#line1547">1547</a><a class="anker" href="#line1548">1548</a><a class="anker" href="#line1549">1549</a><a class="anker" href="#line1550">1550</a><a class="anker" href="#line1551">1551</a><a class="anker" href="#line1552">1552</a><a class="anker" href="#line1553">1553</a><a class="anker" href="#line1554">1554</a><a class="anker" href="#line1555">1555</a><a class="anker" href="#line1556">1556</a><a class="anker" href="#line1557">1557</a><a class="anker" href="#line1558">1558</a><a class="anker" href="#line1559">1559</a><a class="anker" href="#line1560">1560</a><a class="anker" href="#line1561">1561</a><a class="anker" href="#line1562">1562</a><a class="anker" href="#line1563">1563</a><a class="anker" href="#line1564">1564</a><a class="anker" href="#line1565">1565</a><a class="anker" href="#line1566">1566</a><a class="anker" href="#line1567">1567</a><a class="anker" href="#line1568">1568</a><a class="anker" href="#line1569">1569</a><a class="anker" href="#line1570">1570</a><a class="anker" href="#line1571">1571</a><a class="anker" href="#line1572">1572</a><a class="anker" href="#line1573">1573</a><a class="anker" href="#line1574">1574</a><a class="anker" href="#line1575">1575</a><a class="anker" href="#line1576">1576</a><a class="anker" href="#line1577">1577</a><a class="anker" href="#line1578">1578</a><a class="anker" href="#line1579">1579</a><a class="anker" href="#line1580">1580</a><a class="anker" href="#line1581">1581</a><a class="anker" href="#line1582">1582</a><a class="anker" href="#line1583">1583</a><a class="anker" href="#line1584">1584</a><a class="anker" href="#line1585">1585</a><a class="anker" href="#line1586">1586</a><a class="anker" href="#line1587">1587</a><a class="anker" href="#line1588">1588</a><a class="anker" href="#line1589">1589</a><a class="anker" href="#line1590">1590</a><a class="anker" href="#line1591">1591</a><a class="anker" href="#line1592">1592</a><a class="anker" href="#line1593">1593</a><a class="anker" href="#line1594">1594</a><a class="anker" href="#line1595">1595</a><a class="anker" href="#line1596">1596</a><a class="anker" href="#line1597">1597</a><a class="anker" href="#line1598">1598</a><a class="anker" href="#line1599">1599</a><a class="anker" href="#line1600">1600</a><a class="anker" href="#line1601">1601</a><a class="anker" href="#line1602">1602</a><a class="anker" href="#line1603">1603</a><a class="anker" href="#line1604">1604</a><a class="anker" href="#line1605">1605</a><a class="anker" href="#line1606">1606</a><a class="anker" href="#line1607">1607</a><a class="anker" href="#line1608">1608</a><a class="anker" href="#line1609">1609</a><a class="anker" href="#line1610">1610</a><a class="anker" href="#line1611">1611</a><a class="anker" href="#line1612">1612</a><a class="anker" href="#line1613">1613</a><a class="anker" href="#line1614">1614</a><a class="anker" href="#line1615">1615</a><a class="anker" href="#line1616">1616</a><a class="anker" href="#line1617">1617</a><a class="anker" href="#line1618">1618</a><a class="anker" href="#line1619">1619</a><a class="anker" href="#line1620">1620</a><a class="anker" href="#line1621">1621</a><a class="anker" href="#line1622">1622</a><a class="anker" href="#line1623">1623</a><a class="anker" href="#line1624">1624</a><a class="anker" href="#line1625">1625</a><a class="anker" href="#line1626">1626</a><a class="anker" href="#line1627">1627</a><a class="anker" href="#line1628">1628</a><a class="anker" href="#line1629">1629</a><a class="anker" href="#line1630">1630</a><a class="anker" href="#line1631">1631</a><a class="anker" href="#line1632">1632</a><a class="anker" href="#line1633">1633</a><a class="anker" href="#line1634">1634</a><a class="anker" href="#line1635">1635</a><a class="anker" href="#line1636">1636</a><a class="anker" href="#line1637">1637</a><a class="anker" href="#line1638">1638</a><a class="anker" href="#line1639">1639</a><a class="anker" href="#line1640">1640</a><a class="anker" href="#line1641">1641</a><a class="anker" href="#line1642">1642</a><a class="anker" href="#line1643">1643</a><a class="anker" href="#line1644">1644</a><a class="anker" href="#line1645">1645</a><a class="anker" href="#line1646">1646</a><a class="anker" href="#line1647">1647</a><a class="anker" href="#line1648">1648</a><a class="anker" href="#line1649">1649</a><a class="anker" href="#line1650">1650</a><a class="anker" href="#line1651">1651</a><a class="anker" href="#line1652">1652</a><a class="anker" href="#line1653">1653</a><a class="anker" href="#line1654">1654</a><a class="anker" href="#line1655">1655</a><a class="anker" href="#line1656">1656</a><a class="anker" href="#line1657">1657</a><a class="anker" href="#line1658">1658</a><a class="anker" href="#line1659">1659</a><a class="anker" href="#line1660">1660</a><a class="anker" href="#line1661">1661</a><a class="anker" href="#line1662">1662</a><a class="anker" href="#line1663">1663</a><a class="anker" href="#line1664">1664</a><a class="anker" href="#line1665">1665</a><a class="anker" href="#line1666">1666</a><a class="anker" href="#line1667">1667</a><a class="anker" href="#line1668">1668</a><a class="anker" href="#line1669">1669</a><a class="anker" href="#line1670">1670</a><a class="anker" href="#line1671">1671</a><a class="anker" href="#line1672">1672</a><a class="anker" href="#line1673">1673</a><a class="anker" href="#line1674">1674</a><a class="anker" href="#line1675">1675</a><a class="anker" href="#line1676">1676</a><a class="anker" href="#line1677">1677</a><a class="anker" href="#line1678">1678</a><a class="anker" href="#line1679">1679</a><a class="anker" href="#line1680">1680</a><a class="anker" href="#line1681">1681</a><a class="anker" href="#line1682">1682</a><a class="anker" href="#line1683">1683</a><a class="anker" href="#line1684">1684</a><a class="anker" href="#line1685">1685</a><a class="anker" href="#line1686">1686</a><a class="anker" href="#line1687">1687</a><a class="anker" href="#line1688">1688</a><a class="anker" href="#line1689">1689</a><a class="anker" href="#line1690">1690</a><a class="anker" href="#line1691">1691</a><a class="anker" href="#line1692">1692</a><a class="anker" href="#line1693">1693</a><a class="anker" href="#line1694">1694</a><a class="anker" href="#line1695">1695</a><a class="anker" href="#line1696">1696</a><a class="anker" href="#line1697">1697</a><a class="anker" href="#line1698">1698</a><a class="anker" href="#line1699">1699</a><a class="anker" href="#line1700">1700</a><a class="anker" href="#line1701">1701</a><a class="anker" href="#line1702">1702</a><a class="anker" href="#line1703">1703</a><a class="anker" href="#line1704">1704</a><a class="anker" href="#line1705">1705</a><a class="anker" href="#line1706">1706</a><a class="anker" href="#line1707">1707</a><a class="anker" href="#line1708">1708</a><a class="anker" href="#line1709">1709</a><a class="anker" href="#line1710">1710</a><a class="anker" href="#line1711">1711</a><a class="anker" href="#line1712">1712</a><a class="anker" href="#line1713">1713</a><a class="anker" href="#line1714">1714</a><a class="anker" href="#line1715">1715</a><a class="anker" href="#line1716">1716</a><a class="anker" href="#line1717">1717</a><a class="anker" href="#line1718">1718</a><a class="anker" href="#line1719">1719</a><a class="anker" href="#line1720">1720</a><a class="anker" href="#line1721">1721</a><a class="anker" href="#line1722">1722</a><a class="anker" href="#line1723">1723</a><a class="anker" href="#line1724">1724</a><a class="anker" href="#line1725">1725</a><a class="anker" href="#line1726">1726</a><a class="anker" href="#line1727">1727</a><a class="anker" href="#line1728">1728</a><a class="anker" href="#line1729">1729</a><a class="anker" href="#line1730">1730</a><a class="anker" href="#line1731">1731</a><a class="anker" href="#line1732">1732</a><a class="anker" href="#line1733">1733</a><a class="anker" href="#line1734">1734</a><a class="anker" href="#line1735">1735</a><a class="anker" href="#line1736">1736</a><a class="anker" href="#line1737">1737</a><a class="anker" href="#line1738">1738</a><a class="anker" href="#line1739">1739</a><a class="anker" href="#line1740">1740</a><a class="anker" href="#line1741">1741</a><a class="anker" href="#line1742">1742</a><a class="anker" href="#line1743">1743</a><a class="anker" href="#line1744">1744</a><a class="anker" href="#line1745">1745</a><a class="anker" href="#line1746">1746</a><a class="anker" href="#line1747">1747</a><a class="anker" href="#line1748">1748</a><a class="anker" href="#line1749">1749</a><a class="anker" href="#line1750">1750</a><a class="anker" href="#line1751">1751</a><a class="anker" href="#line1752">1752</a><a class="anker" href="#line1753">1753</a><a class="anker" href="#line1754">1754</a><a class="anker" href="#line1755">1755</a><a class="anker" href="#line1756">1756</a><a class="anker" href="#line1757">1757</a><a class="anker" href="#line1758">1758</a><a class="anker" href="#line1759">1759</a><a class="anker" href="#line1760">1760</a><a class="anker" href="#line1761">1761</a><a class="anker" href="#line1762">1762</a><a class="anker" href="#line1763">1763</a><a class="anker" href="#line1764">1764</a><a class="anker" href="#line1765">1765</a><a class="anker" href="#line1766">1766</a><a class="anker" href="#line1767">1767</a><a class="anker" href="#line1768">1768</a><a class="anker" href="#line1769">1769</a><a class="anker" href="#line1770">1770</a><a class="anker" href="#line1771">1771</a><a class="anker" href="#line1772">1772</a><a class="anker" href="#line1773">1773</a><a class="anker" href="#line1774">1774</a><a class="anker" href="#line1775">1775</a><a class="anker" href="#line1776">1776</a><a class="anker" href="#line1777">1777</a><a class="anker" href="#line1778">1778</a><a class="anker" href="#line1779">1779</a><a class="anker" href="#line1780">1780</a><a class="anker" href="#line1781">1781</a><a class="anker" href="#line1782">1782</a><a class="anker" href="#line1783">1783</a><a class="anker" href="#line1784">1784</a><a class="anker" href="#line1785">1785</a><a class="anker" href="#line1786">1786</a><a class="anker" href="#line1787">1787</a><a class="anker" href="#line1788">1788</a><a class="anker" href="#line1789">1789</a><a class="anker" href="#line1790">1790</a><a class="anker" href="#line1791">1791</a><a class="anker" href="#line1792">1792</a><a class="anker" href="#line1793">1793</a><a class="anker" href="#line1794">1794</a><a class="anker" href="#line1795">1795</a><a class="anker" href="#line1796">1796</a><a class="anker" href="#line1797">1797</a><a class="anker" href="#line1798">1798</a><a class="anker" href="#line1799">1799</a><a class="anker" href="#line1800">1800</a><a class="anker" href="#line1801">1801</a><a class="anker" href="#line1802">1802</a><a class="anker" href="#line1803">1803</a><a class="anker" href="#line1804">1804</a><a class="anker" href="#line1805">1805</a><a class="anker" href="#line1806">1806</a><a class="anker" href="#line1807">1807</a><a class="anker" href="#line1808">1808</a><a class="anker" href="#line1809">1809</a><a class="anker" href="#line1810">1810</a><a class="anker" href="#line1811">1811</a><a class="anker" href="#line1812">1812</a><a class="anker" href="#line1813">1813</a><a class="anker" href="#line1814">1814</a><a class="anker" href="#line1815">1815</a><a class="anker" href="#line1816">1816</a><a class="anker" href="#line1817">1817</a><a class="anker" href="#line1818">1818</a><a class="anker" href="#line1819">1819</a><a class="anker" href="#line1820">1820</a><a class="anker" href="#line1821">1821</a><a class="anker" href="#line1822">1822</a><a class="anker" href="#line1823">1823</a><a class="anker" href="#line1824">1824</a><a class="anker" href="#line1825">1825</a><a class="anker" href="#line1826">1826</a><a class="anker" href="#line1827">1827</a><a class="anker" href="#line1828">1828</a><a class="anker" href="#line1829">1829</a><a class="anker" href="#line1830">1830</a><a class="anker" href="#line1831">1831</a><a class="anker" href="#line1832">1832</a><a class="anker" href="#line1833">1833</a><a class="anker" href="#line1834">1834</a><a class="anker" href="#line1835">1835</a><a class="anker" href="#line1836">1836</a><a class="anker" href="#line1837">1837</a><a class="anker" href="#line1838">1838</a><a class="anker" href="#line1839">1839</a><a class="anker" href="#line1840">1840</a><a class="anker" href="#line1841">1841</a><a class="anker" href="#line1842">1842</a><a class="anker" href="#line1843">1843</a><a class="anker" href="#line1844">1844</a><a class="anker" href="#line1845">1845</a><a class="anker" href="#line1846">1846</a><a class="anker" href="#line1847">1847</a><a class="anker" href="#line1848">1848</a><a class="anker" href="#line1849">1849</a><a class="anker" href="#line1850">1850</a><a class="anker" href="#line1851">1851</a><a class="anker" href="#line1852">1852</a><a class="anker" href="#line1853">1853</a><a class="anker" href="#line1854">1854</a><a class="anker" href="#line1855">1855</a><a class="anker" href="#line1856">1856</a><a class="anker" href="#line1857">1857</a><a class="anker" href="#line1858">1858</a><a class="anker" href="#line1859">1859</a><a class="anker" href="#line1860">1860</a><a class="anker" href="#line1861">1861</a><a class="anker" href="#line1862">1862</a><a class="anker" href="#line1863">1863</a><a class="anker" href="#line1864">1864</a><a class="anker" href="#line1865">1865</a><a class="anker" href="#line1866">1866</a><a class="anker" href="#line1867">1867</a><a class="anker" href="#line1868">1868</a><a class="anker" href="#line1869">1869</a><a class="anker" href="#line1870">1870</a><a class="anker" href="#line1871">1871</a><a class="anker" href="#line1872">1872</a><a class="anker" href="#line1873">1873</a><a class="anker" href="#line1874">1874</a><a class="anker" href="#line1875">1875</a><a class="anker" href="#line1876">1876</a><a class="anker" href="#line1877">1877</a><a class="anker" href="#line1878">1878</a><a class="anker" href="#line1879">1879</a><a class="anker" href="#line1880">1880</a><a class="anker" href="#line1881">1881</a><a class="anker" href="#line1882">1882</a><a class="anker" href="#line1883">1883</a><a class="anker" href="#line1884">1884</a><a class="anker" href="#line1885">1885</a><a class="anker" href="#line1886">1886</a><a class="anker" href="#line1887">1887</a><a class="anker" href="#line1888">1888</a><a class="anker" href="#line1889">1889</a><a class="anker" href="#line1890">1890</a><a class="anker" href="#line1891">1891</a><a class="anker" href="#line1892">1892</a><a class="anker" href="#line1893">1893</a><a class="anker" href="#line1894">1894</a><a class="anker" href="#line1895">1895</a><a class="anker" href="#line1896">1896</a><a class="anker" href="#line1897">1897</a><a class="anker" href="#line1898">1898</a><a class="anker" href="#line1899">1899</a><a class="anker" href="#line1900">1900</a><a class="anker" href="#line1901">1901</a><a class="anker" href="#line1902">1902</a><a class="anker" href="#line1903">1903</a><a class="anker" href="#line1904">1904</a><a class="anker" href="#line1905">1905</a><a class="anker" href="#line1906">1906</a><a class="anker" href="#line1907">1907</a><a class="anker" href="#line1908">1908</a><a class="anker" href="#line1909">1909</a><a class="anker" href="#line1910">1910</a><a class="anker" href="#line1911">1911</a><a class="anker" href="#line1912">1912</a><a class="anker" href="#line1913">1913</a><a class="anker" href="#line1914">1914</a><a class="anker" href="#line1915">1915</a><a class="anker" href="#line1916">1916</a><a class="anker" href="#line1917">1917</a><a class="anker" href="#line1918">1918</a><a class="anker" href="#line1919">1919</a><a class="anker" href="#line1920">1920</a><a class="anker" href="#line1921">1921</a><a class="anker" href="#line1922">1922</a><a class="anker" href="#line1923">1923</a><a class="anker" href="#line1924">1924</a><a class="anker" href="#line1925">1925</a><a class="anker" href="#line1926">1926</a><a class="anker" href="#line1927">1927</a><a class="anker" href="#line1928">1928</a><a class="anker" href="#line1929">1929</a><a class="anker" href="#line1930">1930</a><a class="anker" href="#line1931">1931</a><a class="anker" href="#line1932">1932</a><a class="anker" href="#line1933">1933</a><a class="anker" href="#line1934">1934</a><a class="anker" href="#line1935">1935</a><a class="anker" href="#line1936">1936</a><a class="anker" href="#line1937">1937</a><a class="anker" href="#line1938">1938</a><a class="anker" href="#line1939">1939</a><a class="anker" href="#line1940">1940</a><a class="anker" href="#line1941">1941</a><a class="anker" href="#line1942">1942</a><a class="anker" href="#line1943">1943</a><a class="anker" href="#line1944">1944</a><a class="anker" href="#line1945">1945</a><a class="anker" href="#line1946">1946</a><a class="anker" href="#line1947">1947</a><a class="anker" href="#line1948">1948</a><a class="anker" href="#line1949">1949</a><a class="anker" href="#line1950">1950</a><a class="anker" href="#line1951">1951</a><a class="anker" href="#line1952">1952</a><a class="anker" href="#line1953">1953</a><a class="anker" href="#line1954">1954</a><a class="anker" href="#line1955">1955</a><a class="anker" href="#line1956">1956</a><a class="anker" href="#line1957">1957</a><a class="anker" href="#line1958">1958</a><a class="anker" href="#line1959">1959</a><a class="anker" href="#line1960">1960</a><a class="anker" href="#line1961">1961</a><a class="anker" href="#line1962">1962</a><a class="anker" href="#line1963">1963</a><a class="anker" href="#line1964">1964</a><a class="anker" href="#line1965">1965</a><a class="anker" href="#line1966">1966</a><a class="anker" href="#line1967">1967</a><a class="anker" href="#line1968">1968</a><a class="anker" href="#line1969">1969</a><a class="anker" href="#line1970">1970</a><a class="anker" href="#line1971">1971</a><a class="anker" href="#line1972">1972</a><a class="anker" href="#line1973">1973</a><a class="anker" href="#line1974">1974</a><a class="anker" href="#line1975">1975</a><a class="anker" href="#line1976">1976</a><a class="anker" href="#line1977">1977</a><a class="anker" href="#line1978">1978</a><a class="anker" href="#line1979">1979</a><a class="anker" href="#line1980">1980</a><a class="anker" href="#line1981">1981</a><a class="anker" href="#line1982">1982</a><a class="anker" href="#line1983">1983</a><a class="anker" href="#line1984">1984</a><a class="anker" href="#line1985">1985</a><a class="anker" href="#line1986">1986</a><a class="anker" href="#line1987">1987</a><a class="anker" href="#line1988">1988</a><a class="anker" href="#line1989">1989</a><a class="anker" href="#line1990">1990</a><a class="anker" href="#line1991">1991</a><a class="anker" href="#line1992">1992</a><a class="anker" href="#line1993">1993</a><a class="anker" href="#line1994">1994</a><a class="anker" href="#line1995">1995</a><a class="anker" href="#line1996">1996</a><a class="anker" href="#line1997">1997</a><a class="anker" href="#line1998">1998</a><a class="anker" href="#line1999">1999</a><a class="anker" href="#line2000">2000</a><a class="anker" href="#line2001">2001</a><a class="anker" href="#line2002">2002</a><a class="anker" href="#line2003">2003</a><a class="anker" href="#line2004">2004</a><a class="anker" href="#line2005">2005</a><a class="anker" href="#line2006">2006</a><a class="anker" href="#line2007">2007</a><a class="anker" href="#line2008">2008</a><a class="anker" href="#line2009">2009</a><a class="anker" href="#line2010">2010</a><a class="anker" href="#line2011">2011</a><a class="anker" href="#line2012">2012</a><a class="anker" href="#line2013">2013</a><a class="anker" href="#line2014">2014</a><a class="anker" href="#line2015">2015</a><a class="anker" href="#line2016">2016</a><a class="anker" href="#line2017">2017</a><a class="anker" href="#line2018">2018</a><a class="anker" href="#line2019">2019</a><a class="anker" href="#line2020">2020</a><a class="anker" href="#line2021">2021</a><a class="anker" href="#line2022">2022</a><a class="anker" href="#line2023">2023</a><a class="anker" href="#line2024">2024</a><a class="anker" href="#line2025">2025</a><a class="anker" href="#line2026">2026</a><a class="anker" href="#line2027">2027</a><a class="anker" href="#line2028">2028</a><a class="anker" href="#line2029">2029</a><a class="anker" href="#line2030">2030</a><a class="anker" href="#line2031">2031</a><a class="anker" href="#line2032">2032</a><a class="anker" href="#line2033">2033</a><a class="anker" href="#line2034">2034</a><a class="anker" href="#line2035">2035</a><a class="anker" href="#line2036">2036</a><a class="anker" href="#line2037">2037</a><a class="anker" href="#line2038">2038</a><a class="anker" href="#line2039">2039</a><a class="anker" href="#line2040">2040</a><a class="anker" href="#line2041">2041</a><a class="anker" href="#line2042">2042</a><a class="anker" href="#line2043">2043</a><a class="anker" href="#line2044">2044</a><a class="anker" href="#line2045">2045</a><a class="anker" href="#line2046">2046</a><a class="anker" href="#line2047">2047</a><a class="anker" href="#line2048">2048</a><a class="anker" href="#line2049">2049</a><a class="anker" href="#line2050">2050</a><a class="anker" href="#line2051">2051</a><a class="anker" href="#line2052">2052</a><a class="anker" href="#line2053">2053</a><a class="anker" href="#line2054">2054</a><a class="anker" href="#line2055">2055</a><a class="anker" href="#line2056">2056</a><a class="anker" href="#line2057">2057</a><a class="anker" href="#line2058">2058</a><a class="anker" href="#line2059">2059</a><a class="anker" href="#line2060">2060</a><a class="anker" href="#line2061">2061</a><a class="anker" href="#line2062">2062</a><a class="anker" href="#line2063">2063</a><a class="anker" href="#line2064">2064</a><a class="anker" href="#line2065">2065</a><a class="anker" href="#line2066">2066</a><a class="anker" href="#line2067">2067</a><a class="anker" href="#line2068">2068</a><a class="anker" href="#line2069">2069</a><a class="anker" href="#line2070">2070</a><a class="anker" href="#line2071">2071</a><a class="anker" href="#line2072">2072</a><a class="anker" href="#line2073">2073</a><a class="anker" href="#line2074">2074</a><a class="anker" href="#line2075">2075</a><a class="anker" href="#line2076">2076</a><a class="anker" href="#line2077">2077</a><a class="anker" href="#line2078">2078</a><a class="anker" href="#line2079">2079</a><a class="anker" href="#line2080">2080</a><a class="anker" href="#line2081">2081</a><a class="anker" href="#line2082">2082</a><a class="anker" href="#line2083">2083</a><a class="anker" href="#line2084">2084</a><a class="anker" href="#line2085">2085</a><a class="anker" href="#line2086">2086</a><a class="anker" href="#line2087">2087</a><a class="anker" href="#line2088">2088</a><a class="anker" href="#line2089">2089</a><a class="anker" href="#line2090">2090</a><a class="anker" href="#line2091">2091</a><a class="anker" href="#line2092">2092</a><a class="anker" href="#line2093">2093</a><a class="anker" href="#line2094">2094</a><a class="anker" href="#line2095">2095</a><a class="anker" href="#line2096">2096</a><a class="anker" href="#line2097">2097</a><a class="anker" href="#line2098">2098</a><a class="anker" href="#line2099">2099</a><a class="anker" href="#line2100">2100</a><a class="anker" href="#line2101">2101</a><a class="anker" href="#line2102">2102</a><a class="anker" href="#line2103">2103</a><a class="anker" href="#line2104">2104</a><a class="anker" href="#line2105">2105</a><a class="anker" href="#line2106">2106</a><a class="anker" href="#line2107">2107</a><a class="anker" href="#line2108">2108</a><a class="anker" href="#line2109">2109</a><a class="anker" href="#line2110">2110</a><a class="anker" href="#line2111">2111</a><a class="anker" href="#line2112">2112</a><a class="anker" href="#line2113">2113</a><a class="anker" href="#line2114">2114</a><a class="anker" href="#line2115">2115</a><a class="anker" href="#line2116">2116</a><a class="anker" href="#line2117">2117</a><a class="anker" href="#line2118">2118</a><a class="anker" href="#line2119">2119</a><a class="anker" href="#line2120">2120</a><a class="anker" href="#line2121">2121</a><a class="anker" href="#line2122">2122</a><a class="anker" href="#line2123">2123</a><a class="anker" href="#line2124">2124</a><a class="anker" href="#line2125">2125</a><a class="anker" href="#line2126">2126</a><a class="anker" href="#line2127">2127</a><a class="anker" href="#line2128">2128</a><a class="anker" href="#line2129">2129</a><a class="anker" href="#line2130">2130</a><a class="anker" href="#line2131">2131</a><a class="anker" href="#line2132">2132</a><a class="anker" href="#line2133">2133</a><a class="anker" href="#line2134">2134</a><a class="anker" href="#line2135">2135</a><a class="anker" href="#line2136">2136</a><a class="anker" href="#line2137">2137</a><a class="anker" href="#line2138">2138</a><a class="anker" href="#line2139">2139</a><a class="anker" href="#line2140">2140</a><a class="anker" href="#line2141">2141</a><a class="anker" href="#line2142">2142</a><a class="anker" href="#line2143">2143</a><a class="anker" href="#line2144">2144</a><a class="anker" href="#line2145">2145</a><a class="anker" href="#line2146">2146</a><a class="anker" href="#line2147">2147</a><a class="anker" href="#line2148">2148</a><a class="anker" href="#line2149">2149</a><a class="anker" href="#line2150">2150</a><a class="anker" href="#line2151">2151</a><a class="anker" href="#line2152">2152</a><a class="anker" href="#line2153">2153</a><a class="anker" href="#line2154">2154</a><a class="anker" href="#line2155">2155</a><a class="anker" href="#line2156">2156</a><a class="anker" href="#line2157">2157</a><a class="anker" href="#line2158">2158</a><a class="anker" href="#line2159">2159</a><a class="anker" href="#line2160">2160</a><a class="anker" href="#line2161">2161</a><a class="anker" href="#line2162">2162</a><a class="anker" href="#line2163">2163</a><a class="anker" href="#line2164">2164</a><a class="anker" href="#line2165">2165</a><a class="anker" href="#line2166">2166</a><a class="anker" href="#line2167">2167</a><a class="anker" href="#line2168">2168</a><a class="anker" href="#line2169">2169</a><a class="anker" href="#line2170">2170</a><a class="anker" href="#line2171">2171</a><a class="anker" href="#line2172">2172</a><a class="anker" href="#line2173">2173</a><a class="anker" href="#line2174">2174</a><a class="anker" href="#line2175">2175</a><a class="anker" href="#line2176">2176</a><a class="anker" href="#line2177">2177</a><a class="anker" href="#line2178">2178</a><a class="anker" href="#line2179">2179</a><a class="anker" href="#line2180">2180</a><a class="anker" href="#line2181">2181</a><a class="anker" href="#line2182">2182</a><a class="anker" href="#line2183">2183</a><a class="anker" href="#line2184">2184</a><a class="anker" href="#line2185">2185</a><a class="anker" href="#line2186">2186</a><a class="anker" href="#line2187">2187</a><a class="anker" href="#line2188">2188</a><a class="anker" href="#line2189">2189</a><a class="anker" href="#line2190">2190</a><a class="anker" href="#line2191">2191</a><a class="anker" href="#line2192">2192</a><a class="anker" href="#line2193">2193</a><a class="anker" href="#line2194">2194</a><a class="anker" href="#line2195">2195</a><a class="anker" href="#line2196">2196</a><a class="anker" href="#line2197">2197</a><a class="anker" href="#line2198">2198</a><a class="anker" href="#line2199">2199</a><a class="anker" href="#line2200">2200</a><a class="anker" href="#line2201">2201</a><a class="anker" href="#line2202">2202</a><a class="anker" href="#line2203">2203</a><a class="anker" href="#line2204">2204</a><a class="anker" href="#line2205">2205</a><a class="anker" href="#line2206">2206</a><a class="anker" href="#line2207">2207</a><a class="anker" href="#line2208">2208</a><a class="anker" href="#line2209">2209</a><a class="anker" href="#line2210">2210</a><a class="anker" href="#line2211">2211</a><a class="anker" href="#line2212">2212</a><a class="anker" href="#line2213">2213</a><a class="anker" href="#line2214">2214</a><a class="anker" href="#line2215">2215</a><a class="anker" href="#line2216">2216</a><a class="anker" href="#line2217">2217</a><a class="anker" href="#line2218">2218</a><a class="anker" href="#line2219">2219</a><a class="anker" href="#line2220">2220</a><a class="anker" href="#line2221">2221</a><a class="anker" href="#line2222">2222</a><a class="anker" href="#line2223">2223</a><a class="anker" href="#line2224">2224</a><a class="anker" href="#line2225">2225</a><a class="anker" href="#line2226">2226</a><a class="anker" href="#line2227">2227</a><a class="anker" href="#line2228">2228</a><a class="anker" href="#line2229">2229</a><a class="anker" href="#line2230">2230</a><a class="anker" href="#line2231">2231</a><a class="anker" href="#line2232">2232</a><a class="anker" href="#line2233">2233</a><a class="anker" href="#line2234">2234</a><a class="anker" href="#line2235">2235</a><a class="anker" href="#line2236">2236</a><a class="anker" href="#line2237">2237</a><a class="anker" href="#line2238">2238</a><a class="anker" href="#line2239">2239</a><a class="anker" href="#line2240">2240</a><a class="anker" href="#line2241">2241</a><a class="anker" href="#line2242">2242</a><a class="anker" href="#line2243">2243</a><a class="anker" href="#line2244">2244</a><a class="anker" href="#line2245">2245</a><a class="anker" href="#line2246">2246</a><a class="anker" href="#line2247">2247</a><a class="anker" href="#line2248">2248</a><a class="anker" href="#line2249">2249</a><a class="anker" href="#line2250">2250</a><a class="anker" href="#line2251">2251</a><a class="anker" href="#line2252">2252</a><a class="anker" href="#line2253">2253</a><a class="anker" href="#line2254">2254</a><a class="anker" href="#line2255">2255</a><a class="anker" href="#line2256">2256</a><a class="anker" href="#line2257">2257</a><a class="anker" href="#line2258">2258</a><a class="anker" href="#line2259">2259</a><a class="anker" href="#line2260">2260</a><a class="anker" href="#line2261">2261</a><a class="anker" href="#line2262">2262</a><a class="anker" href="#line2263">2263</a><a class="anker" href="#line2264">2264</a><a class="anker" href="#line2265">2265</a><a class="anker" href="#line2266">2266</a><a class="anker" href="#line2267">2267</a><a class="anker" href="#line2268">2268</a><a class="anker" href="#line2269">2269</a><a class="anker" href="#line2270">2270</a><a class="anker" href="#line2271">2271</a><a class="anker" href="#line2272">2272</a><a class="anker" href="#line2273">2273</a><a class="anker" href="#line2274">2274</a><a class="anker" href="#line2275">2275</a><a class="anker" href="#line2276">2276</a><a class="anker" href="#line2277">2277</a><a class="anker" href="#line2278">2278</a><a class="anker" href="#line2279">2279</a><a class="anker" href="#line2280">2280</a><a class="anker" href="#line2281">2281</a><a class="anker" href="#line2282">2282</a><a class="anker" href="#line2283">2283</a><a class="anker" href="#line2284">2284</a><a class="anker" href="#line2285">2285</a><a class="anker" href="#line2286">2286</a><a class="anker" href="#line2287">2287</a><a class="anker" href="#line2288">2288</a><a class="anker" href="#line2289">2289</a><a class="anker" href="#line2290">2290</a><a class="anker" href="#line2291">2291</a><a class="anker" href="#line2292">2292</a><a class="anker" href="#line2293">2293</a><a class="anker" href="#line2294">2294</a><a class="anker" href="#line2295">2295</a><a class="anker" href="#line2296">2296</a><a class="anker" href="#line2297">2297</a><a class="anker" href="#line2298">2298</a><a class="anker" href="#line2299">2299</a><a class="anker" href="#line2300">2300</a><a class="anker" href="#line2301">2301</a><a class="anker" href="#line2302">2302</a><a class="anker" href="#line2303">2303</a><a class="anker" href="#line2304">2304</a><a class="anker" href="#line2305">2305</a><a class="anker" href="#line2306">2306</a><a class="anker" href="#line2307">2307</a><a class="anker" href="#line2308">2308</a><a class="anker" href="#line2309">2309</a><a class="anker" href="#line2310">2310</a><a class="anker" href="#line2311">2311</a><a class="anker" href="#line2312">2312</a><a class="anker" href="#line2313">2313</a><a class="anker" href="#line2314">2314</a><a class="anker" href="#line2315">2315</a><a class="anker" href="#line2316">2316</a><a class="anker" href="#line2317">2317</a><a class="anker" href="#line2318">2318</a><a class="anker" href="#line2319">2319</a><a class="anker" href="#line2320">2320</a><a class="anker" href="#line2321">2321</a><a class="anker" href="#line2322">2322</a><a class="anker" href="#line2323">2323</a><a class="anker" href="#line2324">2324</a><a class="anker" href="#line2325">2325</a><a class="anker" href="#line2326">2326</a><a class="anker" href="#line2327">2327</a><a class="anker" href="#line2328">2328</a><a class="anker" href="#line2329">2329</a><a class="anker" href="#line2330">2330</a><a class="anker" href="#line2331">2331</a><a class="anker" href="#line2332">2332</a><a class="anker" href="#line2333">2333</a><a class="anker" href="#line2334">2334</a><a class="anker" href="#line2335">2335</a><a class="anker" href="#line2336">2336</a><a class="anker" href="#line2337">2337</a><a class="anker" href="#line2338">2338</a><a class="anker" href="#line2339">2339</a><a class="anker" href="#line2340">2340</a><a class="anker" href="#line2341">2341</a><a class="anker" href="#line2342">2342</a><a class="anker" href="#line2343">2343</a><a class="anker" href="#line2344">2344</a><a class="anker" href="#line2345">2345</a><a class="anker" href="#line2346">2346</a><a class="anker" href="#line2347">2347</a><a class="anker" href="#line2348">2348</a><a class="anker" href="#line2349">2349</a><a class="anker" href="#line2350">2350</a><a class="anker" href="#line2351">2351</a><a class="anker" href="#line2352">2352</a><a class="anker" href="#line2353">2353</a><a class="anker" href="#line2354">2354</a><a class="anker" href="#line2355">2355</a><a class="anker" href="#line2356">2356</a><a class="anker" href="#line2357">2357</a><a class="anker" href="#line2358">2358</a><a class="anker" href="#line2359">2359</a><a class="anker" href="#line2360">2360</a><a class="anker" href="#line2361">2361</a><a class="anker" href="#line2362">2362</a><a class="anker" href="#line2363">2363</a><a class="anker" href="#line2364">2364</a><a class="anker" href="#line2365">2365</a><a class="anker" href="#line2366">2366</a><a class="anker" href="#line2367">2367</a><a class="anker" href="#line2368">2368</a><a class="anker" href="#line2369">2369</a><a class="anker" href="#line2370">2370</a><a class="anker" href="#line2371">2371</a><a class="anker" href="#line2372">2372</a><a class="anker" href="#line2373">2373</a><a class="anker" href="#line2374">2374</a><a class="anker" href="#line2375">2375</a><a class="anker" href="#line2376">2376</a><a class="anker" href="#line2377">2377</a><a class="anker" href="#line2378">2378</a><a class="anker" href="#line2379">2379</a><a class="anker" href="#line2380">2380</a><a class="anker" href="#line2381">2381</a><a class="anker" href="#line2382">2382</a><a class="anker" href="#line2383">2383</a><a class="anker" href="#line2384">2384</a><a class="anker" href="#line2385">2385</a><a class="anker" href="#line2386">2386</a><a class="anker" href="#line2387">2387</a><a class="anker" href="#line2388">2388</a><a class="anker" href="#line2389">2389</a><a class="anker" href="#line2390">2390</a><a class="anker" href="#line2391">2391</a><a class="anker" href="#line2392">2392</a><a class="anker" href="#line2393">2393</a><a class="anker" href="#line2394">2394</a><a class="anker" href="#line2395">2395</a><a class="anker" href="#line2396">2396</a><a class="anker" href="#line2397">2397</a><a class="anker" href="#line2398">2398</a><a class="anker" href="#line2399">2399</a><a class="anker" href="#line2400">2400</a><a class="anker" href="#line2401">2401</a><a class="anker" href="#line2402">2402</a><a class="anker" href="#line2403">2403</a><a class="anker" href="#line2404">2404</a><a class="anker" href="#line2405">2405</a><a class="anker" href="#line2406">2406</a><a class="anker" href="#line2407">2407</a><a class="anker" href="#line2408">2408</a><a class="anker" href="#line2409">2409</a><a class="anker" href="#line2410">2410</a><a class="anker" href="#line2411">2411</a><a class="anker" href="#line2412">2412</a><a class="anker" href="#line2413">2413</a><a class="anker" href="#line2414">2414</a><a class="anker" href="#line2415">2415</a><a class="anker" href="#line2416">2416</a><a class="anker" href="#line2417">2417</a><a class="anker" href="#line2418">2418</a><a class="anker" href="#line2419">2419</a><a class="anker" href="#line2420">2420</a><a class="anker" href="#line2421">2421</a><a class="anker" href="#line2422">2422</a><a class="anker" href="#line2423">2423</a><a class="anker" href="#line2424">2424</a><a class="anker" href="#line2425">2425</a><a class="anker" href="#line2426">2426</a><a class="anker" href="#line2427">2427</a><a class="anker" href="#line2428">2428</a><a class="anker" href="#line2429">2429</a><a class="anker" href="#line2430">2430</a><a class="anker" href="#line2431">2431</a><a class="anker" href="#line2432">2432</a><a class="anker" href="#line2433">2433</a><a class="anker" href="#line2434">2434</a><a class="anker" href="#line2435">2435</a><a class="anker" href="#line2436">2436</a><a class="anker" href="#line2437">2437</a><a class="anker" href="#line2438">2438</a><a class="anker" href="#line2439">2439</a><a class="anker" href="#line2440">2440</a><a class="anker" href="#line2441">2441</a><a class="anker" href="#line2442">2442</a><a class="anker" href="#line2443">2443</a><a class="anker" href="#line2444">2444</a><a class="anker" href="#line2445">2445</a><a class="anker" href="#line2446">2446</a><a class="anker" href="#line2447">2447</a><a class="anker" href="#line2448">2448</a><a class="anker" href="#line2449">2449</a><a class="anker" href="#line2450">2450</a><a class="anker" href="#line2451">2451</a><a class="anker" href="#line2452">2452</a><a class="anker" href="#line2453">2453</a><a class="anker" href="#line2454">2454</a><a class="anker" href="#line2455">2455</a><a class="anker" href="#line2456">2456</a><a class="anker" href="#line2457">2457</a><a class="anker" href="#line2458">2458</a><a class="anker" href="#line2459">2459</a><a class="anker" href="#line2460">2460</a><a class="anker" href="#line2461">2461</a><a class="anker" href="#line2462">2462</a><a class="anker" href="#line2463">2463</a><a class="anker" href="#line2464">2464</a><a class="anker" href="#line2465">2465</a><a class="anker" href="#line2466">2466</a><a class="anker" href="#line2467">2467</a><a class="anker" href="#line2468">2468</a><a class="anker" href="#line2469">2469</a><a class="anker" href="#line2470">2470</a><a class="anker" href="#line2471">2471</a><a class="anker" href="#line2472">2472</a><a class="anker" href="#line2473">2473</a><a class="anker" href="#line2474">2474</a><a class="anker" href="#line2475">2475</a><a class="anker" href="#line2476">2476</a><a class="anker" href="#line2477">2477</a><a class="anker" href="#line2478">2478</a><a class="anker" href="#line2479">2479</a><a class="anker" href="#line2480">2480</a><a class="anker" href="#line2481">2481</a><a class="anker" href="#line2482">2482</a><a class="anker" href="#line2483">2483</a><a class="anker" href="#line2484">2484</a><a class="anker" href="#line2485">2485</a><a class="anker" href="#line2486">2486</a><a class="anker" href="#line2487">2487</a><a class="anker" href="#line2488">2488</a><a class="anker" href="#line2489">2489</a><a class="anker" href="#line2490">2490</a><a class="anker" href="#line2491">2491</a><a class="anker" href="#line2492">2492</a><a class="anker" href="#line2493">2493</a><a class="anker" href="#line2494">2494</a><a class="anker" href="#line2495">2495</a><a class="anker" href="#line2496">2496</a><a class="anker" href="#line2497">2497</a><a class="anker" href="#line2498">2498</a><a class="anker" href="#line2499">2499</a><a class="anker" href="#line2500">2500</a><a class="anker" href="#line2501">2501</a><a class="anker" href="#line2502">2502</a><a class="anker" href="#line2503">2503</a><a class="anker" href="#line2504">2504</a><a class="anker" href="#line2505">2505</a><a class="anker" href="#line2506">2506</a><a class="anker" href="#line2507">2507</a><a class="anker" href="#line2508">2508</a><a class="anker" href="#line2509">2509</a><a class="anker" href="#line2510">2510</a><a class="anker" href="#line2511">2511</a><a class="anker" href="#line2512">2512</a><a class="anker" href="#line2513">2513</a><a class="anker" href="#line2514">2514</a><a class="anker" href="#line2515">2515</a><a class="anker" href="#line2516">2516</a><a class="anker" href="#line2517">2517</a><a class="anker" href="#line2518">2518</a><a class="anker" href="#line2519">2519</a><a class="anker" href="#line2520">2520</a><a class="anker" href="#line2521">2521</a><a class="anker" href="#line2522">2522</a><a class="anker" href="#line2523">2523</a><a class="anker" href="#line2524">2524</a><a class="anker" href="#line2525">2525</a><a class="anker" href="#line2526">2526</a><a class="anker" href="#line2527">2527</a><a class="anker" href="#line2528">2528</a><a class="anker" href="#line2529">2529</a><a class="anker" href="#line2530">2530</a><a class="anker" href="#line2531">2531</a><a class="anker" href="#line2532">2532</a><a class="anker" href="#line2533">2533</a><a class="anker" href="#line2534">2534</a><a class="anker" href="#line2535">2535</a><a class="anker" href="#line2536">2536</a><a class="anker" href="#line2537">2537</a><a class="anker" href="#line2538">2538</a><a class="anker" href="#line2539">2539</a><a class="anker" href="#line2540">2540</a><a class="anker" href="#line2541">2541</a><a class="anker" href="#line2542">2542</a><a class="anker" href="#line2543">2543</a><a class="anker" href="#line2544">2544</a><a class="anker" href="#line2545">2545</a><a class="anker" href="#line2546">2546</a><a class="anker" href="#line2547">2547</a><a class="anker" href="#line2548">2548</a><a class="anker" href="#line2549">2549</a><a class="anker" href="#line2550">2550</a><a class="anker" href="#line2551">2551</a><a class="anker" href="#line2552">2552</a><a class="anker" href="#line2553">2553</a><a class="anker" href="#line2554">2554</a><a class="anker" href="#line2555">2555</a><a class="anker" href="#line2556">2556</a><a class="anker" href="#line2557">2557</a><a class="anker" href="#line2558">2558</a><a class="anker" href="#line2559">2559</a><a class="anker" href="#line2560">2560</a><a class="anker" href="#line2561">2561</a><a class="anker" href="#line2562">2562</a><a class="anker" href="#line2563">2563</a><a class="anker" href="#line2564">2564</a><a class="anker" href="#line2565">2565</a><a class="anker" href="#line2566">2566</a><a class="anker" href="#line2567">2567</a><a class="anker" href="#line2568">2568</a><a class="anker" href="#line2569">2569</a><a class="anker" href="#line2570">2570</a><a class="anker" href="#line2571">2571</a><a class="anker" href="#line2572">2572</a><a class="anker" href="#line2573">2573</a><a class="anker" href="#line2574">2574</a><a class="anker" href="#line2575">2575</a><a class="anker" href="#line2576">2576</a><a class="anker" href="#line2577">2577</a><a class="anker" href="#line2578">2578</a><a class="anker" href="#line2579">2579</a><a class="anker" href="#line2580">2580</a><a class="anker" href="#line2581">2581</a><a class="anker" href="#line2582">2582</a><a class="anker" href="#line2583">2583</a><a class="anker" href="#line2584">2584</a><a class="anker" href="#line2585">2585</a><a class="anker" href="#line2586">2586</a><a class="anker" href="#line2587">2587</a><a class="anker" href="#line2588">2588</a><a class="anker" href="#line2589">2589</a><a class="anker" href="#line2590">2590</a><a class="anker" href="#line2591">2591</a><a class="anker" href="#line2592">2592</a><a class="anker" href="#line2593">2593</a><a class="anker" href="#line2594">2594</a><a class="anker" href="#line2595">2595</a><a class="anker" href="#line2596">2596</a><a class="anker" href="#line2597">2597</a><a class="anker" href="#line2598">2598</a><a class="anker" href="#line2599">2599</a><a class="anker" href="#line2600">2600</a><a class="anker" href="#line2601">2601</a><a class="anker" href="#line2602">2602</a><a class="anker" href="#line2603">2603</a><a class="anker" href="#line2604">2604</a><a class="anker" href="#line2605">2605</a><a class="anker" href="#line2606">2606</a><a class="anker" href="#line2607">2607</a><a class="anker" href="#line2608">2608</a><a class="anker" href="#line2609">2609</a><a class="anker" href="#line2610">2610</a><a class="anker" href="#line2611">2611</a><a class="anker" href="#line2612">2612</a><a class="anker" href="#line2613">2613</a><a class="anker" href="#line2614">2614</a><a class="anker" href="#line2615">2615</a><a class="anker" href="#line2616">2616</a><a class="anker" href="#line2617">2617</a><a class="anker" href="#line2618">2618</a><a class="anker" href="#line2619">2619</a><a class="anker" href="#line2620">2620</a><a class="anker" href="#line2621">2621</a><a class="anker" href="#line2622">2622</a><a class="anker" href="#line2623">2623</a><a class="anker" href="#line2624">2624</a><a class="anker" href="#line2625">2625</a><a class="anker" href="#line2626">2626</a><a class="anker" href="#line2627">2627</a><a class="anker" href="#line2628">2628</a><a class="anker" href="#line2629">2629</a><a class="anker" href="#line2630">2630</a><a class="anker" href="#line2631">2631</a><a class="anker" href="#line2632">2632</a><a class="anker" href="#line2633">2633</a><a class="anker" href="#line2634">2634</a><a class="anker" href="#line2635">2635</a><a class="anker" href="#line2636">2636</a><a class="anker" href="#line2637">2637</a><a class="anker" href="#line2638">2638</a><a class="anker" href="#line2639">2639</a><a class="anker" href="#line2640">2640</a><a class="anker" href="#line2641">2641</a><a class="anker" href="#line2642">2642</a><a class="anker" href="#line2643">2643</a><a class="anker" href="#line2644">2644</a><a class="anker" href="#line2645">2645</a><a class="anker" href="#line2646">2646</a><a class="anker" href="#line2647">2647</a><a class="anker" href="#line2648">2648</a><a class="anker" href="#line2649">2649</a><a class="anker" href="#line2650">2650</a><a class="anker" href="#line2651">2651</a><a class="anker" href="#line2652">2652</a><a class="anker" href="#line2653">2653</a><a class="anker" href="#line2654">2654</a><a class="anker" href="#line2655">2655</a><a class="anker" href="#line2656">2656</a><a class="anker" href="#line2657">2657</a><a class="anker" href="#line2658">2658</a><a class="anker" href="#line2659">2659</a><a class="anker" href="#line2660">2660</a><a class="anker" href="#line2661">2661</a><a class="anker" href="#line2662">2662</a><a class="anker" href="#line2663">2663</a><a class="anker" href="#line2664">2664</a><a class="anker" href="#line2665">2665</a><a class="anker" href="#line2666">2666</a><a class="anker" href="#line2667">2667</a><a class="anker" href="#line2668">2668</a><a class="anker" href="#line2669">2669</a><a class="anker" href="#line2670">2670</a><a class="anker" href="#line2671">2671</a><a class="anker" href="#line2672">2672</a><a class="anker" href="#line2673">2673</a><a class="anker" href="#line2674">2674</a><a class="anker" href="#line2675">2675</a><a class="anker" href="#line2676">2676</a><a class="anker" href="#line2677">2677</a><a class="anker" href="#line2678">2678</a><a class="anker" href="#line2679">2679</a><a class="anker" href="#line2680">2680</a><a class="anker" href="#line2681">2681</a><a class="anker" href="#line2682">2682</a><a class="anker" href="#line2683">2683</a><a class="anker" href="#line2684">2684</a><a class="anker" href="#line2685">2685</a><a class="anker" href="#line2686">2686</a><a class="anker" href="#line2687">2687</a><a class="anker" href="#line2688">2688</a><a class="anker" href="#line2689">2689</a><a class="anker" href="#line2690">2690</a><a class="anker" href="#line2691">2691</a><a class="anker" href="#line2692">2692</a><a class="anker" href="#line2693">2693</a><a class="anker" href="#line2694">2694</a><a class="anker" href="#line2695">2695</a><a class="anker" href="#line2696">2696</a><a class="anker" href="#line2697">2697</a><a class="anker" href="#line2698">2698</a><a class="anker" href="#line2699">2699</a><a class="anker" href="#line2700">2700</a><a class="anker" href="#line2701">2701</a><a class="anker" href="#line2702">2702</a><a class="anker" href="#line2703">2703</a><a class="anker" href="#line2704">2704</a><a class="anker" href="#line2705">2705</a><a class="anker" href="#line2706">2706</a><a class="anker" href="#line2707">2707</a><a class="anker" href="#line2708">2708</a><a class="anker" href="#line2709">2709</a><a class="anker" href="#line2710">2710</a><a class="anker" href="#line2711">2711</a><a class="anker" href="#line2712">2712</a><a class="anker" href="#line2713">2713</a><a class="anker" href="#line2714">2714</a><a class="anker" href="#line2715">2715</a><a class="anker" href="#line2716">2716</a><a class="anker" href="#line2717">2717</a><a class="anker" href="#line2718">2718</a><a class="anker" href="#line2719">2719</a><a class="anker" href="#line2720">2720</a><a class="anker" href="#line2721">2721</a><a class="anker" href="#line2722">2722</a><a class="anker" href="#line2723">2723</a><a class="anker" href="#line2724">2724</a><a class="anker" href="#line2725">2725</a><a class="anker" href="#line2726">2726</a><a class="anker" href="#line2727">2727</a><a class="anker" href="#line2728">2728</a><a class="anker" href="#line2729">2729</a><a class="anker" href="#line2730">2730</a><a class="anker" href="#line2731">2731</a><a class="anker" href="#line2732">2732</a><a class="anker" href="#line2733">2733</a><a class="anker" href="#line2734">2734</a><a class="anker" href="#line2735">2735</a><a class="anker" href="#line2736">2736</a><a class="anker" href="#line2737">2737</a><a class="anker" href="#line2738">2738</a><a class="anker" href="#line2739">2739</a><a class="anker" href="#line2740">2740</a><a class="anker" href="#line2741">2741</a><a class="anker" href="#line2742">2742</a><a class="anker" href="#line2743">2743</a><a class="anker" href="#line2744">2744</a><a class="anker" href="#line2745">2745</a><a class="anker" href="#line2746">2746</a><a class="anker" href="#line2747">2747</a><a class="anker" href="#line2748">2748</a><a class="anker" href="#line2749">2749</a><a class="anker" href="#line2750">2750</a><a class="anker" href="#line2751">2751</a><a class="anker" href="#line2752">2752</a><a class="anker" href="#line2753">2753</a><a class="anker" href="#line2754">2754</a><a class="anker" href="#line2755">2755</a><a class="anker" href="#line2756">2756</a><a class="anker" href="#line2757">2757</a><a class="anker" href="#line2758">2758</a><a class="anker" href="#line2759">2759</a><a class="anker" href="#line2760">2760</a><a class="anker" href="#line2761">2761</a><a class="anker" href="#line2762">2762</a><a class="anker" href="#line2763">2763</a><a class="anker" href="#line2764">2764</a><a class="anker" href="#line2765">2765</a><a class="anker" href="#line2766">2766</a><a class="anker" href="#line2767">2767</a><a class="anker" href="#line2768">2768</a><a class="anker" href="#line2769">2769</a><a class="anker" href="#line2770">2770</a><a class="anker" href="#line2771">2771</a><a class="anker" href="#line2772">2772</a><a class="anker" href="#line2773">2773</a><a class="anker" href="#line2774">2774</a><a class="anker" href="#line2775">2775</a><a class="anker" href="#line2776">2776</a><a class="anker" href="#line2777">2777</a><a class="anker" href="#line2778">2778</a><a class="anker" href="#line2779">2779</a><a class="anker" href="#line2780">2780</a><a class="anker" href="#line2781">2781</a><a class="anker" href="#line2782">2782</a><a class="anker" href="#line2783">2783</a><a class="anker" href="#line2784">2784</a><a class="anker" href="#line2785">2785</a><a class="anker" href="#line2786">2786</a><a class="anker" href="#line2787">2787</a><a class="anker" href="#line2788">2788</a><a class="anker" href="#line2789">2789</a><a class="anker" href="#line2790">2790</a><a class="anker" href="#line2791">2791</a><a class="anker" href="#line2792">2792</a><a class="anker" href="#line2793">2793</a><a class="anker" href="#line2794">2794</a><a class="anker" href="#line2795">2795</a><a class="anker" href="#line2796">2796</a><a class="anker" href="#line2797">2797</a><a class="anker" href="#line2798">2798</a><a class="anker" href="#line2799">2799</a><a class="anker" href="#line2800">2800</a><a class="anker" href="#line2801">2801</a><a class="anker" href="#line2802">2802</a><a class="anker" href="#line2803">2803</a><a class="anker" href="#line2804">2804</a><a class="anker" href="#line2805">2805</a><a class="anker" href="#line2806">2806</a><a class="anker" href="#line2807">2807</a><a class="anker" href="#line2808">2808</a><a class="anker" href="#line2809">2809</a><a class="anker" href="#line2810">2810</a><a class="anker" href="#line2811">2811</a><a class="anker" href="#line2812">2812</a><a class="anker" href="#line2813">2813</a><a class="anker" href="#line2814">2814</a><a class="anker" href="#line2815">2815</a><a class="anker" href="#line2816">2816</a><a class="anker" href="#line2817">2817</a><a class="anker" href="#line2818">2818</a><a class="anker" href="#line2819">2819</a><a class="anker" href="#line2820">2820</a><a class="anker" href="#line2821">2821</a><a class="anker" href="#line2822">2822</a><a class="anker" href="#line2823">2823</a><a class="anker" href="#line2824">2824</a><a class="anker" href="#line2825">2825</a><a class="anker" href="#line2826">2826</a><a class="anker" href="#line2827">2827</a><a class="anker" href="#line2828">2828</a><a class="anker" href="#line2829">2829</a><a class="anker" href="#line2830">2830</a><a class="anker" href="#line2831">2831</a><a class="anker" href="#line2832">2832</a><a class="anker" href="#line2833">2833</a><a class="anker" href="#line2834">2834</a><a class="anker" href="#line2835">2835</a><a class="anker" href="#line2836">2836</a><a class="anker" href="#line2837">2837</a><a class="anker" href="#line2838">2838</a><a class="anker" href="#line2839">2839</a><a class="anker" href="#line2840">2840</a><a class="anker" href="#line2841">2841</a><a class="anker" href="#line2842">2842</a><a class="anker" href="#line2843">2843</a><a class="anker" href="#line2844">2844</a><a class="anker" href="#line2845">2845</a><a class="anker" href="#line2846">2846</a><a class="anker" href="#line2847">2847</a><a class="anker" href="#line2848">2848</a><a class="anker" href="#line2849">2849</a><a class="anker" href="#line2850">2850</a><a class="anker" href="#line2851">2851</a><a class="anker" href="#line2852">2852</a><a class="anker" href="#line2853">2853</a><a class="anker" href="#line2854">2854</a><a class="anker" href="#line2855">2855</a><a class="anker" href="#line2856">2856</a><a class="anker" href="#line2857">2857</a><a class="anker" href="#line2858">2858</a><a class="anker" href="#line2859">2859</a><a class="anker" href="#line2860">2860</a><a class="anker" href="#line2861">2861</a><a class="anker" href="#line2862">2862</a><a class="anker" href="#line2863">2863</a><a class="anker" href="#line2864">2864</a><a class="anker" href="#line2865">2865</a><a class="anker" href="#line2866">2866</a><a class="anker" href="#line2867">2867</a><a class="anker" href="#line2868">2868</a><a class="anker" href="#line2869">2869</a><a class="anker" href="#line2870">2870</a><a class="anker" href="#line2871">2871</a><a class="anker" href="#line2872">2872</a><a class="anker" href="#line2873">2873</a><a class="anker" href="#line2874">2874</a><a class="anker" href="#line2875">2875</a><a class="anker" href="#line2876">2876</a><a class="anker" href="#line2877">2877</a><a class="anker" href="#line2878">2878</a><a class="anker" href="#line2879">2879</a><a class="anker" href="#line2880">2880</a><a class="anker" href="#line2881">2881</a><a class="anker" href="#line2882">2882</a><a class="anker" href="#line2883">2883</a><a class="anker" href="#line2884">2884</a><a class="anker" href="#line2885">2885</a><a class="anker" href="#line2886">2886</a><a class="anker" href="#line2887">2887</a><a class="anker" href="#line2888">2888</a><a class="anker" href="#line2889">2889</a><a class="anker" href="#line2890">2890</a><a class="anker" href="#line2891">2891</a><a class="anker" href="#line2892">2892</a><a class="anker" href="#line2893">2893</a><a class="anker" href="#line2894">2894</a><a class="anker" href="#line2895">2895</a><a class="anker" href="#line2896">2896</a><a class="anker" href="#line2897">2897</a><a class="anker" href="#line2898">2898</a><a class="anker" href="#line2899">2899</a><a class="anker" href="#line2900">2900</a><a class="anker" href="#line2901">2901</a><a class="anker" href="#line2902">2902</a><a class="anker" href="#line2903">2903</a><a class="anker" href="#line2904">2904</a><a class="anker" href="#line2905">2905</a><a class="anker" href="#line2906">2906</a><a class="anker" href="#line2907">2907</a><a class="anker" href="#line2908">2908</a><a class="anker" href="#line2909">2909</a><a class="anker" href="#line2910">2910</a><a class="anker" href="#line2911">2911</a><a class="anker" href="#line2912">2912</a><a class="anker" href="#line2913">2913</a><a class="anker" href="#line2914">2914</a><a class="anker" href="#line2915">2915</a><a class="anker" href="#line2916">2916</a><a class="anker" href="#line2917">2917</a><a class="anker" href="#line2918">2918</a><a class="anker" href="#line2919">2919</a><a class="anker" href="#line2920">2920</a><a class="anker" href="#line2921">2921</a><a class="anker" href="#line2922">2922</a><a class="anker" href="#line2923">2923</a><a class="anker" href="#line2924">2924</a><a class="anker" href="#line2925">2925</a><a class="anker" href="#line2926">2926</a><a class="anker" href="#line2927">2927</a><a class="anker" href="#line2928">2928</a><a class="anker" href="#line2929">2929</a><a class="anker" href="#line2930">2930</a><a class="anker" href="#line2931">2931</a><a class="anker" href="#line2932">2932</a><a class="anker" href="#line2933">2933</a><a class="anker" href="#line2934">2934</a><a class="anker" href="#line2935">2935</a><a class="anker" href="#line2936">2936</a><a class="anker" href="#line2937">2937</a><a class="anker" href="#line2938">2938</a><a class="anker" href="#line2939">2939</a><a class="anker" href="#line2940">2940</a><a class="anker" href="#line2941">2941</a><a class="anker" href="#line2942">2942</a><a class="anker" href="#line2943">2943</a><a class="anker" href="#line2944">2944</a><a class="anker" href="#line2945">2945</a><a class="anker" href="#line2946">2946</a><a class="anker" href="#line2947">2947</a><a class="anker" href="#line2948">2948</a><a class="anker" href="#line2949">2949</a><a class="anker" href="#line2950">2950</a><a class="anker" href="#line2951">2951</a><a class="anker" href="#line2952">2952</a><a class="anker" href="#line2953">2953</a><a class="anker" href="#line2954">2954</a><a class="anker" href="#line2955">2955</a><a class="anker" href="#line2956">2956</a><a class="anker" href="#line2957">2957</a><a class="anker" href="#line2958">2958</a><a class="anker" href="#line2959">2959</a><a class="anker" href="#line2960">2960</a><a class="anker" href="#line2961">2961</a><a class="anker" href="#line2962">2962</a><a class="anker" href="#line2963">2963</a><a class="anker" href="#line2964">2964</a><a class="anker" href="#line2965">2965</a><a class="anker" href="#line2966">2966</a><a class="anker" href="#line2967">2967</a><a class="anker" href="#line2968">2968</a><a class="anker" href="#line2969">2969</a><a class="anker" href="#line2970">2970</a><a class="anker" href="#line2971">2971</a><a class="anker" href="#line2972">2972</a><a class="anker" href="#line2973">2973</a><a class="anker" href="#line2974">2974</a><a class="anker" href="#line2975">2975</a><a class="anker" href="#line2976">2976</a><a class="anker" href="#line2977">2977</a><a class="anker" href="#line2978">2978</a><a class="anker" href="#line2979">2979</a><a class="anker" href="#line2980">2980</a><a class="anker" href="#line2981">2981</a><a class="anker" href="#line2982">2982</a><a class="anker" href="#line2983">2983</a><a class="anker" href="#line2984">2984</a><a class="anker" href="#line2985">2985</a><a class="anker" href="#line2986">2986</a><a class="anker" href="#line2987">2987</a><a class="anker" href="#line2988">2988</a><a class="anker" href="#line2989">2989</a><a class="anker" href="#line2990">2990</a><a class="anker" href="#line2991">2991</a><a class="anker" href="#line2992">2992</a><a class="anker" href="#line2993">2993</a><a class="anker" href="#line2994">2994</a><a class="anker" href="#line2995">2995</a><a class="anker" href="#line2996">2996</a><a class="anker" href="#line2997">2997</a><a class="anker" href="#line2998">2998</a><a class="anker" href="#line2999">2999</a><a class="anker" href="#line3000">3000</a><a class="anker" href="#line3001">3001</a><a class="anker" href="#line3002">3002</a><a class="anker" href="#line3003">3003</a><a class="anker" href="#line3004">3004</a><a class="anker" href="#line3005">3005</a><a class="anker" href="#line3006">3006</a><a class="anker" href="#line3007">3007</a><a class="anker" href="#line3008">3008</a><a class="anker" href="#line3009">3009</a><a class="anker" href="#line3010">3010</a><a class="anker" href="#line3011">3011</a><a class="anker" href="#line3012">3012</a><a class="anker" href="#line3013">3013</a><a class="anker" href="#line3014">3014</a><a class="anker" href="#line3015">3015</a><a class="anker" href="#line3016">3016</a><a class="anker" href="#line3017">3017</a><a class="anker" href="#line3018">3018</a><a class="anker" href="#line3019">3019</a><a class="anker" href="#line3020">3020</a><a class="anker" href="#line3021">3021</a><a class="anker" href="#line3022">3022</a><a class="anker" href="#line3023">3023</a><a class="anker" href="#line3024">3024</a><a class="anker" href="#line3025">3025</a><a class="anker" href="#line3026">3026</a><a class="anker" href="#line3027">3027</a><a class="anker" href="#line3028">3028</a><a class="anker" href="#line3029">3029</a><a class="anker" href="#line3030">3030</a><a class="anker" href="#line3031">3031</a><a class="anker" href="#line3032">3032</a><a class="anker" href="#line3033">3033</a><a class="anker" href="#line3034">3034</a><a class="anker" href="#line3035">3035</a><a class="anker" href="#line3036">3036</a><a class="anker" href="#line3037">3037</a><a class="anker" href="#line3038">3038</a><a class="anker" href="#line3039">3039</a><a class="anker" href="#line3040">3040</a><a class="anker" href="#line3041">3041</a><a class="anker" href="#line3042">3042</a><a class="anker" href="#line3043">3043</a><a class="anker" href="#line3044">3044</a><a class="anker" href="#line3045">3045</a><a class="anker" href="#line3046">3046</a><a class="anker" href="#line3047">3047</a><a class="anker" href="#line3048">3048</a><a class="anker" href="#line3049">3049</a><a class="anker" href="#line3050">3050</a><a class="anker" href="#line3051">3051</a><a class="anker" href="#line3052">3052</a><a class="anker" href="#line3053">3053</a><a class="anker" href="#line3054">3054</a><a class="anker" href="#line3055">3055</a><a class="anker" href="#line3056">3056</a><a class="anker" href="#line3057">3057</a><a class="anker" href="#line3058">3058</a><a class="anker" href="#line3059">3059</a><a class="anker" href="#line3060">3060</a><a class="anker" href="#line3061">3061</a><a class="anker" href="#line3062">3062</a><a class="anker" href="#line3063">3063</a><a class="anker" href="#line3064">3064</a><a class="anker" href="#line3065">3065</a><a class="anker" href="#line3066">3066</a><a class="anker" href="#line3067">3067</a><a class="anker" href="#line3068">3068</a><a class="anker" href="#line3069">3069</a><a class="anker" href="#line3070">3070</a><a class="anker" href="#line3071">3071</a><a class="anker" href="#line3072">3072</a><a class="anker" href="#line3073">3073</a><a class="anker" href="#line3074">3074</a><a class="anker" href="#line3075">3075</a><a class="anker" href="#line3076">3076</a><a class="anker" href="#line3077">3077</a><a class="anker" href="#line3078">3078</a><a class="anker" href="#line3079">3079</a><a class="anker" href="#line3080">3080</a><a class="anker" href="#line3081">3081</a><a class="anker" href="#line3082">3082</a><a class="anker" href="#line3083">3083</a><a class="anker" href="#line3084">3084</a><a class="anker" href="#line3085">3085</a><a class="anker" href="#line3086">3086</a><a class="anker" href="#line3087">3087</a><a class="anker" href="#line3088">3088</a><a class="anker" href="#line3089">3089</a><a class="anker" href="#line3090">3090</a><a class="anker" href="#line3091">3091</a><a class="anker" href="#line3092">3092</a><a class="anker" href="#line3093">3093</a><a class="anker" href="#line3094">3094</a><a class="anker" href="#line3095">3095</a><a class="anker" href="#line3096">3096</a><a class="anker" href="#line3097">3097</a><a class="anker" href="#line3098">3098</a><a class="anker" href="#line3099">3099</a><a class="anker" href="#line3100">3100</a><a class="anker" href="#line3101">3101</a><a class="anker" href="#line3102">3102</a><a class="anker" href="#line3103">3103</a><a class="anker" href="#line3104">3104</a><a class="anker" href="#line3105">3105</a><a class="anker" href="#line3106">3106</a><a class="anker" href="#line3107">3107</a><a class="anker" href="#line3108">3108</a><a class="anker" href="#line3109">3109</a><a class="anker" href="#line3110">3110</a><a class="anker" href="#line3111">3111</a><a class="anker" href="#line3112">3112</a><a class="anker" href="#line3113">3113</a><a class="anker" href="#line3114">3114</a><a class="anker" href="#line3115">3115</a><a class="anker" href="#line3116">3116</a><a class="anker" href="#line3117">3117</a><a class="anker" href="#line3118">3118</a><a class="anker" href="#line3119">3119</a><a class="anker" href="#line3120">3120</a><a class="anker" href="#line3121">3121</a><a class="anker" href="#line3122">3122</a><a class="anker" href="#line3123">3123</a><a class="anker" href="#line3124">3124</a><a class="anker" href="#line3125">3125</a><a class="anker" href="#line3126">3126</a><a class="anker" href="#line3127">3127</a><a class="anker" href="#line3128">3128</a><a class="anker" href="#line3129">3129</a><a class="anker" href="#line3130">3130</a><a class="anker" href="#line3131">3131</a><a class="anker" href="#line3132">3132</a><a class="anker" href="#line3133">3133</a><a class="anker" href="#line3134">3134</a><a class="anker" href="#line3135">3135</a><a class="anker" href="#line3136">3136</a><a class="anker" href="#line3137">3137</a><a class="anker" href="#line3138">3138</a><a class="anker" href="#line3139">3139</a><a class="anker" href="#line3140">3140</a><a class="anker" href="#line3141">3141</a><a class="anker" href="#line3142">3142</a><a class="anker" href="#line3143">3143</a><a class="anker" href="#line3144">3144</a><a class="anker" href="#line3145">3145</a><a class="anker" href="#line3146">3146</a><a class="anker" href="#line3147">3147</a><a class="anker" href="#line3148">3148</a><a class="anker" href="#line3149">3149</a><a class="anker" href="#line3150">3150</a><a class="anker" href="#line3151">3151</a><a class="anker" href="#line3152">3152</a><a class="anker" href="#line3153">3153</a><a class="anker" href="#line3154">3154</a><a class="anker" href="#line3155">3155</a><a class="anker" href="#line3156">3156</a><a class="anker" href="#line3157">3157</a><a class="anker" href="#line3158">3158</a><a class="anker" href="#line3159">3159</a><a class="anker" href="#line3160">3160</a><a class="anker" href="#line3161">3161</a><a class="anker" href="#line3162">3162</a><a class="anker" href="#line3163">3163</a><a class="anker" href="#line3164">3164</a><a class="anker" href="#line3165">3165</a><a class="anker" href="#line3166">3166</a><a class="anker" href="#line3167">3167</a><a class="anker" href="#line3168">3168</a><a class="anker" href="#line3169">3169</a><a class="anker" href="#line3170">3170</a><a class="anker" href="#line3171">3171</a><a class="anker" href="#line3172">3172</a><a class="anker" href="#line3173">3173</a><a class="anker" href="#line3174">3174</a><a class="anker" href="#line3175">3175</a><a class="anker" href="#line3176">3176</a><a class="anker" href="#line3177">3177</a><a class="anker" href="#line3178">3178</a><a class="anker" href="#line3179">3179</a><a class="anker" href="#line3180">3180</a><a class="anker" href="#line3181">3181</a><a class="anker" href="#line3182">3182</a><a class="anker" href="#line3183">3183</a><a class="anker" href="#line3184">3184</a><a class="anker" href="#line3185">3185</a><a class="anker" href="#line3186">3186</a><a class="anker" href="#line3187">3187</a><a class="anker" href="#line3188">3188</a><a class="anker" href="#line3189">3189</a><a class="anker" href="#line3190">3190</a><a class="anker" href="#line3191">3191</a><a class="anker" href="#line3192">3192</a><a class="anker" href="#line3193">3193</a><a class="anker" href="#line3194">3194</a><a class="anker" href="#line3195">3195</a><a class="anker" href="#line3196">3196</a><a class="anker" href="#line3197">3197</a><a class="anker" href="#line3198">3198</a><a class="anker" href="#line3199">3199</a><a class="anker" href="#line3200">3200</a><a class="anker" href="#line3201">3201</a><a class="anker" href="#line3202">3202</a><a class="anker" href="#line3203">3203</a><a class="anker" href="#line3204">3204</a><a class="anker" href="#line3205">3205</a><a class="anker" href="#line3206">3206</a><a class="anker" href="#line3207">3207</a><a class="anker" href="#line3208">3208</a><a class="anker" href="#line3209">3209</a><a class="anker" href="#line3210">3210</a><a class="anker" href="#line3211">3211</a><a class="anker" href="#line3212">3212</a><a class="anker" href="#line3213">3213</a><a class="anker" href="#line3214">3214</a><a class="anker" href="#line3215">3215</a><a class="anker" href="#line3216">3216</a><a class="anker" href="#line3217">3217</a><a class="anker" href="#line3218">3218</a><a class="anker" href="#line3219">3219</a><a class="anker" href="#line3220">3220</a><a class="anker" href="#line3221">3221</a><a class="anker" href="#line3222">3222</a><a class="anker" href="#line3223">3223</a><a class="anker" href="#line3224">3224</a><a class="anker" href="#line3225">3225</a><a class="anker" href="#line3226">3226</a><a class="anker" href="#line3227">3227</a><a class="anker" href="#line3228">3228</a><a class="anker" href="#line3229">3229</a><a class="anker" href="#line3230">3230</a><a class="anker" href="#line3231">3231</a><a class="anker" href="#line3232">3232</a><a class="anker" href="#line3233">3233</a><a class="anker" href="#line3234">3234</a><a class="anker" href="#line3235">3235</a><a class="anker" href="#line3236">3236</a><a class="anker" href="#line3237">3237</a><a class="anker" href="#line3238">3238</a><a class="anker" href="#line3239">3239</a><a class="anker" href="#line3240">3240</a><a class="anker" href="#line3241">3241</a><a class="anker" href="#line3242">3242</a><a class="anker" href="#line3243">3243</a><a class="anker" href="#line3244">3244</a><a class="anker" href="#line3245">3245</a><a class="anker" href="#line3246">3246</a><a class="anker" href="#line3247">3247</a><a class="anker" href="#line3248">3248</a><a class="anker" href="#line3249">3249</a><a class="anker" href="#line3250">3250</a><a class="anker" href="#line3251">3251</a><a class="anker" href="#line3252">3252</a><a class="anker" href="#line3253">3253</a><a class="anker" href="#line3254">3254</a><a class="anker" href="#line3255">3255</a><a class="anker" href="#line3256">3256</a><a class="anker" href="#line3257">3257</a><a class="anker" href="#line3258">3258</a><a class="anker" href="#line3259">3259</a><a class="anker" href="#line3260">3260</a><a class="anker" href="#line3261">3261</a><a class="anker" href="#line3262">3262</a><a class="anker" href="#line3263">3263</a><a class="anker" href="#line3264">3264</a><a class="anker" href="#line3265">3265</a><a class="anker" href="#line3266">3266</a><a class="anker" href="#line3267">3267</a><a class="anker" href="#line3268">3268</a><a class="anker" href="#line3269">3269</a><a class="anker" href="#line3270">3270</a><a class="anker" href="#line3271">3271</a><a class="anker" href="#line3272">3272</a><a class="anker" href="#line3273">3273</a><a class="anker" href="#line3274">3274</a><a class="anker" href="#line3275">3275</a><a class="anker" href="#line3276">3276</a><a class="anker" href="#line3277">3277</a><a class="anker" href="#line3278">3278</a><a class="anker" href="#line3279">3279</a><a class="anker" href="#line3280">3280</a><a class="anker" href="#line3281">3281</a><a class="anker" href="#line3282">3282</a><a class="anker" href="#line3283">3283</a><a class="anker" href="#line3284">3284</a><a class="anker" href="#line3285">3285</a><a class="anker" href="#line3286">3286</a><a class="anker" href="#line3287">3287</a><a class="anker" href="#line3288">3288</a><a class="anker" href="#line3289">3289</a><a class="anker" href="#line3290">3290</a><a class="anker" href="#line3291">3291</a><a class="anker" href="#line3292">3292</a><a class="anker" href="#line3293">3293</a><a class="anker" href="#line3294">3294</a><a class="anker" href="#line3295">3295</a><a class="anker" href="#line3296">3296</a><a class="anker" href="#line3297">3297</a><a class="anker" href="#line3298">3298</a><a class="anker" href="#line3299">3299</a><a class="anker" href="#line3300">3300</a><a class="anker" href="#line3301">3301</a><a class="anker" href="#line3302">3302</a><a class="anker" href="#line3303">3303</a><a class="anker" href="#line3304">3304</a><a class="anker" href="#line3305">3305</a><a class="anker" href="#line3306">3306</a><a class="anker" href="#line3307">3307</a><a class="anker" href="#line3308">3308</a><a class="anker" href="#line3309">3309</a><a class="anker" href="#line3310">3310</a><a class="anker" href="#line3311">3311</a><a class="anker" href="#line3312">3312</a><a class="anker" href="#line3313">3313</a><a class="anker" href="#line3314">3314</a><a class="anker" href="#line3315">3315</a><a class="anker" href="#line3316">3316</a><a class="anker" href="#line3317">3317</a><a class="anker" href="#line3318">3318</a><a class="anker" href="#line3319">3319</a><a class="anker" href="#line3320">3320</a><a class="anker" href="#line3321">3321</a><a class="anker" href="#line3322">3322</a><a class="anker" href="#line3323">3323</a><a class="anker" href="#line3324">3324</a><a class="anker" href="#line3325">3325</a><a class="anker" href="#line3326">3326</a><a class="anker" href="#line3327">3327</a><a class="anker" href="#line3328">3328</a><a class="anker" href="#line3329">3329</a><a class="anker" href="#line3330">3330</a><a class="anker" href="#line3331">3331</a><a class="anker" href="#line3332">3332</a><a class="anker" href="#line3333">3333</a><a class="anker" href="#line3334">3334</a><a class="anker" href="#line3335">3335</a><a class="anker" href="#line3336">3336</a><a class="anker" href="#line3337">3337</a><a class="anker" href="#line3338">3338</a><a class="anker" href="#line3339">3339</a><a class="anker" href="#line3340">3340</a><a class="anker" href="#line3341">3341</a><a class="anker" href="#line3342">3342</a><a class="anker" href="#line3343">3343</a><a class="anker" href="#line3344">3344</a><a class="anker" href="#line3345">3345</a><a class="anker" href="#line3346">3346</a><a class="anker" href="#line3347">3347</a><a class="anker" href="#line3348">3348</a><a class="anker" href="#line3349">3349</a><a class="anker" href="#line3350">3350</a><a class="anker" href="#line3351">3351</a><a class="anker" href="#line3352">3352</a><a class="anker" href="#line3353">3353</a><a class="anker" href="#line3354">3354</a><a class="anker" href="#line3355">3355</a><a class="anker" href="#line3356">3356</a><a class="anker" href="#line3357">3357</a><a class="anker" href="#line3358">3358</a><a class="anker" href="#line3359">3359</a><a class="anker" href="#line3360">3360</a><a class="anker" href="#line3361">3361</a><a class="anker" href="#line3362">3362</a><a class="anker" href="#line3363">3363</a><a class="anker" href="#line3364">3364</a><a class="anker" href="#line3365">3365</a><a class="anker" href="#line3366">3366</a><a class="anker" href="#line3367">3367</a><a class="anker" href="#line3368">3368</a><a class="anker" href="#line3369">3369</a><a class="anker" href="#line3370">3370</a><a class="anker" href="#line3371">3371</a><a class="anker" href="#line3372">3372</a><a class="anker" href="#line3373">3373</a><a class="anker" href="#line3374">3374</a><a class="anker" href="#line3375">3375</a><a class="anker" href="#line3376">3376</a><a class="anker" href="#line3377">3377</a><a class="anker" href="#line3378">3378</a><a class="anker" href="#line3379">3379</a><a class="anker" href="#line3380">3380</a><a class="anker" href="#line3381">3381</a><a class="anker" href="#line3382">3382</a><a class="anker" href="#line3383">3383</a><a class="anker" href="#line3384">3384</a><a class="anker" href="#line3385">3385</a><a class="anker" href="#line3386">3386</a><a class="anker" href="#line3387">3387</a><a class="anker" href="#line3388">3388</a><a class="anker" href="#line3389">3389</a><a class="anker" href="#line3390">3390</a><a class="anker" href="#line3391">3391</a><a class="anker" href="#line3392">3392</a><a class="anker" href="#line3393">3393</a><a class="anker" href="#line3394">3394</a><a class="anker" href="#line3395">3395</a><a class="anker" href="#line3396">3396</a><a class="anker" href="#line3397">3397</a><a class="anker" href="#line3398">3398</a><a class="anker" href="#line3399">3399</a><a class="anker" href="#line3400">3400</a><a class="anker" href="#line3401">3401</a><a class="anker" href="#line3402">3402</a><a class="anker" href="#line3403">3403</a><a class="anker" href="#line3404">3404</a><a class="anker" href="#line3405">3405</a><a class="anker" href="#line3406">3406</a><a class="anker" href="#line3407">3407</a><a class="anker" href="#line3408">3408</a><a class="anker" href="#line3409">3409</a><a class="anker" href="#line3410">3410</a><a class="anker" href="#line3411">3411</a><a class="anker" href="#line3412">3412</a><a class="anker" href="#line3413">3413</a><a class="anker" href="#line3414">3414</a><a class="anker" href="#line3415">3415</a><a class="anker" href="#line3416">3416</a><a class="anker" href="#line3417">3417</a><a class="anker" href="#line3418">3418</a><a class="anker" href="#line3419">3419</a><a class="anker" href="#line3420">3420</a><a class="anker" href="#line3421">3421</a><a class="anker" href="#line3422">3422</a><a class="anker" href="#line3423">3423</a><a class="anker" href="#line3424">3424</a><a class="anker" href="#line3425">3425</a><a class="anker" href="#line3426">3426</a><a class="anker" href="#line3427">3427</a><a class="anker" href="#line3428">3428</a><a class="anker" href="#line3429">3429</a><a class="anker" href="#line3430">3430</a><a class="anker" href="#line3431">3431</a><a class="anker" href="#line3432">3432</a><a class="anker" href="#line3433">3433</a><a class="anker" href="#line3434">3434</a><a class="anker" href="#line3435">3435</a><a class="anker" href="#line3436">3436</a><a class="anker" href="#line3437">3437</a><a class="anker" href="#line3438">3438</a><a class="anker" href="#line3439">3439</a><a class="anker" href="#line3440">3440</a><a class="anker" href="#line3441">3441</a><a class="anker" href="#line3442">3442</a><a class="anker" href="#line3443">3443</a><a class="anker" href="#line3444">3444</a><a class="anker" href="#line3445">3445</a><a class="anker" href="#line3446">3446</a><a class="anker" href="#line3447">3447</a><a class="anker" href="#line3448">3448</a><a class="anker" href="#line3449">3449</a><a class="anker" href="#line3450">3450</a><a class="anker" href="#line3451">3451</a><a class="anker" href="#line3452">3452</a><a class="anker" href="#line3453">3453</a><a class="anker" href="#line3454">3454</a><a class="anker" href="#line3455">3455</a><a class="anker" href="#line3456">3456</a><a class="anker" href="#line3457">3457</a><a class="anker" href="#line3458">3458</a><a class="anker" href="#line3459">3459</a><a class="anker" href="#line3460">3460</a><a class="anker" href="#line3461">3461</a><a class="anker" href="#line3462">3462</a><a class="anker" href="#line3463">3463</a><a class="anker" href="#line3464">3464</a><a class="anker" href="#line3465">3465</a><a class="anker" href="#line3466">3466</a><a class="anker" href="#line3467">3467</a><a class="anker" href="#line3468">3468</a><a class="anker" href="#line3469">3469</a><a class="anker" href="#line3470">3470</a><a class="anker" href="#line3471">3471</a><a class="anker" href="#line3472">3472</a><a class="anker" href="#line3473">3473</a><a class="anker" href="#line3474">3474</a><a class="anker" href="#line3475">3475</a><a class="anker" href="#line3476">3476</a><a class="anker" href="#line3477">3477</a><a class="anker" href="#line3478">3478</a><a class="anker" href="#line3479">3479</a><a class="anker" href="#line3480">3480</a><a class="anker" href="#line3481">3481</a><a class="anker" href="#line3482">3482</a><a class="anker" href="#line3483">3483</a><a class="anker" href="#line3484">3484</a><a class="anker" href="#line3485">3485</a><a class="anker" href="#line3486">3486</a><a class="anker" href="#line3487">3487</a><a class="anker" href="#line3488">3488</a><a class="anker" href="#line3489">3489</a><a class="anker" href="#line3490">3490</a><a class="anker" href="#line3491">3491</a><a class="anker" href="#line3492">3492</a><a class="anker" href="#line3493">3493</a><a class="anker" href="#line3494">3494</a><a class="anker" href="#line3495">3495</a><a class="anker" href="#line3496">3496</a><a class="anker" href="#line3497">3497</a><a class="anker" href="#line3498">3498</a><a class="anker" href="#line3499">3499</a><a class="anker" href="#line3500">3500</a><a class="anker" href="#line3501">3501</a><a class="anker" href="#line3502">3502</a><a class="anker" href="#line3503">3503</a><a class="anker" href="#line3504">3504</a><a class="anker" href="#line3505">3505</a><a class="anker" href="#line3506">3506</a><a class="anker" href="#line3507">3507</a><a class="anker" href="#line3508">3508</a><a class="anker" href="#line3509">3509</a><a class="anker" href="#line3510">3510</a><a class="anker" href="#line3511">3511</a><a class="anker" href="#line3512">3512</a><a class="anker" href="#line3513">3513</a><a class="anker" href="#line3514">3514</a><a class="anker" href="#line3515">3515</a><a class="anker" href="#line3516">3516</a><a class="anker" href="#line3517">3517</a><a class="anker" href="#line3518">3518</a><a class="anker" href="#line3519">3519</a><a class="anker" href="#line3520">3520</a><a class="anker" href="#line3521">3521</a><a class="anker" href="#line3522">3522</a><a class="anker" href="#line3523">3523</a><a class="anker" href="#line3524">3524</a><a class="anker" href="#line3525">3525</a><a class="anker" href="#line3526">3526</a><a class="anker" href="#line3527">3527</a><a class="anker" href="#line3528">3528</a><a class="anker" href="#line3529">3529</a><a class="anker" href="#line3530">3530</a><a class="anker" href="#line3531">3531</a><a class="anker" href="#line3532">3532</a><a class="anker" href="#line3533">3533</a><a class="anker" href="#line3534">3534</a><a class="anker" href="#line3535">3535</a><a class="anker" href="#line3536">3536</a><a class="anker" href="#line3537">3537</a><a class="anker" href="#line3538">3538</a><a class="anker" href="#line3539">3539</a><a class="anker" href="#line3540">3540</a><a class="anker" href="#line3541">3541</a><a class="anker" href="#line3542">3542</a><a class="anker" href="#line3543">3543</a><a class="anker" href="#line3544">3544</a><a class="anker" href="#line3545">3545</a><a class="anker" href="#line3546">3546</a><a class="anker" href="#line3547">3547</a><a class="anker" href="#line3548">3548</a><a class="anker" href="#line3549">3549</a><a class="anker" href="#line3550">3550</a><a class="anker" href="#line3551">3551</a><a class="anker" href="#line3552">3552</a><a class="anker" href="#line3553">3553</a><a class="anker" href="#line3554">3554</a><a class="anker" href="#line3555">3555</a><a class="anker" href="#line3556">3556</a><a class="anker" href="#line3557">3557</a><a class="anker" href="#line3558">3558</a><a class="anker" href="#line3559">3559</a><a class="anker" href="#line3560">3560</a><a class="anker" href="#line3561">3561</a><a class="anker" href="#line3562">3562</a><a class="anker" href="#line3563">3563</a><a class="anker" href="#line3564">3564</a><a class="anker" href="#line3565">3565</a><a class="anker" href="#line3566">3566</a><a class="anker" href="#line3567">3567</a><a class="anker" href="#line3568">3568</a><a class="anker" href="#line3569">3569</a><a class="anker" href="#line3570">3570</a><a class="anker" href="#line3571">3571</a><a class="anker" href="#line3572">3572</a><a class="anker" href="#line3573">3573</a><a class="anker" href="#line3574">3574</a><a class="anker" href="#line3575">3575</a><a class="anker" href="#line3576">3576</a><a class="anker" href="#line3577">3577</a><a class="anker" href="#line3578">3578</a><a class="anker" href="#line3579">3579</a><a class="anker" href="#line3580">3580</a><a class="anker" href="#line3581">3581</a><a class="anker" href="#line3582">3582</a><a class="anker" href="#line3583">3583</a><a class="anker" href="#line3584">3584</a><a class="anker" href="#line3585">3585</a><a class="anker" href="#line3586">3586</a><a class="anker" href="#line3587">3587</a><a class="anker" href="#line3588">3588</a><a class="anker" href="#line3589">3589</a><a class="anker" href="#line3590">3590</a><a class="anker" href="#line3591">3591</a><a class="anker" href="#line3592">3592</a><a class="anker" href="#line3593">3593</a><a class="anker" href="#line3594">3594</a><a class="anker" href="#line3595">3595</a><a class="anker" href="#line3596">3596</a><a class="anker" href="#line3597">3597</a><a class="anker" href="#line3598">3598</a><a class="anker" href="#line3599">3599</a><a class="anker" href="#line3600">3600</a><a class="anker" href="#line3601">3601</a><a class="anker" href="#line3602">3602</a><a class="anker" href="#line3603">3603</a><a class="anker" href="#line3604">3604</a><a class="anker" href="#line3605">3605</a><a class="anker" href="#line3606">3606</a><a class="anker" href="#line3607">3607</a><a class="anker" href="#line3608">3608</a><a class="anker" href="#line3609">3609</a><a class="anker" href="#line3610">3610</a><a class="anker" href="#line3611">3611</a><a class="anker" href="#line3612">3612</a><a class="anker" href="#line3613">3613</a><a class="anker" href="#line3614">3614</a><a class="anker" href="#line3615">3615</a><a class="anker" href="#line3616">3616</a><a class="anker" href="#line3617">3617</a><a class="anker" href="#line3618">3618</a><a class="anker" href="#line3619">3619</a><a class="anker" href="#line3620">3620</a><a class="anker" href="#line3621">3621</a><a class="anker" href="#line3622">3622</a><a class="anker" href="#line3623">3623</a><a class="anker" href="#line3624">3624</a><a class="anker" href="#line3625">3625</a><a class="anker" href="#line3626">3626</a><a class="anker" href="#line3627">3627</a><a class="anker" href="#line3628">3628</a><a class="anker" href="#line3629">3629</a><a class="anker" href="#line3630">3630</a><a class="anker" href="#line3631">3631</a><a class="anker" href="#line3632">3632</a><a class="anker" href="#line3633">3633</a><a class="anker" href="#line3634">3634</a><a class="anker" href="#line3635">3635</a><a class="anker" href="#line3636">3636</a><a class="anker" href="#line3637">3637</a><a class="anker" href="#line3638">3638</a><a class="anker" href="#line3639">3639</a><a class="anker" href="#line3640">3640</a><a class="anker" href="#line3641">3641</a><a class="anker" href="#line3642">3642</a><a class="anker" href="#line3643">3643</a><a class="anker" href="#line3644">3644</a><a class="anker" href="#line3645">3645</a><a class="anker" href="#line3646">3646</a><a class="anker" href="#line3647">3647</a><a class="anker" href="#line3648">3648</a><a class="anker" href="#line3649">3649</a><a class="anker" href="#line3650">3650</a><a class="anker" href="#line3651">3651</a><a class="anker" href="#line3652">3652</a><a class="anker" href="#line3653">3653</a><a class="anker" href="#line3654">3654</a><a class="anker" href="#line3655">3655</a><a class="anker" href="#line3656">3656</a><a class="anker" href="#line3657">3657</a><a class="anker" href="#line3658">3658</a><a class="anker" href="#line3659">3659</a><a class="anker" href="#line3660">3660</a><a class="anker" href="#line3661">3661</a><a class="anker" href="#line3662">3662</a><a class="anker" href="#line3663">3663</a><a class="anker" href="#line3664">3664</a><a class="anker" href="#line3665">3665</a><a class="anker" href="#line3666">3666</a><a class="anker" href="#line3667">3667</a><a class="anker" href="#line3668">3668</a><a class="anker" href="#line3669">3669</a><a class="anker" href="#line3670">3670</a><a class="anker" href="#line3671">3671</a><a class="anker" href="#line3672">3672</a><a class="anker" href="#line3673">3673</a><a class="anker" href="#line3674">3674</a><a class="anker" href="#line3675">3675</a><a class="anker" href="#line3676">3676</a><a class="anker" href="#line3677">3677</a><a class="anker" href="#line3678">3678</a><a class="anker" href="#line3679">3679</a><a class="anker" href="#line3680">3680</a><a class="anker" href="#line3681">3681</a><a class="anker" href="#line3682">3682</a><a class="anker" href="#line3683">3683</a><a class="anker" href="#line3684">3684</a><a class="anker" href="#line3685">3685</a><a class="anker" href="#line3686">3686</a><a class="anker" href="#line3687">3687</a><a class="anker" href="#line3688">3688</a><a class="anker" href="#line3689">3689</a><a class="anker" href="#line3690">3690</a><a class="anker" href="#line3691">3691</a><a class="anker" href="#line3692">3692</a><a class="anker" href="#line3693">3693</a><a class="anker" href="#line3694">3694</a><a class="anker" href="#line3695">3695</a><a class="anker" href="#line3696">3696</a><a class="anker" href="#line3697">3697</a><a class="anker" href="#line3698">3698</a><a class="anker" href="#line3699">3699</a><a class="anker" href="#line3700">3700</a><a class="anker" href="#line3701">3701</a><a class="anker" href="#line3702">3702</a><a class="anker" href="#line3703">3703</a><a class="anker" href="#line3704">3704</a><a class="anker" href="#line3705">3705</a><a class="anker" href="#line3706">3706</a><a class="anker" href="#line3707">3707</a><a class="anker" href="#line3708">3708</a><a class="anker" href="#line3709">3709</a><a class="anker" href="#line3710">3710</a><a class="anker" href="#line3711">3711</a><a class="anker" href="#line3712">3712</a><a class="anker" href="#line3713">3713</a><a class="anker" href="#line3714">3714</a><a class="anker" href="#line3715">3715</a><a class="anker" href="#line3716">3716</a><a class="anker" href="#line3717">3717</a><a class="anker" href="#line3718">3718</a><a class="anker" href="#line3719">3719</a><a class="anker" href="#line3720">3720</a><a class="anker" href="#line3721">3721</a><a class="anker" href="#line3722">3722</a><a class="anker" href="#line3723">3723</a><a class="anker" href="#line3724">3724</a><a class="anker" href="#line3725">3725</a><a class="anker" href="#line3726">3726</a><a class="anker" href="#line3727">3727</a><a class="anker" href="#line3728">3728</a><a class="anker" href="#line3729">3729</a><a class="anker" href="#line3730">3730</a><a class="anker" href="#line3731">3731</a><a class="anker" href="#line3732">3732</a><a class="anker" href="#line3733">3733</a><a class="anker" href="#line3734">3734</a><a class="anker" href="#line3735">3735</a><a class="anker" href="#line3736">3736</a><a class="anker" href="#line3737">3737</a><a class="anker" href="#line3738">3738</a><a class="anker" href="#line3739">3739</a><a class="anker" href="#line3740">3740</a><a class="anker" href="#line3741">3741</a><a class="anker" href="#line3742">3742</a><a class="anker" href="#line3743">3743</a><a class="anker" href="#line3744">3744</a><a class="anker" href="#line3745">3745</a><a class="anker" href="#line3746">3746</a><a class="anker" href="#line3747">3747</a><a class="anker" href="#line3748">3748</a><a class="anker" href="#line3749">3749</a><a class="anker" href="#line3750">3750</a><a class="anker" href="#line3751">3751</a><a class="anker" href="#line3752">3752</a><a class="anker" href="#line3753">3753</a><a class="anker" href="#line3754">3754</a><a class="anker" href="#line3755">3755</a><a class="anker" href="#line3756">3756</a><a class="anker" href="#line3757">3757</a><a class="anker" href="#line3758">3758</a><a class="anker" href="#line3759">3759</a><a class="anker" href="#line3760">3760</a><a class="anker" href="#line3761">3761</a><a class="anker" href="#line3762">3762</a><a class="anker" href="#line3763">3763</a><a class="anker" href="#line3764">3764</a><a class="anker" href="#line3765">3765</a><a class="anker" href="#line3766">3766</a><a class="anker" href="#line3767">3767</a><a class="anker" href="#line3768">3768</a><a class="anker" href="#line3769">3769</a><a class="anker" href="#line3770">3770</a><a class="anker" href="#line3771">3771</a><a class="anker" href="#line3772">3772</a><a class="anker" href="#line3773">3773</a><a class="anker" href="#line3774">3774</a><a class="anker" href="#line3775">3775</a><a class="anker" href="#line3776">3776</a><a class="anker" href="#line3777">3777</a><a class="anker" href="#line3778">3778</a><a class="anker" href="#line3779">3779</a><a class="anker" href="#line3780">3780</a><a class="anker" href="#line3781">3781</a><a class="anker" href="#line3782">3782</a><a class="anker" href="#line3783">3783</a><a class="anker" href="#line3784">3784</a><a class="anker" href="#line3785">3785</a><a class="anker" href="#line3786">3786</a><a class="anker" href="#line3787">3787</a><a class="anker" href="#line3788">3788</a><a class="anker" href="#line3789">3789</a><a class="anker" href="#line3790">3790</a><a class="anker" href="#line3791">3791</a><a class="anker" href="#line3792">3792</a><a class="anker" href="#line3793">3793</a><a class="anker" href="#line3794">3794</a><a class="anker" href="#line3795">3795</a><a class="anker" href="#line3796">3796</a><a class="anker" href="#line3797">3797</a><a class="anker" href="#line3798">3798</a><a class="anker" href="#line3799">3799</a><a class="anker" href="#line3800">3800</a><a class="anker" href="#line3801">3801</a><a class="anker" href="#line3802">3802</a><a class="anker" href="#line3803">3803</a><a class="anker" href="#line3804">3804</a><a class="anker" href="#line3805">3805</a><a class="anker" href="#line3806">3806</a><a class="anker" href="#line3807">3807</a><a class="anker" href="#line3808">3808</a><a class="anker" href="#line3809">3809</a><a class="anker" href="#line3810">3810</a><a class="anker" href="#line3811">3811</a><a class="anker" href="#line3812">3812</a><a class="anker" href="#line3813">3813</a><a class="anker" href="#line3814">3814</a><a class="anker" href="#line3815">3815</a><a class="anker" href="#line3816">3816</a><a class="anker" href="#line3817">3817</a><a class="anker" href="#line3818">3818</a><a class="anker" href="#line3819">3819</a><a class="anker" href="#line3820">3820</a><a class="anker" href="#line3821">3821</a><a class="anker" href="#line3822">3822</a><a class="anker" href="#line3823">3823</a><a class="anker" href="#line3824">3824</a><a class="anker" href="#line3825">3825</a><a class="anker" href="#line3826">3826</a><a class="anker" href="#line3827">3827</a><a class="anker" href="#line3828">3828</a><a class="anker" href="#line3829">3829</a><a class="anker" href="#line3830">3830</a><a class="anker" href="#line3831">3831</a><a class="anker" href="#line3832">3832</a><a class="anker" href="#line3833">3833</a><a class="anker" href="#line3834">3834</a><a class="anker" href="#line3835">3835</a><a class="anker" href="#line3836">3836</a><a class="anker" href="#line3837">3837</a><a class="anker" href="#line3838">3838</a><a class="anker" href="#line3839">3839</a><a class="anker" href="#line3840">3840</a><a class="anker" href="#line3841">3841</a><a class="anker" href="#line3842">3842</a><a class="anker" href="#line3843">3843</a><a class="anker" href="#line3844">3844</a><a class="anker" href="#line3845">3845</a><a class="anker" href="#line3846">3846</a><a class="anker" href="#line3847">3847</a><a class="anker" href="#line3848">3848</a><a class="anker" href="#line3849">3849</a><a class="anker" href="#line3850">3850</a><a class="anker" href="#line3851">3851</a><a class="anker" href="#line3852">3852</a><a class="anker" href="#line3853">3853</a><a class="anker" href="#line3854">3854</a><a class="anker" href="#line3855">3855</a><a class="anker" href="#line3856">3856</a><a class="anker" href="#line3857">3857</a><a class="anker" href="#line3858">3858</a><a class="anker" href="#line3859">3859</a><a class="anker" href="#line3860">3860</a><a class="anker" href="#line3861">3861</a><a class="anker" href="#line3862">3862</a><a class="anker" href="#line3863">3863</a><a class="anker" href="#line3864">3864</a><a class="anker" href="#line3865">3865</a><a class="anker" href="#line3866">3866</a><a class="anker" href="#line3867">3867</a><a class="anker" href="#line3868">3868</a><a class="anker" href="#line3869">3869</a><a class="anker" href="#line3870">3870</a><a class="anker" href="#line3871">3871</a><a class="anker" href="#line3872">3872</a><a class="anker" href="#line3873">3873</a><a class="anker" href="#line3874">3874</a><a class="anker" href="#line3875">3875</a><a class="anker" href="#line3876">3876</a><a class="anker" href="#line3877">3877</a><a class="anker" href="#line3878">3878</a><a class="anker" href="#line3879">3879</a><a class="anker" href="#line3880">3880</a><a class="anker" href="#line3881">3881</a><a class="anker" href="#line3882">3882</a><a class="anker" href="#line3883">3883</a><a class="anker" href="#line3884">3884</a><a class="anker" href="#line3885">3885</a><a class="anker" href="#line3886">3886</a><a class="anker" href="#line3887">3887</a><a class="anker" href="#line3888">3888</a><a class="anker" href="#line3889">3889</a><a class="anker" href="#line3890">3890</a><a class="anker" href="#line3891">3891</a><a class="anker" href="#line3892">3892</a><a class="anker" href="#line3893">3893</a><a class="anker" href="#line3894">3894</a><a class="anker" href="#line3895">3895</a><a class="anker" href="#line3896">3896</a><a class="anker" href="#line3897">3897</a><a class="anker" href="#line3898">3898</a><a class="anker" href="#line3899">3899</a><a class="anker" href="#line3900">3900</a><a class="anker" href="#line3901">3901</a><a class="anker" href="#line3902">3902</a><a class="anker" href="#line3903">3903</a><a class="anker" href="#line3904">3904</a><a class="anker" href="#line3905">3905</a><a class="anker" href="#line3906">3906</a><a class="anker" href="#line3907">3907</a><a class="anker" href="#line3908">3908</a><a class="anker" href="#line3909">3909</a><a class="anker" href="#line3910">3910</a><a class="anker" href="#line3911">3911</a><a class="anker" href="#line3912">3912</a><a class="anker" href="#line3913">3913</a><a class="anker" href="#line3914">3914</a><a class="anker" href="#line3915">3915</a><a class="anker" href="#line3916">3916</a><a class="anker" href="#line3917">3917</a><a class="anker" href="#line3918">3918</a><a class="anker" href="#line3919">3919</a><a class="anker" href="#line3920">3920</a><a class="anker" href="#line3921">3921</a><a class="anker" href="#line3922">3922</a><a class="anker" href="#line3923">3923</a><a class="anker" href="#line3924">3924</a><a class="anker" href="#line3925">3925</a><a class="anker" href="#line3926">3926</a><a class="anker" href="#line3927">3927</a><a class="anker" href="#line3928">3928</a><a class="anker" href="#line3929">3929</a><a class="anker" href="#line3930">3930</a><a class="anker" href="#line3931">3931</a><a class="anker" href="#line3932">3932</a><a class="anker" href="#line3933">3933</a><a class="anker" href="#line3934">3934</a><a class="anker" href="#line3935">3935</a><a class="anker" href="#line3936">3936</a><a class="anker" href="#line3937">3937</a><a class="anker" href="#line3938">3938</a><a class="anker" href="#line3939">3939</a><a class="anker" href="#line3940">3940</a><a class="anker" href="#line3941">3941</a><a class="anker" href="#line3942">3942</a><a class="anker" href="#line3943">3943</a><a class="anker" href="#line3944">3944</a><a class="anker" href="#line3945">3945</a><a class="anker" href="#line3946">3946</a><a class="anker" href="#line3947">3947</a><a class="anker" href="#line3948">3948</a><a class="anker" href="#line3949">3949</a><a class="anker" href="#line3950">3950</a><a class="anker" href="#line3951">3951</a><a class="anker" href="#line3952">3952</a><a class="anker" href="#line3953">3953</a><a class="anker" href="#line3954">3954</a><a class="anker" href="#line3955">3955</a><a class="anker" href="#line3956">3956</a><a class="anker" href="#line3957">3957</a><a class="anker" href="#line3958">3958</a><a class="anker" href="#line3959">3959</a><a class="anker" href="#line3960">3960</a><a class="anker" href="#line3961">3961</a><a class="anker" href="#line3962">3962</a><a class="anker" href="#line3963">3963</a><a class="anker" href="#line3964">3964</a><a class="anker" href="#line3965">3965</a><a class="anker" href="#line3966">3966</a><a class="anker" href="#line3967">3967</a><a class="anker" href="#line3968">3968</a><a class="anker" href="#line3969">3969</a><a class="anker" href="#line3970">3970</a><a class="anker" href="#line3971">3971</a><a class="anker" href="#line3972">3972</a><a class="anker" href="#line3973">3973</a><a class="anker" href="#line3974">3974</a><a class="anker" href="#line3975">3975</a><a class="anker" href="#line3976">3976</a><a class="anker" href="#line3977">3977</a><a class="anker" href="#line3978">3978</a><a class="anker" href="#line3979">3979</a><a class="anker" href="#line3980">3980</a><a class="anker" href="#line3981">3981</a><a class="anker" href="#line3982">3982</a><a class="anker" href="#line3983">3983</a><a class="anker" href="#line3984">3984</a><a class="anker" href="#line3985">3985</a><a class="anker" href="#line3986">3986</a><a class="anker" href="#line3987">3987</a><a class="anker" href="#line3988">3988</a><a class="anker" href="#line3989">3989</a><a class="anker" href="#line3990">3990</a><a class="anker" href="#line3991">3991</a><a class="anker" href="#line3992">3992</a><a class="anker" href="#line3993">3993</a><a class="anker" href="#line3994">3994</a><a class="anker" href="#line3995">3995</a><a class="anker" href="#line3996">3996</a><a class="anker" href="#line3997">3997</a><a class="anker" href="#line3998">3998</a><a class="anker" href="#line3999">3999</a><a class="anker" href="#line4000">4000</a><a class="anker" href="#line4001">4001</a><a class="anker" href="#line4002">4002</a><a class="anker" href="#line4003">4003</a><a class="anker" href="#line4004">4004</a><a class="anker" href="#line4005">4005</a><a class="anker" href="#line4006">4006</a><a class="anker" href="#line4007">4007</a><a class="anker" href="#line4008">4008</a><a class="anker" href="#line4009">4009</a><a class="anker" href="#line4010">4010</a><a class="anker" href="#line4011">4011</a><a class="anker" href="#line4012">4012</a><a class="anker" href="#line4013">4013</a><a class="anker" href="#line4014">4014</a><a class="anker" href="#line4015">4015</a><a class="anker" href="#line4016">4016</a><a class="anker" href="#line4017">4017</a><a class="anker" href="#line4018">4018</a><a class="anker" href="#line4019">4019</a><a class="anker" href="#line4020">4020</a><a class="anker" href="#line4021">4021</a><a class="anker" href="#line4022">4022</a><a class="anker" href="#line4023">4023</a><a class="anker" href="#line4024">4024</a><a class="anker" href="#line4025">4025</a><a class="anker" href="#line4026">4026</a><a class="anker" href="#line4027">4027</a><a class="anker" href="#line4028">4028</a><a class="anker" href="#line4029">4029</a><a class="anker" href="#line4030">4030</a><a class="anker" href="#line4031">4031</a><a class="anker" href="#line4032">4032</a><a class="anker" href="#line4033">4033</a><a class="anker" href="#line4034">4034</a><a class="anker" href="#line4035">4035</a><a class="anker" href="#line4036">4036</a><a class="anker" href="#line4037">4037</a><a class="anker" href="#line4038">4038</a><a class="anker" href="#line4039">4039</a><a class="anker" href="#line4040">4040</a><a class="anker" href="#line4041">4041</a><a class="anker" href="#line4042">4042</a><a class="anker" href="#line4043">4043</a><a class="anker" href="#line4044">4044</a><a class="anker" href="#line4045">4045</a><a class="anker" href="#line4046">4046</a><a class="anker" href="#line4047">4047</a><a class="anker" href="#line4048">4048</a><a class="anker" href="#line4049">4049</a><a class="anker" href="#line4050">4050</a><a class="anker" href="#line4051">4051</a><a class="anker" href="#line4052">4052</a><a class="anker" href="#line4053">4053</a><a class="anker" href="#line4054">4054</a><a class="anker" href="#line4055">4055</a><a class="anker" href="#line4056">4056</a><a class="anker" href="#line4057">4057</a><a class="anker" href="#line4058">4058</a><a class="anker" href="#line4059">4059</a><a class="anker" href="#line4060">4060</a><a class="anker" href="#line4061">4061</a><a class="anker" href="#line4062">4062</a><a class="anker" href="#line4063">4063</a><a class="anker" href="#line4064">4064</a><a class="anker" href="#line4065">4065</a><a class="anker" href="#line4066">4066</a><a class="anker" href="#line4067">4067</a><a class="anker" href="#line4068">4068</a><a class="anker" href="#line4069">4069</a><a class="anker" href="#line4070">4070</a><a class="anker" href="#line4071">4071</a><a class="anker" href="#line4072">4072</a><a class="anker" href="#line4073">4073</a><a class="anker" href="#line4074">4074</a><a class="anker" href="#line4075">4075</a><a class="anker" href="#line4076">4076</a><a class="anker" href="#line4077">4077</a><a class="anker" href="#line4078">4078</a><a class="anker" href="#line4079">4079</a><a class="anker" href="#line4080">4080</a><a class="anker" href="#line4081">4081</a><a class="anker" href="#line4082">4082</a><a class="anker" href="#line4083">4083</a><a class="anker" href="#line4084">4084</a><a class="anker" href="#line4085">4085</a><a class="anker" href="#line4086">4086</a><a class="anker" href="#line4087">4087</a><a class="anker" href="#line4088">4088</a><a class="anker" href="#line4089">4089</a><a class="anker" href="#line4090">4090</a><a class="anker" href="#line4091">4091</a><a class="anker" href="#line4092">4092</a><a class="anker" href="#line4093">4093</a><a class="anker" href="#line4094">4094</a><a class="anker" href="#line4095">4095</a><a class="anker" href="#line4096">4096</a><a class="anker" href="#line4097">4097</a><a class="anker" href="#line4098">4098</a><a class="anker" href="#line4099">4099</a><a class="anker" href="#line4100">4100</a><a class="anker" href="#line4101">4101</a><a class="anker" href="#line4102">4102</a><a class="anker" href="#line4103">4103</a><a class="anker" href="#line4104">4104</a><a class="anker" href="#line4105">4105</a><a class="anker" href="#line4106">4106</a><a class="anker" href="#line4107">4107</a><a class="anker" href="#line4108">4108</a><a class="anker" href="#line4109">4109</a><a class="anker" href="#line4110">4110</a><a class="anker" href="#line4111">4111</a><a class="anker" href="#line4112">4112</a><a class="anker" href="#line4113">4113</a><a class="anker" href="#line4114">4114</a><a class="anker" href="#line4115">4115</a><a class="anker" href="#line4116">4116</a><a class="anker" href="#line4117">4117</a><a class="anker" href="#line4118">4118</a><a class="anker" href="#line4119">4119</a><a class="anker" href="#line4120">4120</a><a class="anker" href="#line4121">4121</a><a class="anker" href="#line4122">4122</a><a class="anker" href="#line4123">4123</a><a class="anker" href="#line4124">4124</a><a class="anker" href="#line4125">4125</a><a class="anker" href="#line4126">4126</a><a class="anker" href="#line4127">4127</a><a class="anker" href="#line4128">4128</a><a class="anker" href="#line4129">4129</a><a class="anker" href="#line4130">4130</a><a class="anker" href="#line4131">4131</a><a class="anker" href="#line4132">4132</a><a class="anker" href="#line4133">4133</a><a class="anker" href="#line4134">4134</a><a class="anker" href="#line4135">4135</a><a class="anker" href="#line4136">4136</a><a class="anker" href="#line4137">4137</a><a class="anker" href="#line4138">4138</a><a class="anker" href="#line4139">4139</a><a class="anker" href="#line4140">4140</a><a class="anker" href="#line4141">4141</a><a class="anker" href="#line4142">4142</a><a class="anker" href="#line4143">4143</a><a class="anker" href="#line4144">4144</a><a class="anker" href="#line4145">4145</a><a class="anker" href="#line4146">4146</a><a class="anker" href="#line4147">4147</a><a class="anker" href="#line4148">4148</a><a class="anker" href="#line4149">4149</a><a class="anker" href="#line4150">4150</a><a class="anker" href="#line4151">4151</a><a class="anker" href="#line4152">4152</a><a class="anker" href="#line4153">4153</a><a class="anker" href="#line4154">4154</a><a class="anker" href="#line4155">4155</a><a class="anker" href="#line4156">4156</a><a class="anker" href="#line4157">4157</a><a class="anker" href="#line4158">4158</a><a class="anker" href="#line4159">4159</a><a class="anker" href="#line4160">4160</a><a class="anker" href="#line4161">4161</a><a class="anker" href="#line4162">4162</a><a class="anker" href="#line4163">4163</a><a class="anker" href="#line4164">4164</a><a class="anker" href="#line4165">4165</a><a class="anker" href="#line4166">4166</a><a class="anker" href="#line4167">4167</a><a class="anker" href="#line4168">4168</a><a class="anker" href="#line4169">4169</a><a class="anker" href="#line4170">4170</a><a class="anker" href="#line4171">4171</a><a class="anker" href="#line4172">4172</a><a class="anker" href="#line4173">4173</a><a class="anker" href="#line4174">4174</a><a class="anker" href="#line4175">4175</a><a class="anker" href="#line4176">4176</a><a class="anker" href="#line4177">4177</a><a class="anker" href="#line4178">4178</a><a class="anker" href="#line4179">4179</a><a class="anker" href="#line4180">4180</a><a class="anker" href="#line4181">4181</a><a class="anker" href="#line4182">4182</a><a class="anker" href="#line4183">4183</a><a class="anker" href="#line4184">4184</a><a class="anker" href="#line4185">4185</a><a class="anker" href="#line4186">4186</a><a class="anker" href="#line4187">4187</a><a class="anker" href="#line4188">4188</a><a class="anker" href="#line4189">4189</a><a class="anker" href="#line4190">4190</a><a class="anker" href="#line4191">4191</a><a class="anker" href="#line4192">4192</a><a class="anker" href="#line4193">4193</a><a class="anker" href="#line4194">4194</a><a class="anker" href="#line4195">4195</a><a class="anker" href="#line4196">4196</a><a class="anker" href="#line4197">4197</a><a class="anker" href="#line4198">4198</a><a class="anker" href="#line4199">4199</a><a class="anker" href="#line4200">4200</a><a class="anker" href="#line4201">4201</a><a class="anker" href="#line4202">4202</a><a class="anker" href="#line4203">4203</a><a class="anker" href="#line4204">4204</a><a class="anker" href="#line4205">4205</a><a class="anker" href="#line4206">4206</a><a class="anker" href="#line4207">4207</a><a class="anker" href="#line4208">4208</a><a class="anker" href="#line4209">4209</a><a class="anker" href="#line4210">4210</a><a class="anker" href="#line4211">4211</a><a class="anker" href="#line4212">4212</a><a class="anker" href="#line4213">4213</a><a class="anker" href="#line4214">4214</a><a class="anker" href="#line4215">4215</a><a class="anker" href="#line4216">4216</a><a class="anker" href="#line4217">4217</a><a class="anker" href="#line4218">4218</a><a class="anker" href="#line4219">4219</a><a class="anker" href="#line4220">4220</a><a class="anker" href="#line4221">4221</a><a class="anker" href="#line4222">4222</a><a class="anker" href="#line4223">4223</a><a class="anker" href="#line4224">4224</a><a class="anker" href="#line4225">4225</a><a class="anker" href="#line4226">4226</a><a class="anker" href="#line4227">4227</a><a class="anker" href="#line4228">4228</a><a class="anker" href="#line4229">4229</a><a class="anker" href="#line4230">4230</a><a class="anker" href="#line4231">4231</a><a class="anker" href="#line4232">4232</a><a class="anker" href="#line4233">4233</a><a class="anker" href="#line4234">4234</a><a class="anker" href="#line4235">4235</a><a class="anker" href="#line4236">4236</a><a class="anker" href="#line4237">4237</a><a class="anker" href="#line4238">4238</a><a class="anker" href="#line4239">4239</a><a class="anker" href="#line4240">4240</a><a class="anker" href="#line4241">4241</a><a class="anker" href="#line4242">4242</a><a class="anker" href="#line4243">4243</a><a class="anker" href="#line4244">4244</a><a class="anker" href="#line4245">4245</a><a class="anker" href="#line4246">4246</a><a class="anker" href="#line4247">4247</a><a class="anker" href="#line4248">4248</a><a class="anker" href="#line4249">4249</a><a class="anker" href="#line4250">4250</a><a class="anker" href="#line4251">4251</a><a class="anker" href="#line4252">4252</a><a class="anker" href="#line4253">4253</a><a class="anker" href="#line4254">4254</a><a class="anker" href="#line4255">4255</a><a class="anker" href="#line4256">4256</a><a class="anker" href="#line4257">4257</a><a class="anker" href="#line4258">4258</a><a class="anker" href="#line4259">4259</a><a class="anker" href="#line4260">4260</a><a class="anker" href="#line4261">4261</a><a class="anker" href="#line4262">4262</a><a class="anker" href="#line4263">4263</a><a class="anker" href="#line4264">4264</a><a class="anker" href="#line4265">4265</a><a class="anker" href="#line4266">4266</a><a class="anker" href="#line4267">4267</a><a class="anker" href="#line4268">4268</a><a class="anker" href="#line4269">4269</a><a class="anker" href="#line4270">4270</a><a class="anker" href="#line4271">4271</a><a class="anker" href="#line4272">4272</a><a class="anker" href="#line4273">4273</a><a class="anker" href="#line4274">4274</a><a class="anker" href="#line4275">4275</a><a class="anker" href="#line4276">4276</a><a class="anker" href="#line4277">4277</a><a class="anker" href="#line4278">4278</a><a class="anker" href="#line4279">4279</a><a class="anker" href="#line4280">4280</a><a class="anker" href="#line4281">4281</a><a class="anker" href="#line4282">4282</a><a class="anker" href="#line4283">4283</a><a class="anker" href="#line4284">4284</a><a class="anker" href="#line4285">4285</a><a class="anker" href="#line4286">4286</a><a class="anker" href="#line4287">4287</a><a class="anker" href="#line4288">4288</a><a class="anker" href="#line4289">4289</a><a class="anker" href="#line4290">4290</a><a class="anker" href="#line4291">4291</a><a class="anker" href="#line4292">4292</a><a class="anker" href="#line4293">4293</a><a class="anker" href="#line4294">4294</a><a class="anker" href="#line4295">4295</a><a class="anker" href="#line4296">4296</a><a class="anker" href="#line4297">4297</a><a class="anker" href="#line4298">4298</a><a class="anker" href="#line4299">4299</a><a class="anker" href="#line4300">4300</a><a class="anker" href="#line4301">4301</a><a class="anker" href="#line4302">4302</a><a class="anker" href="#line4303">4303</a><a class="anker" href="#line4304">4304</a><a class="anker" href="#line4305">4305</a><a class="anker" href="#line4306">4306</a><a class="anker" href="#line4307">4307</a><a class="anker" href="#line4308">4308</a><a class="anker" href="#line4309">4309</a><a class="anker" href="#line4310">4310</a><a class="anker" href="#line4311">4311</a><a class="anker" href="#line4312">4312</a><a class="anker" href="#line4313">4313</a><a class="anker" href="#line4314">4314</a><a class="anker" href="#line4315">4315</a><a class="anker" href="#line4316">4316</a><a class="anker" href="#line4317">4317</a><a class="anker" href="#line4318">4318</a><a class="anker" href="#line4319">4319</a><a class="anker" href="#line4320">4320</a><a class="anker" href="#line4321">4321</a><a class="anker" href="#line4322">4322</a><a class="anker" href="#line4323">4323</a><a class="anker" href="#line4324">4324</a><a class="anker" href="#line4325">4325</a><a class="anker" href="#line4326">4326</a><a class="anker" href="#line4327">4327</a><a class="anker" href="#line4328">4328</a><a class="anker" href="#line4329">4329</a><a class="anker" href="#line4330">4330</a><a class="anker" href="#line4331">4331</a><a class="anker" href="#line4332">4332</a><a class="anker" href="#line4333">4333</a><a class="anker" href="#line4334">4334</a><a class="anker" href="#line4335">4335</a><a class="anker" href="#line4336">4336</a><a class="anker" href="#line4337">4337</a><a class="anker" href="#line4338">4338</a><a class="anker" href="#line4339">4339</a><a class="anker" href="#line4340">4340</a><a class="anker" href="#line4341">4341</a><a class="anker" href="#line4342">4342</a><a class="anker" href="#line4343">4343</a><a class="anker" href="#line4344">4344</a><a class="anker" href="#line4345">4345</a><a class="anker" href="#line4346">4346</a><a class="anker" href="#line4347">4347</a><a class="anker" href="#line4348">4348</a><a class="anker" href="#line4349">4349</a><a class="anker" href="#line4350">4350</a><a class="anker" href="#line4351">4351</a><a class="anker" href="#line4352">4352</a><a class="anker" href="#line4353">4353</a><a class="anker" href="#line4354">4354</a><a class="anker" href="#line4355">4355</a><a class="anker" href="#line4356">4356</a><a class="anker" href="#line4357">4357</a><a class="anker" href="#line4358">4358</a><a class="anker" href="#line4359">4359</a><a class="anker" href="#line4360">4360</a><a class="anker" href="#line4361">4361</a><a class="anker" href="#line4362">4362</a><a class="anker" href="#line4363">4363</a><a class="anker" href="#line4364">4364</a><a class="anker" href="#line4365">4365</a><a class="anker" href="#line4366">4366</a><a class="anker" href="#line4367">4367</a><a class="anker" href="#line4368">4368</a><a class="anker" href="#line4369">4369</a><a class="anker" href="#line4370">4370</a><a class="anker" href="#line4371">4371</a><a class="anker" href="#line4372">4372</a><a class="anker" href="#line4373">4373</a><a class="anker" href="#line4374">4374</a><a class="anker" href="#line4375">4375</a><a class="anker" href="#line4376">4376</a><a class="anker" href="#line4377">4377</a><a class="anker" href="#line4378">4378</a><a class="anker" href="#line4379">4379</a><a class="anker" href="#line4380">4380</a><a class="anker" href="#line4381">4381</a><a class="anker" href="#line4382">4382</a><a class="anker" href="#line4383">4383</a><a class="anker" href="#line4384">4384</a><a class="anker" href="#line4385">4385</a><a class="anker" href="#line4386">4386</a><a class="anker" href="#line4387">4387</a><a class="anker" href="#line4388">4388</a><a class="anker" href="#line4389">4389</a><a class="anker" href="#line4390">4390</a><a class="anker" href="#line4391">4391</a><a class="anker" href="#line4392">4392</a><a class="anker" href="#line4393">4393</a><a class="anker" href="#line4394">4394</a><a class="anker" href="#line4395">4395</a><a class="anker" href="#line4396">4396</a><a class="anker" href="#line4397">4397</a><a class="anker" href="#line4398">4398</a><a class="anker" href="#line4399">4399</a><a class="anker" href="#line4400">4400</a><a class="anker" href="#line4401">4401</a><a class="anker" href="#line4402">4402</a><a class="anker" href="#line4403">4403</a><a class="anker" href="#line4404">4404</a><a class="anker" href="#line4405">4405</a><a class="anker" href="#line4406">4406</a><a class="anker" href="#line4407">4407</a><a class="anker" href="#line4408">4408</a><a class="anker" href="#line4409">4409</a><a class="anker" href="#line4410">4410</a><a class="anker" href="#line4411">4411</a><a class="anker" href="#line4412">4412</a><a class="anker" href="#line4413">4413</a><a class="anker" href="#line4414">4414</a><a class="anker" href="#line4415">4415</a><a class="anker" href="#line4416">4416</a><a class="anker" href="#line4417">4417</a><a class="anker" href="#line4418">4418</a><a class="anker" href="#line4419">4419</a><a class="anker" href="#line4420">4420</a><a class="anker" href="#line4421">4421</a><a class="anker" href="#line4422">4422</a><a class="anker" href="#line4423">4423</a><a class="anker" href="#line4424">4424</a><a class="anker" href="#line4425">4425</a><a class="anker" href="#line4426">4426</a><a class="anker" href="#line4427">4427</a><a class="anker" href="#line4428">4428</a><a class="anker" href="#line4429">4429</a><a class="anker" href="#line4430">4430</a><a class="anker" href="#line4431">4431</a><a class="anker" href="#line4432">4432</a><a class="anker" href="#line4433">4433</a><a class="anker" href="#line4434">4434</a><a class="anker" href="#line4435">4435</a><a class="anker" href="#line4436">4436</a><a class="anker" href="#line4437">4437</a><a class="anker" href="#line4438">4438</a><a class="anker" href="#line4439">4439</a><a class="anker" href="#line4440">4440</a><a class="anker" href="#line4441">4441</a><a class="anker" href="#line4442">4442</a><a class="anker" href="#line4443">4443</a><a class="anker" href="#line4444">4444</a><a class="anker" href="#line4445">4445</a><a class="anker" href="#line4446">4446</a><a class="anker" href="#line4447">4447</a><a class="anker" href="#line4448">4448</a><a class="anker" href="#line4449">4449</a><a class="anker" href="#line4450">4450</a><a class="anker" href="#line4451">4451</a><a class="anker" href="#line4452">4452</a><a class="anker" href="#line4453">4453</a><a class="anker" href="#line4454">4454</a><a class="anker" href="#line4455">4455</a><a class="anker" href="#line4456">4456</a><a class="anker" href="#line4457">4457</a><a class="anker" href="#line4458">4458</a><a class="anker" href="#line4459">4459</a><a class="anker" href="#line4460">4460</a><a class="anker" href="#line4461">4461</a><a class="anker" href="#line4462">4462</a><a class="anker" href="#line4463">4463</a><a class="anker" href="#line4464">4464</a><a class="anker" href="#line4465">4465</a><a class="anker" href="#line4466">4466</a><a class="anker" href="#line4467">4467</a><a class="anker" href="#line4468">4468</a><a class="anker" href="#line4469">4469</a><a class="anker" href="#line4470">4470</a><a class="anker" href="#line4471">4471</a><a class="anker" href="#line4472">4472</a><a class="anker" href="#line4473">4473</a><a class="anker" href="#line4474">4474</a><a class="anker" href="#line4475">4475</a><a class="anker" href="#line4476">4476</a><a class="anker" href="#line4477">4477</a><a class="anker" href="#line4478">4478</a><a class="anker" href="#line4479">4479</a><a class="anker" href="#line4480">4480</a><a class="anker" href="#line4481">4481</a><a class="anker" href="#line4482">4482</a><a class="anker" href="#line4483">4483</a><a class="anker" href="#line4484">4484</a><a class="anker" href="#line4485">4485</a><a class="anker" href="#line4486">4486</a><a class="anker" href="#line4487">4487</a><a class="anker" href="#line4488">4488</a><a class="anker" href="#line4489">4489</a><a class="anker" href="#line4490">4490</a><a class="anker" href="#line4491">4491</a><a class="anker" href="#line4492">4492</a><a class="anker" href="#line4493">4493</a><a class="anker" href="#line4494">4494</a><a class="anker" href="#line4495">4495</a><a class="anker" href="#line4496">4496</a><a class="anker" href="#line4497">4497</a><a class="anker" href="#line4498">4498</a><a class="anker" href="#line4499">4499</a><a class="anker" href="#line4500">4500</a><a class="anker" href="#line4501">4501</a><a class="anker" href="#line4502">4502</a><a class="anker" href="#line4503">4503</a><a class="anker" href="#line4504">4504</a><a class="anker" href="#line4505">4505</a><a class="anker" href="#line4506">4506</a><a class="anker" href="#line4507">4507</a><a class="anker" href="#line4508">4508</a><a class="anker" href="#line4509">4509</a><a class="anker" href="#line4510">4510</a><a class="anker" href="#line4511">4511</a><a class="anker" href="#line4512">4512</a><a class="anker" href="#line4513">4513</a><a class="anker" href="#line4514">4514</a><a class="anker" href="#line4515">4515</a><a class="anker" href="#line4516">4516</a><a class="anker" href="#line4517">4517</a><a class="anker" href="#line4518">4518</a><a class="anker" href="#line4519">4519</a><a class="anker" href="#line4520">4520</a><a class="anker" href="#line4521">4521</a><a class="anker" href="#line4522">4522</a><a class="anker" href="#line4523">4523</a><a class="anker" href="#line4524">4524</a><a class="anker" href="#line4525">4525</a><a class="anker" href="#line4526">4526</a><a class="anker" href="#line4527">4527</a><a class="anker" href="#line4528">4528</a><a class="anker" href="#line4529">4529</a><a class="anker" href="#line4530">4530</a><a class="anker" href="#line4531">4531</a><a class="anker" href="#line4532">4532</a><a class="anker" href="#line4533">4533</a><a class="anker" href="#line4534">4534</a><a class="anker" href="#line4535">4535</a><a class="anker" href="#line4536">4536</a><a class="anker" href="#line4537">4537</a><a class="anker" href="#line4538">4538</a><a class="anker" href="#line4539">4539</a><a class="anker" href="#line4540">4540</a><a class="anker" href="#line4541">4541</a><a class="anker" href="#line4542">4542</a><a class="anker" href="#line4543">4543</a><a class="anker" href="#line4544">4544</a><a class="anker" href="#line4545">4545</a><a class="anker" href="#line4546">4546</a><a class="anker" href="#line4547">4547</a><a class="anker" href="#line4548">4548</a><a class="anker" href="#line4549">4549</a><a class="anker" href="#line4550">4550</a><a class="anker" href="#line4551">4551</a><a class="anker" href="#line4552">4552</a><a class="anker" href="#line4553">4553</a><a class="anker" href="#line4554">4554</a><a class="anker" href="#line4555">4555</a><a class="anker" href="#line4556">4556</a><a class="anker" href="#line4557">4557</a><a class="anker" href="#line4558">4558</a><a class="anker" href="#line4559">4559</a><a class="anker" href="#line4560">4560</a><a class="anker" href="#line4561">4561</a><a class="anker" href="#line4562">4562</a><a class="anker" href="#line4563">4563</a><a class="anker" href="#line4564">4564</a><a class="anker" href="#line4565">4565</a><a class="anker" href="#line4566">4566</a><a class="anker" href="#line4567">4567</a><a class="anker" href="#line4568">4568</a><a class="anker" href="#line4569">4569</a><a class="anker" href="#line4570">4570</a><a class="anker" href="#line4571">4571</a><a class="anker" href="#line4572">4572</a><a class="anker" href="#line4573">4573</a><a class="anker" href="#line4574">4574</a><a class="anker" href="#line4575">4575</a><a class="anker" href="#line4576">4576</a><a class="anker" href="#line4577">4577</a><a class="anker" href="#line4578">4578</a><a class="anker" href="#line4579">4579</a><a class="anker" href="#line4580">4580</a><a class="anker" href="#line4581">4581</a><a class="anker" href="#line4582">4582</a><a class="anker" href="#line4583">4583</a><a class="anker" href="#line4584">4584</a><a class="anker" href="#line4585">4585</a><a class="anker" href="#line4586">4586</a><a class="anker" href="#line4587">4587</a><a class="anker" href="#line4588">4588</a><a class="anker" href="#line4589">4589</a><a class="anker" href="#line4590">4590</a><a class="anker" href="#line4591">4591</a><a class="anker" href="#line4592">4592</a><a class="anker" href="#line4593">4593</a><a class="anker" href="#line4594">4594</a><a class="anker" href="#line4595">4595</a><a class="anker" href="#line4596">4596</a><a class="anker" href="#line4597">4597</a><a class="anker" href="#line4598">4598</a><a class="anker" href="#line4599">4599</a><a class="anker" href="#line4600">4600</a><a class="anker" href="#line4601">4601</a><a class="anker" href="#line4602">4602</a><a class="anker" href="#line4603">4603</a><a class="anker" href="#line4604">4604</a><a class="anker" href="#line4605">4605</a><a class="anker" href="#line4606">4606</a><a class="anker" href="#line4607">4607</a><a class="anker" href="#line4608">4608</a><a class="anker" href="#line4609">4609</a><a class="anker" href="#line4610">4610</a><a class="anker" href="#line4611">4611</a><a class="anker" href="#line4612">4612</a><a class="anker" href="#line4613">4613</a><a class="anker" href="#line4614">4614</a><a class="anker" href="#line4615">4615</a><a class="anker" href="#line4616">4616</a><a class="anker" href="#line4617">4617</a><a class="anker" href="#line4618">4618</a><a class="anker" href="#line4619">4619</a><a class="anker" href="#line4620">4620</a><a class="anker" href="#line4621">4621</a><a class="anker" href="#line4622">4622</a><a class="anker" href="#line4623">4623</a><a class="anker" href="#line4624">4624</a><a class="anker" href="#line4625">4625</a><a class="anker" href="#line4626">4626</a><a class="anker" href="#line4627">4627</a><a class="anker" href="#line4628">4628</a><a class="anker" href="#line4629">4629</a><a class="anker" href="#line4630">4630</a><a class="anker" href="#line4631">4631</a><a class="anker" href="#line4632">4632</a><a class="anker" href="#line4633">4633</a><a class="anker" href="#line4634">4634</a><a class="anker" href="#line4635">4635</a><a class="anker" href="#line4636">4636</a><a class="anker" href="#line4637">4637</a><a class="anker" href="#line4638">4638</a><a class="anker" href="#line4639">4639</a><a class="anker" href="#line4640">4640</a><a class="anker" href="#line4641">4641</a><a class="anker" href="#line4642">4642</a><a class="anker" href="#line4643">4643</a><a class="anker" href="#line4644">4644</a><a class="anker" href="#line4645">4645</a><a class="anker" href="#line4646">4646</a><a class="anker" href="#line4647">4647</a><a class="anker" href="#line4648">4648</a><a class="anker" href="#line4649">4649</a><a class="anker" href="#line4650">4650</a><a class="anker" href="#line4651">4651</a><a class="anker" href="#line4652">4652</a><a class="anker" href="#line4653">4653</a><a class="anker" href="#line4654">4654</a><a class="anker" href="#line4655">4655</a><a class="anker" href="#line4656">4656</a><a class="anker" href="#line4657">4657</a><a class="anker" href="#line4658">4658</a><a class="anker" href="#line4659">4659</a><a class="anker" href="#line4660">4660</a><a class="anker" href="#line4661">4661</a><a class="anker" href="#line4662">4662</a><a class="anker" href="#line4663">4663</a><a class="anker" href="#line4664">4664</a><a class="anker" href="#line4665">4665</a><a class="anker" href="#line4666">4666</a><a class="anker" href="#line4667">4667</a><a class="anker" href="#line4668">4668</a><a class="anker" href="#line4669">4669</a><a class="anker" href="#line4670">4670</a><a class="anker" href="#line4671">4671</a><a class="anker" href="#line4672">4672</a><a class="anker" href="#line4673">4673</a><a class="anker" href="#line4674">4674</a><a class="anker" href="#line4675">4675</a><a class="anker" href="#line4676">4676</a><a class="anker" href="#line4677">4677</a><a class="anker" href="#line4678">4678</a><a class="anker" href="#line4679">4679</a><a class="anker" href="#line4680">4680</a><a class="anker" href="#line4681">4681</a><a class="anker" href="#line4682">4682</a><a class="anker" href="#line4683">4683</a><a class="anker" href="#line4684">4684</a><a class="anker" href="#line4685">4685</a><a class="anker" href="#line4686">4686</a><a class="anker" href="#line4687">4687</a><a class="anker" href="#line4688">4688</a><a class="anker" href="#line4689">4689</a><a class="anker" href="#line4690">4690</a><a class="anker" href="#line4691">4691</a><a class="anker" href="#line4692">4692</a><a class="anker" href="#line4693">4693</a><a class="anker" href="#line4694">4694</a><a class="anker" href="#line4695">4695</a><a class="anker" href="#line4696">4696</a><a class="anker" href="#line4697">4697</a><a class="anker" href="#line4698">4698</a><a class="anker" href="#line4699">4699</a><a class="anker" href="#line4700">4700</a><a class="anker" href="#line4701">4701</a><a class="anker" href="#line4702">4702</a><a class="anker" href="#line4703">4703</a><a class="anker" href="#line4704">4704</a><a class="anker" href="#line4705">4705</a><a class="anker" href="#line4706">4706</a><a class="anker" href="#line4707">4707</a><a class="anker" href="#line4708">4708</a><a class="anker" href="#line4709">4709</a><a class="anker" href="#line4710">4710</a><a class="anker" href="#line4711">4711</a><a class="anker" href="#line4712">4712</a><a class="anker" href="#line4713">4713</a><a class="anker" href="#line4714">4714</a><a class="anker" href="#line4715">4715</a><a class="anker" href="#line4716">4716</a><a class="anker" href="#line4717">4717</a><a class="anker" href="#line4718">4718</a><a class="anker" href="#line4719">4719</a><a class="anker" href="#line4720">4720</a><a class="anker" href="#line4721">4721</a><a class="anker" href="#line4722">4722</a><a class="anker" href="#line4723">4723</a><a class="anker" href="#line4724">4724</a><a class="anker" href="#line4725">4725</a><a class="anker" href="#line4726">4726</a><a class="anker" href="#line4727">4727</a><a class="anker" href="#line4728">4728</a><a class="anker" href="#line4729">4729</a><a class="anker" href="#line4730">4730</a><a class="anker" href="#line4731">4731</a><a class="anker" href="#line4732">4732</a><a class="anker" href="#line4733">4733</a><a class="anker" href="#line4734">4734</a><a class="anker" href="#line4735">4735</a><a class="anker" href="#line4736">4736</a><a class="anker" href="#line4737">4737</a><a class="anker" href="#line4738">4738</a><a class="anker" href="#line4739">4739</a><a class="anker" href="#line4740">4740</a><a class="anker" href="#line4741">4741</a><a class="anker" href="#line4742">4742</a><a class="anker" href="#line4743">4743</a><a class="anker" href="#line4744">4744</a><a class="anker" href="#line4745">4745</a><a class="anker" href="#line4746">4746</a><a class="anker" href="#line4747">4747</a><a class="anker" href="#line4748">4748</a><a class="anker" href="#line4749">4749</a><a class="anker" href="#line4750">4750</a><a class="anker" href="#line4751">4751</a><a class="anker" href="#line4752">4752</a><a class="anker" href="#line4753">4753</a><a class="anker" href="#line4754">4754</a><a class="anker" href="#line4755">4755</a><a class="anker" href="#line4756">4756</a><a class="anker" href="#line4757">4757</a><a class="anker" href="#line4758">4758</a><a class="anker" href="#line4759">4759</a><a class="anker" href="#line4760">4760</a><a class="anker" href="#line4761">4761</a><a class="anker" href="#line4762">4762</a><a class="anker" href="#line4763">4763</a><a class="anker" href="#line4764">4764</a><a class="anker" href="#line4765">4765</a><a class="anker" href="#line4766">4766</a><a class="anker" href="#line4767">4767</a><a class="anker" href="#line4768">4768</a><a class="anker" href="#line4769">4769</a><a class="anker" href="#line4770">4770</a><a class="anker" href="#line4771">4771</a><a class="anker" href="#line4772">4772</a><a class="anker" href="#line4773">4773</a><a class="anker" href="#line4774">4774</a><a class="anker" href="#line4775">4775</a><a class="anker" href="#line4776">4776</a><a class="anker" href="#line4777">4777</a><a class="anker" href="#line4778">4778</a><a class="anker" href="#line4779">4779</a><a class="anker" href="#line4780">4780</a><a class="anker" href="#line4781">4781</a><a class="anker" href="#line4782">4782</a><a class="anker" href="#line4783">4783</a><a class="anker" href="#line4784">4784</a><a class="anker" href="#line4785">4785</a><a class="anker" href="#line4786">4786</a><a class="anker" href="#line4787">4787</a><a class="anker" href="#line4788">4788</a><a class="anker" href="#line4789">4789</a><a class="anker" href="#line4790">4790</a><a class="anker" href="#line4791">4791</a><a class="anker" href="#line4792">4792</a><a class="anker" href="#line4793">4793</a><a class="anker" href="#line4794">4794</a><a class="anker" href="#line4795">4795</a><a class="anker" href="#line4796">4796</a><a class="anker" href="#line4797">4797</a><a class="anker" href="#line4798">4798</a><a class="anker" href="#line4799">4799</a><a class="anker" href="#line4800">4800</a><a class="anker" href="#line4801">4801</a><a class="anker" href="#line4802">4802</a><a class="anker" href="#line4803">4803</a><a class="anker" href="#line4804">4804</a><a class="anker" href="#line4805">4805</a><a class="anker" href="#line4806">4806</a><a class="anker" href="#line4807">4807</a><a class="anker" href="#line4808">4808</a><a class="anker" href="#line4809">4809</a><a class="anker" href="#line4810">4810</a><a class="anker" href="#line4811">4811</a><a class="anker" href="#line4812">4812</a><a class="anker" href="#line4813">4813</a><a class="anker" href="#line4814">4814</a><a class="anker" href="#line4815">4815</a><a class="anker" href="#line4816">4816</a><a class="anker" href="#line4817">4817</a><a class="anker" href="#line4818">4818</a><a class="anker" href="#line4819">4819</a><a class="anker" href="#line4820">4820</a><a class="anker" href="#line4821">4821</a><a class="anker" href="#line4822">4822</a><a class="anker" href="#line4823">4823</a><a class="anker" href="#line4824">4824</a><a class="anker" href="#line4825">4825</a><a class="anker" href="#line4826">4826</a><a class="anker" href="#line4827">4827</a><a class="anker" href="#line4828">4828</a><a class="anker" href="#line4829">4829</a><a class="anker" href="#line4830">4830</a><a class="anker" href="#line4831">4831</a><a class="anker" href="#line4832">4832</a><a class="anker" href="#line4833">4833</a><a class="anker" href="#line4834">4834</a><a class="anker" href="#line4835">4835</a><a class="anker" href="#line4836">4836</a><a class="anker" href="#line4837">4837</a><a class="anker" href="#line4838">4838</a><a class="anker" href="#line4839">4839</a><a class="anker" href="#line4840">4840</a><a class="anker" href="#line4841">4841</a><a class="anker" href="#line4842">4842</a><a class="anker" href="#line4843">4843</a><a class="anker" href="#line4844">4844</a><a class="anker" href="#line4845">4845</a><a class="anker" href="#line4846">4846</a><a class="anker" href="#line4847">4847</a><a class="anker" href="#line4848">4848</a><a class="anker" href="#line4849">4849</a><a class="anker" href="#line4850">4850</a><a class="anker" href="#line4851">4851</a><a class="anker" href="#line4852">4852</a><a class="anker" href="#line4853">4853</a><a class="anker" href="#line4854">4854</a><a class="anker" href="#line4855">4855</a><a class="anker" href="#line4856">4856</a><a class="anker" href="#line4857">4857</a><a class="anker" href="#line4858">4858</a><a class="anker" href="#line4859">4859</a><a class="anker" href="#line4860">4860</a><a class="anker" href="#line4861">4861</a><a class="anker" href="#line4862">4862</a><a class="anker" href="#line4863">4863</a><a class="anker" href="#line4864">4864</a><a class="anker" href="#line4865">4865</a><a class="anker" href="#line4866">4866</a><a class="anker" href="#line4867">4867</a><a class="anker" href="#line4868">4868</a><a class="anker" href="#line4869">4869</a><a class="anker" href="#line4870">4870</a><a class="anker" href="#line4871">4871</a><a class="anker" href="#line4872">4872</a><a class="anker" href="#line4873">4873</a><a class="anker" href="#line4874">4874</a><a class="anker" href="#line4875">4875</a><a class="anker" href="#line4876">4876</a><a class="anker" href="#line4877">4877</a><a class="anker" href="#line4878">4878</a><a class="anker" href="#line4879">4879</a><a class="anker" href="#line4880">4880</a><a class="anker" href="#line4881">4881</a><a class="anker" href="#line4882">4882</a><a class="anker" href="#line4883">4883</a><a class="anker" href="#line4884">4884</a><a class="anker" href="#line4885">4885</a><a class="anker" href="#line4886">4886</a><a class="anker" href="#line4887">4887</a><a class="anker" href="#line4888">4888</a><a class="anker" href="#line4889">4889</a><a class="anker" href="#line4890">4890</a><a class="anker" href="#line4891">4891</a><a class="anker" href="#line4892">4892</a><a class="anker" href="#line4893">4893</a><a class="anker" href="#line4894">4894</a><a class="anker" href="#line4895">4895</a><a class="anker" href="#line4896">4896</a><a class="anker" href="#line4897">4897</a><a class="anker" href="#line4898">4898</a><a class="anker" href="#line4899">4899</a><a class="anker" href="#line4900">4900</a><a class="anker" href="#line4901">4901</a><a class="anker" href="#line4902">4902</a><a class="anker" href="#line4903">4903</a><a class="anker" href="#line4904">4904</a><a class="anker" href="#line4905">4905</a><a class="anker" href="#line4906">4906</a><a class="anker" href="#line4907">4907</a><a class="anker" href="#line4908">4908</a><a class="anker" href="#line4909">4909</a><a class="anker" href="#line4910">4910</a><a class="anker" href="#line4911">4911</a><a class="anker" href="#line4912">4912</a><a class="anker" href="#line4913">4913</a><a class="anker" href="#line4914">4914</a><a class="anker" href="#line4915">4915</a><a class="anker" href="#line4916">4916</a><a class="anker" href="#line4917">4917</a><a class="anker" href="#line4918">4918</a><a class="anker" href="#line4919">4919</a><a class="anker" href="#line4920">4920</a><a class="anker" href="#line4921">4921</a><a class="anker" href="#line4922">4922</a><a class="anker" href="#line4923">4923</a><a class="anker" href="#line4924">4924</a><a class="anker" href="#line4925">4925</a><a class="anker" href="#line4926">4926</a><a class="anker" href="#line4927">4927</a><a class="anker" href="#line4928">4928</a><a class="anker" href="#line4929">4929</a><a class="anker" href="#line4930">4930</a><a class="anker" href="#line4931">4931</a><a class="anker" href="#line4932">4932</a><a class="anker" href="#line4933">4933</a><a class="anker" href="#line4934">4934</a><a class="anker" href="#line4935">4935</a><a class="anker" href="#line4936">4936</a><a class="anker" href="#line4937">4937</a><a class="anker" href="#line4938">4938</a><a class="anker" href="#line4939">4939</a><a class="anker" href="#line4940">4940</a><a class="anker" href="#line4941">4941</a><a class="anker" href="#line4942">4942</a><a class="anker" href="#line4943">4943</a><a class="anker" href="#line4944">4944</a><a class="anker" href="#line4945">4945</a><a class="anker" href="#line4946">4946</a><a class="anker" href="#line4947">4947</a><a class="anker" href="#line4948">4948</a><a class="anker" href="#line4949">4949</a><a class="anker" href="#line4950">4950</a><a class="anker" href="#line4951">4951</a><a class="anker" href="#line4952">4952</a><a class="anker" href="#line4953">4953</a><a class="anker" href="#line4954">4954</a><a class="anker" href="#line4955">4955</a><a class="anker" href="#line4956">4956</a><a class="anker" href="#line4957">4957</a><a class="anker" href="#line4958">4958</a><a class="anker" href="#line4959">4959</a><a class="anker" href="#line4960">4960</a><a class="anker" href="#line4961">4961</a><a class="anker" href="#line4962">4962</a><a class="anker" href="#line4963">4963</a><a class="anker" href="#line4964">4964</a><a class="anker" href="#line4965">4965</a><a class="anker" href="#line4966">4966</a><a class="anker" href="#line4967">4967</a><a class="anker" href="#line4968">4968</a><a class="anker" href="#line4969">4969</a><a class="anker" href="#line4970">4970</a><a class="anker" href="#line4971">4971</a><a class="anker" href="#line4972">4972</a><a class="anker" href="#line4973">4973</a><a class="anker" href="#line4974">4974</a><a class="anker" href="#line4975">4975</a><a class="anker" href="#line4976">4976</a><a class="anker" href="#line4977">4977</a><a class="anker" href="#line4978">4978</a><a class="anker" href="#line4979">4979</a><a class="anker" href="#line4980">4980</a><a class="anker" href="#line4981">4981</a><a class="anker" href="#line4982">4982</a><a class="anker" href="#line4983">4983</a><a class="anker" href="#line4984">4984</a><a class="anker" href="#line4985">4985</a><a class="anker" href="#line4986">4986</a><a class="anker" href="#line4987">4987</a><a class="anker" href="#line4988">4988</a><a class="anker" href="#line4989">4989</a><a class="anker" href="#line4990">4990</a><a class="anker" href="#line4991">4991</a><a class="anker" href="#line4992">4992</a><a class="anker" href="#line4993">4993</a><a class="anker" href="#line4994">4994</a><a class="anker" href="#line4995">4995</a><a class="anker" href="#line4996">4996</a><a class="anker" href="#line4997">4997</a><a class="anker" href="#line4998">4998</a><a class="anker" href="#line4999">4999</a><a class="anker" href="#line5000">5000</a><a class="anker" href="#line5001">5001</a><a class="anker" href="#line5002">5002</a><a class="anker" href="#line5003">5003</a><a class="anker" href="#line5004">5004</a><a class="anker" href="#line5005">5005</a><a class="anker" href="#line5006">5006</a><a class="anker" href="#line5007">5007</a><a class="anker" href="#line5008">5008</a><a class="anker" href="#line5009">5009</a><a class="anker" href="#line5010">5010</a><a class="anker" href="#line5011">5011</a><a class="anker" href="#line5012">5012</a><a class="anker" href="#line5013">5013</a><a class="anker" href="#line5014">5014</a><a class="anker" href="#line5015">5015</a><a class="anker" href="#line5016">5016</a><a class="anker" href="#line5017">5017</a><a class="anker" href="#line5018">5018</a><a class="anker" href="#line5019">5019</a><a class="anker" href="#line5020">5020</a><a class="anker" href="#line5021">5021</a><a class="anker" href="#line5022">5022</a><a class="anker" href="#line5023">5023</a><a class="anker" href="#line5024">5024</a><a class="anker" href="#line5025">5025</a><a class="anker" href="#line5026">5026</a><a class="anker" href="#line5027">5027</a><a class="anker" href="#line5028">5028</a><a class="anker" href="#line5029">5029</a><a class="anker" href="#line5030">5030</a><a class="anker" href="#line5031">5031</a><a class="anker" href="#line5032">5032</a><a class="anker" href="#line5033">5033</a><a class="anker" href="#line5034">5034</a><a class="anker" href="#line5035">5035</a><a class="anker" href="#line5036">5036</a><a class="anker" href="#line5037">5037</a><a class="anker" href="#line5038">5038</a><a class="anker" href="#line5039">5039</a><a class="anker" href="#line5040">5040</a><a class="anker" href="#line5041">5041</a><a class="anker" href="#line5042">5042</a><a class="anker" href="#line5043">5043</a><a class="anker" href="#line5044">5044</a><a class="anker" href="#line5045">5045</a><a class="anker" href="#line5046">5046</a><a class="anker" href="#line5047">5047</a><a class="anker" href="#line5048">5048</a><a class="anker" href="#line5049">5049</a><a class="anker" href="#line5050">5050</a><a class="anker" href="#line5051">5051</a><a class="anker" href="#line5052">5052</a><a class="anker" href="#line5053">5053</a><a class="anker" href="#line5054">5054</a><a class="anker" href="#line5055">5055</a><a class="anker" href="#line5056">5056</a><a class="anker" href="#line5057">5057</a><a class="anker" href="#line5058">5058</a><a class="anker" href="#line5059">5059</a><a class="anker" href="#line5060">5060</a><a class="anker" href="#line5061">5061</a><a class="anker" href="#line5062">5062</a><a class="anker" href="#line5063">5063</a><a class="anker" href="#line5064">5064</a><a class="anker" href="#line5065">5065</a><a class="anker" href="#line5066">5066</a><a class="anker" href="#line5067">5067</a><a class="anker" href="#line5068">5068</a><a class="anker" href="#line5069">5069</a><a class="anker" href="#line5070">5070</a><a class="anker" href="#line5071">5071</a><a class="anker" href="#line5072">5072</a><a class="anker" href="#line5073">5073</a><a class="anker" href="#line5074">5074</a><a class="anker" href="#line5075">5075</a><a class="anker" href="#line5076">5076</a><a class="anker" href="#line5077">5077</a><a class="anker" href="#line5078">5078</a><a class="anker" href="#line5079">5079</a><a class="anker" href="#line5080">5080</a><a class="anker" href="#line5081">5081</a><a class="anker" href="#line5082">5082</a><a class="anker" href="#line5083">5083</a><a class="anker" href="#line5084">5084</a><a class="anker" href="#line5085">5085</a><a class="anker" href="#line5086">5086</a><a class="anker" href="#line5087">5087</a><a class="anker" href="#line5088">5088</a><a class="anker" href="#line5089">5089</a><a class="anker" href="#line5090">5090</a><a class="anker" href="#line5091">5091</a><a class="anker" href="#line5092">5092</a><a class="anker" href="#line5093">5093</a><a class="anker" href="#line5094">5094</a><a class="anker" href="#line5095">5095</a><a class="anker" href="#line5096">5096</a><a class="anker" href="#line5097">5097</a><a class="anker" href="#line5098">5098</a><a class="anker" href="#line5099">5099</a><a class="anker" href="#line5100">5100</a><a class="anker" href="#line5101">5101</a><a class="anker" href="#line5102">5102</a><a class="anker" href="#line5103">5103</a><a class="anker" href="#line5104">5104</a><a class="anker" href="#line5105">5105</a><a class="anker" href="#line5106">5106</a><a class="anker" href="#line5107">5107</a><a class="anker" href="#line5108">5108</a><a class="anker" href="#line5109">5109</a><a class="anker" href="#line5110">5110</a><a class="anker" href="#line5111">5111</a><a class="anker" href="#line5112">5112</a><a class="anker" href="#line5113">5113</a><a class="anker" href="#line5114">5114</a><a class="anker" href="#line5115">5115</a><a class="anker" href="#line5116">5116</a><a class="anker" href="#line5117">5117</a><a class="anker" href="#line5118">5118</a><a class="anker" href="#line5119">5119</a><a class="anker" href="#line5120">5120</a><a class="anker" href="#line5121">5121</a><a class="anker" href="#line5122">5122</a><a class="anker" href="#line5123">5123</a><a class="anker" href="#line5124">5124</a><a class="anker" href="#line5125">5125</a><a class="anker" href="#line5126">5126</a><a class="anker" href="#line5127">5127</a><a class="anker" href="#line5128">5128</a><a class="anker" href="#line5129">5129</a><a class="anker" href="#line5130">5130</a><a class="anker" href="#line5131">5131</a><a class="anker" href="#line5132">5132</a><a class="anker" href="#line5133">5133</a><a class="anker" href="#line5134">5134</a><a class="anker" href="#line5135">5135</a><a class="anker" href="#line5136">5136</a><a class="anker" href="#line5137">5137</a><a class="anker" href="#line5138">5138</a><a class="anker" href="#line5139">5139</a><a class="anker" href="#line5140">5140</a><a class="anker" href="#line5141">5141</a><a class="anker" href="#line5142">5142</a><a class="anker" href="#line5143">5143</a><a class="anker" href="#line5144">5144</a><a class="anker" href="#line5145">5145</a><a class="anker" href="#line5146">5146</a><a class="anker" href="#line5147">5147</a><a class="anker" href="#line5148">5148</a><a class="anker" href="#line5149">5149</a><a class="anker" href="#line5150">5150</a><a class="anker" href="#line5151">5151</a><a class="anker" href="#line5152">5152</a><a class="anker" href="#line5153">5153</a><a class="anker" href="#line5154">5154</a><a class="anker" href="#line5155">5155</a><a class="anker" href="#line5156">5156</a><a class="anker" href="#line5157">5157</a><a class="anker" href="#line5158">5158</a><a class="anker" href="#line5159">5159</a><a class="anker" href="#line5160">5160</a><a class="anker" href="#line5161">5161</a><a class="anker" href="#line5162">5162</a><a class="anker" href="#line5163">5163</a><a class="anker" href="#line5164">5164</a><a class="anker" href="#line5165">5165</a><a class="anker" href="#line5166">5166</a><a class="anker" href="#line5167">5167</a><a class="anker" href="#line5168">5168</a><a class="anker" href="#line5169">5169</a><a class="anker" href="#line5170">5170</a><a class="anker" href="#line5171">5171</a><a class="anker" href="#line5172">5172</a><a class="anker" href="#line5173">5173</a><a class="anker" href="#line5174">5174</a><a class="anker" href="#line5175">5175</a><a class="anker" href="#line5176">5176</a><a class="anker" href="#line5177">5177</a><a class="anker" href="#line5178">5178</a><a class="anker" href="#line5179">5179</a><a class="anker" href="#line5180">5180</a><a class="anker" href="#line5181">5181</a><a class="anker" href="#line5182">5182</a><a class="anker" href="#line5183">5183</a><a class="anker" href="#line5184">5184</a><a class="anker" href="#line5185">5185</a><a class="anker" href="#line5186">5186</a><a class="anker" href="#line5187">5187</a><a class="anker" href="#line5188">5188</a><a class="anker" href="#line5189">5189</a><a class="anker" href="#line5190">5190</a><a class="anker" href="#line5191">5191</a><a class="anker" href="#line5192">5192</a><a class="anker" href="#line5193">5193</a><a class="anker" href="#line5194">5194</a><a class="anker" href="#line5195">5195</a><a class="anker" href="#line5196">5196</a><a class="anker" href="#line5197">5197</a><a class="anker" href="#line5198">5198</a><a class="anker" href="#line5199">5199</a><a class="anker" href="#line5200">5200</a><a class="anker" href="#line5201">5201</a><a class="anker" href="#line5202">5202</a><a class="anker" href="#line5203">5203</a><a class="anker" href="#line5204">5204</a><a class="anker" href="#line5205">5205</a><a class="anker" href="#line5206">5206</a><a class="anker" href="#line5207">5207</a><a class="anker" href="#line5208">5208</a><a class="anker" href="#line5209">5209</a><a class="anker" href="#line5210">5210</a><a class="anker" href="#line5211">5211</a><a class="anker" href="#line5212">5212</a><a class="anker" href="#line5213">5213</a><a class="anker" href="#line5214">5214</a><a class="anker" href="#line5215">5215</a><a class="anker" href="#line5216">5216</a><a class="anker" href="#line5217">5217</a><a class="anker" href="#line5218">5218</a><a class="anker" href="#line5219">5219</a><a class="anker" href="#line5220">5220</a><a class="anker" href="#line5221">5221</a><a class="anker" href="#line5222">5222</a><a class="anker" href="#line5223">5223</a><a class="anker" href="#line5224">5224</a><a class="anker" href="#line5225">5225</a><a class="anker" href="#line5226">5226</a><a class="anker" href="#line5227">5227</a><a class="anker" href="#line5228">5228</a><a class="anker" href="#line5229">5229</a><a class="anker" href="#line5230">5230</a><a class="anker" href="#line5231">5231</a><a class="anker" href="#line5232">5232</a><a class="anker" href="#line5233">5233</a><a class="anker" href="#line5234">5234</a><a class="anker" href="#line5235">5235</a><a class="anker" href="#line5236">5236</a><a class="anker" href="#line5237">5237</a><a class="anker" href="#line5238">5238</a><a class="anker" href="#line5239">5239</a><a class="anker" href="#line5240">5240</a><a class="anker" href="#line5241">5241</a><a class="anker" href="#line5242">5242</a><a class="anker" href="#line5243">5243</a><a class="anker" href="#line5244">5244</a><a class="anker" href="#line5245">5245</a><a class="anker" href="#line5246">5246</a><a class="anker" href="#line5247">5247</a><a class="anker" href="#line5248">5248</a><a class="anker" href="#line5249">5249</a><a class="anker" href="#line5250">5250</a><a class="anker" href="#line5251">5251</a><a class="anker" href="#line5252">5252</a><a class="anker" href="#line5253">5253</a><a class="anker" href="#line5254">5254</a><a class="anker" href="#line5255">5255</a><a class="anker" href="#line5256">5256</a><a class="anker" href="#line5257">5257</a><a class="anker" href="#line5258">5258</a><a class="anker" href="#line5259">5259</a><a class="anker" href="#line5260">5260</a><a class="anker" href="#line5261">5261</a><a class="anker" href="#line5262">5262</a><a class="anker" href="#line5263">5263</a><a class="anker" href="#line5264">5264</a><a class="anker" href="#line5265">5265</a><a class="anker" href="#line5266">5266</a><a class="anker" href="#line5267">5267</a><a class="anker" href="#line5268">5268</a><a class="anker" href="#line5269">5269</a><a class="anker" href="#line5270">5270</a><a class="anker" href="#line5271">5271</a><a class="anker" href="#line5272">5272</a><a class="anker" href="#line5273">5273</a><a class="anker" href="#line5274">5274</a><a class="anker" href="#line5275">5275</a><a class="anker" href="#line5276">5276</a><a class="anker" href="#line5277">5277</a><a class="anker" href="#line5278">5278</a><a class="anker" href="#line5279">5279</a><a class="anker" href="#line5280">5280</a><a class="anker" href="#line5281">5281</a><a class="anker" href="#line5282">5282</a><a class="anker" href="#line5283">5283</a><a class="anker" href="#line5284">5284</a><a class="anker" href="#line5285">5285</a><a class="anker" href="#line5286">5286</a><a class="anker" href="#line5287">5287</a><a class="anker" href="#line5288">5288</a><a class="anker" href="#line5289">5289</a><a class="anker" href="#line5290">5290</a><a class="anker" href="#line5291">5291</a><a class="anker" href="#line5292">5292</a><a class="anker" href="#line5293">5293</a><a class="anker" href="#line5294">5294</a><a class="anker" href="#line5295">5295</a><a class="anker" href="#line5296">5296</a><a class="anker" href="#line5297">5297</a><a class="anker" href="#line5298">5298</a><a class="anker" href="#line5299">5299</a><a class="anker" href="#line5300">5300</a><a class="anker" href="#line5301">5301</a><a class="anker" href="#line5302">5302</a><a class="anker" href="#line5303">5303</a><a class="anker" href="#line5304">5304</a><a class="anker" href="#line5305">5305</a><a class="anker" href="#line5306">5306</a><a class="anker" href="#line5307">5307</a><a class="anker" href="#line5308">5308</a><a class="anker" href="#line5309">5309</a><a class="anker" href="#line5310">5310</a><a class="anker" href="#line5311">5311</a><a class="anker" href="#line5312">5312</a><a class="anker" href="#line5313">5313</a><a class="anker" href="#line5314">5314</a><a class="anker" href="#line5315">5315</a><a class="anker" href="#line5316">5316</a><a class="anker" href="#line5317">5317</a><a class="anker" href="#line5318">5318</a><a class="anker" href="#line5319">5319</a><a class="anker" href="#line5320">5320</a><a class="anker" href="#line5321">5321</a><a class="anker" href="#line5322">5322</a><a class="anker" href="#line5323">5323</a><a class="anker" href="#line5324">5324</a><a class="anker" href="#line5325">5325</a><a class="anker" href="#line5326">5326</a><a class="anker" href="#line5327">5327</a><a class="anker" href="#line5328">5328</a><a class="anker" href="#line5329">5329</a><a class="anker" href="#line5330">5330</a><a class="anker" href="#line5331">5331</a><a class="anker" href="#line5332">5332</a><a class="anker" href="#line5333">5333</a><a class="anker" href="#line5334">5334</a><a class="anker" href="#line5335">5335</a><a class="anker" href="#line5336">5336</a><a class="anker" href="#line5337">5337</a><a class="anker" href="#line5338">5338</a><a class="anker" href="#line5339">5339</a><a class="anker" href="#line5340">5340</a><a class="anker" href="#line5341">5341</a><a class="anker" href="#line5342">5342</a><a class="anker" href="#line5343">5343</a><a class="anker" href="#line5344">5344</a><a class="anker" href="#line5345">5345</a><a class="anker" href="#line5346">5346</a><a class="anker" href="#line5347">5347</a><a class="anker" href="#line5348">5348</a><a class="anker" href="#line5349">5349</a><a class="anker" href="#line5350">5350</a><a class="anker" href="#line5351">5351</a><a class="anker" href="#line5352">5352</a><a class="anker" href="#line5353">5353</a><a class="anker" href="#line5354">5354</a><a class="anker" href="#line5355">5355</a><a class="anker" href="#line5356">5356</a><a class="anker" href="#line5357">5357</a><a class="anker" href="#line5358">5358</a><a class="anker" href="#line5359">5359</a><a class="anker" href="#line5360">5360</a><a class="anker" href="#line5361">5361</a><a class="anker" href="#line5362">5362</a><a class="anker" href="#line5363">5363</a><a class="anker" href="#line5364">5364</a><a class="anker" href="#line5365">5365</a><a class="anker" href="#line5366">5366</a><a class="anker" href="#line5367">5367</a><a class="anker" href="#line5368">5368</a><a class="anker" href="#line5369">5369</a><a class="anker" href="#line5370">5370</a><a class="anker" href="#line5371">5371</a><a class="anker" href="#line5372">5372</a><a class="anker" href="#line5373">5373</a><a class="anker" href="#line5374">5374</a><a class="anker" href="#line5375">5375</a><a class="anker" href="#line5376">5376</a><a class="anker" href="#line5377">5377</a><a class="anker" href="#line5378">5378</a><a class="anker" href="#line5379">5379</a><a class="anker" href="#line5380">5380</a><a class="anker" href="#line5381">5381</a><a class="anker" href="#line5382">5382</a><a class="anker" href="#line5383">5383</a><a class="anker" href="#line5384">5384</a><a class="anker" href="#line5385">5385</a><a class="anker" href="#line5386">5386</a><a class="anker" href="#line5387">5387</a><a class="anker" href="#line5388">5388</a><a class="anker" href="#line5389">5389</a><a class="anker" href="#line5390">5390</a><a class="anker" href="#line5391">5391</a><a class="anker" href="#line5392">5392</a><a class="anker" href="#line5393">5393</a><a class="anker" href="#line5394">5394</a><a class="anker" href="#line5395">5395</a><a class="anker" href="#line5396">5396</a><a class="anker" href="#line5397">5397</a><a class="anker" href="#line5398">5398</a><a class="anker" href="#line5399">5399</a><a class="anker" href="#line5400">5400</a><a class="anker" href="#line5401">5401</a><a class="anker" href="#line5402">5402</a><a class="anker" href="#line5403">5403</a><a class="anker" href="#line5404">5404</a><a class="anker" href="#line5405">5405</a><a class="anker" href="#line5406">5406</a><a class="anker" href="#line5407">5407</a><a class="anker" href="#line5408">5408</a><a class="anker" href="#line5409">5409</a><a class="anker" href="#line5410">5410</a><a class="anker" href="#line5411">5411</a><a class="anker" href="#line5412">5412</a><a class="anker" href="#line5413">5413</a><a class="anker" href="#line5414">5414</a><a class="anker" href="#line5415">5415</a><a class="anker" href="#line5416">5416</a><a class="anker" href="#line5417">5417</a><a class="anker" href="#line5418">5418</a><a class="anker" href="#line5419">5419</a><a class="anker" href="#line5420">5420</a><a class="anker" href="#line5421">5421</a><a class="anker" href="#line5422">5422</a><a class="anker" href="#line5423">5423</a><a class="anker" href="#line5424">5424</a><a class="anker" href="#line5425">5425</a><a class="anker" href="#line5426">5426</a><a class="anker" href="#line5427">5427</a><a class="anker" href="#line5428">5428</a><a class="anker" href="#line5429">5429</a><a class="anker" href="#line5430">5430</a><a class="anker" href="#line5431">5431</a><a class="anker" href="#line5432">5432</a><a class="anker" href="#line5433">5433</a><a class="anker" href="#line5434">5434</a><a class="anker" href="#line5435">5435</a><a class="anker" href="#line5436">5436</a><a class="anker" href="#line5437">5437</a><a class="anker" href="#line5438">5438</a><a class="anker" href="#line5439">5439</a><a class="anker" href="#line5440">5440</a><a class="anker" href="#line5441">5441</a><a class="anker" href="#line5442">5442</a><a class="anker" href="#line5443">5443</a><a class="anker" href="#line5444">5444</a><a class="anker" href="#line5445">5445</a><a class="anker" href="#line5446">5446</a><a class="anker" href="#line5447">5447</a><a class="anker" href="#line5448">5448</a><a class="anker" href="#line5449">5449</a><a class="anker" href="#line5450">5450</a><a class="anker" href="#line5451">5451</a><a class="anker" href="#line5452">5452</a><a class="anker" href="#line5453">5453</a><a class="anker" href="#line5454">5454</a><a class="anker" href="#line5455">5455</a><a class="anker" href="#line5456">5456</a><a class="anker" href="#line5457">5457</a><a class="anker" href="#line5458">5458</a><a class="anker" href="#line5459">5459</a><a class="anker" href="#line5460">5460</a><a class="anker" href="#line5461">5461</a><a class="anker" href="#line5462">5462</a><a class="anker" href="#line5463">5463</a><a class="anker" href="#line5464">5464</a><a class="anker" href="#line5465">5465</a><a class="anker" href="#line5466">5466</a><a class="anker" href="#line5467">5467</a><a class="anker" href="#line5468">5468</a><a class="anker" href="#line5469">5469</a><a class="anker" href="#line5470">5470</a><a class="anker" href="#line5471">5471</a><a class="anker" href="#line5472">5472</a><a class="anker" href="#line5473">5473</a><a class="anker" href="#line5474">5474</a><a class="anker" href="#line5475">5475</a><a class="anker" href="#line5476">5476</a><a class="anker" href="#line5477">5477</a><a class="anker" href="#line5478">5478</a><a class="anker" href="#line5479">5479</a><a class="anker" href="#line5480">5480</a><a class="anker" href="#line5481">5481</a><a class="anker" href="#line5482">5482</a><a class="anker" href="#line5483">5483</a><a class="anker" href="#line5484">5484</a><a class="anker" href="#line5485">5485</a><a class="anker" href="#line5486">5486</a><a class="anker" href="#line5487">5487</a><a class="anker" href="#line5488">5488</a><a class="anker" href="#line5489">5489</a><a class="anker" href="#line5490">5490</a><a class="anker" href="#line5491">5491</a><a class="anker" href="#line5492">5492</a><a class="anker" href="#line5493">5493</a><a class="anker" href="#line5494">5494</a><a class="anker" href="#line5495">5495</a><a class="anker" href="#line5496">5496</a><a class="anker" href="#line5497">5497</a><a class="anker" href="#line5498">5498</a><a class="anker" href="#line5499">5499</a><a class="anker" href="#line5500">5500</a><a class="anker" href="#line5501">5501</a><a class="anker" href="#line5502">5502</a><a class="anker" href="#line5503">5503</a><a class="anker" href="#line5504">5504</a><a class="anker" href="#line5505">5505</a><a class="anker" href="#line5506">5506</a><a class="anker" href="#line5507">5507</a><a class="anker" href="#line5508">5508</a><a class="anker" href="#line5509">5509</a><a class="anker" href="#line5510">5510</a><a class="anker" href="#line5511">5511</a><a class="anker" href="#line5512">5512</a><a class="anker" href="#line5513">5513</a><a class="anker" href="#line5514">5514</a><a class="anker" href="#line5515">5515</a><a class="anker" href="#line5516">5516</a><a class="anker" href="#line5517">5517</a><a class="anker" href="#line5518">5518</a><a class="anker" href="#line5519">5519</a><a class="anker" href="#line5520">5520</a><a class="anker" href="#line5521">5521</a><a class="anker" href="#line5522">5522</a><a class="anker" href="#line5523">5523</a><a class="anker" href="#line5524">5524</a><a class="anker" href="#line5525">5525</a><a class="anker" href="#line5526">5526</a><a class="anker" href="#line5527">5527</a><a class="anker" href="#line5528">5528</a><a class="anker" href="#line5529">5529</a><a class="anker" href="#line5530">5530</a><a class="anker" href="#line5531">5531</a><a class="anker" href="#line5532">5532</a><a class="anker" href="#line5533">5533</a><a class="anker" href="#line5534">5534</a><a class="anker" href="#line5535">5535</a><a class="anker" href="#line5536">5536</a><a class="anker" href="#line5537">5537</a><a class="anker" href="#line5538">5538</a><a class="anker" href="#line5539">5539</a><a class="anker" href="#line5540">5540</a><a class="anker" href="#line5541">5541</a><a class="anker" href="#line5542">5542</a><a class="anker" href="#line5543">5543</a><a class="anker" href="#line5544">5544</a><a class="anker" href="#line5545">5545</a><a class="anker" href="#line5546">5546</a><a class="anker" href="#line5547">5547</a><a class="anker" href="#line5548">5548</a><a class="anker" href="#line5549">5549</a><a class="anker" href="#line5550">5550</a><a class="anker" href="#line5551">5551</a><a class="anker" href="#line5552">5552</a><a class="anker" href="#line5553">5553</a><a class="anker" href="#line5554">5554</a><a class="anker" href="#line5555">5555</a><a class="anker" href="#line5556">5556</a><a class="anker" href="#line5557">5557</a><a class="anker" href="#line5558">5558</a><a class="anker" href="#line5559">5559</a><a class="anker" href="#line5560">5560</a><a class="anker" href="#line5561">5561</a><a class="anker" href="#line5562">5562</a><a class="anker" href="#line5563">5563</a><a class="anker" href="#line5564">5564</a><a class="anker" href="#line5565">5565</a><a class="anker" href="#line5566">5566</a><a class="anker" href="#line5567">5567</a><a class="anker" href="#line5568">5568</a><a class="anker" href="#line5569">5569</a><a class="anker" href="#line5570">5570</a><a class="anker" href="#line5571">5571</a><a class="anker" href="#line5572">5572</a><a class="anker" href="#line5573">5573</a><a class="anker" href="#line5574">5574</a><a class="anker" href="#line5575">5575</a><a class="anker" href="#line5576">5576</a><a class="anker" href="#line5577">5577</a><a class="anker" href="#line5578">5578</a><a class="anker" href="#line5579">5579</a><a class="anker" href="#line5580">5580</a><a class="anker" href="#line5581">5581</a><a class="anker" href="#line5582">5582</a><a class="anker" href="#line5583">5583</a><a class="anker" href="#line5584">5584</a><a class="anker" href="#line5585">5585</a><a class="anker" href="#line5586">5586</a><a class="anker" href="#line5587">5587</a><a class="anker" href="#line5588">5588</a><a class="anker" href="#line5589">5589</a><a class="anker" href="#line5590">5590</a><a class="anker" href="#line5591">5591</a><a class="anker" href="#line5592">5592</a><a class="anker" href="#line5593">5593</a><a class="anker" href="#line5594">5594</a><a class="anker" href="#line5595">5595</a><a class="anker" href="#line5596">5596</a><a class="anker" href="#line5597">5597</a><a class="anker" href="#line5598">5598</a><a class="anker" href="#line5599">5599</a><a class="anker" href="#line5600">5600</a><a class="anker" href="#line5601">5601</a><a class="anker" href="#line5602">5602</a><a class="anker" href="#line5603">5603</a><a class="anker" href="#line5604">5604</a><a class="anker" href="#line5605">5605</a><a class="anker" href="#line5606">5606</a><a class="anker" href="#line5607">5607</a><a class="anker" href="#line5608">5608</a><a class="anker" href="#line5609">5609</a><a class="anker" href="#line5610">5610</a><a class="anker" href="#line5611">5611</a><a class="anker" href="#line5612">5612</a><a class="anker" href="#line5613">5613</a><a class="anker" href="#line5614">5614</a><a class="anker" href="#line5615">5615</a><a class="anker" href="#line5616">5616</a><a class="anker" href="#line5617">5617</a><a class="anker" href="#line5618">5618</a><a class="anker" href="#line5619">5619</a><a class="anker" href="#line5620">5620</a><a class="anker" href="#line5621">5621</a><a class="anker" href="#line5622">5622</a><a class="anker" href="#line5623">5623</a><a class="anker" href="#line5624">5624</a><a class="anker" href="#line5625">5625</a><a class="anker" href="#line5626">5626</a><a class="anker" href="#line5627">5627</a><a class="anker" href="#line5628">5628</a><a class="anker" href="#line5629">5629</a><a class="anker" href="#line5630">5630</a><a class="anker" href="#line5631">5631</a><a class="anker" href="#line5632">5632</a><a class="anker" href="#line5633">5633</a><a class="anker" href="#line5634">5634</a><a class="anker" href="#line5635">5635</a><a class="anker" href="#line5636">5636</a><a class="anker" href="#line5637">5637</a><a class="anker" href="#line5638">5638</a><a class="anker" href="#line5639">5639</a><a class="anker" href="#line5640">5640</a><a class="anker" href="#line5641">5641</a><a class="anker" href="#line5642">5642</a><a class="anker" href="#line5643">5643</a><a class="anker" href="#line5644">5644</a><a class="anker" href="#line5645">5645</a><a class="anker" href="#line5646">5646</a><a class="anker" href="#line5647">5647</a><a class="anker" href="#line5648">5648</a><a class="anker" href="#line5649">5649</a><a class="anker" href="#line5650">5650</a><a class="anker" href="#line5651">5651</a><a class="anker" href="#line5652">5652</a><a class="anker" href="#line5653">5653</a><a class="anker" href="#line5654">5654</a><a class="anker" href="#line5655">5655</a><a class="anker" href="#line5656">5656</a><a class="anker" href="#line5657">5657</a><a class="anker" href="#line5658">5658</a><a class="anker" href="#line5659">5659</a><a class="anker" href="#line5660">5660</a><a class="anker" href="#line5661">5661</a><a class="anker" href="#line5662">5662</a><a class="anker" href="#line5663">5663</a><a class="anker" href="#line5664">5664</a><a class="anker" href="#line5665">5665</a><a class="anker" href="#line5666">5666</a><a class="anker" href="#line5667">5667</a><a class="anker" href="#line5668">5668</a><a class="anker" href="#line5669">5669</a><a class="anker" href="#line5670">5670</a><a class="anker" href="#line5671">5671</a><a class="anker" href="#line5672">5672</a><a class="anker" href="#line5673">5673</a><a class="anker" href="#line5674">5674</a><a class="anker" href="#line5675">5675</a><a class="anker" href="#line5676">5676</a><a class="anker" href="#line5677">5677</a><a class="anker" href="#line5678">5678</a><a class="anker" href="#line5679">5679</a><a class="anker" href="#line5680">5680</a><a class="anker" href="#line5681">5681</a><a class="anker" href="#line5682">5682</a><a class="anker" href="#line5683">5683</a><a class="anker" href="#line5684">5684</a><a class="anker" href="#line5685">5685</a><a class="anker" href="#line5686">5686</a><a class="anker" href="#line5687">5687</a><a class="anker" href="#line5688">5688</a><a class="anker" href="#line5689">5689</a><a class="anker" href="#line5690">5690</a><a class="anker" href="#line5691">5691</a><a class="anker" href="#line5692">5692</a><a class="anker" href="#line5693">5693</a><a class="anker" href="#line5694">5694</a><a class="anker" href="#line5695">5695</a><a class="anker" href="#line5696">5696</a><a class="anker" href="#line5697">5697</a><a class="anker" href="#line5698">5698</a><a class="anker" href="#line5699">5699</a><a class="anker" href="#line5700">5700</a><a class="anker" href="#line5701">5701</a><a class="anker" href="#line5702">5702</a><a class="anker" href="#line5703">5703</a><a class="anker" href="#line5704">5704</a><a class="anker" href="#line5705">5705</a><a class="anker" href="#line5706">5706</a><a class="anker" href="#line5707">5707</a><a class="anker" href="#line5708">5708</a><a class="anker" href="#line5709">5709</a><a class="anker" href="#line5710">5710</a><a class="anker" href="#line5711">5711</a><a class="anker" href="#line5712">5712</a><a class="anker" href="#line5713">5713</a><a class="anker" href="#line5714">5714</a><a class="anker" href="#line5715">5715</a><a class="anker" href="#line5716">5716</a><a class="anker" href="#line5717">5717</a><a class="anker" href="#line5718">5718</a><a class="anker" href="#line5719">5719</a><a class="anker" href="#line5720">5720</a><a class="anker" href="#line5721">5721</a><a class="anker" href="#line5722">5722</a><a class="anker" href="#line5723">5723</a><a class="anker" href="#line5724">5724</a><a class="anker" href="#line5725">5725</a><a class="anker" href="#line5726">5726</a><a class="anker" href="#line5727">5727</a><a class="anker" href="#line5728">5728</a><a class="anker" href="#line5729">5729</a><a class="anker" href="#line5730">5730</a><a class="anker" href="#line5731">5731</a><a class="anker" href="#line5732">5732</a><a class="anker" href="#line5733">5733</a><a class="anker" href="#line5734">5734</a><a class="anker" href="#line5735">5735</a><a class="anker" href="#line5736">5736</a><a class="anker" href="#line5737">5737</a><a class="anker" href="#line5738">5738</a><a class="anker" href="#line5739">5739</a><a class="anker" href="#line5740">5740</a><a class="anker" href="#line5741">5741</a><a class="anker" href="#line5742">5742</a><a class="anker" href="#line5743">5743</a><a class="anker" href="#line5744">5744</a><a class="anker" href="#line5745">5745</a><a class="anker" href="#line5746">5746</a><a class="anker" href="#line5747">5747</a><a class="anker" href="#line5748">5748</a><a class="anker" href="#line5749">5749</a><a class="anker" href="#line5750">5750</a><a class="anker" href="#line5751">5751</a><a class="anker" href="#line5752">5752</a><a class="anker" href="#line5753">5753</a><a class="anker" href="#line5754">5754</a><a class="anker" href="#line5755">5755</a><a class="anker" href="#line5756">5756</a><a class="anker" href="#line5757">5757</a><a class="anker" href="#line5758">5758</a><a class="anker" href="#line5759">5759</a><a class="anker" href="#line5760">5760</a><a class="anker" href="#line5761">5761</a><a class="anker" href="#line5762">5762</a><a class="anker" href="#line5763">5763</a><a class="anker" href="#line5764">5764</a><a class="anker" href="#line5765">5765</a><a class="anker" href="#line5766">5766</a><a class="anker" href="#line5767">5767</a><a class="anker" href="#line5768">5768</a><a class="anker" href="#line5769">5769</a><a class="anker" href="#line5770">5770</a><a class="anker" href="#line5771">5771</a><a class="anker" href="#line5772">5772</a><a class="anker" href="#line5773">5773</a><a class="anker" href="#line5774">5774</a><a class="anker" href="#line5775">5775</a><a class="anker" href="#line5776">5776</a><a class="anker" href="#line5777">5777</a><a class="anker" href="#line5778">5778</a><a class="anker" href="#line5779">5779</a><a class="anker" href="#line5780">5780</a><a class="anker" href="#line5781">5781</a><a class="anker" href="#line5782">5782</a><a class="anker" href="#line5783">5783</a><a class="anker" href="#line5784">5784</a><a class="anker" href="#line5785">5785</a><a class="anker" href="#line5786">5786</a><a class="anker" href="#line5787">5787</a><a class="anker" href="#line5788">5788</a><a class="anker" href="#line5789">5789</a><a class="anker" href="#line5790">5790</a><a class="anker" href="#line5791">5791</a><a class="anker" href="#line5792">5792</a><a class="anker" href="#line5793">5793</a><a class="anker" href="#line5794">5794</a><a class="anker" href="#line5795">5795</a><a class="anker" href="#line5796">5796</a><a class="anker" href="#line5797">5797</a><a class="anker" href="#line5798">5798</a><a class="anker" href="#line5799">5799</a><a class="anker" href="#line5800">5800</a><a class="anker" href="#line5801">5801</a><a class="anker" href="#line5802">5802</a><a class="anker" href="#line5803">5803</a><a class="anker" href="#line5804">5804</a><a class="anker" href="#line5805">5805</a><a class="anker" href="#line5806">5806</a><a class="anker" href="#line5807">5807</a><a class="anker" href="#line5808">5808</a><a class="anker" href="#line5809">5809</a><a class="anker" href="#line5810">5810</a><a class="anker" href="#line5811">5811</a><a class="anker" href="#line5812">5812</a><a class="anker" href="#line5813">5813</a><a class="anker" href="#line5814">5814</a><a class="anker" href="#line5815">5815</a><a class="anker" href="#line5816">5816</a><a class="anker" href="#line5817">5817</a><a class="anker" href="#line5818">5818</a><a class="anker" href="#line5819">5819</a><a class="anker" href="#line5820">5820</a><a class="anker" href="#line5821">5821</a><a class="anker" href="#line5822">5822</a><a class="anker" href="#line5823">5823</a><a class="anker" href="#line5824">5824</a><a class="anker" href="#line5825">5825</a><a class="anker" href="#line5826">5826</a><a class="anker" href="#line5827">5827</a><a class="anker" href="#line5828">5828</a><a class="anker" href="#line5829">5829</a><a class="anker" href="#line5830">5830</a><a class="anker" href="#line5831">5831</a><a class="anker" href="#line5832">5832</a><a class="anker" href="#line5833">5833</a><a class="anker" href="#line5834">5834</a><a class="anker" href="#line5835">5835</a><a class="anker" href="#line5836">5836</a><a class="anker" href="#line5837">5837</a><a class="anker" href="#line5838">5838</a><a class="anker" href="#line5839">5839</a><a class="anker" href="#line5840">5840</a><a class="anker" href="#line5841">5841</a><a class="anker" href="#line5842">5842</a><a class="anker" href="#line5843">5843</a><a class="anker" href="#line5844">5844</a><a class="anker" href="#line5845">5845</a><a class="anker" href="#line5846">5846</a><a class="anker" href="#line5847">5847</a><a class="anker" href="#line5848">5848</a><a class="anker" href="#line5849">5849</a><a class="anker" href="#line5850">5850</a><a class="anker" href="#line5851">5851</a><a class="anker" href="#line5852">5852</a><a class="anker" href="#line5853">5853</a><a class="anker" href="#line5854">5854</a><a class="anker" href="#line5855">5855</a><a class="anker" href="#line5856">5856</a><a class="anker" href="#line5857">5857</a><a class="anker" href="#line5858">5858</a><a class="anker" href="#line5859">5859</a><a class="anker" href="#line5860">5860</a><a class="anker" href="#line5861">5861</a><a class="anker" href="#line5862">5862</a><a class="anker" href="#line5863">5863</a><a class="anker" href="#line5864">5864</a><a class="anker" href="#line5865">5865</a><a class="anker" href="#line5866">5866</a><a class="anker" href="#line5867">5867</a><a class="anker" href="#line5868">5868</a><a class="anker" href="#line5869">5869</a><a class="anker" href="#line5870">5870</a><a class="anker" href="#line5871">5871</a><a class="anker" href="#line5872">5872</a><a class="anker" href="#line5873">5873</a><a class="anker" href="#line5874">5874</a><a class="anker" href="#line5875">5875</a><a class="anker" href="#line5876">5876</a><a class="anker" href="#line5877">5877</a><a class="anker" href="#line5878">5878</a><a class="anker" href="#line5879">5879</a><a class="anker" href="#line5880">5880</a><a class="anker" href="#line5881">5881</a><a class="anker" href="#line5882">5882</a><a class="anker" href="#line5883">5883</a><a class="anker" href="#line5884">5884</a><a class="anker" href="#line5885">5885</a><a class="anker" href="#line5886">5886</a><a class="anker" href="#line5887">5887</a><a class="anker" href="#line5888">5888</a><a class="anker" href="#line5889">5889</a><a class="anker" href="#line5890">5890</a><a class="anker" href="#line5891">5891</a><a class="anker" href="#line5892">5892</a><a class="anker" href="#line5893">5893</a><a class="anker" href="#line5894">5894</a><a class="anker" href="#line5895">5895</a><a class="anker" href="#line5896">5896</a><a class="anker" href="#line5897">5897</a><a class="anker" href="#line5898">5898</a><a class="anker" href="#line5899">5899</a><a class="anker" href="#line5900">5900</a><a class="anker" href="#line5901">5901</a><a class="anker" href="#line5902">5902</a><a class="anker" href="#line5903">5903</a><a class="anker" href="#line5904">5904</a><a class="anker" href="#line5905">5905</a><a class="anker" href="#line5906">5906</a><a class="anker" href="#line5907">5907</a><a class="anker" href="#line5908">5908</a><a class="anker" href="#line5909">5909</a><a class="anker" href="#line5910">5910</a><a class="anker" href="#line5911">5911</a><a class="anker" href="#line5912">5912</a><a class="anker" href="#line5913">5913</a><a class="anker" href="#line5914">5914</a><a class="anker" href="#line5915">5915</a><a class="anker" href="#line5916">5916</a><a class="anker" href="#line5917">5917</a><a class="anker" href="#line5918">5918</a><a class="anker" href="#line5919">5919</a><a class="anker" href="#line5920">5920</a><a class="anker" href="#line5921">5921</a><a class="anker" href="#line5922">5922</a><a class="anker" href="#line5923">5923</a><a class="anker" href="#line5924">5924</a><a class="anker" href="#line5925">5925</a><a class="anker" href="#line5926">5926</a><a class="anker" href="#line5927">5927</a><a class="anker" href="#line5928">5928</a><a class="anker" href="#line5929">5929</a><a class="anker" href="#line5930">5930</a><a class="anker" href="#line5931">5931</a><a class="anker" href="#line5932">5932</a><a class="anker" href="#line5933">5933</a><a class="anker" href="#line5934">5934</a><a class="anker" href="#line5935">5935</a><a class="anker" href="#line5936">5936</a><a class="anker" href="#line5937">5937</a><a class="anker" href="#line5938">5938</a><a class="anker" href="#line5939">5939</a><a class="anker" href="#line5940">5940</a><a class="anker" href="#line5941">5941</a><a class="anker" href="#line5942">5942</a><a class="anker" href="#line5943">5943</a><a class="anker" href="#line5944">5944</a><a class="anker" href="#line5945">5945</a><a class="anker" href="#line5946">5946</a><a class="anker" href="#line5947">5947</a><a class="anker" href="#line5948">5948</a><a class="anker" href="#line5949">5949</a><a class="anker" href="#line5950">5950</a><a class="anker" href="#line5951">5951</a><a class="anker" href="#line5952">5952</a><a class="anker" href="#line5953">5953</a><a class="anker" href="#line5954">5954</a><a class="anker" href="#line5955">5955</a><a class="anker" href="#line5956">5956</a><a class="anker" href="#line5957">5957</a><a class="anker" href="#line5958">5958</a><a class="anker" href="#line5959">5959</a><a class="anker" href="#line5960">5960</a><a class="anker" href="#line5961">5961</a><a class="anker" href="#line5962">5962</a><a class="anker" href="#line5963">5963</a><a class="anker" href="#line5964">5964</a><a class="anker" href="#line5965">5965</a><a class="anker" href="#line5966">5966</a><a class="anker" href="#line5967">5967</a><a class="anker" href="#line5968">5968</a><a class="anker" href="#line5969">5969</a><a class="anker" href="#line5970">5970</a><a class="anker" href="#line5971">5971</a><a class="anker" href="#line5972">5972</a><a class="anker" href="#line5973">5973</a><a class="anker" href="#line5974">5974</a><a class="anker" href="#line5975">5975</a><a class="anker" href="#line5976">5976</a><a class="anker" href="#line5977">5977</a><a class="anker" href="#line5978">5978</a><a class="anker" href="#line5979">5979</a><a class="anker" href="#line5980">5980</a><a class="anker" href="#line5981">5981</a><a class="anker" href="#line5982">5982</a><a class="anker" href="#line5983">5983</a><a class="anker" href="#line5984">5984</a><a class="anker" href="#line5985">5985</a><a class="anker" href="#line5986">5986</a><a class="anker" href="#line5987">5987</a><a class="anker" href="#line5988">5988</a><a class="anker" href="#line5989">5989</a><a class="anker" href="#line5990">5990</a><a class="anker" href="#line5991">5991</a><a class="anker" href="#line5992">5992</a><a class="anker" href="#line5993">5993</a><a class="anker" href="#line5994">5994</a><a class="anker" href="#line5995">5995</a><a class="anker" href="#line5996">5996</a><a class="anker" href="#line5997">5997</a><a class="anker" href="#line5998">5998</a><a class="anker" href="#line5999">5999</a><a class="anker" href="#line6000">6000</a><a class="anker" href="#line6001">6001</a><a class="anker" href="#line6002">6002</a><a class="anker" href="#line6003">6003</a><a class="anker" href="#line6004">6004</a><a class="anker" href="#line6005">6005</a><a class="anker" href="#line6006">6006</a><a class="anker" href="#line6007">6007</a><a class="anker" href="#line6008">6008</a><a class="anker" href="#line6009">6009</a><a class="anker" href="#line6010">6010</a><a class="anker" href="#line6011">6011</a><a class="anker" href="#line6012">6012</a><a class="anker" href="#line6013">6013</a><a class="anker" href="#line6014">6014</a><a class="anker" href="#line6015">6015</a><a class="anker" href="#line6016">6016</a><a class="anker" href="#line6017">6017</a><a class="anker" href="#line6018">6018</a><a class="anker" href="#line6019">6019</a><a class="anker" href="#line6020">6020</a><a class="anker" href="#line6021">6021</a><a class="anker" href="#line6022">6022</a><a class="anker" href="#line6023">6023</a><a class="anker" href="#line6024">6024</a><a class="anker" href="#line6025">6025</a><a class="anker" href="#line6026">6026</a><a class="anker" href="#line6027">6027</a><a class="anker" href="#line6028">6028</a><a class="anker" href="#line6029">6029</a><a class="anker" href="#line6030">6030</a><a class="anker" href="#line6031">6031</a><a class="anker" href="#line6032">6032</a><a class="anker" href="#line6033">6033</a><a class="anker" href="#line6034">6034</a><a class="anker" href="#line6035">6035</a><a class="anker" href="#line6036">6036</a><a class="anker" href="#line6037">6037</a><a class="anker" href="#line6038">6038</a><a class="anker" href="#line6039">6039</a><a class="anker" href="#line6040">6040</a><a class="anker" href="#line6041">6041</a><a class="anker" href="#line6042">6042</a><a class="anker" href="#line6043">6043</a><a class="anker" href="#line6044">6044</a><a class="anker" href="#line6045">6045</a><a class="anker" href="#line6046">6046</a><a class="anker" href="#line6047">6047</a><a class="anker" href="#line6048">6048</a><a class="anker" href="#line6049">6049</a><a class="anker" href="#line6050">6050</a><a class="anker" href="#line6051">6051</a><a class="anker" href="#line6052">6052</a><a class="anker" href="#line6053">6053</a><a class="anker" href="#line6054">6054</a><a class="anker" href="#line6055">6055</a><a class="anker" href="#line6056">6056</a><a class="anker" href="#line6057">6057</a><a class="anker" href="#line6058">6058</a><a class="anker" href="#line6059">6059</a><a class="anker" href="#line6060">6060</a><a class="anker" href="#line6061">6061</a><a class="anker" href="#line6062">6062</a><a class="anker" href="#line6063">6063</a><a class="anker" href="#line6064">6064</a><a class="anker" href="#line6065">6065</a><a class="anker" href="#line6066">6066</a><a class="anker" href="#line6067">6067</a><a class="anker" href="#line6068">6068</a><a class="anker" href="#line6069">6069</a><a class="anker" href="#line6070">6070</a><a class="anker" href="#line6071">6071</a><a class="anker" href="#line6072">6072</a><a class="anker" href="#line6073">6073</a><a class="anker" href="#line6074">6074</a><a class="anker" href="#line6075">6075</a><a class="anker" href="#line6076">6076</a><a class="anker" href="#line6077">6077</a><a class="anker" href="#line6078">6078</a><a class="anker" href="#line6079">6079</a><a class="anker" href="#line6080">6080</a><a class="anker" href="#line6081">6081</a><a class="anker" href="#line6082">6082</a><a class="anker" href="#line6083">6083</a><a class="anker" href="#line6084">6084</a><a class="anker" href="#line6085">6085</a><a class="anker" href="#line6086">6086</a><a class="anker" href="#line6087">6087</a><a class="anker" href="#line6088">6088</a><a class="anker" href="#line6089">6089</a><a class="anker" href="#line6090">6090</a><a class="anker" href="#line6091">6091</a><a class="anker" href="#line6092">6092</a><a class="anker" href="#line6093">6093</a><a class="anker" href="#line6094">6094</a><a class="anker" href="#line6095">6095</a><a class="anker" href="#line6096">6096</a><a class="anker" href="#line6097">6097</a><a class="anker" href="#line6098">6098</a><a class="anker" href="#line6099">6099</a><a class="anker" href="#line6100">6100</a><a class="anker" href="#line6101">6101</a><a class="anker" href="#line6102">6102</a><a class="anker" href="#line6103">6103</a><a class="anker" href="#line6104">6104</a><a class="anker" href="#line6105">6105</a><a class="anker" href="#line6106">6106</a><a class="anker" href="#line6107">6107</a><a class="anker" href="#line6108">6108</a><a class="anker" href="#line6109">6109</a><a class="anker" href="#line6110">6110</a><a class="anker" href="#line6111">6111</a><a class="anker" href="#line6112">6112</a><a class="anker" href="#line6113">6113</a><a class="anker" href="#line6114">6114</a><a class="anker" href="#line6115">6115</a><a class="anker" href="#line6116">6116</a><a class="anker" href="#line6117">6117</a><a class="anker" href="#line6118">6118</a><a class="anker" href="#line6119">6119</a><a class="anker" href="#line6120">6120</a><a class="anker" href="#line6121">6121</a><a class="anker" href="#line6122">6122</a><a class="anker" href="#line6123">6123</a><a class="anker" href="#line6124">6124</a><a class="anker" href="#line6125">6125</a><a class="anker" href="#line6126">6126</a><a class="anker" href="#line6127">6127</a><a class="anker" href="#line6128">6128</a><a class="anker" href="#line6129">6129</a><a class="anker" href="#line6130">6130</a><a class="anker" href="#line6131">6131</a><a class="anker" href="#line6132">6132</a><a class="anker" href="#line6133">6133</a><a class="anker" href="#line6134">6134</a><a class="anker" href="#line6135">6135</a><a class="anker" href="#line6136">6136</a><a class="anker" href="#line6137">6137</a><a class="anker" href="#line6138">6138</a><a class="anker" href="#line6139">6139</a><a class="anker" href="#line6140">6140</a><a class="anker" href="#line6141">6141</a><a class="anker" href="#line6142">6142</a><a class="anker" href="#line6143">6143</a><a class="anker" href="#line6144">6144</a><a class="anker" href="#line6145">6145</a><a class="anker" href="#line6146">6146</a><a class="anker" href="#line6147">6147</a><a class="anker" href="#line6148">6148</a><a class="anker" href="#line6149">6149</a><a class="anker" href="#line6150">6150</a><a class="anker" href="#line6151">6151</a><a class="anker" href="#line6152">6152</a><a class="anker" href="#line6153">6153</a><a class="anker" href="#line6154">6154</a><a class="anker" href="#line6155">6155</a><a class="anker" href="#line6156">6156</a><a class="anker" href="#line6157">6157</a><a class="anker" href="#line6158">6158</a><a class="anker" href="#line6159">6159</a><a class="anker" href="#line6160">6160</a><a class="anker" href="#line6161">6161</a><a class="anker" href="#line6162">6162</a><a class="anker" href="#line6163">6163</a><a class="anker" href="#line6164">6164</a><a class="anker" href="#line6165">6165</a><a class="anker" href="#line6166">6166</a><a class="anker" href="#line6167">6167</a><a class="anker" href="#line6168">6168</a><a class="anker" href="#line6169">6169</a><a class="anker" href="#line6170">6170</a><a class="anker" href="#line6171">6171</a><a class="anker" href="#line6172">6172</a><a class="anker" href="#line6173">6173</a><a class="anker" href="#line6174">6174</a><a class="anker" href="#line6175">6175</a><a class="anker" href="#line6176">6176</a><a class="anker" href="#line6177">6177</a><a class="anker" href="#line6178">6178</a><a class="anker" href="#line6179">6179</a><a class="anker" href="#line6180">6180</a><a class="anker" href="#line6181">6181</a><a class="anker" href="#line6182">6182</a><a class="anker" href="#line6183">6183</a><a class="anker" href="#line6184">6184</a><a class="anker" href="#line6185">6185</a><a class="anker" href="#line6186">6186</a><a class="anker" href="#line6187">6187</a><a class="anker" href="#line6188">6188</a><a class="anker" href="#line6189">6189</a><a class="anker" href="#line6190">6190</a><a class="anker" href="#line6191">6191</a><a class="anker" href="#line6192">6192</a><a class="anker" href="#line6193">6193</a><a class="anker" href="#line6194">6194</a><a class="anker" href="#line6195">6195</a><a class="anker" href="#line6196">6196</a><a class="anker" href="#line6197">6197</a><a class="anker" href="#line6198">6198</a><a class="anker" href="#line6199">6199</a><a class="anker" href="#line6200">6200</a><a class="anker" href="#line6201">6201</a><a class="anker" href="#line6202">6202</a><a class="anker" href="#line6203">6203</a><a class="anker" href="#line6204">6204</a><a class="anker" href="#line6205">6205</a><a class="anker" href="#line6206">6206</a><a class="anker" href="#line6207">6207</a><a class="anker" href="#line6208">6208</a><a class="anker" href="#line6209">6209</a><a class="anker" href="#line6210">6210</a><a class="anker" href="#line6211">6211</a><a class="anker" href="#line6212">6212</a><a class="anker" href="#line6213">6213</a><a class="anker" href="#line6214">6214</a><a class="anker" href="#line6215">6215</a><a class="anker" href="#line6216">6216</a><a class="anker" href="#line6217">6217</a><a class="anker" href="#line6218">6218</a><a class="anker" href="#line6219">6219</a><a class="anker" href="#line6220">6220</a><a class="anker" href="#line6221">6221</a><a class="anker" href="#line6222">6222</a><a class="anker" href="#line6223">6223</a><a class="anker" href="#line6224">6224</a><a class="anker" href="#line6225">6225</a><a class="anker" href="#line6226">6226</a><a class="anker" href="#line6227">6227</a><a class="anker" href="#line6228">6228</a><a class="anker" href="#line6229">6229</a><a class="anker" href="#line6230">6230</a><a class="anker" href="#line6231">6231</a><a class="anker" href="#line6232">6232</a><a class="anker" href="#line6233">6233</a><a class="anker" href="#line6234">6234</a><a class="anker" href="#line6235">6235</a><a class="anker" href="#line6236">6236</a><a class="anker" href="#line6237">6237</a><a class="anker" href="#line6238">6238</a><a class="anker" href="#line6239">6239</a><a class="anker" href="#line6240">6240</a><a class="anker" href="#line6241">6241</a><a class="anker" href="#line6242">6242</a><a class="anker" href="#line6243">6243</a><a class="anker" href="#line6244">6244</a><a class="anker" href="#line6245">6245</a><a class="anker" href="#line6246">6246</a><a class="anker" href="#line6247">6247</a><a class="anker" href="#line6248">6248</a><a class="anker" href="#line6249">6249</a><a class="anker" href="#line6250">6250</a><a class="anker" href="#line6251">6251</a><a class="anker" href="#line6252">6252</a><a class="anker" href="#line6253">6253</a><a class="anker" href="#line6254">6254</a><a class="anker" href="#line6255">6255</a><a class="anker" href="#line6256">6256</a><a class="anker" href="#line6257">6257</a><a class="anker" href="#line6258">6258</a><a class="anker" href="#line6259">6259</a><a class="anker" href="#line6260">6260</a><a class="anker" href="#line6261">6261</a><a class="anker" href="#line6262">6262</a><a class="anker" href="#line6263">6263</a><a class="anker" href="#line6264">6264</a><a class="anker" href="#line6265">6265</a><a class="anker" href="#line6266">6266</a><a class="anker" href="#line6267">6267</a><a class="anker" href="#line6268">6268</a><a class="anker" href="#line6269">6269</a><a class="anker" href="#line6270">6270</a><a class="anker" href="#line6271">6271</a><a class="anker" href="#line6272">6272</a><a class="anker" href="#line6273">6273</a><a class="anker" href="#line6274">6274</a><a class="anker" href="#line6275">6275</a><a class="anker" href="#line6276">6276</a><a class="anker" href="#line6277">6277</a><a class="anker" href="#line6278">6278</a><a class="anker" href="#line6279">6279</a><a class="anker" href="#line6280">6280</a><a class="anker" href="#line6281">6281</a><a class="anker" href="#line6282">6282</a><a class="anker" href="#line6283">6283</a><a class="anker" href="#line6284">6284</a><a class="anker" href="#line6285">6285</a><a class="anker" href="#line6286">6286</a><a class="anker" href="#line6287">6287</a><a class="anker" href="#line6288">6288</a><a class="anker" href="#line6289">6289</a><a class="anker" href="#line6290">6290</a><a class="anker" href="#line6291">6291</a><a class="anker" href="#line6292">6292</a><a class="anker" href="#line6293">6293</a><a class="anker" href="#line6294">6294</a><a class="anker" href="#line6295">6295</a><a class="anker" href="#line6296">6296</a><a class="anker" href="#line6297">6297</a><a class="anker" href="#line6298">6298</a><a class="anker" href="#line6299">6299</a><a class="anker" href="#line6300">6300</a><a class="anker" href="#line6301">6301</a><a class="anker" href="#line6302">6302</a><a class="anker" href="#line6303">6303</a><a class="anker" href="#line6304">6304</a><a class="anker" href="#line6305">6305</a><a class="anker" href="#line6306">6306</a><a class="anker" href="#line6307">6307</a><a class="anker" href="#line6308">6308</a><a class="anker" href="#line6309">6309</a><a class="anker" href="#line6310">6310</a><a class="anker" href="#line6311">6311</a><a class="anker" href="#line6312">6312</a><a class="anker" href="#line6313">6313</a><a class="anker" href="#line6314">6314</a><a class="anker" href="#line6315">6315</a><a class="anker" href="#line6316">6316</a><a class="anker" href="#line6317">6317</a><a class="anker" href="#line6318">6318</a><a class="anker" href="#line6319">6319</a><a class="anker" href="#line6320">6320</a><a class="anker" href="#line6321">6321</a><a class="anker" href="#line6322">6322</a><a class="anker" href="#line6323">6323</a><a class="anker" href="#line6324">6324</a><a class="anker" href="#line6325">6325</a><a class="anker" href="#line6326">6326</a><a class="anker" href="#line6327">6327</a><a class="anker" href="#line6328">6328</a><a class="anker" href="#line6329">6329</a><a class="anker" href="#line6330">6330</a><a class="anker" href="#line6331">6331</a><a class="anker" href="#line6332">6332</a><a class="anker" href="#line6333">6333</a><a class="anker" href="#line6334">6334</a><a class="anker" href="#line6335">6335</a><a class="anker" href="#line6336">6336</a><a class="anker" href="#line6337">6337</a><a class="anker" href="#line6338">6338</a><a class="anker" href="#line6339">6339</a><a class="anker" href="#line6340">6340</a><a class="anker" href="#line6341">6341</a><a class="anker" href="#line6342">6342</a><a class="anker" href="#line6343">6343</a><a class="anker" href="#line6344">6344</a><a class="anker" href="#line6345">6345</a><a class="anker" href="#line6346">6346</a><a class="anker" href="#line6347">6347</a><a class="anker" href="#line6348">6348</a><a class="anker" href="#line6349">6349</a><a class="anker" href="#line6350">6350</a><a class="anker" href="#line6351">6351</a><a class="anker" href="#line6352">6352</a><a class="anker" href="#line6353">6353</a><a class="anker" href="#line6354">6354</a><a class="anker" href="#line6355">6355</a><a class="anker" href="#line6356">6356</a><a class="anker" href="#line6357">6357</a><a class="anker" href="#line6358">6358</a><a class="anker" href="#line6359">6359</a><a class="anker" href="#line6360">6360</a><a class="anker" href="#line6361">6361</a><a class="anker" href="#line6362">6362</a><a class="anker" href="#line6363">6363</a><a class="anker" href="#line6364">6364</a><a class="anker" href="#line6365">6365</a><a class="anker" href="#line6366">6366</a><a class="anker" href="#line6367">6367</a><a class="anker" href="#line6368">6368</a><a class="anker" href="#line6369">6369</a><a class="anker" href="#line6370">6370</a><a class="anker" href="#line6371">6371</a><a class="anker" href="#line6372">6372</a><a class="anker" href="#line6373">6373</a><a class="anker" href="#line6374">6374</a><a class="anker" href="#line6375">6375</a><a class="anker" href="#line6376">6376</a><a class="anker" href="#line6377">6377</a><a class="anker" href="#line6378">6378</a><a class="anker" href="#line6379">6379</a><a class="anker" href="#line6380">6380</a><a class="anker" href="#line6381">6381</a><a class="anker" href="#line6382">6382</a><a class="anker" href="#line6383">6383</a><a class="anker" href="#line6384">6384</a><a class="anker" href="#line6385">6385</a><a class="anker" href="#line6386">6386</a><a class="anker" href="#line6387">6387</a><a class="anker" href="#line6388">6388</a><a class="anker" href="#line6389">6389</a><a class="anker" href="#line6390">6390</a><a class="anker" href="#line6391">6391</a><a class="anker" href="#line6392">6392</a><a class="anker" href="#line6393">6393</a><a class="anker" href="#line6394">6394</a><a class="anker" href="#line6395">6395</a><a class="anker" href="#line6396">6396</a><a class="anker" href="#line6397">6397</a><a class="anker" href="#line6398">6398</a><a class="anker" href="#line6399">6399</a><a class="anker" href="#line6400">6400</a><a class="anker" href="#line6401">6401</a><a class="anker" href="#line6402">6402</a><a class="anker" href="#line6403">6403</a><a class="anker" href="#line6404">6404</a><a class="anker" href="#line6405">6405</a><a class="anker" href="#line6406">6406</a><a class="anker" href="#line6407">6407</a><a class="anker" href="#line6408">6408</a><a class="anker" href="#line6409">6409</a><a class="anker" href="#line6410">6410</a><a class="anker" href="#line6411">6411</a><a class="anker" href="#line6412">6412</a><a class="anker" href="#line6413">6413</a><a class="anker" href="#line6414">6414</a><a class="anker" href="#line6415">6415</a><a class="anker" href="#line6416">6416</a><a class="anker" href="#line6417">6417</a><a class="anker" href="#line6418">6418</a><a class="anker" href="#line6419">6419</a><a class="anker" href="#line6420">6420</a><a class="anker" href="#line6421">6421</a><a class="anker" href="#line6422">6422</a><a class="anker" href="#line6423">6423</a><a class="anker" href="#line6424">6424</a><a class="anker" href="#line6425">6425</a><a class="anker" href="#line6426">6426</a><a class="anker" href="#line6427">6427</a><a class="anker" href="#line6428">6428</a><a class="anker" href="#line6429">6429</a><a class="anker" href="#line6430">6430</a><a class="anker" href="#line6431">6431</a><a class="anker" href="#line6432">6432</a><a class="anker" href="#line6433">6433</a><a class="anker" href="#line6434">6434</a><a class="anker" href="#line6435">6435</a><a class="anker" href="#line6436">6436</a><a class="anker" href="#line6437">6437</a><a class="anker" href="#line6438">6438</a><a class="anker" href="#line6439">6439</a><a class="anker" href="#line6440">6440</a><a class="anker" href="#line6441">6441</a><a class="anker" href="#line6442">6442</a><a class="anker" href="#line6443">6443</a><a class="anker" href="#line6444">6444</a><a class="anker" href="#line6445">6445</a><a class="anker" href="#line6446">6446</a><a class="anker" href="#line6447">6447</a><a class="anker" href="#line6448">6448</a><a class="anker" href="#line6449">6449</a><a class="anker" href="#line6450">6450</a><a class="anker" href="#line6451">6451</a><a class="anker" href="#line6452">6452</a><a class="anker" href="#line6453">6453</a><a class="anker" href="#line6454">6454</a><a class="anker" href="#line6455">6455</a><a class="anker" href="#line6456">6456</a><a class="anker" href="#line6457">6457</a><a class="anker" href="#line6458">6458</a><a class="anker" href="#line6459">6459</a><a class="anker" href="#line6460">6460</a><a class="anker" href="#line6461">6461</a><a class="anker" href="#line6462">6462</a><a class="anker" href="#line6463">6463</a><a class="anker" href="#line6464">6464</a><a class="anker" href="#line6465">6465</a><a class="anker" href="#line6466">6466</a><a class="anker" href="#line6467">6467</a><a class="anker" href="#line6468">6468</a><a class="anker" href="#line6469">6469</a><a class="anker" href="#line6470">6470</a><a class="anker" href="#line6471">6471</a><a class="anker" href="#line6472">6472</a><a class="anker" href="#line6473">6473</a><a class="anker" href="#line6474">6474</a><a class="anker" href="#line6475">6475</a><a class="anker" href="#line6476">6476</a><a class="anker" href="#line6477">6477</a><a class="anker" href="#line6478">6478</a><a class="anker" href="#line6479">6479</a><a class="anker" href="#line6480">6480</a><a class="anker" href="#line6481">6481</a><a class="anker" href="#line6482">6482</a><a class="anker" href="#line6483">6483</a><a class="anker" href="#line6484">6484</a><a class="anker" href="#line6485">6485</a><a class="anker" href="#line6486">6486</a><a class="anker" href="#line6487">6487</a><a class="anker" href="#line6488">6488</a><a class="anker" href="#line6489">6489</a><a class="anker" href="#line6490">6490</a><a class="anker" href="#line6491">6491</a><a class="anker" href="#line6492">6492</a><a class="anker" href="#line6493">6493</a><a class="anker" href="#line6494">6494</a><a class="anker" href="#line6495">6495</a><a class="anker" href="#line6496">6496</a><a class="anker" href="#line6497">6497</a><a class="anker" href="#line6498">6498</a><a class="anker" href="#line6499">6499</a><a class="anker" href="#line6500">6500</a><a class="anker" href="#line6501">6501</a><a class="anker" href="#line6502">6502</a><a class="anker" href="#line6503">6503</a><a class="anker" href="#line6504">6504</a><a class="anker" href="#line6505">6505</a><a class="anker" href="#line6506">6506</a><a class="anker" href="#line6507">6507</a><a class="anker" href="#line6508">6508</a><a class="anker" href="#line6509">6509</a><a class="anker" href="#line6510">6510</a><a class="anker" href="#line6511">6511</a><a class="anker" href="#line6512">6512</a><a class="anker" href="#line6513">6513</a><a class="anker" href="#line6514">6514</a><a class="anker" href="#line6515">6515</a><a class="anker" href="#line6516">6516</a><a class="anker" href="#line6517">6517</a><a class="anker" href="#line6518">6518</a><a class="anker" href="#line6519">6519</a><a class="anker" href="#line6520">6520</a><a class="anker" href="#line6521">6521</a><a class="anker" href="#line6522">6522</a><a class="anker" href="#line6523">6523</a><a class="anker" href="#line6524">6524</a><a class="anker" href="#line6525">6525</a><a class="anker" href="#line6526">6526</a><a class="anker" href="#line6527">6527</a><a class="anker" href="#line6528">6528</a><a class="anker" href="#line6529">6529</a><a class="anker" href="#line6530">6530</a><a class="anker" href="#line6531">6531</a><a class="anker" href="#line6532">6532</a><a class="anker" href="#line6533">6533</a><a class="anker" href="#line6534">6534</a><a class="anker" href="#line6535">6535</a><a class="anker" href="#line6536">6536</a><a class="anker" href="#line6537">6537</a><a class="anker" href="#line6538">6538</a><a class="anker" href="#line6539">6539</a><a class="anker" href="#line6540">6540</a><a class="anker" href="#line6541">6541</a><a class="anker" href="#line6542">6542</a><a class="anker" href="#line6543">6543</a><a class="anker" href="#line6544">6544</a><a class="anker" href="#line6545">6545</a><a class="anker" href="#line6546">6546</a><a class="anker" href="#line6547">6547</a><a class="anker" href="#line6548">6548</a><a class="anker" href="#line6549">6549</a><a class="anker" href="#line6550">6550</a><a class="anker" href="#line6551">6551</a><a class="anker" href="#line6552">6552</a><a class="anker" href="#line6553">6553</a><a class="anker" href="#line6554">6554</a><a class="anker" href="#line6555">6555</a><a class="anker" href="#line6556">6556</a><a class="anker" href="#line6557">6557</a><a class="anker" href="#line6558">6558</a><a class="anker" href="#line6559">6559</a><a class="anker" href="#line6560">6560</a><a class="anker" href="#line6561">6561</a><a class="anker" href="#line6562">6562</a><a class="anker" href="#line6563">6563</a><a class="anker" href="#line6564">6564</a><a class="anker" href="#line6565">6565</a><a class="anker" href="#line6566">6566</a><a class="anker" href="#line6567">6567</a><a class="anker" href="#line6568">6568</a><a class="anker" href="#line6569">6569</a><a class="anker" href="#line6570">6570</a><a class="anker" href="#line6571">6571</a><a class="anker" href="#line6572">6572</a><a class="anker" href="#line6573">6573</a><a class="anker" href="#line6574">6574</a><a class="anker" href="#line6575">6575</a><a class="anker" href="#line6576">6576</a><a class="anker" href="#line6577">6577</a><a class="anker" href="#line6578">6578</a><a class="anker" href="#line6579">6579</a><a class="anker" href="#line6580">6580</a><a class="anker" href="#line6581">6581</a><a class="anker" href="#line6582">6582</a><a class="anker" href="#line6583">6583</a><a class="anker" href="#line6584">6584</a><a class="anker" href="#line6585">6585</a><a class="anker" href="#line6586">6586</a><a class="anker" href="#line6587">6587</a><a class="anker" href="#line6588">6588</a><a class="anker" href="#line6589">6589</a><a class="anker" href="#line6590">6590</a><a class="anker" href="#line6591">6591</a><a class="anker" href="#line6592">6592</a><a class="anker" href="#line6593">6593</a><a class="anker" href="#line6594">6594</a><a class="anker" href="#line6595">6595</a><a class="anker" href="#line6596">6596</a><a class="anker" href="#line6597">6597</a><a class="anker" href="#line6598">6598</a><a class="anker" href="#line6599">6599</a><a class="anker" href="#line6600">6600</a><a class="anker" href="#line6601">6601</a><a class="anker" href="#line6602">6602</a><a class="anker" href="#line6603">6603</a><a class="anker" href="#line6604">6604</a><a class="anker" href="#line6605">6605</a><a class="anker" href="#line6606">6606</a><a class="anker" href="#line6607">6607</a><a class="anker" href="#line6608">6608</a><a class="anker" href="#line6609">6609</a><a class="anker" href="#line6610">6610</a><a class="anker" href="#line6611">6611</a><a class="anker" href="#line6612">6612</a><a class="anker" href="#line6613">6613</a><a class="anker" href="#line6614">6614</a><a class="anker" href="#line6615">6615</a><a class="anker" href="#line6616">6616</a><a class="anker" href="#line6617">6617</a><a class="anker" href="#line6618">6618</a><a class="anker" href="#line6619">6619</a><a class="anker" href="#line6620">6620</a><a class="anker" href="#line6621">6621</a><a class="anker" href="#line6622">6622</a><a class="anker" href="#line6623">6623</a><a class="anker" href="#line6624">6624</a><a class="anker" href="#line6625">6625</a><a class="anker" href="#line6626">6626</a><a class="anker" href="#line6627">6627</a><a class="anker" href="#line6628">6628</a><a class="anker" href="#line6629">6629</a><a class="anker" href="#line6630">6630</a><a class="anker" href="#line6631">6631</a><a class="anker" href="#line6632">6632</a><a class="anker" href="#line6633">6633</a><a class="anker" href="#line6634">6634</a><a class="anker" href="#line6635">6635</a><a class="anker" href="#line6636">6636</a><a class="anker" href="#line6637">6637</a><a class="anker" href="#line6638">6638</a><a class="anker" href="#line6639">6639</a><a class="anker" href="#line6640">6640</a><a class="anker" href="#line6641">6641</a><a class="anker" href="#line6642">6642</a><a class="anker" href="#line6643">6643</a><a class="anker" href="#line6644">6644</a><a class="anker" href="#line6645">6645</a><a class="anker" href="#line6646">6646</a><a class="anker" href="#line6647">6647</a><a class="anker" href="#line6648">6648</a><a class="anker" href="#line6649">6649</a><a class="anker" href="#line6650">6650</a><a class="anker" href="#line6651">6651</a><a class="anker" href="#line6652">6652</a><a class="anker" href="#line6653">6653</a><a class="anker" href="#line6654">6654</a><a class="anker" href="#line6655">6655</a><a class="anker" href="#line6656">6656</a><a class="anker" href="#line6657">6657</a><a class="anker" href="#line6658">6658</a><a class="anker" href="#line6659">6659</a><a class="anker" href="#line6660">6660</a><a class="anker" href="#line6661">6661</a><a class="anker" href="#line6662">6662</a><a class="anker" href="#line6663">6663</a><a class="anker" href="#line6664">6664</a><a class="anker" href="#line6665">6665</a><a class="anker" href="#line6666">6666</a><a class="anker" href="#line6667">6667</a><a class="anker" href="#line6668">6668</a><a class="anker" href="#line6669">6669</a><a class="anker" href="#line6670">6670</a><a class="anker" href="#line6671">6671</a><a class="anker" href="#line6672">6672</a><a class="anker" href="#line6673">6673</a><a class="anker" href="#line6674">6674</a><a class="anker" href="#line6675">6675</a><a class="anker" href="#line6676">6676</a><a class="anker" href="#line6677">6677</a><a class="anker" href="#line6678">6678</a><a class="anker" href="#line6679">6679</a><a class="anker" href="#line6680">6680</a><a class="anker" href="#line6681">6681</a><a class="anker" href="#line6682">6682</a><a class="anker" href="#line6683">6683</a><a class="anker" href="#line6684">6684</a><a class="anker" href="#line6685">6685</a><a class="anker" href="#line6686">6686</a><a class="anker" href="#line6687">6687</a><a class="anker" href="#line6688">6688</a><a class="anker" href="#line6689">6689</a><a class="anker" href="#line6690">6690</a><a class="anker" href="#line6691">6691</a><a class="anker" href="#line6692">6692</a><a class="anker" href="#line6693">6693</a><a class="anker" href="#line6694">6694</a><a class="anker" href="#line6695">6695</a><a class="anker" href="#line6696">6696</a><a class="anker" href="#line6697">6697</a><a class="anker" href="#line6698">6698</a><a class="anker" href="#line6699">6699</a><a class="anker" href="#line6700">6700</a><a class="anker" href="#line6701">6701</a><a class="anker" href="#line6702">6702</a><a class="anker" href="#line6703">6703</a><a class="anker" href="#line6704">6704</a><a class="anker" href="#line6705">6705</a><a class="anker" href="#line6706">6706</a><a class="anker" href="#line6707">6707</a><a class="anker" href="#line6708">6708</a><a class="anker" href="#line6709">6709</a><a class="anker" href="#line6710">6710</a><a class="anker" href="#line6711">6711</a><a class="anker" href="#line6712">6712</a><a class="anker" href="#line6713">6713</a><a class="anker" href="#line6714">6714</a><a class="anker" href="#line6715">6715</a><a class="anker" href="#line6716">6716</a><a class="anker" href="#line6717">6717</a><a class="anker" href="#line6718">6718</a><a class="anker" href="#line6719">6719</a><a class="anker" href="#line6720">6720</a><a class="anker" href="#line6721">6721</a><a class="anker" href="#line6722">6722</a><a class="anker" href="#line6723">6723</a><a class="anker" href="#line6724">6724</a><a class="anker" href="#line6725">6725</a><a class="anker" href="#line6726">6726</a><a class="anker" href="#line6727">6727</a><a class="anker" href="#line6728">6728</a><a class="anker" href="#line6729">6729</a><a class="anker" href="#line6730">6730</a><a class="anker" href="#line6731">6731</a><a class="anker" href="#line6732">6732</a><a class="anker" href="#line6733">6733</a><a class="anker" href="#line6734">6734</a><a class="anker" href="#line6735">6735</a><a class="anker" href="#line6736">6736</a><a class="anker" href="#line6737">6737</a><a class="anker" href="#line6738">6738</a><a class="anker" href="#line6739">6739</a><a class="anker" href="#line6740">6740</a><a class="anker" href="#line6741">6741</a><a class="anker" href="#line6742">6742</a><a class="anker" href="#line6743">6743</a><a class="anker" href="#line6744">6744</a><a class="anker" href="#line6745">6745</a><a class="anker" href="#line6746">6746</a><a class="anker" href="#line6747">6747</a><a class="anker" href="#line6748">6748</a><a class="anker" href="#line6749">6749</a><a class="anker" href="#line6750">6750</a><a class="anker" href="#line6751">6751</a><a class="anker" href="#line6752">6752</a><a class="anker" href="#line6753">6753</a><a class="anker" href="#line6754">6754</a><a class="anker" href="#line6755">6755</a><a class="anker" href="#line6756">6756</a><a class="anker" href="#line6757">6757</a><a class="anker" href="#line6758">6758</a><a class="anker" href="#line6759">6759</a><a class="anker" href="#line6760">6760</a><a class="anker" href="#line6761">6761</a><a class="anker" href="#line6762">6762</a><a class="anker" href="#line6763">6763</a><a class="anker" href="#line6764">6764</a><a class="anker" href="#line6765">6765</a><a class="anker" href="#line6766">6766</a><a class="anker" href="#line6767">6767</a><a class="anker" href="#line6768">6768</a><a class="anker" href="#line6769">6769</a><a class="anker" href="#line6770">6770</a><a class="anker" href="#line6771">6771</a><a class="anker" href="#line6772">6772</a><a class="anker" href="#line6773">6773</a><a class="anker" href="#line6774">6774</a><a class="anker" href="#line6775">6775</a><a class="anker" href="#line6776">6776</a><a class="anker" href="#line6777">6777</a><a class="anker" href="#line6778">6778</a><a class="anker" href="#line6779">6779</a><a class="anker" href="#line6780">6780</a><a class="anker" href="#line6781">6781</a><a class="anker" href="#line6782">6782</a><a class="anker" href="#line6783">6783</a><a class="anker" href="#line6784">6784</a><a class="anker" href="#line6785">6785</a><a class="anker" href="#line6786">6786</a><a class="anker" href="#line6787">6787</a><a class="anker" href="#line6788">6788</a><a class="anker" href="#line6789">6789</a><a class="anker" href="#line6790">6790</a><a class="anker" href="#line6791">6791</a><a class="anker" href="#line6792">6792</a><a class="anker" href="#line6793">6793</a><a class="anker" href="#line6794">6794</a><a class="anker" href="#line6795">6795</a><a class="anker" href="#line6796">6796</a><a class="anker" href="#line6797">6797</a><a class="anker" href="#line6798">6798</a><a class="anker" href="#line6799">6799</a><a class="anker" href="#line6800">6800</a><a class="anker" href="#line6801">6801</a><a class="anker" href="#line6802">6802</a><a class="anker" href="#line6803">6803</a><a class="anker" href="#line6804">6804</a><a class="anker" href="#line6805">6805</a><a class="anker" href="#line6806">6806</a><a class="anker" href="#line6807">6807</a><a class="anker" href="#line6808">6808</a><a class="anker" href="#line6809">6809</a><a class="anker" href="#line6810">6810</a><a class="anker" href="#line6811">6811</a><a class="anker" href="#line6812">6812</a><a class="anker" href="#line6813">6813</a><a class="anker" href="#line6814">6814</a><a class="anker" href="#line6815">6815</a><a class="anker" href="#line6816">6816</a><a class="anker" href="#line6817">6817</a><a class="anker" href="#line6818">6818</a><a class="anker" href="#line6819">6819</a><a class="anker" href="#line6820">6820</a><a class="anker" href="#line6821">6821</a><a class="anker" href="#line6822">6822</a><a class="anker" href="#line6823">6823</a><a class="anker" href="#line6824">6824</a><a class="anker" href="#line6825">6825</a><a class="anker" href="#line6826">6826</a><a class="anker" href="#line6827">6827</a><a class="anker" href="#line6828">6828</a><a class="anker" href="#line6829">6829</a><a class="anker" href="#line6830">6830</a><a class="anker" href="#line6831">6831</a><a class="anker" href="#line6832">6832</a><a class="anker" href="#line6833">6833</a><a class="anker" href="#line6834">6834</a><a class="anker" href="#line6835">6835</a><a class="anker" href="#line6836">6836</a><a class="anker" href="#line6837">6837</a><a class="anker" href="#line6838">6838</a><a class="anker" href="#line6839">6839</a><a class="anker" href="#line6840">6840</a><a class="anker" href="#line6841">6841</a><a class="anker" href="#line6842">6842</a><a class="anker" href="#line6843">6843</a><a class="anker" href="#line6844">6844</a><a class="anker" href="#line6845">6845</a><a class="anker" href="#line6846">6846</a><a class="anker" href="#line6847">6847</a><a class="anker" href="#line6848">6848</a><a class="anker" href="#line6849">6849</a><a class="anker" href="#line6850">6850</a><a class="anker" href="#line6851">6851</a><a class="anker" href="#line6852">6852</a><a class="anker" href="#line6853">6853</a><a class="anker" href="#line6854">6854</a><a class="anker" href="#line6855">6855</a><a class="anker" href="#line6856">6856</a><a class="anker" href="#line6857">6857</a><a class="anker" href="#line6858">6858</a><a class="anker" href="#line6859">6859</a><a class="anker" href="#line6860">6860</a><a class="anker" href="#line6861">6861</a><a class="anker" href="#line6862">6862</a><a class="anker" href="#line6863">6863</a><a class="anker" href="#line6864">6864</a><a class="anker" href="#line6865">6865</a><a class="anker" href="#line6866">6866</a><a class="anker" href="#line6867">6867</a><a class="anker" href="#line6868">6868</a><a class="anker" href="#line6869">6869</a><a class="anker" href="#line6870">6870</a><a class="anker" href="#line6871">6871</a><a class="anker" href="#line6872">6872</a><a class="anker" href="#line6873">6873</a><a class="anker" href="#line6874">6874</a><a class="anker" href="#line6875">6875</a><a class="anker" href="#line6876">6876</a><a class="anker" href="#line6877">6877</a><a class="anker" href="#line6878">6878</a><a class="anker" href="#line6879">6879</a><a class="anker" href="#line6880">6880</a><a class="anker" href="#line6881">6881</a><a class="anker" href="#line6882">6882</a><a class="anker" href="#line6883">6883</a><a class="anker" href="#line6884">6884</a><a class="anker" href="#line6885">6885</a><a class="anker" href="#line6886">6886</a><a class="anker" href="#line6887">6887</a><a class="anker" href="#line6888">6888</a><a class="anker" href="#line6889">6889</a><a class="anker" href="#line6890">6890</a><a class="anker" href="#line6891">6891</a><a class="anker" href="#line6892">6892</a><a class="anker" href="#line6893">6893</a><a class="anker" href="#line6894">6894</a><a class="anker" href="#line6895">6895</a><a class="anker" href="#line6896">6896</a><a class="anker" href="#line6897">6897</a><a class="anker" href="#line6898">6898</a><a class="anker" href="#line6899">6899</a><a class="anker" href="#line6900">6900</a><a class="anker" href="#line6901">6901</a><a class="anker" href="#line6902">6902</a><a class="anker" href="#line6903">6903</a><a class="anker" href="#line6904">6904</a><a class="anker" href="#line6905">6905</a><a class="anker" href="#line6906">6906</a><a class="anker" href="#line6907">6907</a><a class="anker" href="#line6908">6908</a><a class="anker" href="#line6909">6909</a><a class="anker" href="#line6910">6910</a><a class="anker" href="#line6911">6911</a><a class="anker" href="#line6912">6912</a><a class="anker" href="#line6913">6913</a><a class="anker" href="#line6914">6914</a><a class="anker" href="#line6915">6915</a><a class="anker" href="#line6916">6916</a><a class="anker" href="#line6917">6917</a><a class="anker" href="#line6918">6918</a><a class="anker" href="#line6919">6919</a><a class="anker" href="#line6920">6920</a><a class="anker" href="#line6921">6921</a><a class="anker" href="#line6922">6922</a><a class="anker" href="#line6923">6923</a><a class="anker" href="#line6924">6924</a><a class="anker" href="#line6925">6925</a><a class="anker" href="#line6926">6926</a><a class="anker" href="#line6927">6927</a><a class="anker" href="#line6928">6928</a><a class="anker" href="#line6929">6929</a><a class="anker" href="#line6930">6930</a><a class="anker" href="#line6931">6931</a><a class="anker" href="#line6932">6932</a><a class="anker" href="#line6933">6933</a><a class="anker" href="#line6934">6934</a><a class="anker" href="#line6935">6935</a><a class="anker" href="#line6936">6936</a><a class="anker" href="#line6937">6937</a><a class="anker" href="#line6938">6938</a><a class="anker" href="#line6939">6939</a><a class="anker" href="#line6940">6940</a><a class="anker" href="#line6941">6941</a><a class="anker" href="#line6942">6942</a><a class="anker" href="#line6943">6943</a><a class="anker" href="#line6944">6944</a><a class="anker" href="#line6945">6945</a><a class="anker" href="#line6946">6946</a><a class="anker" href="#line6947">6947</a><a class="anker" href="#line6948">6948</a><a class="anker" href="#line6949">6949</a><a class="anker" href="#line6950">6950</a><a class="anker" href="#line6951">6951</a><a class="anker" href="#line6952">6952</a><a class="anker" href="#line6953">6953</a><a class="anker" href="#line6954">6954</a><a class="anker" href="#line6955">6955</a><a class="anker" href="#line6956">6956</a><a class="anker" href="#line6957">6957</a><a class="anker" href="#line6958">6958</a><a class="anker" href="#line6959">6959</a><a class="anker" href="#line6960">6960</a><a class="anker" href="#line6961">6961</a><a class="anker" href="#line6962">6962</a><a class="anker" href="#line6963">6963</a><a class="anker" href="#line6964">6964</a><a class="anker" href="#line6965">6965</a><a class="anker" href="#line6966">6966</a><a class="anker" href="#line6967">6967</a><a class="anker" href="#line6968">6968</a><a class="anker" href="#line6969">6969</a><a class="anker" href="#line6970">6970</a><a class="anker" href="#line6971">6971</a><a class="anker" href="#line6972">6972</a><a class="anker" href="#line6973">6973</a><a class="anker" href="#line6974">6974</a><a class="anker" href="#line6975">6975</a><a class="anker" href="#line6976">6976</a><a class="anker" href="#line6977">6977</a><a class="anker" href="#line6978">6978</a><a class="anker" href="#line6979">6979</a><a class="anker" href="#line6980">6980</a><a class="anker" href="#line6981">6981</a><a class="anker" href="#line6982">6982</a><a class="anker" href="#line6983">6983</a><a class="anker" href="#line6984">6984</a><a class="anker" href="#line6985">6985</a><a class="anker" href="#line6986">6986</a><a class="anker" href="#line6987">6987</a><a class="anker" href="#line6988">6988</a><a class="anker" href="#line6989">6989</a><a class="anker" href="#line6990">6990</a><a class="anker" href="#line6991">6991</a><a class="anker" href="#line6992">6992</a><a class="anker" href="#line6993">6993</a><a class="anker" href="#line6994">6994</a><a class="anker" href="#line6995">6995</a><a class="anker" href="#line6996">6996</a><a class="anker" href="#line6997">6997</a><a class="anker" href="#line6998">6998</a><a class="anker" href="#line6999">6999</a><a class="anker" href="#line7000">7000</a><a class="anker" href="#line7001">7001</a><a class="anker" href="#line7002">7002</a><a class="anker" href="#line7003">7003</a><a class="anker" href="#line7004">7004</a><a class="anker" href="#line7005">7005</a><a class="anker" href="#line7006">7006</a><a class="anker" href="#line7007">7007</a><a class="anker" href="#line7008">7008</a><a class="anker" href="#line7009">7009</a><a class="anker" href="#line7010">7010</a><a class="anker" href="#line7011">7011</a><a class="anker" href="#line7012">7012</a><a class="anker" href="#line7013">7013</a><a class="anker" href="#line7014">7014</a><a class="anker" href="#line7015">7015</a><a class="anker" href="#line7016">7016</a><a class="anker" href="#line7017">7017</a><a class="anker" href="#line7018">7018</a><a class="anker" href="#line7019">7019</a><a class="anker" href="#line7020">7020</a><a class="anker" href="#line7021">7021</a><a class="anker" href="#line7022">7022</a><a class="anker" href="#line7023">7023</a><a class="anker" href="#line7024">7024</a><a class="anker" href="#line7025">7025</a><a class="anker" href="#line7026">7026</a><a class="anker" href="#line7027">7027</a><a class="anker" href="#line7028">7028</a><a class="anker" href="#line7029">7029</a><a class="anker" href="#line7030">7030</a><a class="anker" href="#line7031">7031</a><a class="anker" href="#line7032">7032</a><a class="anker" href="#line7033">7033</a><a class="anker" href="#line7034">7034</a><a class="anker" href="#line7035">7035</a><a class="anker" href="#line7036">7036</a><a class="anker" href="#line7037">7037</a><a class="anker" href="#line7038">7038</a><a class="anker" href="#line7039">7039</a><a class="anker" href="#line7040">7040</a><a class="anker" href="#line7041">7041</a><a class="anker" href="#line7042">7042</a><a class="anker" href="#line7043">7043</a><a class="anker" href="#line7044">7044</a><a class="anker" href="#line7045">7045</a><a class="anker" href="#line7046">7046</a><a class="anker" href="#line7047">7047</a><a class="anker" href="#line7048">7048</a><a class="anker" href="#line7049">7049</a><a class="anker" href="#line7050">7050</a><a class="anker" href="#line7051">7051</a><a class="anker" href="#line7052">7052</a><a class="anker" href="#line7053">7053</a><a class="anker" href="#line7054">7054</a><a class="anker" href="#line7055">7055</a><a class="anker" href="#line7056">7056</a><a class="anker" href="#line7057">7057</a><a class="anker" href="#line7058">7058</a><a class="anker" href="#line7059">7059</a><a class="anker" href="#line7060">7060</a><a class="anker" href="#line7061">7061</a><a class="anker" href="#line7062">7062</a><a class="anker" href="#line7063">7063</a><a class="anker" href="#line7064">7064</a><a class="anker" href="#line7065">7065</a><a class="anker" href="#line7066">7066</a><a class="anker" href="#line7067">7067</a><a class="anker" href="#line7068">7068</a><a class="anker" href="#line7069">7069</a><a class="anker" href="#line7070">7070</a><a class="anker" href="#line7071">7071</a><a class="anker" href="#line7072">7072</a><a class="anker" href="#line7073">7073</a><a class="anker" href="#line7074">7074</a><a class="anker" href="#line7075">7075</a><a class="anker" href="#line7076">7076</a><a class="anker" href="#line7077">7077</a><a class="anker" href="#line7078">7078</a><a class="anker" href="#line7079">7079</a><a class="anker" href="#line7080">7080</a><a class="anker" href="#line7081">7081</a><a class="anker" href="#line7082">7082</a><a class="anker" href="#line7083">7083</a><a class="anker" href="#line7084">7084</a><a class="anker" href="#line7085">7085</a><a class="anker" href="#line7086">7086</a><a class="anker" href="#line7087">7087</a><a class="anker" href="#line7088">7088</a><a class="anker" href="#line7089">7089</a><a class="anker" href="#line7090">7090</a><a class="anker" href="#line7091">7091</a><a class="anker" href="#line7092">7092</a><a class="anker" href="#line7093">7093</a><a class="anker" href="#line7094">7094</a><a class="anker" href="#line7095">7095</a><a class="anker" href="#line7096">7096</a><a class="anker" href="#line7097">7097</a><a class="anker" href="#line7098">7098</a><a class="anker" href="#line7099">7099</a><a class="anker" href="#line7100">7100</a><a class="anker" href="#line7101">7101</a><a class="anker" href="#line7102">7102</a><a class="anker" href="#line7103">7103</a><a class="anker" href="#line7104">7104</a><a class="anker" href="#line7105">7105</a><a class="anker" href="#line7106">7106</a><a class="anker" href="#line7107">7107</a><a class="anker" href="#line7108">7108</a><a class="anker" href="#line7109">7109</a><a class="anker" href="#line7110">7110</a><a class="anker" href="#line7111">7111</a><a class="anker" href="#line7112">7112</a><a class="anker" href="#line7113">7113</a><a class="anker" href="#line7114">7114</a><a class="anker" href="#line7115">7115</a><a class="anker" href="#line7116">7116</a><a class="anker" href="#line7117">7117</a><a class="anker" href="#line7118">7118</a><a class="anker" href="#line7119">7119</a><a class="anker" href="#line7120">7120</a><a class="anker" href="#line7121">7121</a><a class="anker" href="#line7122">7122</a><a class="anker" href="#line7123">7123</a><a class="anker" href="#line7124">7124</a><a class="anker" href="#line7125">7125</a><a class="anker" href="#line7126">7126</a><a class="anker" href="#line7127">7127</a><a class="anker" href="#line7128">7128</a><a class="anker" href="#line7129">7129</a><a class="anker" href="#line7130">7130</a><a class="anker" href="#line7131">7131</a><a class="anker" href="#line7132">7132</a><a class="anker" href="#line7133">7133</a><a class="anker" href="#line7134">7134</a><a class="anker" href="#line7135">7135</a><a class="anker" href="#line7136">7136</a><a class="anker" href="#line7137">7137</a><a class="anker" href="#line7138">7138</a><a class="anker" href="#line7139">7139</a><a class="anker" href="#line7140">7140</a><a class="anker" href="#line7141">7141</a><a class="anker" href="#line7142">7142</a><a class="anker" href="#line7143">7143</a><a class="anker" href="#line7144">7144</a><a class="anker" href="#line7145">7145</a><a class="anker" href="#line7146">7146</a><a class="anker" href="#line7147">7147</a><a class="anker" href="#line7148">7148</a><a class="anker" href="#line7149">7149</a><a class="anker" href="#line7150">7150</a><a class="anker" href="#line7151">7151</a><a class="anker" href="#line7152">7152</a><a class="anker" href="#line7153">7153</a><a class="anker" href="#line7154">7154</a><a class="anker" href="#line7155">7155</a><a class="anker" href="#line7156">7156</a><a class="anker" href="#line7157">7157</a><a class="anker" href="#line7158">7158</a><a class="anker" href="#line7159">7159</a><a class="anker" href="#line7160">7160</a><a class="anker" href="#line7161">7161</a><a class="anker" href="#line7162">7162</a><a class="anker" href="#line7163">7163</a><a class="anker" href="#line7164">7164</a><a class="anker" href="#line7165">7165</a><a class="anker" href="#line7166">7166</a><a class="anker" href="#line7167">7167</a><a class="anker" href="#line7168">7168</a><a class="anker" href="#line7169">7169</a><a class="anker" href="#line7170">7170</a><a class="anker" href="#line7171">7171</a><a class="anker" href="#line7172">7172</a><a class="anker" href="#line7173">7173</a><a class="anker" href="#line7174">7174</a><a class="anker" href="#line7175">7175</a><a class="anker" href="#line7176">7176</a><a class="anker" href="#line7177">7177</a><a class="anker" href="#line7178">7178</a><a class="anker" href="#line7179">7179</a><a class="anker" href="#line7180">7180</a><a class="anker" href="#line7181">7181</a><a class="anker" href="#line7182">7182</a><a class="anker" href="#line7183">7183</a><a class="anker" href="#line7184">7184</a><a class="anker" href="#line7185">7185</a><a class="anker" href="#line7186">7186</a><a class="anker" href="#line7187">7187</a><a class="anker" href="#line7188">7188</a><a class="anker" href="#line7189">7189</a><a class="anker" href="#line7190">7190</a><a class="anker" href="#line7191">7191</a><a class="anker" href="#line7192">7192</a><a class="anker" href="#line7193">7193</a><a class="anker" href="#line7194">7194</a><a class="anker" href="#line7195">7195</a><a class="anker" href="#line7196">7196</a><a class="anker" href="#line7197">7197</a><a class="anker" href="#line7198">7198</a><a class="anker" href="#line7199">7199</a><a class="anker" href="#line7200">7200</a><a class="anker" href="#line7201">7201</a><a class="anker" href="#line7202">7202</a><a class="anker" href="#line7203">7203</a><a class="anker" href="#line7204">7204</a><a class="anker" href="#line7205">7205</a><a class="anker" href="#line7206">7206</a><a class="anker" href="#line7207">7207</a><a class="anker" href="#line7208">7208</a><a class="anker" href="#line7209">7209</a><a class="anker" href="#line7210">7210</a><a class="anker" href="#line7211">7211</a><a class="anker" href="#line7212">7212</a><a class="anker" href="#line7213">7213</a><a class="anker" href="#line7214">7214</a><a class="anker" href="#line7215">7215</a><a class="anker" href="#line7216">7216</a><a class="anker" href="#line7217">7217</a><a class="anker" href="#line7218">7218</a><a class="anker" href="#line7219">7219</a><a class="anker" href="#line7220">7220</a><a class="anker" href="#line7221">7221</a><a class="anker" href="#line7222">7222</a><a class="anker" href="#line7223">7223</a><a class="anker" href="#line7224">7224</a><a class="anker" href="#line7225">7225</a><a class="anker" href="#line7226">7226</a><a class="anker" href="#line7227">7227</a><a class="anker" href="#line7228">7228</a><a class="anker" href="#line7229">7229</a><a class="anker" href="#line7230">7230</a><a class="anker" href="#line7231">7231</a><a class="anker" href="#line7232">7232</a><a class="anker" href="#line7233">7233</a><a class="anker" href="#line7234">7234</a><a class="anker" href="#line7235">7235</a><a class="anker" href="#line7236">7236</a><a class="anker" href="#line7237">7237</a><a class="anker" href="#line7238">7238</a><a class="anker" href="#line7239">7239</a><a class="anker" href="#line7240">7240</a><a class="anker" href="#line7241">7241</a><a class="anker" href="#line7242">7242</a><a class="anker" href="#line7243">7243</a><a class="anker" href="#line7244">7244</a><a class="anker" href="#line7245">7245</a><a class="anker" href="#line7246">7246</a><a class="anker" href="#line7247">7247</a><a class="anker" href="#line7248">7248</a><a class="anker" href="#line7249">7249</a><a class="anker" href="#line7250">7250</a><a class="anker" href="#line7251">7251</a><a class="anker" href="#line7252">7252</a><a class="anker" href="#line7253">7253</a><a class="anker" href="#line7254">7254</a><a class="anker" href="#line7255">7255</a><a class="anker" href="#line7256">7256</a><a class="anker" href="#line7257">7257</a><a class="anker" href="#line7258">7258</a><a class="anker" href="#line7259">7259</a><a class="anker" href="#line7260">7260</a><a class="anker" href="#line7261">7261</a><a class="anker" href="#line7262">7262</a><a class="anker" href="#line7263">7263</a><a class="anker" href="#line7264">7264</a><a class="anker" href="#line7265">7265</a><a class="anker" href="#line7266">7266</a><a class="anker" href="#line7267">7267</a><a class="anker" href="#line7268">7268</a><a class="anker" href="#line7269">7269</a><a class="anker" href="#line7270">7270</a><a class="anker" href="#line7271">7271</a><a class="anker" href="#line7272">7272</a><a class="anker" href="#line7273">7273</a><a class="anker" href="#line7274">7274</a><a class="anker" href="#line7275">7275</a><a class="anker" href="#line7276">7276</a><a class="anker" href="#line7277">7277</a><a class="anker" href="#line7278">7278</a><a class="anker" href="#line7279">7279</a><a class="anker" href="#line7280">7280</a><a class="anker" href="#line7281">7281</a><a class="anker" href="#line7282">7282</a><a class="anker" href="#line7283">7283</a><a class="anker" href="#line7284">7284</a><a class="anker" href="#line7285">7285</a><a class="anker" href="#line7286">7286</a><a class="anker" href="#line7287">7287</a><a class="anker" href="#line7288">7288</a><a class="anker" href="#line7289">7289</a><a class="anker" href="#line7290">7290</a><a class="anker" href="#line7291">7291</a><a class="anker" href="#line7292">7292</a><a class="anker" href="#line7293">7293</a><a class="anker" href="#line7294">7294</a><a class="anker" href="#line7295">7295</a><a class="anker" href="#line7296">7296</a><a class="anker" href="#line7297">7297</a><a class="anker" href="#line7298">7298</a><a class="anker" href="#line7299">7299</a><a class="anker" href="#line7300">7300</a><a class="anker" href="#line7301">7301</a><a class="anker" href="#line7302">7302</a><a class="anker" href="#line7303">7303</a><a class="anker" href="#line7304">7304</a><a class="anker" href="#line7305">7305</a><a class="anker" href="#line7306">7306</a><a class="anker" href="#line7307">7307</a><a class="anker" href="#line7308">7308</a><a class="anker" href="#line7309">7309</a><a class="anker" href="#line7310">7310</a><a class="anker" href="#line7311">7311</a><a class="anker" href="#line7312">7312</a><a class="anker" href="#line7313">7313</a><a class="anker" href="#line7314">7314</a><a class="anker" href="#line7315">7315</a><a class="anker" href="#line7316">7316</a><a class="anker" href="#line7317">7317</a><a class="anker" href="#line7318">7318</a><a class="anker" href="#line7319">7319</a><a class="anker" href="#line7320">7320</a><a class="anker" href="#line7321">7321</a><a class="anker" href="#line7322">7322</a><a class="anker" href="#line7323">7323</a><a class="anker" href="#line7324">7324</a><a class="anker" href="#line7325">7325</a><a class="anker" href="#line7326">7326</a><a class="anker" href="#line7327">7327</a><a class="anker" href="#line7328">7328</a><a class="anker" href="#line7329">7329</a><a class="anker" href="#line7330">7330</a><a class="anker" href="#line7331">7331</a><a class="anker" href="#line7332">7332</a><a class="anker" href="#line7333">7333</a><a class="anker" href="#line7334">7334</a><a class="anker" href="#line7335">7335</a><a class="anker" href="#line7336">7336</a><a class="anker" href="#line7337">7337</a><a class="anker" href="#line7338">7338</a><a class="anker" href="#line7339">7339</a><a class="anker" href="#line7340">7340</a><a class="anker" href="#line7341">7341</a><a class="anker" href="#line7342">7342</a><a class="anker" href="#line7343">7343</a><a class="anker" href="#line7344">7344</a><a class="anker" href="#line7345">7345</a><a class="anker" href="#line7346">7346</a><a class="anker" href="#line7347">7347</a><a class="anker" href="#line7348">7348</a><a class="anker" href="#line7349">7349</a><a class="anker" href="#line7350">7350</a><a class="anker" href="#line7351">7351</a><a class="anker" href="#line7352">7352</a><a class="anker" href="#line7353">7353</a><a class="anker" href="#line7354">7354</a><a class="anker" href="#line7355">7355</a><a class="anker" href="#line7356">7356</a><a class="anker" href="#line7357">7357</a><a class="anker" href="#line7358">7358</a><a class="anker" href="#line7359">7359</a><a class="anker" href="#line7360">7360</a><a class="anker" href="#line7361">7361</a><a class="anker" href="#line7362">7362</a><a class="anker" href="#line7363">7363</a><a class="anker" href="#line7364">7364</a><a class="anker" href="#line7365">7365</a><a class="anker" href="#line7366">7366</a><a class="anker" href="#line7367">7367</a><a class="anker" href="#line7368">7368</a><a class="anker" href="#line7369">7369</a><a class="anker" href="#line7370">7370</a><a class="anker" href="#line7371">7371</a><a class="anker" href="#line7372">7372</a><a class="anker" href="#line7373">7373</a><a class="anker" href="#line7374">7374</a><a class="anker" href="#line7375">7375</a><a class="anker" href="#line7376">7376</a><a class="anker" href="#line7377">7377</a><a class="anker" href="#line7378">7378</a><a class="anker" href="#line7379">7379</a><a class="anker" href="#line7380">7380</a><a class="anker" href="#line7381">7381</a><a class="anker" href="#line7382">7382</a><a class="anker" href="#line7383">7383</a><a class="anker" href="#line7384">7384</a><a class="anker" href="#line7385">7385</a><a class="anker" href="#line7386">7386</a><a class="anker" href="#line7387">7387</a><a class="anker" href="#line7388">7388</a><a class="anker" href="#line7389">7389</a><a class="anker" href="#line7390">7390</a><a class="anker" href="#line7391">7391</a><a class="anker" href="#line7392">7392</a><a class="anker" href="#line7393">7393</a><a class="anker" href="#line7394">7394</a><a class="anker" href="#line7395">7395</a><a class="anker" href="#line7396">7396</a><a class="anker" href="#line7397">7397</a><a class="anker" href="#line7398">7398</a><a class="anker" href="#line7399">7399</a><a class="anker" href="#line7400">7400</a><a class="anker" href="#line7401">7401</a><a class="anker" href="#line7402">7402</a><a class="anker" href="#line7403">7403</a><a class="anker" href="#line7404">7404</a><a class="anker" href="#line7405">7405</a><a class="anker" href="#line7406">7406</a><a class="anker" href="#line7407">7407</a><a class="anker" href="#line7408">7408</a><a class="anker" href="#line7409">7409</a><a class="anker" href="#line7410">7410</a><a class="anker" href="#line7411">7411</a><a class="anker" href="#line7412">7412</a><a class="anker" href="#line7413">7413</a><a class="anker" href="#line7414">7414</a><a class="anker" href="#line7415">7415</a><a class="anker" href="#line7416">7416</a><a class="anker" href="#line7417">7417</a><a class="anker" href="#line7418">7418</a><a class="anker" href="#line7419">7419</a><a class="anker" href="#line7420">7420</a><a class="anker" href="#line7421">7421</a><a class="anker" href="#line7422">7422</a><a class="anker" href="#line7423">7423</a><a class="anker" href="#line7424">7424</a><a class="anker" href="#line7425">7425</a><a class="anker" href="#line7426">7426</a><a class="anker" href="#line7427">7427</a><a class="anker" href="#line7428">7428</a><a class="anker" href="#line7429">7429</a><a class="anker" href="#line7430">7430</a><a class="anker" href="#line7431">7431</a><a class="anker" href="#line7432">7432</a><a class="anker" href="#line7433">7433</a><a class="anker" href="#line7434">7434</a><a class="anker" href="#line7435">7435</a><a class="anker" href="#line7436">7436</a><a class="anker" href="#line7437">7437</a><a class="anker" href="#line7438">7438</a><a class="anker" href="#line7439">7439</a><a class="anker" href="#line7440">7440</a><a class="anker" href="#line7441">7441</a><a class="anker" href="#line7442">7442</a><a class="anker" href="#line7443">7443</a><a class="anker" href="#line7444">7444</a><a class="anker" href="#line7445">7445</a><a class="anker" href="#line7446">7446</a><a class="anker" href="#line7447">7447</a><a class="anker" href="#line7448">7448</a><a class="anker" href="#line7449">7449</a><a class="anker" href="#line7450">7450</a><a class="anker" href="#line7451">7451</a><a class="anker" href="#line7452">7452</a><a class="anker" href="#line7453">7453</a><a class="anker" href="#line7454">7454</a><a class="anker" href="#line7455">7455</a><a class="anker" href="#line7456">7456</a><a class="anker" href="#line7457">7457</a><a class="anker" href="#line7458">7458</a><a class="anker" href="#line7459">7459</a><a class="anker" href="#line7460">7460</a><a class="anker" href="#line7461">7461</a><a class="anker" href="#line7462">7462</a><a class="anker" href="#line7463">7463</a><a class="anker" href="#line7464">7464</a><a class="anker" href="#line7465">7465</a><a class="anker" href="#line7466">7466</a><a class="anker" href="#line7467">7467</a><a class="anker" href="#line7468">7468</a><a class="anker" href="#line7469">7469</a><a class="anker" href="#line7470">7470</a><a class="anker" href="#line7471">7471</a><a class="anker" href="#line7472">7472</a><a class="anker" href="#line7473">7473</a><a class="anker" href="#line7474">7474</a><a class="anker" href="#line7475">7475</a><a class="anker" href="#line7476">7476</a><a class="anker" href="#line7477">7477</a><a class="anker" href="#line7478">7478</a><a class="anker" href="#line7479">7479</a><a class="anker" href="#line7480">7480</a><a class="anker" href="#line7481">7481</a><a class="anker" href="#line7482">7482</a><a class="anker" href="#line7483">7483</a><a class="anker" href="#line7484">7484</a><a class="anker" href="#line7485">7485</a><a class="anker" href="#line7486">7486</a><a class="anker" href="#line7487">7487</a><a class="anker" href="#line7488">7488</a><a class="anker" href="#line7489">7489</a><a class="anker" href="#line7490">7490</a><a class="anker" href="#line7491">7491</a><a class="anker" href="#line7492">7492</a><a class="anker" href="#line7493">7493</a><a class="anker" href="#line7494">7494</a><a class="anker" href="#line7495">7495</a><a class="anker" href="#line7496">7496</a><a class="anker" href="#line7497">7497</a><a class="anker" href="#line7498">7498</a><a class="anker" href="#line7499">7499</a><a class="anker" href="#line7500">7500</a><a class="anker" href="#line7501">7501</a><a class="anker" href="#line7502">7502</a><a class="anker" href="#line7503">7503</a><a class="anker" href="#line7504">7504</a><a class="anker" href="#line7505">7505</a><a class="anker" href="#line7506">7506</a><a class="anker" href="#line7507">7507</a><a class="anker" href="#line7508">7508</a><a class="anker" href="#line7509">7509</a><a class="anker" href="#line7510">7510</a><a class="anker" href="#line7511">7511</a><a class="anker" href="#line7512">7512</a><a class="anker" href="#line7513">7513</a><a class="anker" href="#line7514">7514</a><a class="anker" href="#line7515">7515</a><a class="anker" href="#line7516">7516</a><a class="anker" href="#line7517">7517</a><a class="anker" href="#line7518">7518</a><a class="anker" href="#line7519">7519</a><a class="anker" href="#line7520">7520</a><a class="anker" href="#line7521">7521</a><a class="anker" href="#line7522">7522</a><a class="anker" href="#line7523">7523</a><a class="anker" href="#line7524">7524</a><a class="anker" href="#line7525">7525</a><a class="anker" href="#line7526">7526</a><a class="anker" href="#line7527">7527</a><a class="anker" href="#line7528">7528</a><a class="anker" href="#line7529">7529</a><a class="anker" href="#line7530">7530</a><a class="anker" href="#line7531">7531</a><a class="anker" href="#line7532">7532</a><a class="anker" href="#line7533">7533</a><a class="anker" href="#line7534">7534</a><a class="anker" href="#line7535">7535</a><a class="anker" href="#line7536">7536</a><a class="anker" href="#line7537">7537</a><a class="anker" href="#line7538">7538</a><a class="anker" href="#line7539">7539</a><a class="anker" href="#line7540">7540</a><a class="anker" href="#line7541">7541</a><a class="anker" href="#line7542">7542</a><a class="anker" href="#line7543">7543</a><a class="anker" href="#line7544">7544</a><a class="anker" href="#line7545">7545</a><a class="anker" href="#line7546">7546</a><a class="anker" href="#line7547">7547</a><a class="anker" href="#line7548">7548</a><a class="anker" href="#line7549">7549</a><a class="anker" href="#line7550">7550</a><a class="anker" href="#line7551">7551</a><a class="anker" href="#line7552">7552</a><a class="anker" href="#line7553">7553</a><a class="anker" href="#line7554">7554</a><a class="anker" href="#line7555">7555</a><a class="anker" href="#line7556">7556</a><a class="anker" href="#line7557">7557</a><a class="anker" href="#line7558">7558</a><a class="anker" href="#line7559">7559</a><a class="anker" href="#line7560">7560</a><a class="anker" href="#line7561">7561</a><a class="anker" href="#line7562">7562</a><a class="anker" href="#line7563">7563</a><a class="anker" href="#line7564">7564</a><a class="anker" href="#line7565">7565</a><a class="anker" href="#line7566">7566</a><a class="anker" href="#line7567">7567</a><a class="anker" href="#line7568">7568</a><a class="anker" href="#line7569">7569</a><a class="anker" href="#line7570">7570</a><a class="anker" href="#line7571">7571</a><a class="anker" href="#line7572">7572</a><a class="anker" href="#line7573">7573</a><a class="anker" href="#line7574">7574</a><a class="anker" href="#line7575">7575</a><a class="anker" href="#line7576">7576</a><a class="anker" href="#line7577">7577</a><a class="anker" href="#line7578">7578</a><a class="anker" href="#line7579">7579</a><a class="anker" href="#line7580">7580</a><a class="anker" href="#line7581">7581</a><a class="anker" href="#line7582">7582</a><a class="anker" href="#line7583">7583</a><a class="anker" href="#line7584">7584</a><a class="anker" href="#line7585">7585</a><a class="anker" href="#line7586">7586</a><a class="anker" href="#line7587">7587</a><a class="anker" href="#line7588">7588</a><a class="anker" href="#line7589">7589</a><a class="anker" href="#line7590">7590</a><a class="anker" href="#line7591">7591</a><a class="anker" href="#line7592">7592</a><a class="anker" href="#line7593">7593</a><a class="anker" href="#line7594">7594</a><a class="anker" href="#line7595">7595</a><a class="anker" href="#line7596">7596</a><a class="anker" href="#line7597">7597</a><a class="anker" href="#line7598">7598</a><a class="anker" href="#line7599">7599</a><a class="anker" href="#line7600">7600</a><a class="anker" href="#line7601">7601</a><a class="anker" href="#line7602">7602</a><a class="anker" href="#line7603">7603</a><a class="anker" href="#line7604">7604</a><a class="anker" href="#line7605">7605</a><a class="anker" href="#line7606">7606</a><a class="anker" href="#line7607">7607</a><a class="anker" href="#line7608">7608</a><a class="anker" href="#line7609">7609</a><a class="anker" href="#line7610">7610</a><a class="anker" href="#line7611">7611</a><a class="anker" href="#line7612">7612</a><a class="anker" href="#line7613">7613</a><a class="anker" href="#line7614">7614</a><a class="anker" href="#line7615">7615</a><a class="anker" href="#line7616">7616</a><a class="anker" href="#line7617">7617</a><a class="anker" href="#line7618">7618</a><a class="anker" href="#line7619">7619</a><a class="anker" href="#line7620">7620</a><a class="anker" href="#line7621">7621</a><a class="anker" href="#line7622">7622</a><a class="anker" href="#line7623">7623</a><a class="anker" href="#line7624">7624</a><a class="anker" href="#line7625">7625</a><a class="anker" href="#line7626">7626</a><a class="anker" href="#line7627">7627</a><a class="anker" href="#line7628">7628</a><a class="anker" href="#line7629">7629</a><a class="anker" href="#line7630">7630</a><a class="anker" href="#line7631">7631</a><a class="anker" href="#line7632">7632</a><a class="anker" href="#line7633">7633</a><a class="anker" href="#line7634">7634</a><a class="anker" href="#line7635">7635</a><a class="anker" href="#line7636">7636</a><a class="anker" href="#line7637">7637</a><a class="anker" href="#line7638">7638</a><a class="anker" href="#line7639">7639</a><a class="anker" href="#line7640">7640</a><a class="anker" href="#line7641">7641</a><a class="anker" href="#line7642">7642</a><a class="anker" href="#line7643">7643</a><a class="anker" href="#line7644">7644</a><a class="anker" href="#line7645">7645</a><a class="anker" href="#line7646">7646</a><a class="anker" href="#line7647">7647</a><a class="anker" href="#line7648">7648</a><a class="anker" href="#line7649">7649</a><a class="anker" href="#line7650">7650</a><a class="anker" href="#line7651">7651</a><a class="anker" href="#line7652">7652</a><a class="anker" href="#line7653">7653</a></td><td class="line"><div id="line1"><pre><span class="token T_OPEN_TAG">&lt;?php</span></pre></div><div id="line2"><br/></div><div id="line3"><pre><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line4"><pre><span class="token T_DOC_COMMENT"> * Akeeba Restore</span></pre></div><div id="line5"><pre><span class="token T_DOC_COMMENT"> * A JSON-powered JPA, JPS and ZIP archive extraction library</span></pre></div><div id="line6"><pre><span class="token T_DOC_COMMENT"> *</span></pre></div><div id="line7"><pre><span class="token T_DOC_COMMENT"> * @copyright   2010-2014 Nicholas K. Dionysopoulos / Akeeba Ltd.</span></pre></div><div id="line8"><pre><span class="token T_DOC_COMMENT"> * @license     GNU GPL v2 or - at your option - any later version</span></pre></div><div id="line9"><pre><span class="token T_DOC_COMMENT"> * @package     akeebabackup</span></pre></div><div id="line10"><pre><span class="token T_DOC_COMMENT"> * @subpackage  kickstart</span></pre></div><div id="line11"><pre><span class="token T_DOC_COMMENT"> */</span></pre></div><div id="line12"><br/></div><div id="line13"><pre><span class="token T_STRING">define</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'_AKEEBA_RESTORATION'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line14"><pre><span class="token T_STRING">defined</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'DS'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_LOGICAL_OR">or</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">define</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'DS'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">DIRECTORY_SEPARATOR</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line15"><br/></div><div id="line16"><pre><span class="token T_COMMENT">// Unarchiver run states</span></pre></div><div id="line17"><pre><span class="token T_STRING">define</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'AK_STATE_NOFILE'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_COMMENT">// File header not read yet</span></pre></div><div id="line18"><pre><span class="token T_STRING">define</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'AK_STATE_HEADER'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_COMMENT">// File header read; ready to process data</span></pre></div><div id="line19"><pre><span class="token T_STRING">define</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'AK_STATE_DATA'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">2</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_COMMENT">// Processing file data</span></pre></div><div id="line20"><pre><span class="token T_STRING">define</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'AK_STATE_DATAREAD'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">3</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_COMMENT">// Finished processing file data; ready to post-process</span></pre></div><div id="line21"><pre><span class="token T_STRING">define</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'AK_STATE_POSTPROC'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_COMMENT">// Post-processing</span></pre></div><div id="line22"><pre><span class="token T_STRING">define</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'AK_STATE_DONE'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">5</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_COMMENT">// Done with post-processing</span></pre></div><div id="line23"><br/></div><div id="line24"><pre><span class="token T_COMMENT">/* Windows system detection */</span></pre></div><div id="line25"><pre><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">defined</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'_AKEEBA_IS_WINDOWS'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line26"><pre><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line27"><pre><span class="token T_WHITESPACE">	</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">function_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'php_uname'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line28"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line29"><pre><span class="token T_WHITESPACE">		</span><span class="token T_STRING">define</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'_AKEEBA_IS_WINDOWS'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">stristr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">php_uname</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'windows'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line30"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line31"><pre><span class="token T_WHITESPACE">	</span><span class="token T_ELSE">else</span></pre></div><div id="line32"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line33"><pre><span class="token T_WHITESPACE">		</span><span class="token T_STRING">define</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'_AKEEBA_IS_WINDOWS'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">DIRECTORY_SEPARATOR</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'\\'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line34"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line35"><pre><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line36"><br/></div><div id="line37"><pre><span class="token T_COMMENT">// Get the file's root</span></pre></div><div id="line38"><pre><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">defined</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'KSROOTDIR'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line39"><pre><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line40"><pre><span class="token T_WHITESPACE">	</span><span class="token T_STRING">define</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'KSROOTDIR'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">dirname</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_FILE">__FILE__</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line41"><pre><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line42"><pre><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">defined</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'KSLANGDIR'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line43"><pre><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line44"><pre><span class="token T_WHITESPACE">	</span><span class="token T_STRING">define</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'KSLANGDIR'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">KSROOTDIR</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line45"><pre><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line46"><br/></div><div id="line47"><pre><span class="token T_COMMENT">// Make sure the locale is correct for basename() to work</span></pre></div><div id="line48"><pre><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">function_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'setlocale'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line49"><pre><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line50"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">setlocale</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">LC_ALL</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'en_US.UTF8'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line51"><pre><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line52"><br/></div><div id="line53"><pre><span class="token T_COMMENT">// fnmatch not available on non-POSIX systems</span></pre></div><div id="line54"><pre><span class="token T_COMMENT">// Thanks to soywiz@php.net for this usefull alternative function [http://gr2.php.net/fnmatch]</span></pre></div><div id="line55"><pre><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">function_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'fnmatch'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line56"><pre><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line57"><pre><span class="token T_WHITESPACE">	</span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">fnmatch</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$pattern</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$string</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line58"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line59"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">preg_match</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span></pre></div><div id="line60"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/^'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strtr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">addcslashes</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$pattern</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/\\.+^$(){}=!&lt;&gt;|'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line61"><pre><span class="token T_WHITESPACE">				</span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'*'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'.*'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'?'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'.?'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'$/i'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$string</span></pre></div><div id="line62"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line63"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line64"><pre><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line65"><br/></div><div id="line66"><pre><span class="token T_COMMENT">// Unicode-safe binary data length function</span></pre></div><div id="line67"><pre><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">function_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'akstringlen'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line68"><pre><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line69"><pre><span class="token T_WHITESPACE">	</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">function_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'mb_strlen'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line70"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line71"><pre><span class="token T_WHITESPACE">		</span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">akstringlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$string</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line72"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line73"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">mb_strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$string</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'8bit'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line74"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line75"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line76"><pre><span class="token T_WHITESPACE">	</span><span class="token T_ELSE">else</span></pre></div><div id="line77"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line78"><pre><span class="token T_WHITESPACE">		</span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">akstringlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$string</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line79"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line80"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$string</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line81"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line82"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line83"><pre><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line84"><br/></div><div id="line85"><pre><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line86"><pre><span class="token T_DOC_COMMENT"> * Gets a query parameter from GET or POST data</span></pre></div><div id="line87"><pre><span class="token T_DOC_COMMENT"> *</span></pre></div><div id="line88"><pre><span class="token T_DOC_COMMENT"> * @param $key</span></pre></div><div id="line89"><pre><span class="token T_DOC_COMMENT"> * @param $default</span></pre></div><div id="line90"><pre><span class="token T_DOC_COMMENT"> */</span></pre></div><div id="line91"><pre><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">getQueryParam</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$key</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$default</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line92"><pre><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line93"><pre><span class="token T_WHITESPACE">	</span><span class="token T_VARIABLE">$value</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$default</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line94"><br/></div><div id="line95"><pre><span class="token T_WHITESPACE">	</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">array_key_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$key</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$_REQUEST</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line96"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line97"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$value</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$_REQUEST</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$key</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line98"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line99"><br/></div><div id="line100"><pre><span class="token T_WHITESPACE">	</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">get_magic_quotes_gpc</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">is_null</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line101"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line102"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$value</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">stripslashes</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line103"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line104"><br/></div><div id="line105"><pre><span class="token T_WHITESPACE">	</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line106"><pre><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line107"><br/></div><div id="line108"><pre><span class="token T_COMMENT">// Debugging function</span></pre></div><div id="line109"><pre><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$msg</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line110"><pre><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line111"><pre><span class="token T_WHITESPACE">	</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">defined</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'KSDEBUG'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line112"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line113"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line114"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line115"><br/></div><div id="line116"><pre><span class="token T_WHITESPACE">	</span><span class="token T_VARIABLE">$fp</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">fopen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'debug.txt'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'at'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line117"><br/></div><div id="line118"><pre><span class="token T_WHITESPACE">	</span><span class="token T_STRING">fwrite</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$msg</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">"\n"</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line119"><pre><span class="token T_WHITESPACE">	</span><span class="token T_STRING">fclose</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$fp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line120"><pre><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line121"><br/></div><div id="line122"><pre><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line123"><pre><span class="token T_DOC_COMMENT"> * Akeeba Restore</span></pre></div><div id="line124"><pre><span class="token T_DOC_COMMENT"> * A JSON-powered JPA, JPS and ZIP archive extraction library</span></pre></div><div id="line125"><pre><span class="token T_DOC_COMMENT"> *</span></pre></div><div id="line126"><pre><span class="token T_DOC_COMMENT"> * @copyright   2010-2014 Nicholas K. Dionysopoulos / Akeeba Ltd.</span></pre></div><div id="line127"><pre><span class="token T_DOC_COMMENT"> * @license     GNU GPL v2 or - at your option - any later version</span></pre></div><div id="line128"><pre><span class="token T_DOC_COMMENT"> * @package     akeebabackup</span></pre></div><div id="line129"><pre><span class="token T_DOC_COMMENT"> * @subpackage  kickstart</span></pre></div><div id="line130"><pre><span class="token T_DOC_COMMENT"> */</span></pre></div><div id="line131"><br/></div><div id="line132"><pre><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line133"><pre><span class="token T_DOC_COMMENT"> * Akeeba Backup's JSON compatibility layer</span></pre></div><div id="line134"><pre><span class="token T_DOC_COMMENT"> *</span></pre></div><div id="line135"><pre><span class="token T_DOC_COMMENT"> * On systems where json_encode and json_decode are not available, Akeeba</span></pre></div><div id="line136"><pre><span class="token T_DOC_COMMENT"> * Backup will attempt to use PEAR's Services_JSON library to emulate them.</span></pre></div><div id="line137"><pre><span class="token T_DOC_COMMENT"> * A copy of this library is included in this file and will be used if and</span></pre></div><div id="line138"><pre><span class="token T_DOC_COMMENT"> * only if it isn't already loaded, e.g. due to PEAR's auto-loading, or a</span></pre></div><div id="line139"><pre><span class="token T_DOC_COMMENT"> * 3PD extension loading it for its own purposes.</span></pre></div><div id="line140"><pre><span class="token T_DOC_COMMENT"> */</span></pre></div><div id="line141"><br/></div><div id="line142"><pre><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line143"><pre><span class="token T_DOC_COMMENT"> * Converts to and from JSON format.</span></pre></div><div id="line144"><pre><span class="token T_DOC_COMMENT"> *</span></pre></div><div id="line145"><pre><span class="token T_DOC_COMMENT"> * JSON (JavaScript Object Notation) is a lightweight data-interchange</span></pre></div><div id="line146"><pre><span class="token T_DOC_COMMENT"> * format. It is easy for humans to read and write. It is easy for machines</span></pre></div><div id="line147"><pre><span class="token T_DOC_COMMENT"> * to parse and generate. It is based on a subset of the JavaScript</span></pre></div><div id="line148"><pre><span class="token T_DOC_COMMENT"> * Programming Language, Standard ECMA-262 3rd Edition - December 1999.</span></pre></div><div id="line149"><pre><span class="token T_DOC_COMMENT"> * This feature can also be found in  Python. JSON is a text format that is</span></pre></div><div id="line150"><pre><span class="token T_DOC_COMMENT"> * completely language independent but uses conventions that are familiar</span></pre></div><div id="line151"><pre><span class="token T_DOC_COMMENT"> * to programmers of the C-family of languages, including C, C++, C#, Java,</span></pre></div><div id="line152"><pre><span class="token T_DOC_COMMENT"> * JavaScript, Perl, TCL, and many others. These properties make JSON an</span></pre></div><div id="line153"><pre><span class="token T_DOC_COMMENT"> * ideal data-interchange language.</span></pre></div><div id="line154"><pre><span class="token T_DOC_COMMENT"> *</span></pre></div><div id="line155"><pre><span class="token T_DOC_COMMENT"> * This package provides a simple encoder and decoder for JSON notation. It</span></pre></div><div id="line156"><pre><span class="token T_DOC_COMMENT"> * is intended for use with client-side Javascript applications that make</span></pre></div><div id="line157"><pre><span class="token T_DOC_COMMENT"> * use of HTTPRequest to perform server communication functions - data can</span></pre></div><div id="line158"><pre><span class="token T_DOC_COMMENT"> * be encoded into JSON notation for use in a client-side javascript, or</span></pre></div><div id="line159"><pre><span class="token T_DOC_COMMENT"> * decoded from incoming Javascript requests. JSON format is native to</span></pre></div><div id="line160"><pre><span class="token T_DOC_COMMENT"> * Javascript, and can be directly eval()'ed with no further parsing</span></pre></div><div id="line161"><pre><span class="token T_DOC_COMMENT"> * overhead</span></pre></div><div id="line162"><pre><span class="token T_DOC_COMMENT"> *</span></pre></div><div id="line163"><pre><span class="token T_DOC_COMMENT"> * All strings should be in ASCII or UTF-8 format!</span></pre></div><div id="line164"><pre><span class="token T_DOC_COMMENT"> *</span></pre></div><div id="line165"><pre><span class="token T_DOC_COMMENT"> * LICENSE: Redistribution and use in source and binary forms, with or</span></pre></div><div id="line166"><pre><span class="token T_DOC_COMMENT"> * without modification, are permitted provided that the following</span></pre></div><div id="line167"><pre><span class="token T_DOC_COMMENT"> * conditions are met: Redistributions of source code must retain the</span></pre></div><div id="line168"><pre><span class="token T_DOC_COMMENT"> * above copyright notice, this list of conditions and the following</span></pre></div><div id="line169"><pre><span class="token T_DOC_COMMENT"> * disclaimer. Redistributions in binary form must reproduce the above</span></pre></div><div id="line170"><pre><span class="token T_DOC_COMMENT"> * copyright notice, this list of conditions and the following disclaimer</span></pre></div><div id="line171"><pre><span class="token T_DOC_COMMENT"> * in the documentation and/or other materials provided with the</span></pre></div><div id="line172"><pre><span class="token T_DOC_COMMENT"> * distribution.</span></pre></div><div id="line173"><pre><span class="token T_DOC_COMMENT"> *</span></pre></div><div id="line174"><pre><span class="token T_DOC_COMMENT"> * THIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY EXPRESS OR IMPLIED</span></pre></div><div id="line175"><pre><span class="token T_DOC_COMMENT"> * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF</span></pre></div><div id="line176"><pre><span class="token T_DOC_COMMENT"> * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN</span></pre></div><div id="line177"><pre><span class="token T_DOC_COMMENT"> * NO EVENT SHALL CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,</span></pre></div><div id="line178"><pre><span class="token T_DOC_COMMENT"> * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,</span></pre></div><div id="line179"><pre><span class="token T_DOC_COMMENT"> * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS</span></pre></div><div id="line180"><pre><span class="token T_DOC_COMMENT"> * OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND</span></pre></div><div id="line181"><pre><span class="token T_DOC_COMMENT"> * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR</span></pre></div><div id="line182"><pre><span class="token T_DOC_COMMENT"> * TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE</span></pre></div><div id="line183"><pre><span class="token T_DOC_COMMENT"> * USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH</span></pre></div><div id="line184"><pre><span class="token T_DOC_COMMENT"> * DAMAGE.</span></pre></div><div id="line185"><pre><span class="token T_DOC_COMMENT"> *</span></pre></div><div id="line186"><pre><span class="token T_DOC_COMMENT"> * @category</span></pre></div><div id="line187"><pre><span class="token T_DOC_COMMENT"> * @package     Services_JSON</span></pre></div><div id="line188"><pre><span class="token T_DOC_COMMENT"> * @author      Michal Migurski &lt;mike-json@teczno.com&gt;</span></pre></div><div id="line189"><pre><span class="token T_DOC_COMMENT"> * @author      Matt Knapp &lt;mdknapp[at]gmail[dot]com&gt;</span></pre></div><div id="line190"><pre><span class="token T_DOC_COMMENT"> * @author      Brett Stimmerman &lt;brettstimmerman[at]gmail[dot]com&gt;</span></pre></div><div id="line191"><pre><span class="token T_DOC_COMMENT"> * @copyright   2005 Michal Migurski</span></pre></div><div id="line192"><pre><span class="token T_DOC_COMMENT"> * @version     CVS: $Id: restore.php 612 2011-05-19 08:26:26Z nikosdion $</span></pre></div><div id="line193"><pre><span class="token T_DOC_COMMENT"> * @license     http://www.opensource.org/licenses/bsd-license.php</span></pre></div><div id="line194"><pre><span class="token T_DOC_COMMENT"> * @link        http://pear.php.net/pepr/pepr-proposal-show.php?id=198</span></pre></div><div id="line195"><pre><span class="token T_DOC_COMMENT"> */</span></pre></div><div id="line196"><br/></div><div id="line197"><pre><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">defined</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'JSON_FORCE_OBJECT'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line198"><pre><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line199"><pre><span class="token T_WHITESPACE">	</span><span class="token T_STRING">define</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'JSON_FORCE_OBJECT'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line200"><pre><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line201"><br/></div><div id="line202"><pre><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">defined</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'SERVICES_JSON_SLICE'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line203"><pre><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line204"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line205"><pre><span class="token T_DOC_COMMENT">	 * Marker constant for Services_JSON::decode(), used to flag stack state</span></pre></div><div id="line206"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line207"><pre><span class="token T_WHITESPACE">	</span><span class="token T_STRING">define</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'SERVICES_JSON_SLICE'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE">   </span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line208"><br/></div><div id="line209"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line210"><pre><span class="token T_DOC_COMMENT">	 * Marker constant for Services_JSON::decode(), used to flag stack state</span></pre></div><div id="line211"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line212"><pre><span class="token T_WHITESPACE">	</span><span class="token T_STRING">define</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'SERVICES_JSON_IN_STR'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE">  </span><span class="token T_LNUMBER">2</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line213"><br/></div><div id="line214"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line215"><pre><span class="token T_DOC_COMMENT">	 * Marker constant for Services_JSON::decode(), used to flag stack state</span></pre></div><div id="line216"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line217"><pre><span class="token T_WHITESPACE">	</span><span class="token T_STRING">define</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'SERVICES_JSON_IN_ARR'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE">  </span><span class="token T_LNUMBER">3</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line218"><br/></div><div id="line219"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line220"><pre><span class="token T_DOC_COMMENT">	 * Marker constant for Services_JSON::decode(), used to flag stack state</span></pre></div><div id="line221"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line222"><pre><span class="token T_WHITESPACE">	</span><span class="token T_STRING">define</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'SERVICES_JSON_IN_OBJ'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE">  </span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line223"><br/></div><div id="line224"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line225"><pre><span class="token T_DOC_COMMENT">	 * Marker constant for Services_JSON::decode(), used to flag stack state</span></pre></div><div id="line226"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line227"><pre><span class="token T_WHITESPACE">	</span><span class="token T_STRING">define</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'SERVICES_JSON_IN_CMT'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">5</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line228"><br/></div><div id="line229"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line230"><pre><span class="token T_DOC_COMMENT">	 * Behavior switch for Services_JSON::decode()</span></pre></div><div id="line231"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line232"><pre><span class="token T_WHITESPACE">	</span><span class="token T_STRING">define</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'SERVICES_JSON_LOOSE_TYPE'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">16</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line233"><br/></div><div id="line234"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line235"><pre><span class="token T_DOC_COMMENT">	 * Behavior switch for Services_JSON::decode()</span></pre></div><div id="line236"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line237"><pre><span class="token T_WHITESPACE">	</span><span class="token T_STRING">define</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'SERVICES_JSON_SUPPRESS_ERRORS'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">32</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line238"><pre><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line239"><br/></div><div id="line240"><pre><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line241"><pre><span class="token T_DOC_COMMENT"> * Converts to and from JSON format.</span></pre></div><div id="line242"><pre><span class="token T_DOC_COMMENT"> *</span></pre></div><div id="line243"><pre><span class="token T_DOC_COMMENT"> * Brief example of use:</span></pre></div><div id="line244"><pre><span class="token T_DOC_COMMENT"> *</span></pre></div><div id="line245"><pre><span class="token T_DOC_COMMENT"> * &lt;code&gt;</span></pre></div><div id="line246"><pre><span class="token T_DOC_COMMENT"> * // create a new instance of Services_JSON</span></pre></div><div id="line247"><pre><span class="token T_DOC_COMMENT"> * $json = new Services_JSON();</span></pre></div><div id="line248"><pre><span class="token T_DOC_COMMENT"> *</span></pre></div><div id="line249"><pre><span class="token T_DOC_COMMENT"> * // convert a complex value to JSON notation, and send it to the browser</span></pre></div><div id="line250"><pre><span class="token T_DOC_COMMENT"> * $value = array('foo', 'bar', array(1, 2, 'baz'), array(3, array(4)));</span></pre></div><div id="line251"><pre><span class="token T_DOC_COMMENT"> * $output = $json-&gt;encode($value);</span></pre></div><div id="line252"><pre><span class="token T_DOC_COMMENT"> *</span></pre></div><div id="line253"><pre><span class="token T_DOC_COMMENT"> * print($output);</span></pre></div><div id="line254"><pre><span class="token T_DOC_COMMENT"> * // prints: ["foo","bar",[1,2,"baz"],[3,[4]]]</span></pre></div><div id="line255"><pre><span class="token T_DOC_COMMENT"> *</span></pre></div><div id="line256"><pre><span class="token T_DOC_COMMENT"> * // accept incoming POST data, assumed to be in JSON notation</span></pre></div><div id="line257"><pre><span class="token T_DOC_COMMENT"> * $input = file_get_contents('php://input', 1000000);</span></pre></div><div id="line258"><pre><span class="token T_DOC_COMMENT"> * $value = $json-&gt;decode($input);</span></pre></div><div id="line259"><pre><span class="token T_DOC_COMMENT"> * &lt;/code&gt;</span></pre></div><div id="line260"><pre><span class="token T_DOC_COMMENT"> */</span></pre></div><div id="line261"><pre><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">class_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Akeeba_Services_JSON'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line262"><pre><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line263"><pre><span class="token T_WHITESPACE">	</span><span class="token T_CLASS">class</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">Akeeba_Services_JSON</span></pre></div><div id="line264"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line265"><pre><span class="token T_WHITESPACE">	   </span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line266"><pre><span class="token T_DOC_COMMENT">	    * constructs a new JSON instance</span></pre></div><div id="line267"><pre><span class="token T_DOC_COMMENT">	    *</span></pre></div><div id="line268"><pre><span class="token T_DOC_COMMENT">	    * @param    int     $use    object behavior flags; combine with boolean-OR</span></pre></div><div id="line269"><pre><span class="token T_DOC_COMMENT">	    *</span></pre></div><div id="line270"><pre><span class="token T_DOC_COMMENT">	    *                           possible values:</span></pre></div><div id="line271"><pre><span class="token T_DOC_COMMENT">	    *                           - SERVICES_JSON_LOOSE_TYPE:  loose typing.</span></pre></div><div id="line272"><pre><span class="token T_DOC_COMMENT">	    *                                   "{...}" syntax creates associative arrays</span></pre></div><div id="line273"><pre><span class="token T_DOC_COMMENT">	    *                                   instead of objects in decode().</span></pre></div><div id="line274"><pre><span class="token T_DOC_COMMENT">	    *                           - SERVICES_JSON_SUPPRESS_ERRORS:  error suppression.</span></pre></div><div id="line275"><pre><span class="token T_DOC_COMMENT">	    *                                   Values which can't be encoded (e.g. resources)</span></pre></div><div id="line276"><pre><span class="token T_DOC_COMMENT">	    *                                   appear as NULL instead of throwing errors.</span></pre></div><div id="line277"><pre><span class="token T_DOC_COMMENT">	    *                                   By default, a deeply-nested resource will</span></pre></div><div id="line278"><pre><span class="token T_DOC_COMMENT">	    *                                   bubble up with an error, so all return values</span></pre></div><div id="line279"><pre><span class="token T_DOC_COMMENT">	    *                                   from encode() should be checked with isError()</span></pre></div><div id="line280"><pre><span class="token T_DOC_COMMENT">	    */</span></pre></div><div id="line281"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">Akeeba_Services_JSON</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$use</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line282"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line283"><pre><span class="token T_WHITESPACE">	        </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">use</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$use</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line284"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line285"><br/></div><div id="line286"><pre><span class="token T_WHITESPACE">	   </span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line287"><pre><span class="token T_DOC_COMMENT">	    * convert a string from one UTF-16 char to one UTF-8 char</span></pre></div><div id="line288"><pre><span class="token T_DOC_COMMENT">	    *</span></pre></div><div id="line289"><pre><span class="token T_DOC_COMMENT">	    * Normally should be handled by mb_convert_encoding, but</span></pre></div><div id="line290"><pre><span class="token T_DOC_COMMENT">	    * provides a slower PHP-only method for installations</span></pre></div><div id="line291"><pre><span class="token T_DOC_COMMENT">	    * that lack the Multibyte String PHP extension.</span></pre></div><div id="line292"><pre><span class="token T_DOC_COMMENT">	    *</span></pre></div><div id="line293"><pre><span class="token T_DOC_COMMENT">	    * @param    string  $utf16  UTF-16 character</span></pre></div><div id="line294"><pre><span class="token T_DOC_COMMENT">	    * @return   string  UTF-8 character</span></pre></div><div id="line295"><pre><span class="token T_DOC_COMMENT">	    * @access   private</span></pre></div><div id="line296"><pre><span class="token T_DOC_COMMENT">	    */</span></pre></div><div id="line297"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">utf162utf8</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$utf16</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line298"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line299"><pre><span class="token T_WHITESPACE">	        </span><span class="token T_COMMENT">// Use Multibyte String function, if available</span></pre></div><div id="line300"><pre><span class="token T_WHITESPACE">	        </span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">function_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'mb_convert_encoding'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line301"><pre><span class="token T_WHITESPACE">	            </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">mb_convert_encoding</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$utf16</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'UTF-8'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'UTF-16'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line302"><pre><span class="token T_WHITESPACE">	        </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line303"><pre><span class="token T_WHITESPACE">	        </span></pre></div><div id="line304"><pre><span class="token T_WHITESPACE">	        </span><span class="token T_COMMENT">// Fall back to a custom PHP implementation</span></pre></div><div id="line305"><pre><span class="token T_WHITESPACE">	        </span><span class="token T_VARIABLE">$bytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">ord</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$utf16</span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_SL">&lt;&lt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">8</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_PIPE">|</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">ord</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$utf16</span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line306"><br/></div><div id="line307"><pre><span class="token T_WHITESPACE">	        </span><span class="token T_SWITCH">switch</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">true</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line308"><pre><span class="token T_WHITESPACE">	            </span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_LNUMBER">0x7F</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$bytes</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$bytes</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line309"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_COMMENT">// this case should never be reached, because we are in ASCII range</span></pre></div><div id="line310"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_COMMENT">// see: http://www.cl.cam.ac.uk/~mgk25/unicode.html#utf-8</span></pre></div><div id="line311"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">chr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_LNUMBER">0x7F</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$bytes</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line312"><br/></div><div id="line313"><pre><span class="token T_WHITESPACE">	            </span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_LNUMBER">0x07FF</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$bytes</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$bytes</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line314"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_COMMENT">// return a 2-byte UTF-8 character</span></pre></div><div id="line315"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_COMMENT">// see: http://www.cl.cam.ac.uk/~mgk25/unicode.html#utf-8</span></pre></div><div id="line316"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">chr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_LNUMBER">0xC0</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_PIPE">|</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$bytes</span><span class="token T_WHITESPACE"> </span><span class="token T_SR">&gt;&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">6</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x1F</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line317"><pre><span class="token T_WHITESPACE">	                     </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">chr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_LNUMBER">0x80</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_PIPE">|</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$bytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x3F</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line318"><br/></div><div id="line319"><pre><span class="token T_WHITESPACE">	            </span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_LNUMBER">0xFFFF</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$bytes</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$bytes</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line320"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_COMMENT">// return a 3-byte UTF-8 character</span></pre></div><div id="line321"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_COMMENT">// see: http://www.cl.cam.ac.uk/~mgk25/unicode.html#utf-8</span></pre></div><div id="line322"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">chr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_LNUMBER">0xE0</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_PIPE">|</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$bytes</span><span class="token T_WHITESPACE"> </span><span class="token T_SR">&gt;&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">12</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x0F</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line323"><pre><span class="token T_WHITESPACE">	                     </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">chr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_LNUMBER">0x80</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_PIPE">|</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$bytes</span><span class="token T_WHITESPACE"> </span><span class="token T_SR">&gt;&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">6</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x3F</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line324"><pre><span class="token T_WHITESPACE">	                     </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">chr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_LNUMBER">0x80</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_PIPE">|</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$bytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x3F</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line325"><pre><span class="token T_WHITESPACE">	        </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line326"><br/></div><div id="line327"><pre><span class="token T_WHITESPACE">	        </span><span class="token T_COMMENT">// ignoring UTF-32 for now, sorry</span></pre></div><div id="line328"><pre><span class="token T_WHITESPACE">	        </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line329"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line330"><br/></div><div id="line331"><pre><span class="token T_WHITESPACE">	   </span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line332"><pre><span class="token T_DOC_COMMENT">	    * convert a string from one UTF-8 char to one UTF-16 char</span></pre></div><div id="line333"><pre><span class="token T_DOC_COMMENT">	    *</span></pre></div><div id="line334"><pre><span class="token T_DOC_COMMENT">	    * Normally should be handled by mb_convert_encoding, but</span></pre></div><div id="line335"><pre><span class="token T_DOC_COMMENT">	    * provides a slower PHP-only method for installations</span></pre></div><div id="line336"><pre><span class="token T_DOC_COMMENT">	    * that lack the Multibyte String PHP extension.</span></pre></div><div id="line337"><pre><span class="token T_DOC_COMMENT">	    *</span></pre></div><div id="line338"><pre><span class="token T_DOC_COMMENT">	    * @param    string  $utf8   UTF-8 character</span></pre></div><div id="line339"><pre><span class="token T_DOC_COMMENT">	    * @return   string  UTF-16 character</span></pre></div><div id="line340"><pre><span class="token T_DOC_COMMENT">	    * @access   private</span></pre></div><div id="line341"><pre><span class="token T_DOC_COMMENT">	    */</span></pre></div><div id="line342"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">utf82utf16</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$utf8</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line343"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line344"><pre><span class="token T_WHITESPACE">	        </span><span class="token T_COMMENT">// oh please oh please oh please oh please oh please</span></pre></div><div id="line345"><pre><span class="token T_WHITESPACE">	        </span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">function_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'mb_convert_encoding'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line346"><pre><span class="token T_WHITESPACE">	            </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">mb_convert_encoding</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$utf8</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'UTF-16'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'UTF-8'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line347"><pre><span class="token T_WHITESPACE">	        </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line348"><br/></div><div id="line349"><pre><span class="token T_WHITESPACE">	        </span><span class="token T_SWITCH">switch</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$utf8</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line350"><pre><span class="token T_WHITESPACE">	            </span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line351"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_COMMENT">// this case should never be reached, because we are in ASCII range</span></pre></div><div id="line352"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_COMMENT">// see: http://www.cl.cam.ac.uk/~mgk25/unicode.html#utf-8</span></pre></div><div id="line353"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$utf8</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line354"><br/></div><div id="line355"><pre><span class="token T_WHITESPACE">	            </span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">2</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line356"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_COMMENT">// return a UTF-16 character from a 2-byte UTF-8 char</span></pre></div><div id="line357"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_COMMENT">// see: http://www.cl.cam.ac.uk/~mgk25/unicode.html#utf-8</span></pre></div><div id="line358"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">chr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_LNUMBER">0x07</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">ord</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$utf8</span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_SR">&gt;&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">2</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line359"><pre><span class="token T_WHITESPACE">	                     </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">chr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_LNUMBER">0xC0</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">ord</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$utf8</span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_SL">&lt;&lt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">6</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line360"><pre><span class="token T_WHITESPACE">	                         </span><span class="token T_PHPDOX_PIPE">|</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_LNUMBER">0x3F</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">ord</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$utf8</span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line361"><br/></div><div id="line362"><pre><span class="token T_WHITESPACE">	            </span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">3</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line363"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_COMMENT">// return a UTF-16 character from a 3-byte UTF-8 char</span></pre></div><div id="line364"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_COMMENT">// see: http://www.cl.cam.ac.uk/~mgk25/unicode.html#utf-8</span></pre></div><div id="line365"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">chr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_LNUMBER">0xF0</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">ord</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$utf8</span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_SL">&lt;&lt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line366"><pre><span class="token T_WHITESPACE">	                         </span><span class="token T_PHPDOX_PIPE">|</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_LNUMBER">0x0F</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">ord</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$utf8</span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_SR">&gt;&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">2</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line367"><pre><span class="token T_WHITESPACE">	                     </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">chr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_LNUMBER">0xC0</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">ord</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$utf8</span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_SL">&lt;&lt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">6</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line368"><pre><span class="token T_WHITESPACE">	                         </span><span class="token T_PHPDOX_PIPE">|</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_LNUMBER">0x7F</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">ord</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$utf8</span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_LNUMBER">2</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line369"><pre><span class="token T_WHITESPACE">	        </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line370"><br/></div><div id="line371"><pre><span class="token T_WHITESPACE">	        </span><span class="token T_COMMENT">// ignoring UTF-32 for now, sorry</span></pre></div><div id="line372"><pre><span class="token T_WHITESPACE">	        </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line373"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line374"><br/></div><div id="line375"><pre><span class="token T_WHITESPACE">	   </span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line376"><pre><span class="token T_DOC_COMMENT">	    * encodes an arbitrary variable into JSON format</span></pre></div><div id="line377"><pre><span class="token T_DOC_COMMENT">	    *</span></pre></div><div id="line378"><pre><span class="token T_DOC_COMMENT">	    * @param    mixed   $var    any number, boolean, string, array, or object to be encoded.</span></pre></div><div id="line379"><pre><span class="token T_DOC_COMMENT">	    *                           see argument 1 to Services_JSON() above for array-parsing behavior.</span></pre></div><div id="line380"><pre><span class="token T_DOC_COMMENT">	    *                           if var is a string, note that encode() always expects it</span></pre></div><div id="line381"><pre><span class="token T_DOC_COMMENT">	    *                           to be in ASCII or UTF-8 format!</span></pre></div><div id="line382"><pre><span class="token T_DOC_COMMENT">	    *</span></pre></div><div id="line383"><pre><span class="token T_DOC_COMMENT">	    * @return   mixed   JSON string representation of input var or an error if a problem occurs</span></pre></div><div id="line384"><pre><span class="token T_DOC_COMMENT">	    * @access   public</span></pre></div><div id="line385"><pre><span class="token T_DOC_COMMENT">	    */</span></pre></div><div id="line386"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">encode</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$var</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line387"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line388"><pre><span class="token T_WHITESPACE">	        </span><span class="token T_SWITCH">switch</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">gettype</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$var</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line389"><pre><span class="token T_WHITESPACE">	            </span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'boolean'</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line390"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$var</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_QUESTION_MARK">?</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'true'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_COLON">:</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'false'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line391"><br/></div><div id="line392"><pre><span class="token T_WHITESPACE">	            </span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'NULL'</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line393"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'null'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line394"><br/></div><div id="line395"><pre><span class="token T_WHITESPACE">	            </span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'integer'</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line396"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_INT_CAST">(int)</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$var</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line397"><br/></div><div id="line398"><pre><span class="token T_WHITESPACE">	            </span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'double'</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line399"><pre><span class="token T_WHITESPACE">	            </span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'float'</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line400"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_CAST">(float)</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$var</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line401"><br/></div><div id="line402"><pre><span class="token T_WHITESPACE">	            </span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'string'</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line403"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_COMMENT">// STRINGS ARE EXPECTED TO BE IN ASCII OR UTF-8 FORMAT</span></pre></div><div id="line404"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_VARIABLE">$ascii</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line405"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_VARIABLE">$strlen_var</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$var</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line406"><br/></div><div id="line407"><pre><span class="token T_WHITESPACE">	               </span><span class="token T_COMMENT">/*</span></pre></div><div id="line408"><pre><span class="token T_COMMENT">	                * Iterate over every character in the string,</span></pre></div><div id="line409"><pre><span class="token T_COMMENT">	                * escaping with a slash or encoding to UTF-8 where necessary</span></pre></div><div id="line410"><pre><span class="token T_COMMENT">	                */</span></pre></div><div id="line411"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_FOR">for</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$c</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$c</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$strlen_var</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_INC">++</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line412"><br/></div><div id="line413"><pre><span class="token T_WHITESPACE">	                    </span><span class="token T_VARIABLE">$ord_var_c</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">ord</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$var</span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line414"><br/></div><div id="line415"><pre><span class="token T_WHITESPACE">	                    </span><span class="token T_SWITCH">switch</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">true</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line416"><pre><span class="token T_WHITESPACE">	                        </span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$ord_var_c</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x08</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line417"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_VARIABLE">$ascii</span><span class="token T_WHITESPACE"> </span><span class="token T_CONCAT_EQUAL">.=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'\b'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line418"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line419"><pre><span class="token T_WHITESPACE">	                        </span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$ord_var_c</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x09</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line420"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_VARIABLE">$ascii</span><span class="token T_WHITESPACE"> </span><span class="token T_CONCAT_EQUAL">.=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'\t'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line421"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line422"><pre><span class="token T_WHITESPACE">	                        </span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$ord_var_c</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x0A</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line423"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_VARIABLE">$ascii</span><span class="token T_WHITESPACE"> </span><span class="token T_CONCAT_EQUAL">.=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'\n'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line424"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line425"><pre><span class="token T_WHITESPACE">	                        </span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$ord_var_c</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x0C</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line426"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_VARIABLE">$ascii</span><span class="token T_WHITESPACE"> </span><span class="token T_CONCAT_EQUAL">.=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'\f'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line427"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line428"><pre><span class="token T_WHITESPACE">	                        </span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$ord_var_c</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x0D</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line429"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_VARIABLE">$ascii</span><span class="token T_WHITESPACE"> </span><span class="token T_CONCAT_EQUAL">.=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'\r'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line430"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line431"><br/></div><div id="line432"><pre><span class="token T_WHITESPACE">	                        </span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$ord_var_c</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x22</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line433"><pre><span class="token T_WHITESPACE">	                        </span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$ord_var_c</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x2F</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line434"><pre><span class="token T_WHITESPACE">	                        </span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$ord_var_c</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x5C</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line435"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_COMMENT">// double quote, slash, slosh</span></pre></div><div id="line436"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_VARIABLE">$ascii</span><span class="token T_WHITESPACE"> </span><span class="token T_CONCAT_EQUAL">.=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'\\'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$var</span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line437"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line438"><br/></div><div id="line439"><pre><span class="token T_WHITESPACE">	                        </span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$ord_var_c</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_GREATER_OR_EQUAL">&gt;=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x20</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$ord_var_c</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_SMALLER_OR_EQUAL">&lt;=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x7F</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line440"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_COMMENT">// characters U-00000000 - U-0000007F (same as ASCII)</span></pre></div><div id="line441"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_VARIABLE">$ascii</span><span class="token T_WHITESPACE"> </span><span class="token T_CONCAT_EQUAL">.=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$var</span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line442"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line443"><br/></div><div id="line444"><pre><span class="token T_WHITESPACE">	                        </span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$ord_var_c</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0xE0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0xC0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line445"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_COMMENT">// characters U-00000080 - U-000007FF, mask 110XXXXX</span></pre></div><div id="line446"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_COMMENT">// see http://www.cl.cam.ac.uk/~mgk25/unicode.html#utf-8</span></pre></div><div id="line447"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_VARIABLE">$char</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">pack</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'C*'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$ord_var_c</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">ord</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$var</span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_VARIABLE">$c</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_PLUS">+</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line448"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_VARIABLE">$c</span><span class="token T_WHITESPACE"> </span><span class="token T_PLUS_EQUAL">+=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line449"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_VARIABLE">$utf16</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">utf82utf16</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$char</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line450"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_VARIABLE">$ascii</span><span class="token T_WHITESPACE"> </span><span class="token T_CONCAT_EQUAL">.=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">sprintf</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'\u%04s'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">bin2hex</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$utf16</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line451"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line452"><br/></div><div id="line453"><pre><span class="token T_WHITESPACE">	                        </span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$ord_var_c</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0xF0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0xE0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line454"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_COMMENT">// characters U-00000800 - U-0000FFFF, mask 1110XXXX</span></pre></div><div id="line455"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_COMMENT">// see http://www.cl.cam.ac.uk/~mgk25/unicode.html#utf-8</span></pre></div><div id="line456"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_VARIABLE">$char</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">pack</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'C*'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$ord_var_c</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line457"><pre><span class="token T_WHITESPACE">	                                         </span><span class="token T_STRING">ord</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$var</span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_VARIABLE">$c</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_PLUS">+</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line458"><pre><span class="token T_WHITESPACE">	                                         </span><span class="token T_STRING">ord</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$var</span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_VARIABLE">$c</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_PLUS">+</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">2</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line459"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_VARIABLE">$c</span><span class="token T_WHITESPACE"> </span><span class="token T_PLUS_EQUAL">+=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">2</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line460"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_VARIABLE">$utf16</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">utf82utf16</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$char</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line461"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_VARIABLE">$ascii</span><span class="token T_WHITESPACE"> </span><span class="token T_CONCAT_EQUAL">.=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">sprintf</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'\u%04s'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">bin2hex</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$utf16</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line462"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line463"><br/></div><div id="line464"><pre><span class="token T_WHITESPACE">	                        </span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$ord_var_c</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0xF8</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0xF0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line465"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_COMMENT">// characters U-00010000 - U-001FFFFF, mask 11110XXX</span></pre></div><div id="line466"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_COMMENT">// see http://www.cl.cam.ac.uk/~mgk25/unicode.html#utf-8</span></pre></div><div id="line467"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_VARIABLE">$char</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">pack</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'C*'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$ord_var_c</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line468"><pre><span class="token T_WHITESPACE">	                                         </span><span class="token T_STRING">ord</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$var</span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_VARIABLE">$c</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_PLUS">+</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line469"><pre><span class="token T_WHITESPACE">	                                         </span><span class="token T_STRING">ord</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$var</span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_VARIABLE">$c</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_PLUS">+</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">2</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line470"><pre><span class="token T_WHITESPACE">	                                         </span><span class="token T_STRING">ord</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$var</span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_VARIABLE">$c</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_PLUS">+</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">3</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line471"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_VARIABLE">$c</span><span class="token T_WHITESPACE"> </span><span class="token T_PLUS_EQUAL">+=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">3</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line472"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_VARIABLE">$utf16</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">utf82utf16</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$char</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line473"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_VARIABLE">$ascii</span><span class="token T_WHITESPACE"> </span><span class="token T_CONCAT_EQUAL">.=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">sprintf</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'\u%04s'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">bin2hex</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$utf16</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line474"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line475"><br/></div><div id="line476"><pre><span class="token T_WHITESPACE">	                        </span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$ord_var_c</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0xFC</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0xF8</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line477"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_COMMENT">// characters U-00200000 - U-03FFFFFF, mask 111110XX</span></pre></div><div id="line478"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_COMMENT">// see http://www.cl.cam.ac.uk/~mgk25/unicode.html#utf-8</span></pre></div><div id="line479"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_VARIABLE">$char</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">pack</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'C*'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$ord_var_c</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line480"><pre><span class="token T_WHITESPACE">	                                         </span><span class="token T_STRING">ord</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$var</span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_VARIABLE">$c</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_PLUS">+</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line481"><pre><span class="token T_WHITESPACE">	                                         </span><span class="token T_STRING">ord</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$var</span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_VARIABLE">$c</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_PLUS">+</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">2</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line482"><pre><span class="token T_WHITESPACE">	                                         </span><span class="token T_STRING">ord</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$var</span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_VARIABLE">$c</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_PLUS">+</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">3</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line483"><pre><span class="token T_WHITESPACE">	                                         </span><span class="token T_STRING">ord</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$var</span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_VARIABLE">$c</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_PLUS">+</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line484"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_VARIABLE">$c</span><span class="token T_WHITESPACE"> </span><span class="token T_PLUS_EQUAL">+=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line485"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_VARIABLE">$utf16</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">utf82utf16</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$char</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line486"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_VARIABLE">$ascii</span><span class="token T_WHITESPACE"> </span><span class="token T_CONCAT_EQUAL">.=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">sprintf</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'\u%04s'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">bin2hex</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$utf16</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line487"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line488"><br/></div><div id="line489"><pre><span class="token T_WHITESPACE">	                        </span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$ord_var_c</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0xFE</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0xFC</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line490"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_COMMENT">// characters U-04000000 - U-7FFFFFFF, mask 1111110X</span></pre></div><div id="line491"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_COMMENT">// see http://www.cl.cam.ac.uk/~mgk25/unicode.html#utf-8</span></pre></div><div id="line492"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_VARIABLE">$char</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">pack</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'C*'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$ord_var_c</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line493"><pre><span class="token T_WHITESPACE">	                                         </span><span class="token T_STRING">ord</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$var</span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_VARIABLE">$c</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_PLUS">+</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line494"><pre><span class="token T_WHITESPACE">	                                         </span><span class="token T_STRING">ord</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$var</span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_VARIABLE">$c</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_PLUS">+</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">2</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line495"><pre><span class="token T_WHITESPACE">	                                         </span><span class="token T_STRING">ord</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$var</span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_VARIABLE">$c</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_PLUS">+</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">3</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line496"><pre><span class="token T_WHITESPACE">	                                         </span><span class="token T_STRING">ord</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$var</span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_VARIABLE">$c</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_PLUS">+</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line497"><pre><span class="token T_WHITESPACE">	                                         </span><span class="token T_STRING">ord</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$var</span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_VARIABLE">$c</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_PLUS">+</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">5</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line498"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_VARIABLE">$c</span><span class="token T_WHITESPACE"> </span><span class="token T_PLUS_EQUAL">+=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">5</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line499"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_VARIABLE">$utf16</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">utf82utf16</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$char</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line500"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_VARIABLE">$ascii</span><span class="token T_WHITESPACE"> </span><span class="token T_CONCAT_EQUAL">.=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">sprintf</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'\u%04s'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">bin2hex</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$utf16</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line501"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line502"><pre><span class="token T_WHITESPACE">	                    </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line503"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line504"><br/></div><div id="line505"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'"'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$ascii</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'"'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line506"><br/></div><div id="line507"><pre><span class="token T_WHITESPACE">	            </span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'array'</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line508"><pre><span class="token T_WHITESPACE">	               </span><span class="token T_COMMENT">/*</span></pre></div><div id="line509"><pre><span class="token T_COMMENT">	                * As per JSON spec if any array key is not an integer</span></pre></div><div id="line510"><pre><span class="token T_COMMENT">	                * we must treat the the whole array as an object. We</span></pre></div><div id="line511"><pre><span class="token T_COMMENT">	                * also try to catch a sparsely populated associative</span></pre></div><div id="line512"><pre><span class="token T_COMMENT">	                * array with numeric keys here because some JS engines</span></pre></div><div id="line513"><pre><span class="token T_COMMENT">	                * will create an array with empty indexes up to</span></pre></div><div id="line514"><pre><span class="token T_COMMENT">	                * max_index which can cause memory issues and because</span></pre></div><div id="line515"><pre><span class="token T_COMMENT">	                * the keys, which may be relevant, will be remapped</span></pre></div><div id="line516"><pre><span class="token T_COMMENT">	                * otherwise.</span></pre></div><div id="line517"><pre><span class="token T_COMMENT">	                *</span></pre></div><div id="line518"><pre><span class="token T_COMMENT">	                * As per the ECMA and JSON specification an object may</span></pre></div><div id="line519"><pre><span class="token T_COMMENT">	                * have any string as a property. Unfortunately due to</span></pre></div><div id="line520"><pre><span class="token T_COMMENT">	                * a hole in the ECMA specification if the key is a</span></pre></div><div id="line521"><pre><span class="token T_COMMENT">	                * ECMA reserved word or starts with a digit the</span></pre></div><div id="line522"><pre><span class="token T_COMMENT">	                * parameter is only accessible using ECMAScript's</span></pre></div><div id="line523"><pre><span class="token T_COMMENT">	                * bracket notation.</span></pre></div><div id="line524"><pre><span class="token T_COMMENT">	                */</span></pre></div><div id="line525"><br/></div><div id="line526"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_COMMENT">// treat as a JSON object</span></pre></div><div id="line527"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">is_array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$var</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">count</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$var</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">array_keys</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$var</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_NOT_IDENTICAL">!==</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">range</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">sizeof</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$var</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line528"><pre><span class="token T_WHITESPACE">	                    </span><span class="token T_VARIABLE">$properties</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">array_map</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'name_value'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line529"><pre><span class="token T_WHITESPACE">	                                            </span><span class="token T_STRING">array_keys</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$var</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line530"><pre><span class="token T_WHITESPACE">	                                            </span><span class="token T_STRING">array_values</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$var</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line531"><br/></div><div id="line532"><pre><span class="token T_WHITESPACE">	                    </span><span class="token T_FOREACH">foreach</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$properties</span><span class="token T_WHITESPACE"> </span><span class="token T_AS">as</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$property</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line533"><pre><span class="token T_WHITESPACE">	                        </span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">Akeeba_Services_JSON</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">isError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$property</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line534"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$property</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line535"><pre><span class="token T_WHITESPACE">	                        </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line536"><pre><span class="token T_WHITESPACE">	                    </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line537"><br/></div><div id="line538"><pre><span class="token T_WHITESPACE">	                    </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'{'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">join</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">','</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$properties</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'}'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line539"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line540"><br/></div><div id="line541"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_COMMENT">// treat it like a regular array</span></pre></div><div id="line542"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_VARIABLE">$elements</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">array_map</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'encode'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$var</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line543"><br/></div><div id="line544"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_FOREACH">foreach</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$elements</span><span class="token T_WHITESPACE"> </span><span class="token T_AS">as</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$element</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line545"><pre><span class="token T_WHITESPACE">	                    </span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">Akeeba_Services_JSON</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">isError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$element</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line546"><pre><span class="token T_WHITESPACE">	                        </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$element</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line547"><pre><span class="token T_WHITESPACE">	                    </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line548"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line549"><br/></div><div id="line550"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'['</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">join</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">','</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$elements</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">']'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line551"><br/></div><div id="line552"><pre><span class="token T_WHITESPACE">	            </span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'object'</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line553"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_VARIABLE">$vars</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">get_object_vars</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$var</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line554"><br/></div><div id="line555"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_VARIABLE">$properties</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">array_map</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'name_value'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line556"><pre><span class="token T_WHITESPACE">	                                        </span><span class="token T_STRING">array_keys</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$vars</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line557"><pre><span class="token T_WHITESPACE">	                                        </span><span class="token T_STRING">array_values</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$vars</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line558"><br/></div><div id="line559"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_FOREACH">foreach</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$properties</span><span class="token T_WHITESPACE"> </span><span class="token T_AS">as</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$property</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line560"><pre><span class="token T_WHITESPACE">	                    </span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">Akeeba_Services_JSON</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">isError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$property</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line561"><pre><span class="token T_WHITESPACE">	                        </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$property</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line562"><pre><span class="token T_WHITESPACE">	                    </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line563"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line564"><br/></div><div id="line565"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'{'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">join</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">','</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$properties</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'}'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line566"><br/></div><div id="line567"><pre><span class="token T_WHITESPACE">	            </span><span class="token T_DEFAULT">default</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line568"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">use</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">SERVICES_JSON_SUPPRESS_ERRORS</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line569"><pre><span class="token T_WHITESPACE">	                    </span><span class="token T_PHPDOX_QUESTION_MARK">?</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'null'</span></pre></div><div id="line570"><pre><span class="token T_WHITESPACE">	                    </span><span class="token T_PHPDOX_COLON">:</span><span class="token T_WHITESPACE"> </span><span class="token T_NEW">new</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">Akeeba_Services_JSON_Error</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">gettype</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$var</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">" can not be encoded as JSON string"</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line571"><pre><span class="token T_WHITESPACE">	        </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line572"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line573"><br/></div><div id="line574"><pre><span class="token T_WHITESPACE">	   </span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line575"><pre><span class="token T_DOC_COMMENT">	    * array-walking function for use in generating JSON-formatted name-value pairs</span></pre></div><div id="line576"><pre><span class="token T_DOC_COMMENT">	    *</span></pre></div><div id="line577"><pre><span class="token T_DOC_COMMENT">	    * @param    string  $name   name of key to use</span></pre></div><div id="line578"><pre><span class="token T_DOC_COMMENT">	    * @param    mixed   $value  reference to an array element to be encoded</span></pre></div><div id="line579"><pre><span class="token T_DOC_COMMENT">	    *</span></pre></div><div id="line580"><pre><span class="token T_DOC_COMMENT">	    * @return   string  JSON-formatted name-value pair, like '"name":value'</span></pre></div><div id="line581"><pre><span class="token T_DOC_COMMENT">	    * @access   private</span></pre></div><div id="line582"><pre><span class="token T_DOC_COMMENT">	    */</span></pre></div><div id="line583"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">name_value</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$name</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line584"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line585"><pre><span class="token T_WHITESPACE">	        </span><span class="token T_VARIABLE">$encoded_value</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">encode</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line586"><br/></div><div id="line587"><pre><span class="token T_WHITESPACE">	        </span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">Akeeba_Services_JSON</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">isError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$encoded_value</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line588"><pre><span class="token T_WHITESPACE">	            </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$encoded_value</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line589"><pre><span class="token T_WHITESPACE">	        </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line590"><br/></div><div id="line591"><pre><span class="token T_WHITESPACE">	        </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">encode</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">strval</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$name</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">':'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$encoded_value</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line592"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line593"><br/></div><div id="line594"><pre><span class="token T_WHITESPACE">	   </span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line595"><pre><span class="token T_DOC_COMMENT">	    * reduce a string by removing leading and trailing comments and whitespace</span></pre></div><div id="line596"><pre><span class="token T_DOC_COMMENT">	    *</span></pre></div><div id="line597"><pre><span class="token T_DOC_COMMENT">	    * @param    $str    string      string value to strip of comments and whitespace</span></pre></div><div id="line598"><pre><span class="token T_DOC_COMMENT">	    *</span></pre></div><div id="line599"><pre><span class="token T_DOC_COMMENT">	    * @return   string  string value stripped of comments and whitespace</span></pre></div><div id="line600"><pre><span class="token T_DOC_COMMENT">	    * @access   private</span></pre></div><div id="line601"><pre><span class="token T_DOC_COMMENT">	    */</span></pre></div><div id="line602"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">reduce_string</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$str</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line603"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line604"><pre><span class="token T_WHITESPACE">	        </span><span class="token T_VARIABLE">$str</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">preg_replace</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span></pre></div><div id="line605"><br/></div><div id="line606"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_COMMENT">// eliminate single line comments in '// ...' form</span></pre></div><div id="line607"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_CONSTANT_ENCAPSED_STRING">'#^\s*//(.+)$#m'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line608"><br/></div><div id="line609"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_COMMENT">// eliminate multi-line comments in '/* ... */' form, at start of string</span></pre></div><div id="line610"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_CONSTANT_ENCAPSED_STRING">'#^\s*/\*(.+)\*/#Us'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line611"><br/></div><div id="line612"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_COMMENT">// eliminate multi-line comments in '/* ... */' form, at end of string</span></pre></div><div id="line613"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_CONSTANT_ENCAPSED_STRING">'#/\*(.+)\*/\s*$#Us'</span></pre></div><div id="line614"><br/></div><div id="line615"><pre><span class="token T_WHITESPACE">	            </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$str</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line616"><br/></div><div id="line617"><pre><span class="token T_WHITESPACE">	        </span><span class="token T_COMMENT">// eliminate extraneous space</span></pre></div><div id="line618"><pre><span class="token T_WHITESPACE">	        </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$str</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line619"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line620"><br/></div><div id="line621"><pre><span class="token T_WHITESPACE">	   </span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line622"><pre><span class="token T_DOC_COMMENT">	    * decodes a JSON string into appropriate variable</span></pre></div><div id="line623"><pre><span class="token T_DOC_COMMENT">	    *</span></pre></div><div id="line624"><pre><span class="token T_DOC_COMMENT">	    * @param    string  $str    JSON-formatted string</span></pre></div><div id="line625"><pre><span class="token T_DOC_COMMENT">	    *</span></pre></div><div id="line626"><pre><span class="token T_DOC_COMMENT">	    * @return   mixed   number, boolean, string, array, or object</span></pre></div><div id="line627"><pre><span class="token T_DOC_COMMENT">	    *                   corresponding to given JSON input string.</span></pre></div><div id="line628"><pre><span class="token T_DOC_COMMENT">	    *                   See argument 1 to Akeeba_Services_JSON() above for object-output behavior.</span></pre></div><div id="line629"><pre><span class="token T_DOC_COMMENT">	    *                   Note that decode() always returns strings</span></pre></div><div id="line630"><pre><span class="token T_DOC_COMMENT">	    *                   in ASCII or UTF-8 format!</span></pre></div><div id="line631"><pre><span class="token T_DOC_COMMENT">	    * @access   public</span></pre></div><div id="line632"><pre><span class="token T_DOC_COMMENT">	    */</span></pre></div><div id="line633"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">decode</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$str</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line634"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line635"><pre><span class="token T_WHITESPACE">	        </span><span class="token T_VARIABLE">$str</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">reduce_string</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$str</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line636"><br/></div><div id="line637"><pre><span class="token T_WHITESPACE">	        </span><span class="token T_SWITCH">switch</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">strtolower</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$str</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line638"><pre><span class="token T_WHITESPACE">	            </span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'true'</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line639"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line640"><br/></div><div id="line641"><pre><span class="token T_WHITESPACE">	            </span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'false'</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line642"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line643"><br/></div><div id="line644"><pre><span class="token T_WHITESPACE">	            </span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'null'</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line645"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line646"><br/></div><div id="line647"><pre><span class="token T_WHITESPACE">	            </span><span class="token T_DEFAULT">default</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line648"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_VARIABLE">$m</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line649"><br/></div><div id="line650"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">is_numeric</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$str</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line651"><pre><span class="token T_WHITESPACE">	                    </span><span class="token T_COMMENT">// Lookie-loo, it's a number</span></pre></div><div id="line652"><br/></div><div id="line653"><pre><span class="token T_WHITESPACE">	                    </span><span class="token T_COMMENT">// This would work on its own, but I'm trying to be</span></pre></div><div id="line654"><pre><span class="token T_WHITESPACE">	                    </span><span class="token T_COMMENT">// good about returning integers where appropriate:</span></pre></div><div id="line655"><pre><span class="token T_WHITESPACE">	                    </span><span class="token T_COMMENT">// return (float)$str;</span></pre></div><div id="line656"><br/></div><div id="line657"><pre><span class="token T_WHITESPACE">	                    </span><span class="token T_COMMENT">// Return float or int, as appropriate</span></pre></div><div id="line658"><pre><span class="token T_WHITESPACE">	                    </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_DOUBLE_CAST">(float)</span><span class="token T_VARIABLE">$str</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_INT_CAST">(integer)</span><span class="token T_VARIABLE">$str</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line659"><pre><span class="token T_WHITESPACE">	                        </span><span class="token T_PHPDOX_QUESTION_MARK">?</span><span class="token T_WHITESPACE"> </span><span class="token T_INT_CAST">(integer)</span><span class="token T_VARIABLE">$str</span></pre></div><div id="line660"><pre><span class="token T_WHITESPACE">	                        </span><span class="token T_PHPDOX_COLON">:</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_CAST">(float)</span><span class="token T_VARIABLE">$str</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line661"><br/></div><div id="line662"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_ELSEIF">elseif</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">preg_match</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/^("|\').*(\1)$/s'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$str</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$m</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$m</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$m</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">2</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line663"><pre><span class="token T_WHITESPACE">	                    </span><span class="token T_COMMENT">// STRINGS RETURNED IN UTF-8 FORMAT</span></pre></div><div id="line664"><pre><span class="token T_WHITESPACE">	                    </span><span class="token T_VARIABLE">$delim</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$str</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line665"><pre><span class="token T_WHITESPACE">	                    </span><span class="token T_VARIABLE">$chrs</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$str</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line666"><pre><span class="token T_WHITESPACE">	                    </span><span class="token T_VARIABLE">$utf8</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line667"><pre><span class="token T_WHITESPACE">	                    </span><span class="token T_VARIABLE">$strlen_chrs</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$chrs</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line668"><br/></div><div id="line669"><pre><span class="token T_WHITESPACE">	                    </span><span class="token T_FOR">for</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$c</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$c</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$strlen_chrs</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_INC">++</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line670"><br/></div><div id="line671"><pre><span class="token T_WHITESPACE">	                        </span><span class="token T_VARIABLE">$substr_chrs_c_2</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$chrs</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">2</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line672"><pre><span class="token T_WHITESPACE">	                        </span><span class="token T_VARIABLE">$ord_chrs_c</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">ord</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$chrs</span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line673"><br/></div><div id="line674"><pre><span class="token T_WHITESPACE">	                        </span><span class="token T_SWITCH">switch</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">true</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line675"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$substr_chrs_c_2</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'\b'</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line676"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_VARIABLE">$utf8</span><span class="token T_WHITESPACE"> </span><span class="token T_CONCAT_EQUAL">.=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">chr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_LNUMBER">0x08</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line677"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_INC">++</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line678"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line679"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$substr_chrs_c_2</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'\t'</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line680"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_VARIABLE">$utf8</span><span class="token T_WHITESPACE"> </span><span class="token T_CONCAT_EQUAL">.=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">chr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_LNUMBER">0x09</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line681"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_INC">++</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line682"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line683"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$substr_chrs_c_2</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'\n'</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line684"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_VARIABLE">$utf8</span><span class="token T_WHITESPACE"> </span><span class="token T_CONCAT_EQUAL">.=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">chr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_LNUMBER">0x0A</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line685"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_INC">++</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line686"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line687"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$substr_chrs_c_2</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'\f'</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line688"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_VARIABLE">$utf8</span><span class="token T_WHITESPACE"> </span><span class="token T_CONCAT_EQUAL">.=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">chr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_LNUMBER">0x0C</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line689"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_INC">++</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line690"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line691"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$substr_chrs_c_2</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'\r'</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line692"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_VARIABLE">$utf8</span><span class="token T_WHITESPACE"> </span><span class="token T_CONCAT_EQUAL">.=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">chr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_LNUMBER">0x0D</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line693"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_INC">++</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line694"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line695"><br/></div><div id="line696"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$substr_chrs_c_2</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'\\"'</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line697"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$substr_chrs_c_2</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'\\\''</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line698"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$substr_chrs_c_2</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'\\\\'</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line699"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$substr_chrs_c_2</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'\\/'</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line700"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$delim</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'"'</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$substr_chrs_c_2</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_NOT_EQUAL">!=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'\\\''</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_OR">||</span></pre></div><div id="line701"><pre><span class="token T_WHITESPACE">	                                   </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$delim</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">"'"</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$substr_chrs_c_2</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_NOT_EQUAL">!=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'\\"'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line702"><pre><span class="token T_WHITESPACE">	                                    </span><span class="token T_VARIABLE">$utf8</span><span class="token T_WHITESPACE"> </span><span class="token T_CONCAT_EQUAL">.=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$chrs</span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_INC">++</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line703"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line704"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line705"><br/></div><div id="line706"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">preg_match</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/\\\u[0-9A-F]{4}/i'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$chrs</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">6</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line707"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_COMMENT">// single, escaped unicode character</span></pre></div><div id="line708"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_VARIABLE">$utf16</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">chr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">hexdec</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$chrs</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$c</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_PLUS">+</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">2</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">2</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line709"><pre><span class="token T_WHITESPACE">	                                       </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">chr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">hexdec</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$chrs</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$c</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_PLUS">+</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">2</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line710"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_VARIABLE">$utf8</span><span class="token T_WHITESPACE"> </span><span class="token T_CONCAT_EQUAL">.=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">utf162utf8</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$utf16</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line711"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_VARIABLE">$c</span><span class="token T_WHITESPACE"> </span><span class="token T_PLUS_EQUAL">+=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">5</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line712"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line713"><br/></div><div id="line714"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$ord_chrs_c</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_GREATER_OR_EQUAL">&gt;=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x20</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$ord_chrs_c</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_SMALLER_OR_EQUAL">&lt;=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x7F</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line715"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_VARIABLE">$utf8</span><span class="token T_WHITESPACE"> </span><span class="token T_CONCAT_EQUAL">.=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$chrs</span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line716"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line717"><br/></div><div id="line718"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$ord_chrs_c</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0xE0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0xC0</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line719"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_COMMENT">// characters U-00000080 - U-000007FF, mask 110XXXXX</span></pre></div><div id="line720"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_COMMENT">//see http://www.cl.cam.ac.uk/~mgk25/unicode.html#utf-8</span></pre></div><div id="line721"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_VARIABLE">$utf8</span><span class="token T_WHITESPACE"> </span><span class="token T_CONCAT_EQUAL">.=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$chrs</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">2</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line722"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_INC">++</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line723"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line724"><br/></div><div id="line725"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$ord_chrs_c</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0xF0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0xE0</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line726"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_COMMENT">// characters U-00000800 - U-0000FFFF, mask 1110XXXX</span></pre></div><div id="line727"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_COMMENT">// see http://www.cl.cam.ac.uk/~mgk25/unicode.html#utf-8</span></pre></div><div id="line728"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_VARIABLE">$utf8</span><span class="token T_WHITESPACE"> </span><span class="token T_CONCAT_EQUAL">.=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$chrs</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">3</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line729"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_VARIABLE">$c</span><span class="token T_WHITESPACE"> </span><span class="token T_PLUS_EQUAL">+=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">2</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line730"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line731"><br/></div><div id="line732"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$ord_chrs_c</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0xF8</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0xF0</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line733"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_COMMENT">// characters U-00010000 - U-001FFFFF, mask 11110XXX</span></pre></div><div id="line734"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_COMMENT">// see http://www.cl.cam.ac.uk/~mgk25/unicode.html#utf-8</span></pre></div><div id="line735"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_VARIABLE">$utf8</span><span class="token T_WHITESPACE"> </span><span class="token T_CONCAT_EQUAL">.=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$chrs</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line736"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_VARIABLE">$c</span><span class="token T_WHITESPACE"> </span><span class="token T_PLUS_EQUAL">+=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">3</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line737"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line738"><br/></div><div id="line739"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$ord_chrs_c</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0xFC</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0xF8</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line740"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_COMMENT">// characters U-00200000 - U-03FFFFFF, mask 111110XX</span></pre></div><div id="line741"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_COMMENT">// see http://www.cl.cam.ac.uk/~mgk25/unicode.html#utf-8</span></pre></div><div id="line742"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_VARIABLE">$utf8</span><span class="token T_WHITESPACE"> </span><span class="token T_CONCAT_EQUAL">.=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$chrs</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">5</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line743"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_VARIABLE">$c</span><span class="token T_WHITESPACE"> </span><span class="token T_PLUS_EQUAL">+=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line744"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line745"><br/></div><div id="line746"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$ord_chrs_c</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0xFE</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0xFC</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line747"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_COMMENT">// characters U-04000000 - U-7FFFFFFF, mask 1111110X</span></pre></div><div id="line748"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_COMMENT">// see http://www.cl.cam.ac.uk/~mgk25/unicode.html#utf-8</span></pre></div><div id="line749"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_VARIABLE">$utf8</span><span class="token T_WHITESPACE"> </span><span class="token T_CONCAT_EQUAL">.=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$chrs</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">6</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line750"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_VARIABLE">$c</span><span class="token T_WHITESPACE"> </span><span class="token T_PLUS_EQUAL">+=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">5</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line751"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line752"><br/></div><div id="line753"><pre><span class="token T_WHITESPACE">	                        </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line754"><br/></div><div id="line755"><pre><span class="token T_WHITESPACE">	                    </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line756"><br/></div><div id="line757"><pre><span class="token T_WHITESPACE">	                    </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$utf8</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line758"><br/></div><div id="line759"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_ELSEIF">elseif</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">preg_match</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/^\[.*\]$/s'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$str</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_OR">||</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">preg_match</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/^\{.*\}$/s'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$str</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line760"><pre><span class="token T_WHITESPACE">	                    </span><span class="token T_COMMENT">// array, or object notation</span></pre></div><div id="line761"><br/></div><div id="line762"><pre><span class="token T_WHITESPACE">	                    </span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$str</span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'['</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line763"><pre><span class="token T_WHITESPACE">	                        </span><span class="token T_VARIABLE">$stk</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">SERVICES_JSON_IN_ARR</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line764"><pre><span class="token T_WHITESPACE">	                        </span><span class="token T_VARIABLE">$arr</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line765"><pre><span class="token T_WHITESPACE">	                    </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_ELSE">else</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line766"><pre><span class="token T_WHITESPACE">	                        </span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">use</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">SERVICES_JSON_LOOSE_TYPE</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line767"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_VARIABLE">$stk</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">SERVICES_JSON_IN_OBJ</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line768"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_VARIABLE">$obj</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line769"><pre><span class="token T_WHITESPACE">	                        </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_ELSE">else</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line770"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_VARIABLE">$stk</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">SERVICES_JSON_IN_OBJ</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line771"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_VARIABLE">$obj</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_NEW">new</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">stdClass</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line772"><pre><span class="token T_WHITESPACE">	                        </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line773"><pre><span class="token T_WHITESPACE">	                    </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line774"><br/></div><div id="line775"><pre><span class="token T_WHITESPACE">	                    </span><span class="token T_STRING">array_push</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$stk</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'what'</span><span class="token T_WHITESPACE">  </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">SERVICES_JSON_SLICE</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line776"><pre><span class="token T_WHITESPACE">	                                           </span><span class="token T_CONSTANT_ENCAPSED_STRING">'where'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line777"><pre><span class="token T_WHITESPACE">	                                           </span><span class="token T_CONSTANT_ENCAPSED_STRING">'delim'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line778"><br/></div><div id="line779"><pre><span class="token T_WHITESPACE">	                    </span><span class="token T_VARIABLE">$chrs</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$str</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line780"><pre><span class="token T_WHITESPACE">	                    </span><span class="token T_VARIABLE">$chrs</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">reduce_string</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$chrs</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line781"><br/></div><div id="line782"><pre><span class="token T_WHITESPACE">	                    </span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$chrs</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line783"><pre><span class="token T_WHITESPACE">	                        </span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">reset</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$stk</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">SERVICES_JSON_IN_ARR</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line784"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$arr</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line785"><br/></div><div id="line786"><pre><span class="token T_WHITESPACE">	                        </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_ELSE">else</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line787"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$obj</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line788"><br/></div><div id="line789"><pre><span class="token T_WHITESPACE">	                        </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line790"><pre><span class="token T_WHITESPACE">	                    </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line791"><br/></div><div id="line792"><pre><span class="token T_WHITESPACE">	                    </span><span class="token T_COMMENT">//print("\nparsing {$chrs}\n");</span></pre></div><div id="line793"><br/></div><div id="line794"><pre><span class="token T_WHITESPACE">	                    </span><span class="token T_VARIABLE">$strlen_chrs</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$chrs</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line795"><br/></div><div id="line796"><pre><span class="token T_WHITESPACE">	                    </span><span class="token T_FOR">for</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$c</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$c</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_SMALLER_OR_EQUAL">&lt;=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$strlen_chrs</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_INC">++</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line797"><br/></div><div id="line798"><pre><span class="token T_WHITESPACE">	                        </span><span class="token T_VARIABLE">$top</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">end</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$stk</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line799"><pre><span class="token T_WHITESPACE">	                        </span><span class="token T_VARIABLE">$substr_chrs_c_2</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$chrs</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">2</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line800"><br/></div><div id="line801"><pre><span class="token T_WHITESPACE">	                        </span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$c</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$strlen_chrs</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_OR">||</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$chrs</span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">','</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$top</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'what'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">SERVICES_JSON_SLICE</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line802"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_COMMENT">// found a comma that is not inside a string, array, etc.,</span></pre></div><div id="line803"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_COMMENT">// OR we've reached the end of the character list</span></pre></div><div id="line804"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_VARIABLE">$slice</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$chrs</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$top</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'where'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$c</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$top</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'where'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line805"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_STRING">array_push</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$stk</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'what'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">SERVICES_JSON_SLICE</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'where'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$c</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_PLUS">+</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'delim'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line806"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_COMMENT">//print("Found split at {$c}: ".substr($chrs, $top['where'], (1 + $c - $top['where']))."\n");</span></pre></div><div id="line807"><br/></div><div id="line808"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">reset</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$stk</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">SERVICES_JSON_IN_ARR</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line809"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_COMMENT">// we are in an array, so just push an element onto the stack</span></pre></div><div id="line810"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_STRING">array_push</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$arr</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">decode</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$slice</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line811"><br/></div><div id="line812"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_ELSEIF">elseif</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">reset</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$stk</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">SERVICES_JSON_IN_OBJ</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line813"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_COMMENT">// we are in an object, so figure</span></pre></div><div id="line814"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_COMMENT">// out the property name and set an</span></pre></div><div id="line815"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_COMMENT">// element in an associative array,</span></pre></div><div id="line816"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_COMMENT">// for now</span></pre></div><div id="line817"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_VARIABLE">$parts</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line818"><br/></div><div id="line819"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">preg_match</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/^\s*(["\'].*[^\\\]["\'])\s*:\s*(\S.*),?$/Uis'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$slice</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$parts</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line820"><pre><span class="token T_WHITESPACE">	                                    </span><span class="token T_COMMENT">// "name":value pair</span></pre></div><div id="line821"><pre><span class="token T_WHITESPACE">	                                    </span><span class="token T_VARIABLE">$key</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">decode</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$parts</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line822"><pre><span class="token T_WHITESPACE">	                                    </span><span class="token T_VARIABLE">$val</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">decode</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$parts</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">2</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line823"><br/></div><div id="line824"><pre><span class="token T_WHITESPACE">	                                    </span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">use</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">SERVICES_JSON_LOOSE_TYPE</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line825"><pre><span class="token T_WHITESPACE">	                                        </span><span class="token T_VARIABLE">$obj</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$key</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$val</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line826"><pre><span class="token T_WHITESPACE">	                                    </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_ELSE">else</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line827"><pre><span class="token T_WHITESPACE">	                                        </span><span class="token T_VARIABLE">$obj</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_VARIABLE">$key</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$val</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line828"><pre><span class="token T_WHITESPACE">	                                    </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line829"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_ELSEIF">elseif</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">preg_match</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/^\s*(\w+)\s*:\s*(\S.*),?$/Uis'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$slice</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$parts</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line830"><pre><span class="token T_WHITESPACE">	                                    </span><span class="token T_COMMENT">// name:value pair, where name is unquoted</span></pre></div><div id="line831"><pre><span class="token T_WHITESPACE">	                                    </span><span class="token T_VARIABLE">$key</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$parts</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line832"><pre><span class="token T_WHITESPACE">	                                    </span><span class="token T_VARIABLE">$val</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">decode</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$parts</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">2</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line833"><br/></div><div id="line834"><pre><span class="token T_WHITESPACE">	                                    </span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">use</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">SERVICES_JSON_LOOSE_TYPE</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line835"><pre><span class="token T_WHITESPACE">	                                        </span><span class="token T_VARIABLE">$obj</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$key</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$val</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line836"><pre><span class="token T_WHITESPACE">	                                    </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_ELSE">else</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line837"><pre><span class="token T_WHITESPACE">	                                        </span><span class="token T_VARIABLE">$obj</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_VARIABLE">$key</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$val</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line838"><pre><span class="token T_WHITESPACE">	                                    </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line839"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line840"><br/></div><div id="line841"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line842"><br/></div><div id="line843"><pre><span class="token T_WHITESPACE">	                        </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_ELSEIF">elseif</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$chrs</span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'"'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_OR">||</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$chrs</span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">"'"</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$top</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'what'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_NOT_EQUAL">!=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">SERVICES_JSON_IN_STR</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line844"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_COMMENT">// found a quote, and we are not inside a string</span></pre></div><div id="line845"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_STRING">array_push</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$stk</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'what'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">SERVICES_JSON_IN_STR</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'where'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'delim'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$chrs</span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line846"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_COMMENT">//print("Found start of string at {$c}\n");</span></pre></div><div id="line847"><br/></div><div id="line848"><pre><span class="token T_WHITESPACE">	                        </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_ELSEIF">elseif</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$chrs</span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$top</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'delim'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span></pre></div><div id="line849"><pre><span class="token T_WHITESPACE">	                                 </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$top</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'what'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">SERVICES_JSON_IN_STR</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span></pre></div><div id="line850"><pre><span class="token T_WHITESPACE">	                                 </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$chrs</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">rtrim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$chrs</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'\\'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_PERCENT">%</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">2</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_NOT_EQUAL">!=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line851"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_COMMENT">// found a quote, we're in a string, and it's not escaped</span></pre></div><div id="line852"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_COMMENT">// we know that it's not escaped becase there is _not_ an</span></pre></div><div id="line853"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_COMMENT">// odd number of backslashes at the end of the string so far</span></pre></div><div id="line854"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_STRING">array_pop</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$stk</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line855"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_COMMENT">//print("Found end of string at {$c}: ".substr($chrs, $top['where'], (1 + 1 + $c - $top['where']))."\n");</span></pre></div><div id="line856"><br/></div><div id="line857"><pre><span class="token T_WHITESPACE">	                        </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_ELSEIF">elseif</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$chrs</span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'['</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span></pre></div><div id="line858"><pre><span class="token T_WHITESPACE">	                                 </span><span class="token T_STRING">in_array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$top</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'what'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">SERVICES_JSON_SLICE</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">SERVICES_JSON_IN_ARR</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">SERVICES_JSON_IN_OBJ</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line859"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_COMMENT">// found a left-bracket, and we are in an array, object, or slice</span></pre></div><div id="line860"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_STRING">array_push</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$stk</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'what'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">SERVICES_JSON_IN_ARR</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'where'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'delim'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line861"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_COMMENT">//print("Found start of array at {$c}\n");</span></pre></div><div id="line862"><br/></div><div id="line863"><pre><span class="token T_WHITESPACE">	                        </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_ELSEIF">elseif</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$chrs</span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">']'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$top</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'what'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">SERVICES_JSON_IN_ARR</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line864"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_COMMENT">// found a right-bracket, and we're in an array</span></pre></div><div id="line865"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_STRING">array_pop</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$stk</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line866"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_COMMENT">//print("Found end of array at {$c}: ".substr($chrs, $top['where'], (1 + $c - $top['where']))."\n");</span></pre></div><div id="line867"><br/></div><div id="line868"><pre><span class="token T_WHITESPACE">	                        </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_ELSEIF">elseif</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$chrs</span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'{'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span></pre></div><div id="line869"><pre><span class="token T_WHITESPACE">	                                 </span><span class="token T_STRING">in_array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$top</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'what'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">SERVICES_JSON_SLICE</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">SERVICES_JSON_IN_ARR</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">SERVICES_JSON_IN_OBJ</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line870"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_COMMENT">// found a left-brace, and we are in an array, object, or slice</span></pre></div><div id="line871"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_STRING">array_push</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$stk</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'what'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">SERVICES_JSON_IN_OBJ</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'where'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'delim'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line872"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_COMMENT">//print("Found start of object at {$c}\n");</span></pre></div><div id="line873"><br/></div><div id="line874"><pre><span class="token T_WHITESPACE">	                        </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_ELSEIF">elseif</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$chrs</span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'}'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$top</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'what'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">SERVICES_JSON_IN_OBJ</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line875"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_COMMENT">// found a right-brace, and we're in an object</span></pre></div><div id="line876"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_STRING">array_pop</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$stk</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line877"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_COMMENT">//print("Found end of object at {$c}: ".substr($chrs, $top['where'], (1 + $c - $top['where']))."\n");</span></pre></div><div id="line878"><br/></div><div id="line879"><pre><span class="token T_WHITESPACE">	                        </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_ELSEIF">elseif</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$substr_chrs_c_2</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/*'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span></pre></div><div id="line880"><pre><span class="token T_WHITESPACE">	                                 </span><span class="token T_STRING">in_array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$top</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'what'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">SERVICES_JSON_SLICE</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">SERVICES_JSON_IN_ARR</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">SERVICES_JSON_IN_OBJ</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line881"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_COMMENT">// found a comment start, and we are in an array, object, or slice</span></pre></div><div id="line882"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_STRING">array_push</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$stk</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'what'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">SERVICES_JSON_IN_CMT</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'where'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'delim'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line883"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_VARIABLE">$c</span><span class="token T_INC">++</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line884"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_COMMENT">//print("Found start of comment at {$c}\n");</span></pre></div><div id="line885"><br/></div><div id="line886"><pre><span class="token T_WHITESPACE">	                        </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_ELSEIF">elseif</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$substr_chrs_c_2</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'*/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$top</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'what'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">SERVICES_JSON_IN_CMT</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line887"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_COMMENT">// found a comment end, and we're in one now</span></pre></div><div id="line888"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_STRING">array_pop</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$stk</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line889"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_VARIABLE">$c</span><span class="token T_INC">++</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line890"><br/></div><div id="line891"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_FOR">for</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$i</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$top</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'where'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$i</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_SMALLER_OR_EQUAL">&lt;=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_INC">++</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line892"><pre><span class="token T_WHITESPACE">	                                </span><span class="token T_VARIABLE">$chrs</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr_replace</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$chrs</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">' '</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line893"><br/></div><div id="line894"><pre><span class="token T_WHITESPACE">	                            </span><span class="token T_COMMENT">//print("Found end of comment at {$c}: ".substr($chrs, $top['where'], (1 + $c - $top['where']))."\n");</span></pre></div><div id="line895"><br/></div><div id="line896"><pre><span class="token T_WHITESPACE">	                        </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line897"><br/></div><div id="line898"><pre><span class="token T_WHITESPACE">	                    </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line899"><br/></div><div id="line900"><pre><span class="token T_WHITESPACE">	                    </span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">reset</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$stk</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">SERVICES_JSON_IN_ARR</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line901"><pre><span class="token T_WHITESPACE">	                        </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$arr</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line902"><br/></div><div id="line903"><pre><span class="token T_WHITESPACE">	                    </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_ELSEIF">elseif</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">reset</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$stk</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">SERVICES_JSON_IN_OBJ</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line904"><pre><span class="token T_WHITESPACE">	                        </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$obj</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line905"><br/></div><div id="line906"><pre><span class="token T_WHITESPACE">	                    </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line907"><br/></div><div id="line908"><pre><span class="token T_WHITESPACE">	                </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line909"><pre><span class="token T_WHITESPACE">	        </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line910"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line911"><br/></div><div id="line912"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">isError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$data</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$code</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line913"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line914"><pre><span class="token T_WHITESPACE">	        </span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">class_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'pear'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line915"><pre><span class="token T_WHITESPACE">	            </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">PEAR</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">isError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$data</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$code</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line916"><pre><span class="token T_WHITESPACE">	        </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_ELSEIF">elseif</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">is_object</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$data</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">get_class</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$data</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'services_json_error'</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_OR">||</span></pre></div><div id="line917"><pre><span class="token T_WHITESPACE">	                                 </span><span class="token T_STRING">is_subclass_of</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$data</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'services_json_error'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line918"><pre><span class="token T_WHITESPACE">	            </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line919"><pre><span class="token T_WHITESPACE">	        </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line920"><br/></div><div id="line921"><pre><span class="token T_WHITESPACE">	        </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line922"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line923"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line924"><br/></div><div id="line925"><pre><span class="token T_WHITESPACE">    </span><span class="token T_CLASS">class</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">Akeeba_Services_JSON_Error</span></pre></div><div id="line926"><pre><span class="token T_WHITESPACE">    </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line927"><pre><span class="token T_WHITESPACE">        </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">Akeeba_Services_JSON_Error</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$message</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'unknown error'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$code</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line928"><pre><span class="token T_WHITESPACE">                                     </span><span class="token T_VARIABLE">$mode</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$options</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$userinfo</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line929"><pre><span class="token T_WHITESPACE">        </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line930"><br/></div><div id="line931"><pre><span class="token T_WHITESPACE">        </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line932"><pre><span class="token T_WHITESPACE">    </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line933"><pre><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line934"><br/></div><div id="line935"><pre><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">function_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'json_encode'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line936"><pre><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line937"><pre><span class="token T_WHITESPACE">	</span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">json_encode</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$options</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line938"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$flags</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">SERVICES_JSON_LOOSE_TYPE</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line939"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$options</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">JSON_FORCE_OBJECT</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$flags</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line940"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$encoder</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_NEW">new</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">Akeeba_Services_JSON</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$flags</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line941"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$encoder</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">encode</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line942"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line943"><pre><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line944"><br/></div><div id="line945"><pre><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">function_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'json_decode'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line946"><pre><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line947"><pre><span class="token T_WHITESPACE">	</span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">json_decode</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$assoc</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line948"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line949"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$flags</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line950"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$assoc</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$flags</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">SERVICES_JSON_LOOSE_TYPE</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line951"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$decoder</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_NEW">new</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">Akeeba_Services_JSON</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$flags</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line952"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$decoder</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">decode</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line953"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line954"><pre><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line955"><br/></div><div id="line956"><pre><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line957"><pre><span class="token T_DOC_COMMENT"> * Akeeba Restore</span></pre></div><div id="line958"><pre><span class="token T_DOC_COMMENT"> * A JSON-powered JPA, JPS and ZIP archive extraction library</span></pre></div><div id="line959"><pre><span class="token T_DOC_COMMENT"> *</span></pre></div><div id="line960"><pre><span class="token T_DOC_COMMENT"> * @copyright   2010-2014 Nicholas K. Dionysopoulos / Akeeba Ltd.</span></pre></div><div id="line961"><pre><span class="token T_DOC_COMMENT"> * @license     GNU GPL v2 or - at your option - any later version</span></pre></div><div id="line962"><pre><span class="token T_DOC_COMMENT"> * @package     akeebabackup</span></pre></div><div id="line963"><pre><span class="token T_DOC_COMMENT"> * @subpackage  kickstart</span></pre></div><div id="line964"><pre><span class="token T_DOC_COMMENT"> */</span></pre></div><div id="line965"><br/></div><div id="line966"><pre><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line967"><pre><span class="token T_DOC_COMMENT"> * The base class of Akeeba Engine objects. Allows for error and warnings logging</span></pre></div><div id="line968"><pre><span class="token T_DOC_COMMENT"> * and propagation. Largely based on the Joomla! 1.5 JObject class.</span></pre></div><div id="line969"><pre><span class="token T_DOC_COMMENT"> */</span></pre></div><div id="line970"><pre><span class="token T_ABSTRACT">abstract</span><span class="token T_WHITESPACE"> </span><span class="token T_CLASS">class</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKAbstractObject</span></pre></div><div id="line971"><pre><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line972"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var	array	An array of errors */</span></pre></div><div id="line973"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PRIVATE">private</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$_errors</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line974"><br/></div><div id="line975"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var	array	The queue size of the $_errors array. Set to 0 for infinite size. */</span></pre></div><div id="line976"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$_errors_queue_size</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line977"><br/></div><div id="line978"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var	array	An array of warnings */</span></pre></div><div id="line979"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PRIVATE">private</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$_warnings</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line980"><br/></div><div id="line981"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var	array	The queue size of the $_warnings array. Set to 0 for infinite size. */</span></pre></div><div id="line982"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$_warnings_queue_size</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line983"><br/></div><div id="line984"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line985"><pre><span class="token T_DOC_COMMENT">	 * Public constructor, makes sure we are instantiated only by the factory class</span></pre></div><div id="line986"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line987"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">__construct</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line988"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line989"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">/*</span></pre></div><div id="line990"><pre><span class="token T_COMMENT">		// Assisted Singleton pattern</span></pre></div><div id="line991"><pre><span class="token T_COMMENT">		if(function_exists('debug_backtrace'))</span></pre></div><div id="line992"><pre><span class="token T_COMMENT">		{</span></pre></div><div id="line993"><pre><span class="token T_COMMENT">			$caller=debug_backtrace();</span></pre></div><div id="line994"><pre><span class="token T_COMMENT">			if(</span></pre></div><div id="line995"><pre><span class="token T_COMMENT">				($caller[1]['class'] != 'AKFactory') &amp;&amp;</span></pre></div><div id="line996"><pre><span class="token T_COMMENT">				($caller[2]['class'] != 'AKFactory') &amp;&amp;</span></pre></div><div id="line997"><pre><span class="token T_COMMENT">				($caller[3]['class'] != 'AKFactory') &amp;&amp;</span></pre></div><div id="line998"><pre><span class="token T_COMMENT">				($caller[4]['class'] != 'AKFactory')</span></pre></div><div id="line999"><pre><span class="token T_COMMENT">			) {</span></pre></div><div id="line1000"><pre><span class="token T_COMMENT">				var_dump(debug_backtrace());</span></pre></div><div id="line1001"><pre><span class="token T_COMMENT">				trigger_error("You can't create direct descendants of ".__CLASS__, E_USER_ERROR);</span></pre></div><div id="line1002"><pre><span class="token T_COMMENT">			}</span></pre></div><div id="line1003"><pre><span class="token T_COMMENT">		}</span></pre></div><div id="line1004"><pre><span class="token T_COMMENT">		*/</span></pre></div><div id="line1005"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1006"><br/></div><div id="line1007"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line1008"><pre><span class="token T_DOC_COMMENT">	 * Get the most recent error message</span></pre></div><div id="line1009"><pre><span class="token T_DOC_COMMENT">	 * @param	integer	$i Optional error index</span></pre></div><div id="line1010"><pre><span class="token T_DOC_COMMENT">	 * @return	string	Error message</span></pre></div><div id="line1011"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line1012"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">getError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$i</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1013"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1014"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">getItemFromArray</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">_errors</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1015"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1016"><br/></div><div id="line1017"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line1018"><pre><span class="token T_DOC_COMMENT">	 * Return all errors, if any</span></pre></div><div id="line1019"><pre><span class="token T_DOC_COMMENT">	 * @return	array	Array of error messages</span></pre></div><div id="line1020"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line1021"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">getErrors</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1022"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1023"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">_errors</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1024"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1025"><br/></div><div id="line1026"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line1027"><pre><span class="token T_DOC_COMMENT">	 * Add an error message</span></pre></div><div id="line1028"><pre><span class="token T_DOC_COMMENT">	 * @param	string $error Error message</span></pre></div><div id="line1029"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line1030"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$error</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1031"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1032"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">_errors_queue_size</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_GT">&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1033"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1034"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">count</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">_errors</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_GREATER_OR_EQUAL">&gt;=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">_errors_queue_size</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1035"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1036"><pre><span class="token T_WHITESPACE">				</span><span class="token T_STRING">array_shift</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">_errors</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1037"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1038"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1039"><pre><span class="token T_WHITESPACE">		</span><span class="token T_STRING">array_push</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">_errors</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$error</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1040"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1041"><br/></div><div id="line1042"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line1043"><pre><span class="token T_DOC_COMMENT">	 * Resets all error messages</span></pre></div><div id="line1044"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line1045"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">resetErrors</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1046"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1047"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">_errors</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1048"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1049"><br/></div><div id="line1050"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line1051"><pre><span class="token T_DOC_COMMENT">	 * Get the most recent warning message</span></pre></div><div id="line1052"><pre><span class="token T_DOC_COMMENT">	 * @param	integer	$i Optional warning index</span></pre></div><div id="line1053"><pre><span class="token T_DOC_COMMENT">	 * @return	string	Error message</span></pre></div><div id="line1054"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line1055"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">getWarning</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$i</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1056"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1057"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">getItemFromArray</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">_warnings</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1058"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1059"><br/></div><div id="line1060"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line1061"><pre><span class="token T_DOC_COMMENT">	 * Return all warnings, if any</span></pre></div><div id="line1062"><pre><span class="token T_DOC_COMMENT">	 * @return	array	Array of error messages</span></pre></div><div id="line1063"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line1064"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">getWarnings</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1065"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1066"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">_warnings</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1067"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1068"><br/></div><div id="line1069"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line1070"><pre><span class="token T_DOC_COMMENT">	 * Add an error message</span></pre></div><div id="line1071"><pre><span class="token T_DOC_COMMENT">	 * @param	string $error Error message</span></pre></div><div id="line1072"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line1073"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">setWarning</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$warning</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1074"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1075"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">_warnings_queue_size</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_GT">&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1076"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1077"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">count</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">_warnings</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_GREATER_OR_EQUAL">&gt;=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">_warnings_queue_size</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1078"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1079"><pre><span class="token T_WHITESPACE">				</span><span class="token T_STRING">array_shift</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">_warnings</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1080"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1081"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1082"><br/></div><div id="line1083"><pre><span class="token T_WHITESPACE">		</span><span class="token T_STRING">array_push</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">_warnings</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$warning</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1084"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1085"><br/></div><div id="line1086"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line1087"><pre><span class="token T_DOC_COMMENT">	 * Resets all warning messages</span></pre></div><div id="line1088"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line1089"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">resetWarnings</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1090"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1091"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">_warnings</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1092"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1093"><br/></div><div id="line1094"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line1095"><pre><span class="token T_DOC_COMMENT">	 * Propagates errors and warnings to a foreign object. The foreign object SHOULD</span></pre></div><div id="line1096"><pre><span class="token T_DOC_COMMENT">	 * implement the setError() and/or setWarning() methods but DOESN'T HAVE TO be of</span></pre></div><div id="line1097"><pre><span class="token T_DOC_COMMENT">	 * AKAbstractObject type. For example, this can even be used to propagate to a</span></pre></div><div id="line1098"><pre><span class="token T_DOC_COMMENT">	 * JObject instance in Joomla!. Propagated items will be removed from ourselves.</span></pre></div><div id="line1099"><pre><span class="token T_DOC_COMMENT">	 * @param object $object The object to propagate errors and warnings to.</span></pre></div><div id="line1100"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line1101"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">propagateToObject</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_VARIABLE">$object</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1102"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1103"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Skip non-objects</span></pre></div><div id="line1104"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">is_object</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$object</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_RETURN">return</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1105"><br/></div><div id="line1106"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">method_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$object</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'setError'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1107"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1108"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">_errors</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1109"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1110"><pre><span class="token T_WHITESPACE">				</span><span class="token T_FOREACH">foreach</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">_errors</span><span class="token T_WHITESPACE"> </span><span class="token T_AS">as</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$error</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1111"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1112"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$object</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$error</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1113"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1114"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">_errors</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1115"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1116"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1117"><br/></div><div id="line1118"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">method_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$object</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'setWarning'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1119"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1120"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">_warnings</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1121"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1122"><pre><span class="token T_WHITESPACE">				</span><span class="token T_FOREACH">foreach</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">_warnings</span><span class="token T_WHITESPACE"> </span><span class="token T_AS">as</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$warning</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1123"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1124"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$object</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setWarning</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$warning</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1125"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1126"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">_warnings</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1127"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1128"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1129"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1130"><br/></div><div id="line1131"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line1132"><pre><span class="token T_DOC_COMMENT">	 * Propagates errors and warnings from a foreign object. Each propagated list is</span></pre></div><div id="line1133"><pre><span class="token T_DOC_COMMENT">	 * then cleared on the foreign object, as long as it implements resetErrors() and/or</span></pre></div><div id="line1134"><pre><span class="token T_DOC_COMMENT">	 * resetWarnings() methods.</span></pre></div><div id="line1135"><pre><span class="token T_DOC_COMMENT">	 * @param object $object The object to propagate errors and warnings from</span></pre></div><div id="line1136"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line1137"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">propagateFromObject</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_VARIABLE">$object</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1138"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1139"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">method_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$object</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'getErrors'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1140"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1141"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$errors</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$object</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">getErrors</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1142"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$errors</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1143"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1144"><pre><span class="token T_WHITESPACE">				</span><span class="token T_FOREACH">foreach</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$errors</span><span class="token T_WHITESPACE"> </span><span class="token T_AS">as</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$error</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1145"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1146"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$error</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1147"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1148"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1149"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">method_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$object</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'resetErrors'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1150"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1151"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$object</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">resetErrors</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1152"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1153"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1154"><br/></div><div id="line1155"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">method_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$object</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'getWarnings'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1156"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1157"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$warnings</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$object</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">getWarnings</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1158"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$warnings</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1159"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1160"><pre><span class="token T_WHITESPACE">				</span><span class="token T_FOREACH">foreach</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$warnings</span><span class="token T_WHITESPACE"> </span><span class="token T_AS">as</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$warning</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1161"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1162"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setWarning</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$warning</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1163"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1164"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1165"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">method_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$object</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'resetWarnings'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1166"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1167"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$object</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">resetWarnings</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1168"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1169"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1170"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1171"><br/></div><div id="line1172"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line1173"><pre><span class="token T_DOC_COMMENT">	 * Sets the size of the error queue (acts like a LIFO buffer)</span></pre></div><div id="line1174"><pre><span class="token T_DOC_COMMENT">	 * @param int $newSize The new queue size. Set to 0 for infinite length.</span></pre></div><div id="line1175"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line1176"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">setErrorsQueueSize</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$newSize</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1177"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1178"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">_errors_queue_size</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_INT_CAST">(int)</span><span class="token T_VARIABLE">$newSize</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1179"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1180"><br/></div><div id="line1181"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line1182"><pre><span class="token T_DOC_COMMENT">	 * Sets the size of the warnings queue (acts like a LIFO buffer)</span></pre></div><div id="line1183"><pre><span class="token T_DOC_COMMENT">	 * @param int $newSize The new queue size. Set to 0 for infinite length.</span></pre></div><div id="line1184"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line1185"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">setWarningsQueueSize</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$newSize</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1186"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1187"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">_warnings_queue_size</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_INT_CAST">(int)</span><span class="token T_VARIABLE">$newSize</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1188"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1189"><br/></div><div id="line1190"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line1191"><pre><span class="token T_DOC_COMMENT">	 * Returns the last item of a LIFO string message queue, or a specific item</span></pre></div><div id="line1192"><pre><span class="token T_DOC_COMMENT">	 * if so specified.</span></pre></div><div id="line1193"><pre><span class="token T_DOC_COMMENT">	 * @param array $array An array of strings, holding messages</span></pre></div><div id="line1194"><pre><span class="token T_DOC_COMMENT">	 * @param int $i Optional message index</span></pre></div><div id="line1195"><pre><span class="token T_DOC_COMMENT">	 * @return mixed The message string, or false if the key doesn't exist</span></pre></div><div id="line1196"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line1197"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PRIVATE">private</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">getItemFromArray</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$array</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$i</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1198"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1199"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Find the item</span></pre></div><div id="line1200"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$i</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_IDENTICAL">===</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1201"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Default, return the last item</span></pre></div><div id="line1202"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$item</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">end</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$array</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1203"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1204"><pre><span class="token T_WHITESPACE">		</span><span class="token T_ELSE">else</span></pre></div><div id="line1205"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">array_key_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$array</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1206"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// If $i has been specified but does not exist, return false</span></pre></div><div id="line1207"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1208"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1209"><pre><span class="token T_WHITESPACE">		</span><span class="token T_ELSE">else</span></pre></div><div id="line1210"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1211"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$item</span><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$array</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1212"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1213"><br/></div><div id="line1214"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$item</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1215"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1216"><br/></div><div id="line1217"><pre><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1218"><br/></div><div id="line1219"><pre><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line1220"><pre><span class="token T_DOC_COMMENT"> * Akeeba Restore</span></pre></div><div id="line1221"><pre><span class="token T_DOC_COMMENT"> * A JSON-powered JPA, JPS and ZIP archive extraction library</span></pre></div><div id="line1222"><pre><span class="token T_DOC_COMMENT"> *</span></pre></div><div id="line1223"><pre><span class="token T_DOC_COMMENT"> * @copyright   2010-2014 Nicholas K. Dionysopoulos / Akeeba Ltd.</span></pre></div><div id="line1224"><pre><span class="token T_DOC_COMMENT"> * @license     GNU GPL v2 or - at your option - any later version</span></pre></div><div id="line1225"><pre><span class="token T_DOC_COMMENT"> * @package     akeebabackup</span></pre></div><div id="line1226"><pre><span class="token T_DOC_COMMENT"> * @subpackage  kickstart</span></pre></div><div id="line1227"><pre><span class="token T_DOC_COMMENT"> */</span></pre></div><div id="line1228"><br/></div><div id="line1229"><pre><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line1230"><pre><span class="token T_DOC_COMMENT"> * The superclass of all Akeeba Kickstart parts. The "parts" are intelligent stateful</span></pre></div><div id="line1231"><pre><span class="token T_DOC_COMMENT"> * classes which perform a single procedure and have preparation, running and</span></pre></div><div id="line1232"><pre><span class="token T_DOC_COMMENT"> * finalization phases. The transition between phases is handled automatically by</span></pre></div><div id="line1233"><pre><span class="token T_DOC_COMMENT"> * this superclass' tick() final public method, which should be the ONLY public API</span></pre></div><div id="line1234"><pre><span class="token T_DOC_COMMENT"> * exposed to the rest of the Akeeba Engine.</span></pre></div><div id="line1235"><pre><span class="token T_DOC_COMMENT"> */</span></pre></div><div id="line1236"><pre><span class="token T_ABSTRACT">abstract</span><span class="token T_WHITESPACE"> </span><span class="token T_CLASS">class</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKAbstractPart</span><span class="token T_WHITESPACE"> </span><span class="token T_EXTENDS">extends</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKAbstractObject</span></pre></div><div id="line1237"><pre><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1238"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line1239"><pre><span class="token T_DOC_COMMENT">	 * Indicates whether this part has finished its initialisation cycle</span></pre></div><div id="line1240"><pre><span class="token T_DOC_COMMENT">	 * @var boolean</span></pre></div><div id="line1241"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line1242"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$isPrepared</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1243"><br/></div><div id="line1244"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line1245"><pre><span class="token T_DOC_COMMENT">	 * Indicates whether this part has more work to do (it's in running state)</span></pre></div><div id="line1246"><pre><span class="token T_DOC_COMMENT">	 * @var boolean</span></pre></div><div id="line1247"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line1248"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$isRunning</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1249"><br/></div><div id="line1250"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line1251"><pre><span class="token T_DOC_COMMENT">	 * Indicates whether this part has finished its finalization cycle</span></pre></div><div id="line1252"><pre><span class="token T_DOC_COMMENT">	 * @var boolean</span></pre></div><div id="line1253"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line1254"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$isFinished</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1255"><br/></div><div id="line1256"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line1257"><pre><span class="token T_DOC_COMMENT">	 * Indicates whether this part has finished its run cycle</span></pre></div><div id="line1258"><pre><span class="token T_DOC_COMMENT">	 * @var boolean</span></pre></div><div id="line1259"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line1260"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$hasRan</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1261"><br/></div><div id="line1262"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line1263"><pre><span class="token T_DOC_COMMENT">	 * The name of the engine part (a.k.a. Domain), used in return table</span></pre></div><div id="line1264"><pre><span class="token T_DOC_COMMENT">	 * generation.</span></pre></div><div id="line1265"><pre><span class="token T_DOC_COMMENT">	 * @var string</span></pre></div><div id="line1266"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line1267"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$active_domain</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">""</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1268"><br/></div><div id="line1269"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line1270"><pre><span class="token T_DOC_COMMENT">	 * The step this engine part is in. Used verbatim in return table and</span></pre></div><div id="line1271"><pre><span class="token T_DOC_COMMENT">	 * should be set by the code in the _run() method.</span></pre></div><div id="line1272"><pre><span class="token T_DOC_COMMENT">	 * @var string</span></pre></div><div id="line1273"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line1274"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$active_step</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">""</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1275"><br/></div><div id="line1276"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line1277"><pre><span class="token T_DOC_COMMENT">	 * A more detailed description of the step this engine part is in. Used</span></pre></div><div id="line1278"><pre><span class="token T_DOC_COMMENT">	 * verbatim in return table and should be set by the code in the _run()</span></pre></div><div id="line1279"><pre><span class="token T_DOC_COMMENT">	 * method.</span></pre></div><div id="line1280"><pre><span class="token T_DOC_COMMENT">	 * @var string</span></pre></div><div id="line1281"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line1282"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$active_substep</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">""</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1283"><br/></div><div id="line1284"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line1285"><pre><span class="token T_DOC_COMMENT">	 * Any configuration variables, in the form of an array.</span></pre></div><div id="line1286"><pre><span class="token T_DOC_COMMENT">	 * @var array</span></pre></div><div id="line1287"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line1288"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$_parametersArray</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1289"><br/></div><div id="line1290"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var string The database root key */</span></pre></div><div id="line1291"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$databaseRoot</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1292"><br/></div><div id="line1293"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var int Last reported warnings's position in array */</span></pre></div><div id="line1294"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PRIVATE">private</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$warnings_pointer</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1295"><br/></div><div id="line1296"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var array An array of observers */</span></pre></div><div id="line1297"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$observers</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1298"><br/></div><div id="line1299"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line1300"><pre><span class="token T_DOC_COMMENT">	 * Runs the preparation for this part. Should set _isPrepared</span></pre></div><div id="line1301"><pre><span class="token T_DOC_COMMENT">	 * to true</span></pre></div><div id="line1302"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line1303"><pre><span class="token T_WHITESPACE">	</span><span class="token T_ABSTRACT">abstract</span><span class="token T_WHITESPACE"> </span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">_prepare</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1304"><br/></div><div id="line1305"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line1306"><pre><span class="token T_DOC_COMMENT">	 * Runs the finalisation process for this part. Should set</span></pre></div><div id="line1307"><pre><span class="token T_DOC_COMMENT">	 * _isFinished to true.</span></pre></div><div id="line1308"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line1309"><pre><span class="token T_WHITESPACE">	</span><span class="token T_ABSTRACT">abstract</span><span class="token T_WHITESPACE"> </span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">_finalize</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1310"><br/></div><div id="line1311"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line1312"><pre><span class="token T_DOC_COMMENT">	 * Runs the main functionality loop for this part. Upon calling,</span></pre></div><div id="line1313"><pre><span class="token T_DOC_COMMENT">	 * should set the _isRunning to true. When it finished, should set</span></pre></div><div id="line1314"><pre><span class="token T_DOC_COMMENT">	 * the _hasRan to true. If an error is encountered, setError should</span></pre></div><div id="line1315"><pre><span class="token T_DOC_COMMENT">	 * be used.</span></pre></div><div id="line1316"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line1317"><pre><span class="token T_WHITESPACE">	</span><span class="token T_ABSTRACT">abstract</span><span class="token T_WHITESPACE"> </span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">_run</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1318"><br/></div><div id="line1319"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line1320"><pre><span class="token T_DOC_COMMENT">	 * Sets the BREAKFLAG, which instructs this engine part that the current step must break immediately,</span></pre></div><div id="line1321"><pre><span class="token T_DOC_COMMENT">	 * in fear of timing out.</span></pre></div><div id="line1322"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line1323"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">setBreakFlag</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1324"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1325"><pre><span class="token T_WHITESPACE">		</span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">set</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'volatile.breakflag'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1326"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1327"><br/></div><div id="line1328"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line1329"><pre><span class="token T_DOC_COMMENT">	 * Sets the engine part's internal state, in an easy to use manner</span></pre></div><div id="line1330"><pre><span class="token T_DOC_COMMENT">	 *</span></pre></div><div id="line1331"><pre><span class="token T_DOC_COMMENT">	 * @param	string	$state			One of init, prepared, running, postrun, finished, error</span></pre></div><div id="line1332"><pre><span class="token T_DOC_COMMENT">	 * @param	string	$errorMessage	The reported error message, should the state be set to error</span></pre></div><div id="line1333"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line1334"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">setState</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$state</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'init'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$errorMessage</span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Invalid setState argument'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1335"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1336"><pre><span class="token T_WHITESPACE">		</span><span class="token T_SWITCH">switch</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$state</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1337"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1338"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'init'</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line1339"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isPrepared</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1340"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isRunning</span><span class="token T_WHITESPACE">  </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1341"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isFinished</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1342"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">hasRun</span><span class="token T_WHITESPACE">     </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1343"><pre><span class="token T_WHITESPACE">				</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1344"><br/></div><div id="line1345"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'prepared'</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line1346"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isPrepared</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1347"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isRunning</span><span class="token T_WHITESPACE">  </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1348"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isFinished</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1349"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">hasRun</span><span class="token T_WHITESPACE">     </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1350"><pre><span class="token T_WHITESPACE">				</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1351"><br/></div><div id="line1352"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'running'</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line1353"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isPrepared</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1354"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isRunning</span><span class="token T_WHITESPACE">  </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1355"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isFinished</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1356"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">hasRun</span><span class="token T_WHITESPACE">     </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1357"><pre><span class="token T_WHITESPACE">				</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1358"><br/></div><div id="line1359"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'postrun'</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line1360"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isPrepared</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1361"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isRunning</span><span class="token T_WHITESPACE">  </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1362"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isFinished</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1363"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">hasRun</span><span class="token T_WHITESPACE">     </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1364"><pre><span class="token T_WHITESPACE">				</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1365"><br/></div><div id="line1366"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'finished'</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line1367"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isPrepared</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1368"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isRunning</span><span class="token T_WHITESPACE">  </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1369"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isFinished</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1370"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">hasRun</span><span class="token T_WHITESPACE">     </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1371"><pre><span class="token T_WHITESPACE">				</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1372"><br/></div><div id="line1373"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'error'</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line1374"><pre><span class="token T_WHITESPACE">			</span><span class="token T_DEFAULT">default</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line1375"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$errorMessage</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1376"><pre><span class="token T_WHITESPACE">				</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1377"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1378"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1379"><br/></div><div id="line1380"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line1381"><pre><span class="token T_DOC_COMMENT">	 * The public interface to an engine part. This method takes care for</span></pre></div><div id="line1382"><pre><span class="token T_DOC_COMMENT">	 * calling the correct method in order to perform the initialisation -</span></pre></div><div id="line1383"><pre><span class="token T_DOC_COMMENT">	 * run - finalisation cycle of operation and return a proper response array.</span></pre></div><div id="line1384"><pre><span class="token T_DOC_COMMENT">	 * @return	array	A Response Array</span></pre></div><div id="line1385"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line1386"><pre><span class="token T_WHITESPACE">	</span><span class="token T_FINAL">final</span><span class="token T_WHITESPACE"> </span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">tick</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1387"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1388"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Call the right action method, depending on engine part state</span></pre></div><div id="line1389"><pre><span class="token T_WHITESPACE">		</span><span class="token T_SWITCH">switch</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">getState</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1390"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1391"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">"init"</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line1392"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">_prepare</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1393"><pre><span class="token T_WHITESPACE">				</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1394"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">"prepared"</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line1395"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">_run</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1396"><pre><span class="token T_WHITESPACE">				</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1397"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">"running"</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line1398"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">_run</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1399"><pre><span class="token T_WHITESPACE">				</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1400"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">"postrun"</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line1401"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">_finalize</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1402"><pre><span class="token T_WHITESPACE">				</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1403"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1404"><br/></div><div id="line1405"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Send a Return Table back to the caller</span></pre></div><div id="line1406"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$out</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">_makeReturnTable</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1407"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$out</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1408"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1409"><br/></div><div id="line1410"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line1411"><pre><span class="token T_DOC_COMMENT">	 * Returns a copy of the class's status array</span></pre></div><div id="line1412"><pre><span class="token T_DOC_COMMENT">	 * @return array</span></pre></div><div id="line1413"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line1414"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">getStatusArray</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1415"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1416"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">_makeReturnTable</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1417"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1418"><br/></div><div id="line1419"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line1420"><pre><span class="token T_DOC_COMMENT">	 * Sends any kind of setup information to the engine part. Using this,</span></pre></div><div id="line1421"><pre><span class="token T_DOC_COMMENT">	 * we avoid passing parameters to the constructor of the class. These</span></pre></div><div id="line1422"><pre><span class="token T_DOC_COMMENT">	 * parameters should be passed as an indexed array and should be taken</span></pre></div><div id="line1423"><pre><span class="token T_DOC_COMMENT">	 * into account during the preparation process only. This function will</span></pre></div><div id="line1424"><pre><span class="token T_DOC_COMMENT">	 * set the error flag if it's called after the engine part is prepared.</span></pre></div><div id="line1425"><pre><span class="token T_DOC_COMMENT">	 *</span></pre></div><div id="line1426"><pre><span class="token T_DOC_COMMENT">	 * @param array $parametersArray The parameters to be passed to the</span></pre></div><div id="line1427"><pre><span class="token T_DOC_COMMENT">	 * engine part.</span></pre></div><div id="line1428"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line1429"><pre><span class="token T_WHITESPACE">	</span><span class="token T_FINAL">final</span><span class="token T_WHITESPACE"> </span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">setup</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$parametersArray</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1430"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1431"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isPrepared</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1432"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1433"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setState</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'error'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">"Can't modify configuration after the preparation of "</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">active_domain</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1434"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1435"><pre><span class="token T_WHITESPACE">		</span><span class="token T_ELSE">else</span></pre></div><div id="line1436"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1437"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">_parametersArray</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$parametersArray</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1438"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">array_key_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'root'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$parametersArray</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1439"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1440"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">databaseRoot</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$parametersArray</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'root'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1441"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1442"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1443"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1444"><br/></div><div id="line1445"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line1446"><pre><span class="token T_DOC_COMMENT">	 * Returns the state of this engine part.</span></pre></div><div id="line1447"><pre><span class="token T_DOC_COMMENT">	 *</span></pre></div><div id="line1448"><pre><span class="token T_DOC_COMMENT">	 * @return string The state of this engine part. It can be one of</span></pre></div><div id="line1449"><pre><span class="token T_DOC_COMMENT">	 * error, init, prepared, running, postrun, finished.</span></pre></div><div id="line1450"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line1451"><pre><span class="token T_WHITESPACE">	</span><span class="token T_FINAL">final</span><span class="token T_WHITESPACE"> </span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">getState</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1452"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1453"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">getError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1454"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1455"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">"error"</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1456"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1457"><br/></div><div id="line1458"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isPrepared</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1459"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1460"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">"init"</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1461"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1462"><br/></div><div id="line1463"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isFinished</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isRunning</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">hasRun</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isPrepared</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1464"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1465"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">"prepared"</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1466"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1467"><br/></div><div id="line1468"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isFinished</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isRunning</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">hasRun</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1469"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1470"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">"running"</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1471"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1472"><br/></div><div id="line1473"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isFinished</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isRunning</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">hasRun</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1474"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1475"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">"postrun"</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1476"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1477"><br/></div><div id="line1478"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isFinished</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1479"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1480"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">"finished"</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1481"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1482"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1483"><br/></div><div id="line1484"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line1485"><pre><span class="token T_DOC_COMMENT">	 * Constructs a Response Array based on the engine part's state.</span></pre></div><div id="line1486"><pre><span class="token T_DOC_COMMENT">	 * @return array The Response Array for the current state</span></pre></div><div id="line1487"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line1488"><pre><span class="token T_WHITESPACE">	</span><span class="token T_FINAL">final</span><span class="token T_WHITESPACE"> </span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">_makeReturnTable</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1489"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1490"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Get a list of warnings</span></pre></div><div id="line1491"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$warnings</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">getWarnings</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1492"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Report only new warnings if there is no warnings queue size</span></pre></div><div id="line1493"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">_warnings_queue_size</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1494"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1495"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">warnings_pointer</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_GT">&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">warnings_pointer</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">count</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$warnings</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1496"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1497"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$warnings</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">array_slice</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$warnings</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">warnings_pointer</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_PLUS">+</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1498"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">warnings_pointer</span><span class="token T_WHITESPACE"> </span><span class="token T_PLUS_EQUAL">+=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">count</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$warnings</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1499"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1500"><pre><span class="token T_WHITESPACE">			</span><span class="token T_ELSE">else</span></pre></div><div id="line1501"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1502"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">warnings_pointer</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">count</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$warnings</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1503"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1504"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1505"><br/></div><div id="line1506"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$out</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE">  </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span></pre></div><div id="line1507"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CONSTANT_ENCAPSED_STRING">'HasRun'</span><span class="token T_WHITESPACE">	</span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isFinished</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line1508"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Domain'</span><span class="token T_WHITESPACE">	</span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">active_domain</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line1509"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Step'</span><span class="token T_WHITESPACE">		</span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">active_step</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line1510"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Substep'</span><span class="token T_WHITESPACE">	</span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">active_substep</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line1511"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Error'</span><span class="token T_WHITESPACE">		</span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">getError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line1512"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Warnings'</span><span class="token T_WHITESPACE">	</span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$warnings</span></pre></div><div id="line1513"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1514"><br/></div><div id="line1515"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$out</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1516"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1517"><br/></div><div id="line1518"><pre><span class="token T_WHITESPACE">	</span><span class="token T_FINAL">final</span><span class="token T_WHITESPACE"> </span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">setDomain</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$new_domain</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1519"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1520"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">active_domain</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$new_domain</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1521"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1522"><br/></div><div id="line1523"><pre><span class="token T_WHITESPACE">	</span><span class="token T_FINAL">final</span><span class="token T_WHITESPACE"> </span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">getDomain</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1524"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1525"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">active_domain</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1526"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1527"><br/></div><div id="line1528"><pre><span class="token T_WHITESPACE">	</span><span class="token T_FINAL">final</span><span class="token T_WHITESPACE"> </span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">setStep</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$new_step</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1529"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1530"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">active_step</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$new_step</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1531"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1532"><br/></div><div id="line1533"><pre><span class="token T_WHITESPACE">	</span><span class="token T_FINAL">final</span><span class="token T_WHITESPACE"> </span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">getStep</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1534"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1535"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">active_step</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1536"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1537"><br/></div><div id="line1538"><pre><span class="token T_WHITESPACE">	</span><span class="token T_FINAL">final</span><span class="token T_WHITESPACE"> </span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">setSubstep</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$new_substep</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1539"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1540"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">active_substep</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$new_substep</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1541"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1542"><br/></div><div id="line1543"><pre><span class="token T_WHITESPACE">	</span><span class="token T_FINAL">final</span><span class="token T_WHITESPACE"> </span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">getSubstep</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1544"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1545"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">active_substep</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1546"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1547"><br/></div><div id="line1548"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line1549"><pre><span class="token T_DOC_COMMENT">	 * Attaches an observer object</span></pre></div><div id="line1550"><pre><span class="token T_DOC_COMMENT">	 * @param AKAbstractPartObserver $obs</span></pre></div><div id="line1551"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line1552"><pre><span class="token T_WHITESPACE">	</span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">attach</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">AKAbstractPartObserver</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$obs</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1553"><pre><span class="token T_WHITESPACE">        </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">observers</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_PHPDOX_DOUBLE_QUOTES">"</span><span class="token T_VARIABLE">$obs</span><span class="token T_PHPDOX_DOUBLE_QUOTES">"</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$obs</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1554"><pre><span class="token T_WHITESPACE">    </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1555"><br/></div><div id="line1556"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line1557"><pre><span class="token T_DOC_COMMENT">	 * Detaches an observer object</span></pre></div><div id="line1558"><pre><span class="token T_DOC_COMMENT">	 * @param AKAbstractPartObserver $obs</span></pre></div><div id="line1559"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line1560"><pre><span class="token T_WHITESPACE">    </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">detach</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">AKAbstractPartObserver</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$obs</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1561"><pre><span class="token T_WHITESPACE">        </span><span class="token T_STRING">delete</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">observers</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_PHPDOX_DOUBLE_QUOTES">"</span><span class="token T_VARIABLE">$obs</span><span class="token T_PHPDOX_DOUBLE_QUOTES">"</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1562"><pre><span class="token T_WHITESPACE">    </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1563"><br/></div><div id="line1564"><pre><span class="token T_WHITESPACE">    </span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line1565"><pre><span class="token T_DOC_COMMENT">     * Notifies observers each time something interesting happened to the part</span></pre></div><div id="line1566"><pre><span class="token T_DOC_COMMENT">     * @param mixed $message The event object</span></pre></div><div id="line1567"><pre><span class="token T_DOC_COMMENT">     */</span></pre></div><div id="line1568"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">notify</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$message</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1569"><pre><span class="token T_WHITESPACE">        </span><span class="token T_FOREACH">foreach</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">observers</span><span class="token T_WHITESPACE"> </span><span class="token T_AS">as</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$obs</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1570"><pre><span class="token T_WHITESPACE">            </span><span class="token T_VARIABLE">$obs</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">update</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$message</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1571"><pre><span class="token T_WHITESPACE">        </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1572"><pre><span class="token T_WHITESPACE">    </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1573"><pre><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1574"><br/></div><div id="line1575"><pre><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line1576"><pre><span class="token T_DOC_COMMENT"> * Akeeba Restore</span></pre></div><div id="line1577"><pre><span class="token T_DOC_COMMENT"> * A JSON-powered JPA, JPS and ZIP archive extraction library</span></pre></div><div id="line1578"><pre><span class="token T_DOC_COMMENT"> *</span></pre></div><div id="line1579"><pre><span class="token T_DOC_COMMENT"> * @copyright   2010-2014 Nicholas K. Dionysopoulos / Akeeba Ltd.</span></pre></div><div id="line1580"><pre><span class="token T_DOC_COMMENT"> * @license     GNU GPL v2 or - at your option - any later version</span></pre></div><div id="line1581"><pre><span class="token T_DOC_COMMENT"> * @package     akeebabackup</span></pre></div><div id="line1582"><pre><span class="token T_DOC_COMMENT"> * @subpackage  kickstart</span></pre></div><div id="line1583"><pre><span class="token T_DOC_COMMENT"> */</span></pre></div><div id="line1584"><br/></div><div id="line1585"><pre><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line1586"><pre><span class="token T_DOC_COMMENT"> * The base class of unarchiver classes</span></pre></div><div id="line1587"><pre><span class="token T_DOC_COMMENT"> */</span></pre></div><div id="line1588"><pre><span class="token T_ABSTRACT">abstract</span><span class="token T_WHITESPACE"> </span><span class="token T_CLASS">class</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKAbstractUnarchiver</span><span class="token T_WHITESPACE"> </span><span class="token T_EXTENDS">extends</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKAbstractPart</span></pre></div><div id="line1589"><pre><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1590"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var string Archive filename */</span></pre></div><div id="line1591"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$filename</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1592"><br/></div><div id="line1593"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var array List of the names of all archive parts */</span></pre></div><div id="line1594"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$archiveList</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1595"><br/></div><div id="line1596"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var int The total size of all archive parts */</span></pre></div><div id="line1597"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$totalSize</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1598"><br/></div><div id="line1599"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var integer Current archive part number */</span></pre></div><div id="line1600"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$currentPartNumber</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1601"><br/></div><div id="line1602"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var integer The offset inside the current part */</span></pre></div><div id="line1603"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$currentPartOffset</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1604"><br/></div><div id="line1605"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var bool Should I restore permissions? */</span></pre></div><div id="line1606"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$flagRestorePermissions</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1607"><br/></div><div id="line1608"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var AKAbstractPostproc Post processing class */</span></pre></div><div id="line1609"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$postProcEngine</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1610"><br/></div><div id="line1611"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var string Absolute path to prepend to extracted files */</span></pre></div><div id="line1612"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$addPath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1613"><br/></div><div id="line1614"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var array Which files to rename */</span></pre></div><div id="line1615"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$renameFiles</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1616"><br/></div><div id="line1617"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var array Which directories to rename */</span></pre></div><div id="line1618"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$renameDirs</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1619"><br/></div><div id="line1620"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var array Which files to skip */</span></pre></div><div id="line1621"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$skipFiles</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1622"><br/></div><div id="line1623"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var integer Chunk size for processing */</span></pre></div><div id="line1624"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$chunkSize</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">524288</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1625"><br/></div><div id="line1626"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var resource File pointer to the current archive part file */</span></pre></div><div id="line1627"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$fp</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1628"><br/></div><div id="line1629"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var int Run state when processing the current archive file */</span></pre></div><div id="line1630"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$runState</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1631"><br/></div><div id="line1632"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var stdClass File header data, as read by the readFileHeader() method */</span></pre></div><div id="line1633"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$fileHeader</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1634"><br/></div><div id="line1635"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var int How much of the uncompressed data we've read so far */</span></pre></div><div id="line1636"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$dataReadLength</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1637"><br/></div><div id="line1638"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var array Unwriteable files in these directories are always ignored and do not cause errors when not extracted */</span></pre></div><div id="line1639"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$ignoreDirectories</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1640"><br/></div><div id="line1641"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line1642"><pre><span class="token T_DOC_COMMENT">	 * Public constructor</span></pre></div><div id="line1643"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line1644"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">__construct</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1645"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1646"><pre><span class="token T_WHITESPACE">		</span><span class="token T_STRING">parent</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">__construct</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1647"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1648"><br/></div><div id="line1649"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line1650"><pre><span class="token T_DOC_COMMENT">	 * Wakeup function, called whenever the class is unserialized</span></pre></div><div id="line1651"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line1652"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">__wakeup</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1653"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1654"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">currentPartNumber</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_GREATER_OR_EQUAL">&gt;=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1655"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1656"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">fopen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">archiveList</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">currentPartNumber</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'rb'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1657"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">is_resource</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">currentPartOffset</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_GT">&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1658"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1659"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">fseek</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">currentPartOffset</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1660"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1661"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1662"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1663"><br/></div><div id="line1664"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line1665"><pre><span class="token T_DOC_COMMENT">	 * Sleep function, called whenever the class is serialized</span></pre></div><div id="line1666"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line1667"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">shutdown</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1668"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1669"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">is_resource</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1670"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1671"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">currentPartOffset</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftell</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1672"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">fclose</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1673"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1674"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1675"><br/></div><div id="line1676"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line1677"><pre><span class="token T_DOC_COMMENT">	 * Implements the abstract _prepare() method</span></pre></div><div id="line1678"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line1679"><pre><span class="token T_WHITESPACE">	</span><span class="token T_FINAL">final</span><span class="token T_WHITESPACE"> </span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">_prepare</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1680"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1681"><pre><span class="token T_WHITESPACE">		</span><span class="token T_STRING">parent</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">__construct</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1682"><br/></div><div id="line1683"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">count</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">_parametersArray</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_GT">&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1684"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1685"><pre><span class="token T_WHITESPACE">			</span><span class="token T_FOREACH">foreach</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">_parametersArray</span><span class="token T_WHITESPACE"> </span><span class="token T_AS">as</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$key</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1686"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1687"><pre><span class="token T_WHITESPACE">				</span><span class="token T_SWITCH">switch</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$key</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1688"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1689"><pre><span class="token T_WHITESPACE">					</span><span class="token T_COMMENT">// Archive's absolute filename</span></pre></div><div id="line1690"><pre><span class="token T_WHITESPACE">					</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'filename'</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line1691"><pre><span class="token T_WHITESPACE">						</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">filename</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1692"><br/></div><div id="line1693"><pre><span class="token T_WHITESPACE">						</span><span class="token T_COMMENT">// Sanity check</span></pre></div><div id="line1694"><pre><span class="token T_WHITESPACE">						</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1695"><pre><span class="token T_WHITESPACE">						</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1696"><pre><span class="token T_WHITESPACE">							</span><span class="token T_VARIABLE">$value</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strtolower</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1697"><br/></div><div id="line1698"><pre><span class="token T_WHITESPACE">							</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_GT">&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">6</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1699"><pre><span class="token T_WHITESPACE">							</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1700"><pre><span class="token T_WHITESPACE">								</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span></pre></div><div id="line1701"><pre><span class="token T_WHITESPACE">									</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">7</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'http://'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1702"><pre><span class="token T_WHITESPACE">									</span><span class="token T_BOOLEAN_OR">||</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">8</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'https://'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1703"><pre><span class="token T_WHITESPACE">									</span><span class="token T_BOOLEAN_OR">||</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">6</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'ftp://'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1704"><pre><span class="token T_WHITESPACE">									</span><span class="token T_BOOLEAN_OR">||</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">7</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'ssh2://'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1705"><pre><span class="token T_WHITESPACE">									</span><span class="token T_BOOLEAN_OR">||</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">6</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'ssl://'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1706"><pre><span class="token T_WHITESPACE">								</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1707"><pre><span class="token T_WHITESPACE">								</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1708"><pre><span class="token T_WHITESPACE">									</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setState</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'error'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Invalid archive location'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1709"><pre><span class="token T_WHITESPACE">								</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1710"><pre><span class="token T_WHITESPACE">							</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1711"><pre><span class="token T_WHITESPACE">						</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1712"><br/></div><div id="line1713"><br/></div><div id="line1714"><br/></div><div id="line1715"><pre><span class="token T_WHITESPACE">						</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1716"><br/></div><div id="line1717"><pre><span class="token T_WHITESPACE">					</span><span class="token T_COMMENT">// Should I restore permissions?</span></pre></div><div id="line1718"><pre><span class="token T_WHITESPACE">					</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'restore_permissions'</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line1719"><pre><span class="token T_WHITESPACE">						</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">flagRestorePermissions</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1720"><pre><span class="token T_WHITESPACE">						</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1721"><br/></div><div id="line1722"><pre><span class="token T_WHITESPACE">					</span><span class="token T_COMMENT">// Should I use FTP?</span></pre></div><div id="line1723"><pre><span class="token T_WHITESPACE">					</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'post_proc'</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line1724"><pre><span class="token T_WHITESPACE">						</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">postProcEngine</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">getpostProc</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1725"><pre><span class="token T_WHITESPACE">						</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1726"><br/></div><div id="line1727"><pre><span class="token T_WHITESPACE">					</span><span class="token T_COMMENT">// Path to add in the beginning</span></pre></div><div id="line1728"><pre><span class="token T_WHITESPACE">					</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'add_path'</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line1729"><pre><span class="token T_WHITESPACE">						</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">addPath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1730"><pre><span class="token T_WHITESPACE">						</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">addPath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">str_replace</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'\\'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">addPath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1731"><pre><span class="token T_WHITESPACE">						</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">addPath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">rtrim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">addPath</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1732"><pre><span class="token T_WHITESPACE">						</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">addPath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">addPath</span><span class="token T_WHITESPACE"> </span><span class="token T_CONCAT_EQUAL">.=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1733"><pre><span class="token T_WHITESPACE">						</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1734"><br/></div><div id="line1735"><pre><span class="token T_WHITESPACE">					</span><span class="token T_COMMENT">// Which files to rename (hash array)</span></pre></div><div id="line1736"><pre><span class="token T_WHITESPACE">					</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'rename_files'</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line1737"><pre><span class="token T_WHITESPACE">						</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">renameFiles</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1738"><pre><span class="token T_WHITESPACE">						</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1739"><br/></div><div id="line1740"><pre><span class="token T_WHITESPACE">					</span><span class="token T_COMMENT">// Which files to rename (hash array)</span></pre></div><div id="line1741"><pre><span class="token T_WHITESPACE">					</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'rename_dirs'</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line1742"><pre><span class="token T_WHITESPACE">						</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">renameDirs</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1743"><pre><span class="token T_WHITESPACE">						</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1744"><br/></div><div id="line1745"><pre><span class="token T_WHITESPACE">					</span><span class="token T_COMMENT">// Which files to skip (indexed array)</span></pre></div><div id="line1746"><pre><span class="token T_WHITESPACE">					</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'skip_files'</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line1747"><pre><span class="token T_WHITESPACE">						</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">skipFiles</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1748"><pre><span class="token T_WHITESPACE">						</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1749"><br/></div><div id="line1750"><pre><span class="token T_WHITESPACE">					</span><span class="token T_COMMENT">// Which directories to ignore when we can't write files in them (indexed array)</span></pre></div><div id="line1751"><pre><span class="token T_WHITESPACE">					</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'ignoredirectories'</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line1752"><pre><span class="token T_WHITESPACE">						</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">ignoreDirectories</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1753"><pre><span class="token T_WHITESPACE">						</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1754"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1755"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1756"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1757"><br/></div><div id="line1758"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">scanArchives</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1759"><br/></div><div id="line1760"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">readArchiveHeader</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1761"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$errMessage</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">getError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1762"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$errMessage</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1763"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1764"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setState</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'error'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$errMessage</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1765"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1766"><pre><span class="token T_WHITESPACE">		</span><span class="token T_ELSE">else</span></pre></div><div id="line1767"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1768"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">runState</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AK_STATE_NOFILE</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1769"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setState</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'prepared'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1770"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1771"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1772"><br/></div><div id="line1773"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">_run</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1774"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1775"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">getState</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'postrun'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_RETURN">return</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1776"><br/></div><div id="line1777"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setState</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'running'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1778"><br/></div><div id="line1779"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$timer</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">getTimer</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1780"><br/></div><div id="line1781"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$status</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1782"><pre><span class="token T_WHITESPACE">		</span><span class="token T_WHILE">while</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$status</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$timer</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">getTimeLeft</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_GT">&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1783"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1784"><pre><span class="token T_WHITESPACE">			</span><span class="token T_SWITCH">switch</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">runState</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1785"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1786"><pre><span class="token T_WHITESPACE">				</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AK_STATE_NOFILE</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line1787"><pre><span class="token T_WHITESPACE">					</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CLASS_C">__CLASS__</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'::_run() - Reading file header'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1788"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$status</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">readFileHeader</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1789"><pre><span class="token T_WHITESPACE">					</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$status</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1790"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1791"><pre><span class="token T_WHITESPACE">						</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CLASS_C">__CLASS__</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'::_run() - Preparing to extract '</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">realFile</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1792"><pre><span class="token T_WHITESPACE">						</span><span class="token T_COMMENT">// Send start of file notification</span></pre></div><div id="line1793"><pre><span class="token T_WHITESPACE">						</span><span class="token T_VARIABLE">$message</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_NEW">new</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">stdClass</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1794"><pre><span class="token T_WHITESPACE">						</span><span class="token T_VARIABLE">$message</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">type</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'startfile'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1795"><pre><span class="token T_WHITESPACE">						</span><span class="token T_VARIABLE">$message</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">content</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_NEW">new</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">stdClass</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1796"><pre><span class="token T_WHITESPACE">						</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">array_key_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'realfile'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">get_object_vars</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1797"><pre><span class="token T_WHITESPACE">							</span><span class="token T_VARIABLE">$message</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">content</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">realfile</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">realFile</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1798"><pre><span class="token T_WHITESPACE">						</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_ELSE">else</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1799"><pre><span class="token T_WHITESPACE">							</span><span class="token T_VARIABLE">$message</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">content</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">realfile</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1800"><pre><span class="token T_WHITESPACE">						</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1801"><pre><span class="token T_WHITESPACE">						</span><span class="token T_VARIABLE">$message</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">content</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1802"><pre><span class="token T_WHITESPACE">						</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">array_key_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'compressed'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">get_object_vars</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1803"><pre><span class="token T_WHITESPACE">							</span><span class="token T_VARIABLE">$message</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">content</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">compressed</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">compressed</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1804"><pre><span class="token T_WHITESPACE">						</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_ELSE">else</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1805"><pre><span class="token T_WHITESPACE">							</span><span class="token T_VARIABLE">$message</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">content</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">compressed</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1806"><pre><span class="token T_WHITESPACE">						</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1807"><pre><span class="token T_WHITESPACE">						</span><span class="token T_VARIABLE">$message</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">content</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">uncompressed</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">uncompressed</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1808"><pre><span class="token T_WHITESPACE">						</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">notify</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$message</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1809"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_ELSE">else</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1810"><pre><span class="token T_WHITESPACE">						</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CLASS_C">__CLASS__</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'::_run() - Could not read file header'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1811"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1812"><pre><span class="token T_WHITESPACE">					</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1813"><br/></div><div id="line1814"><pre><span class="token T_WHITESPACE">				</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AK_STATE_HEADER</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line1815"><pre><span class="token T_WHITESPACE">				</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AK_STATE_DATA</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line1816"><pre><span class="token T_WHITESPACE">					</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CLASS_C">__CLASS__</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'::_run() - Processing file data'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1817"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$status</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">processFileData</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1818"><pre><span class="token T_WHITESPACE">					</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1819"><br/></div><div id="line1820"><pre><span class="token T_WHITESPACE">				</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AK_STATE_DATAREAD</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line1821"><pre><span class="token T_WHITESPACE">				</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AK_STATE_POSTPROC</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line1822"><pre><span class="token T_WHITESPACE">					</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CLASS_C">__CLASS__</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'::_run() - Calling post-processing class'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1823"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">postProcEngine</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">timestamp</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">timestamp</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1824"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$status</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">postProcEngine</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">process</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1825"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">propagateFromObject</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">postProcEngine</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1826"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">runState</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AK_STATE_DONE</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1827"><pre><span class="token T_WHITESPACE">					</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1828"><br/></div><div id="line1829"><pre><span class="token T_WHITESPACE">				</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AK_STATE_DONE</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line1830"><pre><span class="token T_WHITESPACE">				</span><span class="token T_DEFAULT">default</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line1831"><pre><span class="token T_WHITESPACE">					</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$status</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1832"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1833"><pre><span class="token T_WHITESPACE">						</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CLASS_C">__CLASS__</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'::_run() - Finished extracting file'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1834"><pre><span class="token T_WHITESPACE">						</span><span class="token T_COMMENT">// Send end of file notification</span></pre></div><div id="line1835"><pre><span class="token T_WHITESPACE">						</span><span class="token T_VARIABLE">$message</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_NEW">new</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">stdClass</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1836"><pre><span class="token T_WHITESPACE">						</span><span class="token T_VARIABLE">$message</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">type</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'endfile'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1837"><pre><span class="token T_WHITESPACE">						</span><span class="token T_VARIABLE">$message</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">content</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_NEW">new</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">stdClass</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1838"><pre><span class="token T_WHITESPACE">						</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">array_key_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'realfile'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">get_object_vars</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1839"><pre><span class="token T_WHITESPACE">							</span><span class="token T_VARIABLE">$message</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">content</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">realfile</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">realFile</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1840"><pre><span class="token T_WHITESPACE">						</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_ELSE">else</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1841"><pre><span class="token T_WHITESPACE">							</span><span class="token T_VARIABLE">$message</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">content</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">realfile</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1842"><pre><span class="token T_WHITESPACE">						</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1843"><pre><span class="token T_WHITESPACE">						</span><span class="token T_VARIABLE">$message</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">content</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1844"><pre><span class="token T_WHITESPACE">						</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">array_key_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'compressed'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">get_object_vars</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1845"><pre><span class="token T_WHITESPACE">							</span><span class="token T_VARIABLE">$message</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">content</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">compressed</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">compressed</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1846"><pre><span class="token T_WHITESPACE">						</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_ELSE">else</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1847"><pre><span class="token T_WHITESPACE">							</span><span class="token T_VARIABLE">$message</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">content</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">compressed</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1848"><pre><span class="token T_WHITESPACE">						</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1849"><pre><span class="token T_WHITESPACE">						</span><span class="token T_VARIABLE">$message</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">content</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">uncompressed</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">uncompressed</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1850"><pre><span class="token T_WHITESPACE">						</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">notify</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$message</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1851"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1852"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">runState</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AK_STATE_NOFILE</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1853"><pre><span class="token T_WHITESPACE">					</span><span class="token T_CONTINUE">continue</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1854"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1855"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1856"><br/></div><div id="line1857"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$error</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">getError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1858"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$status</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">runState</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AK_STATE_NOFILE</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$error</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1859"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1860"><pre><span class="token T_WHITESPACE">			</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CLASS_C">__CLASS__</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'::_run() - Just finished'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1861"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// We just finished</span></pre></div><div id="line1862"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setState</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'postrun'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1863"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1864"><pre><span class="token T_WHITESPACE">		</span><span class="token T_ELSEIF">elseif</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$error</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1865"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1866"><pre><span class="token T_WHITESPACE">			</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CLASS_C">__CLASS__</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'::_run() - Halted with an error:'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1867"><pre><span class="token T_WHITESPACE">			</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$error</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1868"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setState</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'error'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$error</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1869"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1870"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1871"><br/></div><div id="line1872"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">_finalize</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1873"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1874"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Nothing to do</span></pre></div><div id="line1875"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setState</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'finished'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1876"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1877"><br/></div><div id="line1878"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line1879"><pre><span class="token T_DOC_COMMENT">	 * Returns the base extension of the file, e.g. '.jpa'</span></pre></div><div id="line1880"><pre><span class="token T_DOC_COMMENT">	 * @return string</span></pre></div><div id="line1881"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line1882"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PRIVATE">private</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">getBaseExtension</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1883"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1884"><pre><span class="token T_WHITESPACE">		</span><span class="token T_STATIC">static</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$baseextension</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1885"><br/></div><div id="line1886"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$baseextension</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1887"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1888"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$basename</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">basename</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">filename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1889"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$lastdot</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strrpos</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$basename</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'.'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1890"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$baseextension</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$basename</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$lastdot</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1891"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1892"><br/></div><div id="line1893"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$baseextension</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1894"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1895"><br/></div><div id="line1896"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line1897"><pre><span class="token T_DOC_COMMENT">	 * Scans for archive parts</span></pre></div><div id="line1898"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line1899"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PRIVATE">private</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">scanArchives</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1900"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1901"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">defined</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'KSDEBUG'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1902"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">unlink</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'debug.txt'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1903"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1904"><pre><span class="token T_WHITESPACE">		</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Preparing to scan archives'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1905"><br/></div><div id="line1906"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$privateArchiveList</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1907"><br/></div><div id="line1908"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Get the components of the archive filename</span></pre></div><div id="line1909"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$dirname</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">dirname</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">filename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1910"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$base_extension</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">getBaseExtension</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1911"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$basename</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">basename</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">filename</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$base_extension</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1912"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">totalSize</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1913"><br/></div><div id="line1914"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Scan for multiple parts until we don't find any more of them</span></pre></div><div id="line1915"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$count</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1916"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$found</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1917"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">archiveList</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1918"><pre><span class="token T_WHITESPACE">		</span><span class="token T_WHILE">while</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$found</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1919"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1920"><pre><span class="token T_WHITESPACE">			</span><span class="token T_INC">++</span><span class="token T_VARIABLE">$count</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1921"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$extension</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$base_extension</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">2</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_STRING">sprintf</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'%02d'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$count</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1922"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$filename</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$dirname</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_STRING">DIRECTORY_SEPARATOR</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$basename</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$extension</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1923"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$found</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">file_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$filename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1924"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$found</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1925"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1926"><pre><span class="token T_WHITESPACE">				</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'- Found archive '</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$filename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1927"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// Add yet another part, with a numeric-appended filename</span></pre></div><div id="line1928"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">archiveList</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$filename</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1929"><br/></div><div id="line1930"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$filesize</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">filesize</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$filename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1931"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">totalSize</span><span class="token T_WHITESPACE"> </span><span class="token T_PLUS_EQUAL">+=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$filesize</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1932"><br/></div><div id="line1933"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$privateArchiveList</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$filename</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$filesize</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1934"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1935"><pre><span class="token T_WHITESPACE">			</span><span class="token T_ELSE">else</span></pre></div><div id="line1936"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1937"><pre><span class="token T_WHITESPACE">				</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'- Found archive '</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">filename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1938"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// Add the last part, with the regular extension</span></pre></div><div id="line1939"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">archiveList</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">filename</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1940"><br/></div><div id="line1941"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$filename</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">filename</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1942"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$filesize</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">filesize</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$filename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1943"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">totalSize</span><span class="token T_WHITESPACE"> </span><span class="token T_PLUS_EQUAL">+=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$filesize</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1944"><br/></div><div id="line1945"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$privateArchiveList</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$filename</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$filesize</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1946"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1947"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1948"><pre><span class="token T_WHITESPACE">		</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Total archive parts: '</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$count</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1949"><br/></div><div id="line1950"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">currentPartNumber</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1951"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">currentPartOffset</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1952"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">runState</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AK_STATE_NOFILE</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1953"><br/></div><div id="line1954"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Send start of file notification</span></pre></div><div id="line1955"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$message</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_NEW">new</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">stdClass</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1956"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$message</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">type</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'totalsize'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1957"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$message</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">content</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_NEW">new</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">stdClass</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1958"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$message</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">content</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">totalsize</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">totalSize</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1959"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$message</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">content</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">filelist</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$privateArchiveList</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1960"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">notify</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$message</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1961"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1962"><br/></div><div id="line1963"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line1964"><pre><span class="token T_DOC_COMMENT">	 * Opens the next part file for reading</span></pre></div><div id="line1965"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line1966"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">nextFile</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1967"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1968"><pre><span class="token T_WHITESPACE">		</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Current part is '</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">currentPartNumber</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'; opening the next part'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1969"><pre><span class="token T_WHITESPACE">		</span><span class="token T_INC">++</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">currentPartNumber</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1970"><br/></div><div id="line1971"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">currentPartNumber</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_GT">&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">count</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">archiveList</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1972"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1973"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setState</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'postrun'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1974"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1975"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1976"><br/></div><div id="line1977"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">is_resource</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1978"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1979"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">fclose</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1980"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1981"><br/></div><div id="line1982"><pre><span class="token T_WHITESPACE">		</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Opening file '</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">archiveList</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">currentPartNumber</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1983"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">fopen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">archiveList</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">currentPartNumber</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'rb'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1984"><br/></div><div id="line1985"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_IDENTICAL">===</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line1986"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line1987"><pre><span class="token T_WHITESPACE">			</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Could not open file - crash imminent'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1988"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1989"><br/></div><div id="line1990"><pre><span class="token T_WHITESPACE">		</span><span class="token T_STRING">fseek</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1991"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">currentPartOffset</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1992"><br/></div><div id="line1993"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line1994"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line1995"><br/></div><div id="line1996"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line1997"><pre><span class="token T_DOC_COMMENT">	 * Returns true if we have reached the end of file</span></pre></div><div id="line1998"><pre><span class="token T_DOC_COMMENT">	 * @param $local bool True to return EOF of the local file, false (default) to return if we have reached the end of the archive set</span></pre></div><div id="line1999"><pre><span class="token T_DOC_COMMENT">	 * @return bool True if we have reached End Of File</span></pre></div><div id="line2000"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line2001"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">isEOF</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$local</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2002"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2003"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$eof</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">feof</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2004"><br/></div><div id="line2005"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$eof</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2006"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2007"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Border case: right at the part's end (eeeek!!!). For the life of me, I don't understand why</span></pre></div><div id="line2008"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// feof() doesn't report true. It expects the fp to be positioned *beyond* the EOF to report</span></pre></div><div id="line2009"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// true. Incredible! :(</span></pre></div><div id="line2010"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$position</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftell</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2011"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$filesize</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">filesize</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">archiveList</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">currentPartNumber</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2012"><br/></div><div id="line2013"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$filesize</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_SMALLER_OR_EQUAL">&lt;=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2014"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// 2Gb or more files on a 32 bit version of PHP tend to get screwed up. Meh.</span></pre></div><div id="line2015"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$eof</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2016"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_ELSEIF">elseif</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$position</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_GREATER_OR_EQUAL">&gt;=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$filesize</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2017"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$eof</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2018"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2019"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2020"><br/></div><div id="line2021"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$local</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2022"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2023"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$eof</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2024"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2025"><br/></div><div id="line2026"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$eof</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">currentPartNumber</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_GREATER_OR_EQUAL">&gt;=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">count</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">archiveList</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2027"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2028"><br/></div><div id="line2029"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line2030"><pre><span class="token T_DOC_COMMENT">	 * Tries to make a directory user-writable so that we can write a file to it</span></pre></div><div id="line2031"><pre><span class="token T_DOC_COMMENT">	 * @param $path string A path to a file</span></pre></div><div id="line2032"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line2033"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">setCorrectPermissions</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$path</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2034"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2035"><pre><span class="token T_WHITESPACE">		</span><span class="token T_STATIC">static</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$rootDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2036"><br/></div><div id="line2037"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">is_null</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$rootDir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2038"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$rootDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">rtrim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.destdir'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/\\'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2039"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2040"><br/></div><div id="line2041"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$directory</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">rtrim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">dirname</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$path</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/\\'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2042"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$directory</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_NOT_EQUAL">!=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$rootDir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2043"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Is this an unwritable directory?</span></pre></div><div id="line2044"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">is_writeable</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$directory</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2045"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">postProcEngine</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">chmod</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$directory</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0755</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2046"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2047"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2048"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">postProcEngine</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">chmod</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$path</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0644</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2049"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2050"><br/></div><div id="line2051"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line2052"><pre><span class="token T_DOC_COMMENT">	 * Concrete classes are supposed to use this method in order to read the archive's header and</span></pre></div><div id="line2053"><pre><span class="token T_DOC_COMMENT">	 * prepare themselves to the point of being ready to extract the first file.</span></pre></div><div id="line2054"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line2055"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_ABSTRACT">abstract</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">readArchiveHeader</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2056"><br/></div><div id="line2057"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line2058"><pre><span class="token T_DOC_COMMENT">	 * Concrete classes must use this method to read the file header</span></pre></div><div id="line2059"><pre><span class="token T_DOC_COMMENT">	 * @return bool True if reading the file was successful, false if an error occured or we reached end of archive</span></pre></div><div id="line2060"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line2061"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_ABSTRACT">abstract</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">readFileHeader</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2062"><br/></div><div id="line2063"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line2064"><pre><span class="token T_DOC_COMMENT">	 * Concrete classes must use this method to process file data. It must set $runState to AK_STATE_DATAREAD when</span></pre></div><div id="line2065"><pre><span class="token T_DOC_COMMENT">	 * it's finished processing the file data.</span></pre></div><div id="line2066"><pre><span class="token T_DOC_COMMENT">	 * @return bool True if processing the file data was successful, false if an error occured</span></pre></div><div id="line2067"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line2068"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_ABSTRACT">abstract</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">processFileData</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2069"><br/></div><div id="line2070"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line2071"><pre><span class="token T_DOC_COMMENT">	 * Reads data from the archive and notifies the observer with the 'reading' message</span></pre></div><div id="line2072"><pre><span class="token T_DOC_COMMENT">	 * @param $fp</span></pre></div><div id="line2073"><pre><span class="token T_DOC_COMMENT">	 * @param $length</span></pre></div><div id="line2074"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line2075"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">fread</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$length</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2076"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2077"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">is_numeric</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$length</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2078"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2079"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$length</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_GT">&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2080"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$data</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">fread</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$length</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2081"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_ELSE">else</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2082"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$data</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">fread</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">PHP_INT_MAX</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2083"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2084"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2085"><pre><span class="token T_WHITESPACE">		</span><span class="token T_ELSE">else</span></pre></div><div id="line2086"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2087"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$data</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">fread</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">PHP_INT_MAX</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2088"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2089"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$data</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_IDENTICAL">===</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$data</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2090"><br/></div><div id="line2091"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Send start of file notification</span></pre></div><div id="line2092"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$message</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_NEW">new</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">stdClass</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2093"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$message</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">type</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'reading'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2094"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$message</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">content</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_NEW">new</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">stdClass</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2095"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$message</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">content</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">length</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$data</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2096"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">notify</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$message</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2097"><br/></div><div id="line2098"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$data</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2099"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2100"><br/></div><div id="line2101"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line2102"><pre><span class="token T_DOC_COMMENT">	 * Is this file or directory contained in a directory we've decided to ignore</span></pre></div><div id="line2103"><pre><span class="token T_DOC_COMMENT">	 * write errors for? This is useful to let the extraction work despite write</span></pre></div><div id="line2104"><pre><span class="token T_DOC_COMMENT">	 * errors in the log, logs and tmp directories which MIGHT be used by the system</span></pre></div><div id="line2105"><pre><span class="token T_DOC_COMMENT">	 * on some low quality hosts and Plesk-powered hosts.</span></pre></div><div id="line2106"><pre><span class="token T_DOC_COMMENT">	 *</span></pre></div><div id="line2107"><pre><span class="token T_DOC_COMMENT">	 * @param   string  $shortFilename  The relative path of the file/directory in the package</span></pre></div><div id="line2108"><pre><span class="token T_DOC_COMMENT">	 *</span></pre></div><div id="line2109"><pre><span class="token T_DOC_COMMENT">	 * @return  boolean  True if it belongs in an ignored directory</span></pre></div><div id="line2110"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line2111"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">isIgnoredDirectory</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$shortFilename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2112"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2113"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2114"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$shortFilename</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2115"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2116"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$check</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$shortFilename</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2117"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2118"><pre><span class="token T_WHITESPACE">		</span><span class="token T_ELSE">else</span></pre></div><div id="line2119"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2120"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$check</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">dirname</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$shortFilename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2121"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2122"><br/></div><div id="line2123"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">in_array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$check</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">ignoreDirectories</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2124"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2125"><pre><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2126"><br/></div><div id="line2127"><pre><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line2128"><pre><span class="token T_DOC_COMMENT"> * Akeeba Restore</span></pre></div><div id="line2129"><pre><span class="token T_DOC_COMMENT"> * A JSON-powered JPA, JPS and ZIP archive extraction library</span></pre></div><div id="line2130"><pre><span class="token T_DOC_COMMENT"> *</span></pre></div><div id="line2131"><pre><span class="token T_DOC_COMMENT"> * @copyright   2010-2014 Nicholas K. Dionysopoulos / Akeeba Ltd.</span></pre></div><div id="line2132"><pre><span class="token T_DOC_COMMENT"> * @license     GNU GPL v2 or - at your option - any later version</span></pre></div><div id="line2133"><pre><span class="token T_DOC_COMMENT"> * @package     akeebabackup</span></pre></div><div id="line2134"><pre><span class="token T_DOC_COMMENT"> * @subpackage  kickstart</span></pre></div><div id="line2135"><pre><span class="token T_DOC_COMMENT"> */</span></pre></div><div id="line2136"><br/></div><div id="line2137"><pre><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line2138"><pre><span class="token T_DOC_COMMENT"> * File post processor engines base class</span></pre></div><div id="line2139"><pre><span class="token T_DOC_COMMENT"> */</span></pre></div><div id="line2140"><pre><span class="token T_ABSTRACT">abstract</span><span class="token T_WHITESPACE"> </span><span class="token T_CLASS">class</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKAbstractPostproc</span><span class="token T_WHITESPACE"> </span><span class="token T_EXTENDS">extends</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKAbstractObject</span></pre></div><div id="line2141"><pre><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2142"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var string The current (real) file path we'll have to process */</span></pre></div><div id="line2143"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$filename</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2144"><br/></div><div id="line2145"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var int The requested permissions */</span></pre></div><div id="line2146"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$perms</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0755</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2147"><br/></div><div id="line2148"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var string The temporary file path we gave to the unarchiver engine */</span></pre></div><div id="line2149"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$tempFilename</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2150"><br/></div><div id="line2151"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var int The UNIX timestamp of the file's desired modification date */</span></pre></div><div id="line2152"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$timestamp</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2153"><br/></div><div id="line2154"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line2155"><pre><span class="token T_DOC_COMMENT">	 * Processes the current file, e.g. moves it from temp to final location by FTP</span></pre></div><div id="line2156"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line2157"><pre><span class="token T_WHITESPACE">	</span><span class="token T_ABSTRACT">abstract</span><span class="token T_WHITESPACE"> </span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">process</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2158"><br/></div><div id="line2159"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line2160"><pre><span class="token T_DOC_COMMENT">	 * The unarchiver tells us the path to the filename it wants to extract and we give it</span></pre></div><div id="line2161"><pre><span class="token T_DOC_COMMENT">	 * a different path instead.</span></pre></div><div id="line2162"><pre><span class="token T_DOC_COMMENT">	 * @param string $filename The path to the real file</span></pre></div><div id="line2163"><pre><span class="token T_DOC_COMMENT">	 * @param int $perms The permissions we need the file to have</span></pre></div><div id="line2164"><pre><span class="token T_DOC_COMMENT">	 * @return string The path to the temporary file</span></pre></div><div id="line2165"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line2166"><pre><span class="token T_WHITESPACE">	</span><span class="token T_ABSTRACT">abstract</span><span class="token T_WHITESPACE"> </span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">processFilename</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$filename</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$perms</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0755</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2167"><br/></div><div id="line2168"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line2169"><pre><span class="token T_DOC_COMMENT">	 * Recursively creates a directory if it doesn't exist</span></pre></div><div id="line2170"><pre><span class="token T_DOC_COMMENT">	 * @param string $dirName The directory to create</span></pre></div><div id="line2171"><pre><span class="token T_DOC_COMMENT">	 * @param int $perms The permissions to give to that directory</span></pre></div><div id="line2172"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line2173"><pre><span class="token T_WHITESPACE">	</span><span class="token T_ABSTRACT">abstract</span><span class="token T_WHITESPACE"> </span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">createDirRecursive</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$dirName</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$perms</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2174"><br/></div><div id="line2175"><pre><span class="token T_WHITESPACE">	</span><span class="token T_ABSTRACT">abstract</span><span class="token T_WHITESPACE"> </span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">chmod</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$file</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$perms</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2176"><br/></div><div id="line2177"><pre><span class="token T_WHITESPACE">	</span><span class="token T_ABSTRACT">abstract</span><span class="token T_WHITESPACE"> </span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">unlink</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$file</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2178"><br/></div><div id="line2179"><pre><span class="token T_WHITESPACE">	</span><span class="token T_ABSTRACT">abstract</span><span class="token T_WHITESPACE"> </span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">rmdir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$directory</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2180"><br/></div><div id="line2181"><pre><span class="token T_WHITESPACE">	</span><span class="token T_ABSTRACT">abstract</span><span class="token T_WHITESPACE"> </span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">rename</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$from</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$to</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2182"><pre><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2183"><br/></div><div id="line2184"><br/></div><div id="line2185"><pre><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line2186"><pre><span class="token T_DOC_COMMENT"> * Akeeba Restore</span></pre></div><div id="line2187"><pre><span class="token T_DOC_COMMENT"> * A JSON-powered JPA, JPS and ZIP archive extraction library</span></pre></div><div id="line2188"><pre><span class="token T_DOC_COMMENT"> *</span></pre></div><div id="line2189"><pre><span class="token T_DOC_COMMENT"> * @copyright   2010-2014 Nicholas K. Dionysopoulos / Akeeba Ltd.</span></pre></div><div id="line2190"><pre><span class="token T_DOC_COMMENT"> * @license     GNU GPL v2 or - at your option - any later version</span></pre></div><div id="line2191"><pre><span class="token T_DOC_COMMENT"> * @package     akeebabackup</span></pre></div><div id="line2192"><pre><span class="token T_DOC_COMMENT"> * @subpackage  kickstart</span></pre></div><div id="line2193"><pre><span class="token T_DOC_COMMENT"> */</span></pre></div><div id="line2194"><br/></div><div id="line2195"><pre><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line2196"><pre><span class="token T_DOC_COMMENT"> * Descendants of this class can be used in the unarchiver's observer methods (attach, detach and notify)</span></pre></div><div id="line2197"><pre><span class="token T_DOC_COMMENT"> * @author Nicholas</span></pre></div><div id="line2198"><pre><span class="token T_DOC_COMMENT"> *</span></pre></div><div id="line2199"><pre><span class="token T_DOC_COMMENT"> */</span></pre></div><div id="line2200"><pre><span class="token T_ABSTRACT">abstract</span><span class="token T_WHITESPACE"> </span><span class="token T_CLASS">class</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKAbstractPartObserver</span></pre></div><div id="line2201"><pre><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2202"><pre><span class="token T_WHITESPACE">	</span><span class="token T_ABSTRACT">abstract</span><span class="token T_WHITESPACE"> </span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">update</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$object</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$message</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2203"><pre><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2204"><br/></div><div id="line2205"><br/></div><div id="line2206"><pre><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line2207"><pre><span class="token T_DOC_COMMENT"> * Akeeba Restore</span></pre></div><div id="line2208"><pre><span class="token T_DOC_COMMENT"> * A JSON-powered JPA, JPS and ZIP archive extraction library</span></pre></div><div id="line2209"><pre><span class="token T_DOC_COMMENT"> *</span></pre></div><div id="line2210"><pre><span class="token T_DOC_COMMENT"> * @copyright   2010-2014 Nicholas K. Dionysopoulos / Akeeba Ltd.</span></pre></div><div id="line2211"><pre><span class="token T_DOC_COMMENT"> * @license     GNU GPL v2 or - at your option - any later version</span></pre></div><div id="line2212"><pre><span class="token T_DOC_COMMENT"> * @package     akeebabackup</span></pre></div><div id="line2213"><pre><span class="token T_DOC_COMMENT"> * @subpackage  kickstart</span></pre></div><div id="line2214"><pre><span class="token T_DOC_COMMENT"> */</span></pre></div><div id="line2215"><br/></div><div id="line2216"><pre><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line2217"><pre><span class="token T_DOC_COMMENT"> * Direct file writer</span></pre></div><div id="line2218"><pre><span class="token T_DOC_COMMENT"> */</span></pre></div><div id="line2219"><pre><span class="token T_CLASS">class</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKPostprocDirect</span><span class="token T_WHITESPACE"> </span><span class="token T_EXTENDS">extends</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKAbstractPostproc</span></pre></div><div id="line2220"><pre><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2221"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">process</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2222"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2223"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$restorePerms</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.restoreperms'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2224"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$restorePerms</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2225"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2226"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">chmod</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">filename</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">perms</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2227"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2228"><pre><span class="token T_WHITESPACE">		</span><span class="token T_ELSE">else</span></pre></div><div id="line2229"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2230"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">is_file</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">filename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2231"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2232"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">chmod</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">filename</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0644</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2233"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2234"><pre><span class="token T_WHITESPACE">			</span><span class="token T_ELSE">else</span></pre></div><div id="line2235"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2236"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">chmod</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">filename</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0755</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2237"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2238"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2239"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">timestamp</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_GT">&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2240"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2241"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">touch</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">filename</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">timestamp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2242"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2243"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2244"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2245"><br/></div><div id="line2246"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">processFilename</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$filename</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$perms</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0755</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2247"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2248"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">perms</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$perms</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2249"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">filename</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$filename</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2250"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$filename</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2251"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2252"><br/></div><div id="line2253"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">createDirRecursive</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$dirName</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$perms</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2254"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2255"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.dryrun'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'0'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2256"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">mkdir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$dirName</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0755</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2257"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">chmod</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$dirName</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0755</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2258"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2259"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2260"><br/></div><div id="line2261"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$root</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.destdir'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2262"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$root</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">rtrim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">str_replace</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'\\'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_VARIABLE">$root</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2263"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$dir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">rtrim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">str_replace</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'\\'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_VARIABLE">$dirName</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2264"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">strpos</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$dir</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$root</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_IDENTICAL">===</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2265"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$dir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">ltrim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$dir</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$root</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2266"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$root</span><span class="token T_WHITESPACE"> </span><span class="token T_CONCAT_EQUAL">.=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2267"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_ELSE">else</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2268"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$root</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2269"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2270"><br/></div><div id="line2271"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$dir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2272"><br/></div><div id="line2273"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$dirArray</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">explode</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$dir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2274"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$path</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2275"><pre><span class="token T_WHITESPACE">		</span><span class="token T_FOREACH">foreach</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$dirArray</span><span class="token T_WHITESPACE"> </span><span class="token T_AS">as</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$dir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2276"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2277"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$path</span><span class="token T_WHITESPACE"> </span><span class="token T_CONCAT_EQUAL">.=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$dir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2278"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">is_dir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$root</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$path</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_QUESTION_MARK">?</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_COLON">:</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">mkdir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$root</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$path</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2279"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2280"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// Is this a file instead of a directory?</span></pre></div><div id="line2281"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">is_file</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$root</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$path</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2282"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2283"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">unlink</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$root</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$path</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2284"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">mkdir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$root</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$path</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2285"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2286"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2287"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">sprintf</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'COULDNT_CREATE_DIR'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_VARIABLE">$path</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2288"><pre><span class="token T_WHITESPACE">					</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2289"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2290"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2291"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Try to set new directory permissions to 0755</span></pre></div><div id="line2292"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">chmod</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$root</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$path</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$perms</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2293"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2294"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2295"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2296"><br/></div><div id="line2297"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">chmod</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$file</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$perms</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2298"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2299"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.dryrun'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'0'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2300"><br/></div><div id="line2301"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">chmod</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$file</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$perms</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2302"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2303"><br/></div><div id="line2304"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">unlink</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$file</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2305"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2306"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">unlink</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$file</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2307"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2308"><br/></div><div id="line2309"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">rmdir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$directory</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2310"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2311"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">rmdir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$directory</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2312"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2313"><br/></div><div id="line2314"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">rename</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$from</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$to</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2315"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2316"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">rename</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$from</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$to</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2317"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2318"><br/></div><div id="line2319"><pre><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2320"><br/></div><div id="line2321"><pre><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line2322"><pre><span class="token T_DOC_COMMENT"> * Akeeba Restore</span></pre></div><div id="line2323"><pre><span class="token T_DOC_COMMENT"> * A JSON-powered JPA, JPS and ZIP archive extraction library</span></pre></div><div id="line2324"><pre><span class="token T_DOC_COMMENT"> *</span></pre></div><div id="line2325"><pre><span class="token T_DOC_COMMENT"> * @copyright   2010-2014 Nicholas K. Dionysopoulos / Akeeba Ltd.</span></pre></div><div id="line2326"><pre><span class="token T_DOC_COMMENT"> * @license     GNU GPL v2 or - at your option - any later version</span></pre></div><div id="line2327"><pre><span class="token T_DOC_COMMENT"> * @package     akeebabackup</span></pre></div><div id="line2328"><pre><span class="token T_DOC_COMMENT"> * @subpackage  kickstart</span></pre></div><div id="line2329"><pre><span class="token T_DOC_COMMENT"> */</span></pre></div><div id="line2330"><br/></div><div id="line2331"><pre><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line2332"><pre><span class="token T_DOC_COMMENT"> * FTP file writer</span></pre></div><div id="line2333"><pre><span class="token T_DOC_COMMENT"> */</span></pre></div><div id="line2334"><pre><span class="token T_CLASS">class</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKPostprocFTP</span><span class="token T_WHITESPACE"> </span><span class="token T_EXTENDS">extends</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKAbstractPostproc</span></pre></div><div id="line2335"><pre><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2336"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var bool Should I use FTP over implicit SSL? */</span></pre></div><div id="line2337"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$useSSL</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2338"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var bool use Passive mode? */</span></pre></div><div id="line2339"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$passive</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2340"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var string FTP host name */</span></pre></div><div id="line2341"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$host</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2342"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var int FTP port */</span></pre></div><div id="line2343"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$port</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">21</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2344"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var string FTP user name */</span></pre></div><div id="line2345"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$user</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2346"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var string FTP password */</span></pre></div><div id="line2347"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$pass</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2348"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var string FTP initial directory */</span></pre></div><div id="line2349"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$dir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2350"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var resource The FTP handle */</span></pre></div><div id="line2351"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PRIVATE">private</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$handle</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2352"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var string The temporary directory where the data will be stored */</span></pre></div><div id="line2353"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PRIVATE">private</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$tempDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2354"><br/></div><div id="line2355"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">__construct</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2356"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2357"><pre><span class="token T_WHITESPACE">		</span><span class="token T_STRING">parent</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">__construct</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2358"><br/></div><div id="line2359"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">useSSL</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.ftp.ssl'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2360"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">passive</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.ftp.passive'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2361"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">host</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.ftp.host'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2362"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">port</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.ftp.port'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">21</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2363"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">port</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">port</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">21</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2364"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">user</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.ftp.user'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2365"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">pass</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.ftp.pass'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2366"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">dir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.ftp.dir'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2367"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.ftp.tempdir'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2368"><br/></div><div id="line2369"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$connected</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">connect</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2370"><br/></div><div id="line2371"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$connected</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2372"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2373"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempDir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2374"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2375"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">rtrim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempDir</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/\\'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2376"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$writable</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isDirWritable</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2377"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2378"><pre><span class="token T_WHITESPACE">			</span><span class="token T_ELSE">else</span></pre></div><div id="line2379"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2380"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2381"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$writable</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2382"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2383"><br/></div><div id="line2384"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$writable</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2385"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// Default temporary directory is the current root</span></pre></div><div id="line2386"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">KSROOTDIR</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2387"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2388"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2389"><pre><span class="token T_WHITESPACE">					</span><span class="token T_COMMENT">// Oh, we have no directory reported!</span></pre></div><div id="line2390"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'.'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2391"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2392"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$absoluteDirToHere</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$tempDir</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2393"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">rtrim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">str_replace</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'\\'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2394"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$tempDir</span><span class="token T_WHITESPACE"> </span><span class="token T_CONCAT_EQUAL">.=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2395"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$tempDir</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2396"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// Is this directory writable?</span></pre></div><div id="line2397"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$writable</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isDirWritable</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2398"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2399"><br/></div><div id="line2400"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$writable</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2401"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2402"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// Nope. Let's try creating a temporary directory in the site's root.</span></pre></div><div id="line2403"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$absoluteDirToHere</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/kicktemp'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2404"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">createDirRecursive</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0777</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2405"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// Try making it writable...</span></pre></div><div id="line2406"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fixPermissions</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2407"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$writable</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isDirWritable</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2408"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2409"><br/></div><div id="line2410"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Was the new directory writable?</span></pre></div><div id="line2411"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$writable</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2412"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2413"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// Let's see if the user has specified one</span></pre></div><div id="line2414"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$userdir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.ftp.tempdir'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2415"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$userdir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2416"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2417"><pre><span class="token T_WHITESPACE">					</span><span class="token T_COMMENT">// Is it an absolute or a relative directory?</span></pre></div><div id="line2418"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$absolute</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2419"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$absolute</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$absolute</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_OR">||</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$userdir</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2420"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$absolute</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$absolute</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_OR">||</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$userdir</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">':'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2421"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$absolute</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$absolute</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_OR">||</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$userdir</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">2</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">':'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2422"><pre><span class="token T_WHITESPACE">					</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$absolute</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2423"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2424"><pre><span class="token T_WHITESPACE">						</span><span class="token T_COMMENT">// Make absolute</span></pre></div><div id="line2425"><pre><span class="token T_WHITESPACE">						</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$absoluteDirToHere</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$userdir</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2426"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2427"><pre><span class="token T_WHITESPACE">					</span><span class="token T_ELSE">else</span></pre></div><div id="line2428"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2429"><pre><span class="token T_WHITESPACE">						</span><span class="token T_COMMENT">// it's already absolute</span></pre></div><div id="line2430"><pre><span class="token T_WHITESPACE">						</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$userdir</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2431"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2432"><pre><span class="token T_WHITESPACE">					</span><span class="token T_COMMENT">// Does the directory exist?</span></pre></div><div id="line2433"><pre><span class="token T_WHITESPACE">					</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">is_dir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2434"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2435"><pre><span class="token T_WHITESPACE">						</span><span class="token T_COMMENT">// Yeah. Is it writable?</span></pre></div><div id="line2436"><pre><span class="token T_WHITESPACE">						</span><span class="token T_VARIABLE">$writable</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isDirWritable</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2437"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2438"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2439"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2440"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$tempDir</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2441"><br/></div><div id="line2442"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$writable</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2443"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2444"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// No writable directory found!!!</span></pre></div><div id="line2445"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">_</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'FTP_TEMPDIR_NOT_WRITABLE'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2446"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2447"><pre><span class="token T_WHITESPACE">			</span><span class="token T_ELSE">else</span></pre></div><div id="line2448"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2449"><pre><span class="token T_WHITESPACE">				</span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">set</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.ftp.tempdir'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$tempDir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2450"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$tempDir</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2451"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2452"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2453"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2454"><br/></div><div id="line2455"><pre><span class="token T_WHITESPACE">	</span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">__wakeup</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2456"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2457"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">connect</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2458"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2459"><br/></div><div id="line2460"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">connect</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2461"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2462"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Connect to server, using SSL if so required</span></pre></div><div id="line2463"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">useSSL</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2464"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftp_ssl_connect</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">host</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">port</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2465"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_ELSE">else</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2466"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftp_connect</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">host</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">port</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2467"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2468"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_IDENTICAL">===</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2469"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2470"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">_</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'WRONG_FTP_HOST'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2471"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2472"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2473"><br/></div><div id="line2474"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Login</span></pre></div><div id="line2475"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftp_login</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">user</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">pass</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2476"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2477"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">_</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'WRONG_FTP_USER'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2478"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftp_close</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2479"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2480"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2481"><br/></div><div id="line2482"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Change to initial directory</span></pre></div><div id="line2483"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftp_chdir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">dir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2484"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2485"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">_</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'WRONG_FTP_PATH1'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2486"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftp_close</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2487"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2488"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2489"><br/></div><div id="line2490"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Enable passive mode if the user requested it</span></pre></div><div id="line2491"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">passive</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2492"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2493"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftp_pasv</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2494"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2495"><pre><span class="token T_WHITESPACE">		</span><span class="token T_ELSE">else</span></pre></div><div id="line2496"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2497"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftp_pasv</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2498"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2499"><br/></div><div id="line2500"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Try to download ourselves</span></pre></div><div id="line2501"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$testFilename</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">defined</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'KSSELFNAME'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_QUESTION_MARK">?</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">KSSELFNAME</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_COLON">:</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">basename</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_FILE">__FILE__</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2502"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$tempHandle</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">fopen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'php://temp'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'r+'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2503"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftp_fget</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$tempHandle</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$testFilename</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">FTP_ASCII</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_IDENTICAL">===</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2504"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2505"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">_</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'WRONG_FTP_PATH2'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2506"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftp_close</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2507"><pre><span class="token T_WHITESPACE">			</span><span class="token T_STRING">fclose</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$tempHandle</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2508"><br/></div><div id="line2509"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2510"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2511"><pre><span class="token T_WHITESPACE">		</span><span class="token T_STRING">fclose</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$tempHandle</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2512"><br/></div><div id="line2513"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2514"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2515"><br/></div><div id="line2516"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">process</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2517"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2518"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">is_null</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempFilename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2519"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2520"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// If an empty filename is passed, it means that we shouldn't do any post processing, i.e.</span></pre></div><div id="line2521"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// the entity was a directory or symlink</span></pre></div><div id="line2522"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2523"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2524"><br/></div><div id="line2525"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$remotePath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">dirname</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">filename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2526"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$removePath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.destdir'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2527"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2528"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2529"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$removePath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">ltrim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">"/"</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2530"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$remotePath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">ltrim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$remotePath</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">"/"</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2531"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$left</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$remotePath</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2532"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$left</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2533"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2534"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$remotePath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$remotePath</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2535"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2536"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2537"><br/></div><div id="line2538"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$absoluteFSPath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">dirname</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">filename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2539"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$relativeFTPPath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$remotePath</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2540"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$absoluteFTPPath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">dir</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$remotePath</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2541"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$onlyFilename</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">basename</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">filename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2542"><br/></div><div id="line2543"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$remoteName</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$absoluteFTPPath</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$onlyFilename</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2544"><br/></div><div id="line2545"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftp_chdir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$absoluteFTPPath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2546"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_IDENTICAL">===</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2547"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2548"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">createDirRecursive</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$absoluteFSPath</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0755</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2549"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_IDENTICAL">===</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2550"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">sprintf</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'FTP_COULDNT_UPLOAD'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">filename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2551"><pre><span class="token T_WHITESPACE">				</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2552"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2553"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftp_chdir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$absoluteFTPPath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2554"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_IDENTICAL">===</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2555"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">sprintf</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'FTP_COULDNT_UPLOAD'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">filename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2556"><pre><span class="token T_WHITESPACE">				</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2557"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2558"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2559"><br/></div><div id="line2560"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftp_put</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$remoteName</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempFilename</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">FTP_BINARY</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2561"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_IDENTICAL">===</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2562"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2563"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// If we couldn't create the file, attempt to fix the permissions in the PHP level and retry!</span></pre></div><div id="line2564"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fixPermissions</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">filename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2565"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">unlink</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">filename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2566"><br/></div><div id="line2567"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$fp</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">fopen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempFilename</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'rb'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2568"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$fp</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_NOT_IDENTICAL">!==</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2569"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2570"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftp_fput</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$remoteName</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">FTP_BINARY</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2571"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">fclose</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$fp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2572"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2573"><pre><span class="token T_WHITESPACE">			</span><span class="token T_ELSE">else</span></pre></div><div id="line2574"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2575"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2576"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2577"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2578"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">unlink</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempFilename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2579"><br/></div><div id="line2580"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_IDENTICAL">===</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2581"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2582"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">sprintf</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'FTP_COULDNT_UPLOAD'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">filename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2583"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2584"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2585"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$restorePerms</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.restoreperms'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2586"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$restorePerms</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2587"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2588"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftp_chmod</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">_handle</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">perms</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$remoteName</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2589"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2590"><pre><span class="token T_WHITESPACE">		</span><span class="token T_ELSE">else</span></pre></div><div id="line2591"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2592"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftp_chmod</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">_handle</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0644</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$remoteName</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2593"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2594"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2595"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2596"><br/></div><div id="line2597"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">processFilename</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$filename</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$perms</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0755</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2598"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2599"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Catch some error conditions...</span></pre></div><div id="line2600"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">getError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2601"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2602"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2603"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2604"><br/></div><div id="line2605"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// If a null filename is passed, it means that we shouldn't do any post processing, i.e.</span></pre></div><div id="line2606"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// the entity was a directory or symlink</span></pre></div><div id="line2607"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">is_null</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$filename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2608"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2609"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">filename</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2610"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempFilename</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2611"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2612"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2613"><br/></div><div id="line2614"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Strip absolute filesystem path to website's root</span></pre></div><div id="line2615"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$removePath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.destdir'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2616"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2617"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2618"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$left</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$filename</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2619"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$left</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2620"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2621"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$filename</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$filename</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2622"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2623"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2624"><br/></div><div id="line2625"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Trim slash on the left</span></pre></div><div id="line2626"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$filename</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">ltrim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$filename</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2627"><br/></div><div id="line2628"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">filename</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$filename</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2629"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempFilename</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">tempnam</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempDir</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart-'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2630"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">perms</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$perms</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2631"><br/></div><div id="line2632"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempFilename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2633"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2634"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Oops! Let's try something different</span></pre></div><div id="line2635"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempFilename</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempDir</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/kickstart-'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_STRING">time</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'.dat'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2636"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2637"><br/></div><div id="line2638"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempFilename</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2639"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2640"><br/></div><div id="line2641"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PRIVATE">private</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">isDirWritable</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$dir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2642"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2643"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$fp</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">fopen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$dir</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/kickstart.dat'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'wb'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2644"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$fp</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_IDENTICAL">===</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2645"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2646"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2647"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2648"><pre><span class="token T_WHITESPACE">		</span><span class="token T_ELSE">else</span></pre></div><div id="line2649"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2650"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">fclose</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$fp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2651"><pre><span class="token T_WHITESPACE">			</span><span class="token T_STRING">unlink</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$dir</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/kickstart.dat'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2652"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2653"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2654"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2655"><br/></div><div id="line2656"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">createDirRecursive</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$dirName</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$perms</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2657"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2658"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Strip absolute filesystem path to website's root</span></pre></div><div id="line2659"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$removePath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.destdir'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2660"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2661"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2662"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// UNIXize the paths</span></pre></div><div id="line2663"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$removePath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">str_replace</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'\\'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2664"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$dirName</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">str_replace</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'\\'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_VARIABLE">$dirName</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2665"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Make sure they both end in a slash</span></pre></div><div id="line2666"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$removePath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">rtrim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/\\'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2667"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$dirName</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">rtrim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$dirName</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/\\'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2668"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Process the path removal</span></pre></div><div id="line2669"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$left</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$dirName</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2670"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$left</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2671"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2672"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$dirName</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$dirName</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2673"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2674"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2675"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$dirName</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$dirName</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_COMMENT">// 'cause the substr() above may return FALSE.</span></pre></div><div id="line2676"><br/></div><div id="line2677"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$check</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">dir</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$dirName</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2678"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">is_dir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$check</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2679"><br/></div><div id="line2680"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$alldirs</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">explode</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$dirName</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2681"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$previousDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">dir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2682"><pre><span class="token T_WHITESPACE">		</span><span class="token T_FOREACH">foreach</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$alldirs</span><span class="token T_WHITESPACE"> </span><span class="token T_AS">as</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$curdir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2683"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2684"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$check</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$previousDir</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$curdir</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2685"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">is_dir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$check</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2686"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2687"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// Proactively try to delete a file by the same name</span></pre></div><div id="line2688"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftp_delete</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$check</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2689"><br/></div><div id="line2690"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftp_mkdir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$check</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_IDENTICAL">===</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2691"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2692"><pre><span class="token T_WHITESPACE">					</span><span class="token T_COMMENT">// If we couldn't create the directory, attempt to fix the permissions in the PHP level and retry!</span></pre></div><div id="line2693"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fixPermissions</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$check</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2694"><pre><span class="token T_WHITESPACE">					</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftp_mkdir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$check</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_IDENTICAL">===</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2695"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2696"><pre><span class="token T_WHITESPACE">						</span><span class="token T_COMMENT">// Can we fall back to pure PHP mode, sire?</span></pre></div><div id="line2697"><pre><span class="token T_WHITESPACE">						</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">mkdir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$check</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2698"><pre><span class="token T_WHITESPACE">						</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2699"><pre><span class="token T_WHITESPACE">							</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">sprintf</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'FTP_CANT_CREATE_DIR'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$check</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2700"><pre><span class="token T_WHITESPACE">							</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2701"><pre><span class="token T_WHITESPACE">						</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2702"><pre><span class="token T_WHITESPACE">						</span><span class="token T_ELSE">else</span></pre></div><div id="line2703"><pre><span class="token T_WHITESPACE">						</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2704"><pre><span class="token T_WHITESPACE">							</span><span class="token T_COMMENT">// Since the directory was built by PHP, change its permissions</span></pre></div><div id="line2705"><pre><span class="token T_WHITESPACE">							</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">chmod</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$check</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">"0777"</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2706"><pre><span class="token T_WHITESPACE">							</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2707"><pre><span class="token T_WHITESPACE">						</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2708"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2709"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2710"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftp_chmod</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$perms</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$check</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2711"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2712"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$previousDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$check</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2713"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2714"><br/></div><div id="line2715"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2716"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2717"><br/></div><div id="line2718"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">close</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2719"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2720"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftp_close</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2721"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2722"><br/></div><div id="line2723"><pre><span class="token T_WHITESPACE">	</span><span class="token T_COMMENT">/*</span></pre></div><div id="line2724"><pre><span class="token T_COMMENT">	 * Tries to fix directory/file permissions in the PHP level, so that</span></pre></div><div id="line2725"><pre><span class="token T_COMMENT">	 * the FTP operation doesn't fail.</span></pre></div><div id="line2726"><pre><span class="token T_COMMENT">	 * @param $path string The full path to a directory or file</span></pre></div><div id="line2727"><pre><span class="token T_COMMENT">	 */</span></pre></div><div id="line2728"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PRIVATE">private</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">fixPermissions</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$path</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2729"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2730"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Turn off error reporting</span></pre></div><div id="line2731"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">defined</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'KSDEBUG'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2732"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$oldErrorReporting</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">error_reporting</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">E_NONE</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2733"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2734"><br/></div><div id="line2735"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Get UNIX style paths</span></pre></div><div id="line2736"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$relPath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">str_replace</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'\\'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_VARIABLE">$path</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2737"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$basePath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">rtrim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">str_replace</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'\\'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_STRING">KSROOTDIR</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2738"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$basePath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">rtrim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$basePath</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2739"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$basePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$basePath</span><span class="token T_WHITESPACE"> </span><span class="token T_CONCAT_EQUAL">.=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2740"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Remove the leading relative root</span></pre></div><div id="line2741"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$relPath</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$basePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$basePath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2742"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$relPath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$relPath</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$basePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2743"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$dirArray</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">explode</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$relPath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2744"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$pathBuilt</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">rtrim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$basePath</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2745"><pre><span class="token T_WHITESPACE">		</span><span class="token T_FOREACH">foreach</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$dirArray</span><span class="token T_WHITESPACE"> </span><span class="token T_AS">as</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$dir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2746"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2747"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$dir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_CONTINUE">continue</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2748"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$oldPath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$pathBuilt</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2749"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$pathBuilt</span><span class="token T_WHITESPACE"> </span><span class="token T_CONCAT_EQUAL">.=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$dir</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2750"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">is_dir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$oldPath</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$dir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2751"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2752"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">chmod</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$oldPath</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$dir</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0777</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2753"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2754"><pre><span class="token T_WHITESPACE">			</span><span class="token T_ELSE">else</span></pre></div><div id="line2755"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2756"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">chmod</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$oldPath</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$dir</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0777</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_IDENTICAL">===</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2757"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2758"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">unlink</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$oldPath</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$dir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2759"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2760"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2761"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2762"><br/></div><div id="line2763"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Restore error reporting</span></pre></div><div id="line2764"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">defined</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'KSDEBUG'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2765"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">error_reporting</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$oldErrorReporting</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2766"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2767"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2768"><br/></div><div id="line2769"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">chmod</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$file</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$perms</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2770"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2771"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftp_chmod</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$perms</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$file</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2772"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2773"><br/></div><div id="line2774"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PRIVATE">private</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">is_dir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$dir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2775"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2776"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftp_chdir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$dir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2777"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2778"><br/></div><div id="line2779"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">unlink</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$file</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2780"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2781"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$removePath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.destdir'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2782"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2783"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2784"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$left</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$file</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2785"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$left</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2786"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2787"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$file</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$file</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2788"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2789"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2790"><br/></div><div id="line2791"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$check</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">dir</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$file</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2792"><br/></div><div id="line2793"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftp_delete</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$check</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2794"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2795"><br/></div><div id="line2796"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">rmdir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$directory</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2797"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2798"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$removePath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.destdir'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2799"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2800"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2801"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$left</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$directory</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2802"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$left</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2803"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2804"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$directory</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$directory</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2805"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2806"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2807"><br/></div><div id="line2808"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$check</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">dir</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$directory</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2809"><br/></div><div id="line2810"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftp_rmdir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$check</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2811"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2812"><br/></div><div id="line2813"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">rename</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$from</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$to</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2814"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2815"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$originalFrom</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$from</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2816"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$originalTo</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$to</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2817"><br/></div><div id="line2818"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$removePath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.destdir'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2819"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2820"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2821"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$left</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$from</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2822"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$left</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2823"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2824"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$from</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$from</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2825"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2826"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2827"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$from</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">dir</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$from</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2828"><br/></div><div id="line2829"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2830"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2831"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$left</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$to</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2832"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$left</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2833"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2834"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$to</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$to</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2835"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2836"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2837"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$to</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">dir</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$to</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2838"><br/></div><div id="line2839"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$result</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftp_rename</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$from</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$to</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2840"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$result</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_NOT_IDENTICAL">!==</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2841"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2842"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">rename</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$from</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$to</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2843"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2844"><pre><span class="token T_WHITESPACE">		</span><span class="token T_ELSE">else</span></pre></div><div id="line2845"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2846"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2847"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2848"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2849"><br/></div><div id="line2850"><pre><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2851"><br/></div><div id="line2852"><br/></div><div id="line2853"><pre><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line2854"><pre><span class="token T_DOC_COMMENT"> * Akeeba Restore</span></pre></div><div id="line2855"><pre><span class="token T_DOC_COMMENT"> * A JSON-powered JPA, JPS and ZIP archive extraction library</span></pre></div><div id="line2856"><pre><span class="token T_DOC_COMMENT"> *</span></pre></div><div id="line2857"><pre><span class="token T_DOC_COMMENT"> * @copyright   2010-2014 Nicholas K. Dionysopoulos / Akeeba Ltd.</span></pre></div><div id="line2858"><pre><span class="token T_DOC_COMMENT"> * @license     GNU GPL v2 or - at your option - any later version</span></pre></div><div id="line2859"><pre><span class="token T_DOC_COMMENT"> * @package     akeebabackup</span></pre></div><div id="line2860"><pre><span class="token T_DOC_COMMENT"> * @subpackage  kickstart</span></pre></div><div id="line2861"><pre><span class="token T_DOC_COMMENT"> */</span></pre></div><div id="line2862"><br/></div><div id="line2863"><pre><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line2864"><pre><span class="token T_DOC_COMMENT"> * FTP file writer</span></pre></div><div id="line2865"><pre><span class="token T_DOC_COMMENT"> */</span></pre></div><div id="line2866"><pre><span class="token T_CLASS">class</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKPostprocSFTP</span><span class="token T_WHITESPACE"> </span><span class="token T_EXTENDS">extends</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKAbstractPostproc</span></pre></div><div id="line2867"><pre><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2868"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var bool Should I use FTP over implicit SSL? */</span></pre></div><div id="line2869"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$useSSL</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2870"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var bool use Passive mode? */</span></pre></div><div id="line2871"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$passive</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2872"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var string FTP host name */</span></pre></div><div id="line2873"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$host</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2874"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var int FTP port */</span></pre></div><div id="line2875"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$port</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">21</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2876"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var string FTP user name */</span></pre></div><div id="line2877"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$user</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2878"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var string FTP password */</span></pre></div><div id="line2879"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$pass</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2880"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var string FTP initial directory */</span></pre></div><div id="line2881"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$dir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2882"><br/></div><div id="line2883"><pre><span class="token T_WHITESPACE">    </span><span class="token T_DOC_COMMENT">/** @var resource SFTP resource handle */</span></pre></div><div id="line2884"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PRIVATE">private</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$handle</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2885"><br/></div><div id="line2886"><pre><span class="token T_WHITESPACE">    </span><span class="token T_DOC_COMMENT">/** @var resource SSH2 connection resource handle */</span></pre></div><div id="line2887"><pre><span class="token T_WHITESPACE">    </span><span class="token T_PRIVATE">private</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$_connection</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2888"><br/></div><div id="line2889"><pre><span class="token T_WHITESPACE">    </span><span class="token T_DOC_COMMENT">/** @var string Current remote directory, including the remote directory string */</span></pre></div><div id="line2890"><pre><span class="token T_WHITESPACE">    </span><span class="token T_PRIVATE">private</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$_currentdir</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2891"><br/></div><div id="line2892"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var string The temporary directory where the data will be stored */</span></pre></div><div id="line2893"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PRIVATE">private</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$tempDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2894"><br/></div><div id="line2895"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">__construct</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2896"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2897"><pre><span class="token T_WHITESPACE">		</span><span class="token T_STRING">parent</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">__construct</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2898"><br/></div><div id="line2899"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">host</span><span class="token T_WHITESPACE">     </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.ftp.host'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2900"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">port</span><span class="token T_WHITESPACE">     </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.ftp.port'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">22</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2901"><br/></div><div id="line2902"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">port</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">port</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">22</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2903"><br/></div><div id="line2904"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">user</span><span class="token T_WHITESPACE">     </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.ftp.user'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2905"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">pass</span><span class="token T_WHITESPACE">     </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.ftp.pass'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2906"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">dir</span><span class="token T_WHITESPACE">      </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.ftp.dir'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2907"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempDir</span><span class="token T_WHITESPACE">  </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.ftp.tempdir'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2908"><br/></div><div id="line2909"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$connected</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">connect</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2910"><br/></div><div id="line2911"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$connected</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2912"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2913"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempDir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2914"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2915"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">rtrim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempDir</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/\\'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2916"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$writable</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isDirWritable</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2917"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2918"><pre><span class="token T_WHITESPACE">			</span><span class="token T_ELSE">else</span></pre></div><div id="line2919"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2920"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2921"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$writable</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2922"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2923"><br/></div><div id="line2924"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$writable</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2925"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// Default temporary directory is the current root</span></pre></div><div id="line2926"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">KSROOTDIR</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2927"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2928"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2929"><pre><span class="token T_WHITESPACE">					</span><span class="token T_COMMENT">// Oh, we have no directory reported!</span></pre></div><div id="line2930"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'.'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2931"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2932"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$absoluteDirToHere</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$tempDir</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2933"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">rtrim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">str_replace</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'\\'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2934"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$tempDir</span><span class="token T_WHITESPACE"> </span><span class="token T_CONCAT_EQUAL">.=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2935"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$tempDir</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2936"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// Is this directory writable?</span></pre></div><div id="line2937"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$writable</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isDirWritable</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2938"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2939"><br/></div><div id="line2940"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$writable</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2941"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2942"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// Nope. Let's try creating a temporary directory in the site's root.</span></pre></div><div id="line2943"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$absoluteDirToHere</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/kicktemp'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2944"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">createDirRecursive</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0777</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2945"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// Try making it writable...</span></pre></div><div id="line2946"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fixPermissions</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2947"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$writable</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isDirWritable</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2948"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2949"><br/></div><div id="line2950"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Was the new directory writable?</span></pre></div><div id="line2951"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$writable</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2952"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2953"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// Let's see if the user has specified one</span></pre></div><div id="line2954"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$userdir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.ftp.tempdir'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2955"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$userdir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2956"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2957"><pre><span class="token T_WHITESPACE">					</span><span class="token T_COMMENT">// Is it an absolute or a relative directory?</span></pre></div><div id="line2958"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$absolute</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2959"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$absolute</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$absolute</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_OR">||</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$userdir</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2960"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$absolute</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$absolute</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_OR">||</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$userdir</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">':'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2961"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$absolute</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$absolute</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_OR">||</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$userdir</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">2</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">':'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2962"><pre><span class="token T_WHITESPACE">					</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$absolute</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2963"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2964"><pre><span class="token T_WHITESPACE">						</span><span class="token T_COMMENT">// Make absolute</span></pre></div><div id="line2965"><pre><span class="token T_WHITESPACE">						</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$absoluteDirToHere</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$userdir</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2966"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2967"><pre><span class="token T_WHITESPACE">					</span><span class="token T_ELSE">else</span></pre></div><div id="line2968"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2969"><pre><span class="token T_WHITESPACE">						</span><span class="token T_COMMENT">// it's already absolute</span></pre></div><div id="line2970"><pre><span class="token T_WHITESPACE">						</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$userdir</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2971"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2972"><pre><span class="token T_WHITESPACE">					</span><span class="token T_COMMENT">// Does the directory exist?</span></pre></div><div id="line2973"><pre><span class="token T_WHITESPACE">					</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">is_dir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2974"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2975"><pre><span class="token T_WHITESPACE">						</span><span class="token T_COMMENT">// Yeah. Is it writable?</span></pre></div><div id="line2976"><pre><span class="token T_WHITESPACE">						</span><span class="token T_VARIABLE">$writable</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isDirWritable</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2977"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2978"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2979"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2980"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$tempDir</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2981"><br/></div><div id="line2982"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$writable</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2983"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2984"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// No writable directory found!!!</span></pre></div><div id="line2985"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">_</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'SFTP_TEMPDIR_NOT_WRITABLE'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2986"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2987"><pre><span class="token T_WHITESPACE">			</span><span class="token T_ELSE">else</span></pre></div><div id="line2988"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2989"><pre><span class="token T_WHITESPACE">				</span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">set</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.ftp.tempdir'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$tempDir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2990"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$tempDir</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2991"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2992"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2993"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2994"><br/></div><div id="line2995"><pre><span class="token T_WHITESPACE">	</span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">__wakeup</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line2996"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line2997"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">connect</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line2998"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line2999"><br/></div><div id="line3000"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">connect</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3001"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3002"><pre><span class="token T_WHITESPACE">        </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">_connection</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3003"><br/></div><div id="line3004"><pre><span class="token T_WHITESPACE">        </span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">function_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'ssh2_connect'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3005"><pre><span class="token T_WHITESPACE">        </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3006"><pre><span class="token T_WHITESPACE">            </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">_</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'SFTP_NO_SSH2'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3007"><pre><span class="token T_WHITESPACE">            </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3008"><pre><span class="token T_WHITESPACE">        </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3009"><br/></div><div id="line3010"><pre><span class="token T_WHITESPACE">        </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">_connection</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ssh2_connect</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">host</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">port</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3011"><br/></div><div id="line3012"><pre><span class="token T_WHITESPACE">        </span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ssh2_auth_password</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">_connection</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">user</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">pass</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3013"><pre><span class="token T_WHITESPACE">        </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3014"><pre><span class="token T_WHITESPACE">            </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">_</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'SFTP_WRONG_USER'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3015"><br/></div><div id="line3016"><pre><span class="token T_WHITESPACE">            </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">_connection</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3017"><br/></div><div id="line3018"><pre><span class="token T_WHITESPACE">            </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3019"><pre><span class="token T_WHITESPACE">        </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3020"><br/></div><div id="line3021"><pre><span class="token T_WHITESPACE">        </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ssh2_sftp</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">_connection</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3022"><br/></div><div id="line3023"><pre><span class="token T_WHITESPACE">        </span><span class="token T_COMMENT">// I must have an absolute directory</span></pre></div><div id="line3024"><pre><span class="token T_WHITESPACE">        </span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">dir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3025"><pre><span class="token T_WHITESPACE">        </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3026"><pre><span class="token T_WHITESPACE">            </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">_</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'SFTP_WRONG_STARTING_DIR'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3027"><pre><span class="token T_WHITESPACE">            </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3028"><pre><span class="token T_WHITESPACE">        </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3029"><br/></div><div id="line3030"><pre><span class="token T_WHITESPACE">        </span><span class="token T_COMMENT">// Change to initial directory</span></pre></div><div id="line3031"><pre><span class="token T_WHITESPACE">        </span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">sftp_chdir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3032"><pre><span class="token T_WHITESPACE">        </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3033"><pre><span class="token T_WHITESPACE">            </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">_</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'SFTP_WRONG_STARTING_DIR'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3034"><br/></div><div id="line3035"><pre><span class="token T_WHITESPACE">            </span><span class="token T_UNSET">unset</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">_connection</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3036"><pre><span class="token T_WHITESPACE">            </span><span class="token T_UNSET">unset</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3037"><br/></div><div id="line3038"><pre><span class="token T_WHITESPACE">            </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3039"><pre><span class="token T_WHITESPACE">        </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3040"><br/></div><div id="line3041"><pre><span class="token T_WHITESPACE">        </span><span class="token T_COMMENT">// Try to download ourselves</span></pre></div><div id="line3042"><pre><span class="token T_WHITESPACE">        </span><span class="token T_VARIABLE">$testFilename</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">defined</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'KSSELFNAME'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_QUESTION_MARK">?</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">KSSELFNAME</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_COLON">:</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">basename</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_FILE">__FILE__</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3043"><pre><span class="token T_WHITESPACE">        </span><span class="token T_VARIABLE">$basePath</span><span class="token T_WHITESPACE">     </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">dir</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3044"><br/></div><div id="line3045"><pre><span class="token T_WHITESPACE">        </span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">fopen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_DOUBLE_QUOTES">"</span><span class="token T_ENCAPSED_AND_WHITESPACE">ssh2.sftp://</span><span class="token T_CURLY_OPEN">{</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_VARIABLE">$basePath</span><span class="token T_ENCAPSED_AND_WHITESPACE">/</span><span class="token T_VARIABLE">$testFilename</span><span class="token T_PHPDOX_DOUBLE_QUOTES">"</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'r+'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_IDENTICAL">===</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3046"><pre><span class="token T_WHITESPACE">        </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3047"><pre><span class="token T_WHITESPACE">            </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">_</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'SFTP_WRONG_STARTING_DIR'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3048"><br/></div><div id="line3049"><pre><span class="token T_WHITESPACE">            </span><span class="token T_UNSET">unset</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">_connection</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3050"><pre><span class="token T_WHITESPACE">            </span><span class="token T_UNSET">unset</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3051"><br/></div><div id="line3052"><pre><span class="token T_WHITESPACE">            </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3053"><pre><span class="token T_WHITESPACE">        </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3054"><br/></div><div id="line3055"><pre><span class="token T_WHITESPACE">        </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3056"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3057"><br/></div><div id="line3058"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">process</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3059"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3060"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">is_null</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempFilename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3061"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3062"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// If an empty filename is passed, it means that we shouldn't do any post processing, i.e.</span></pre></div><div id="line3063"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// the entity was a directory or symlink</span></pre></div><div id="line3064"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3065"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3066"><br/></div><div id="line3067"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$remotePath</span><span class="token T_WHITESPACE">      </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">dirname</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">filename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3068"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$absoluteFSPath</span><span class="token T_WHITESPACE">  </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">dirname</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">filename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3069"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$absoluteFTPPath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">dir</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$remotePath</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3070"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$onlyFilename</span><span class="token T_WHITESPACE">    </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">basename</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">filename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3071"><br/></div><div id="line3072"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$remoteName</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$absoluteFTPPath</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$onlyFilename</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3073"><br/></div><div id="line3074"><pre><span class="token T_WHITESPACE">        </span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">sftp_chdir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$absoluteFTPPath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3075"><br/></div><div id="line3076"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_IDENTICAL">===</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3077"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3078"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">createDirRecursive</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$absoluteFSPath</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0755</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3079"><br/></div><div id="line3080"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_IDENTICAL">===</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3081"><pre><span class="token T_WHITESPACE">            </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3082"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">sprintf</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'SFTP_COULDNT_UPLOAD'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">filename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3083"><pre><span class="token T_WHITESPACE">				</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3084"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3085"><br/></div><div id="line3086"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">sftp_chdir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$absoluteFTPPath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3087"><br/></div><div id="line3088"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_IDENTICAL">===</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3089"><pre><span class="token T_WHITESPACE">            </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3090"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">sprintf</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'SFTP_COULDNT_UPLOAD'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">filename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3091"><pre><span class="token T_WHITESPACE">				</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3092"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3093"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3094"><br/></div><div id="line3095"><pre><span class="token T_WHITESPACE">        </span><span class="token T_COMMENT">// Create the file</span></pre></div><div id="line3096"><pre><span class="token T_WHITESPACE">        </span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">write</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempFilename</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$remoteName</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3097"><br/></div><div id="line3098"><pre><span class="token T_WHITESPACE">        </span><span class="token T_COMMENT">// If I got a -1 it means that I wasn't able to open the file, so I have to stop here</span></pre></div><div id="line3099"><pre><span class="token T_WHITESPACE">        </span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_IDENTICAL">===</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3100"><pre><span class="token T_WHITESPACE">        </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3101"><pre><span class="token T_WHITESPACE">            </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">sprintf</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'SFTP_COULDNT_UPLOAD'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">filename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3102"><pre><span class="token T_WHITESPACE">            </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3103"><pre><span class="token T_WHITESPACE">        </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3104"><br/></div><div id="line3105"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_IDENTICAL">===</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3106"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3107"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// If we couldn't create the file, attempt to fix the permissions in the PHP level and retry!</span></pre></div><div id="line3108"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fixPermissions</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">filename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3109"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">unlink</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">filename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3110"><br/></div><div id="line3111"><pre><span class="token T_WHITESPACE">            </span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">write</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempFilename</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$remoteName</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3112"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3113"><br/></div><div id="line3114"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">unlink</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempFilename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3115"><br/></div><div id="line3116"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_IDENTICAL">===</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3117"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3118"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">sprintf</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'SFTP_COULDNT_UPLOAD'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">filename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3119"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3120"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3121"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$restorePerms</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.restoreperms'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3122"><br/></div><div id="line3123"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$restorePerms</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3124"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3125"><pre><span class="token T_WHITESPACE">            </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">chmod</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$remoteName</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">perms</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3126"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3127"><pre><span class="token T_WHITESPACE">		</span><span class="token T_ELSE">else</span></pre></div><div id="line3128"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3129"><pre><span class="token T_WHITESPACE">            </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">chmod</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$remoteName</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0644</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3130"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3131"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3132"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3133"><br/></div><div id="line3134"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">processFilename</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$filename</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$perms</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0755</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3135"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3136"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Catch some error conditions...</span></pre></div><div id="line3137"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">getError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3138"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3139"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3140"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3141"><br/></div><div id="line3142"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// If a null filename is passed, it means that we shouldn't do any post processing, i.e.</span></pre></div><div id="line3143"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// the entity was a directory or symlink</span></pre></div><div id="line3144"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">is_null</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$filename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3145"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3146"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">filename</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3147"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempFilename</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3148"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3149"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3150"><br/></div><div id="line3151"><pre><span class="token T_WHITESPACE">        </span><span class="token T_COMMENT">// Strip absolute filesystem path to website's root</span></pre></div><div id="line3152"><pre><span class="token T_WHITESPACE">        </span><span class="token T_VARIABLE">$removePath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.destdir'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3153"><pre><span class="token T_WHITESPACE">        </span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3154"><pre><span class="token T_WHITESPACE">        </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3155"><pre><span class="token T_WHITESPACE">            </span><span class="token T_VARIABLE">$left</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$filename</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3156"><pre><span class="token T_WHITESPACE">            </span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$left</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3157"><pre><span class="token T_WHITESPACE">            </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3158"><pre><span class="token T_WHITESPACE">                </span><span class="token T_VARIABLE">$filename</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$filename</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3159"><pre><span class="token T_WHITESPACE">            </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3160"><pre><span class="token T_WHITESPACE">        </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3161"><br/></div><div id="line3162"><pre><span class="token T_WHITESPACE">        </span><span class="token T_COMMENT">// Trim slash on the left</span></pre></div><div id="line3163"><pre><span class="token T_WHITESPACE">        </span><span class="token T_VARIABLE">$filename</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">ltrim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$filename</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3164"><br/></div><div id="line3165"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">filename</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$filename</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3166"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempFilename</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">tempnam</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempDir</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart-'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3167"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">perms</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$perms</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3168"><br/></div><div id="line3169"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempFilename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3170"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3171"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Oops! Let's try something different</span></pre></div><div id="line3172"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempFilename</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempDir</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/kickstart-'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_STRING">time</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'.dat'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3173"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3174"><br/></div><div id="line3175"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempFilename</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3176"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3177"><br/></div><div id="line3178"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PRIVATE">private</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">isDirWritable</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$dir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3179"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3180"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">fopen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_DOUBLE_QUOTES">"</span><span class="token T_ENCAPSED_AND_WHITESPACE">ssh2.sftp://</span><span class="token T_CURLY_OPEN">{</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_VARIABLE">$dir</span><span class="token T_ENCAPSED_AND_WHITESPACE">/kickstart.dat</span><span class="token T_PHPDOX_DOUBLE_QUOTES">"</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'wb'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_IDENTICAL">===</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3181"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3182"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3183"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3184"><pre><span class="token T_WHITESPACE">		</span><span class="token T_ELSE">else</span></pre></div><div id="line3185"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3186"><pre><span class="token T_WHITESPACE">            </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ssh2_sftp_unlink</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$dir</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/kickstart.dat'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3187"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3188"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3189"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3190"><br/></div><div id="line3191"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">createDirRecursive</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$dirName</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$perms</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3192"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3193"><pre><span class="token T_WHITESPACE">        </span><span class="token T_COMMENT">// Strip absolute filesystem path to website's root</span></pre></div><div id="line3194"><pre><span class="token T_WHITESPACE">        </span><span class="token T_VARIABLE">$removePath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.destdir'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3195"><pre><span class="token T_WHITESPACE">        </span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3196"><pre><span class="token T_WHITESPACE">        </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3197"><pre><span class="token T_WHITESPACE">            </span><span class="token T_COMMENT">// UNIXize the paths</span></pre></div><div id="line3198"><pre><span class="token T_WHITESPACE">            </span><span class="token T_VARIABLE">$removePath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">str_replace</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'\\'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3199"><pre><span class="token T_WHITESPACE">            </span><span class="token T_VARIABLE">$dirName</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">str_replace</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'\\'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_VARIABLE">$dirName</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3200"><pre><span class="token T_WHITESPACE">            </span><span class="token T_COMMENT">// Make sure they both end in a slash</span></pre></div><div id="line3201"><pre><span class="token T_WHITESPACE">            </span><span class="token T_VARIABLE">$removePath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">rtrim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/\\'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3202"><pre><span class="token T_WHITESPACE">            </span><span class="token T_VARIABLE">$dirName</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">rtrim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$dirName</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/\\'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3203"><pre><span class="token T_WHITESPACE">            </span><span class="token T_COMMENT">// Process the path removal</span></pre></div><div id="line3204"><pre><span class="token T_WHITESPACE">            </span><span class="token T_VARIABLE">$left</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$dirName</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3205"><pre><span class="token T_WHITESPACE">            </span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$left</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3206"><pre><span class="token T_WHITESPACE">            </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3207"><pre><span class="token T_WHITESPACE">                </span><span class="token T_VARIABLE">$dirName</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$dirName</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3208"><pre><span class="token T_WHITESPACE">            </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3209"><pre><span class="token T_WHITESPACE">        </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3210"><pre><span class="token T_WHITESPACE">        </span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$dirName</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$dirName</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_COMMENT">// 'cause the substr() above may return FALSE.</span></pre></div><div id="line3211"><br/></div><div id="line3212"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$check</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">dir</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/ '</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$dirName</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3213"><br/></div><div id="line3214"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">is_dir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$check</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3215"><pre><span class="token T_WHITESPACE">        </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3216"><pre><span class="token T_WHITESPACE">            </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3217"><pre><span class="token T_WHITESPACE">        </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3218"><br/></div><div id="line3219"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$alldirs</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">explode</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$dirName</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3220"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$previousDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">dir</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/ '</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3221"><br/></div><div id="line3222"><pre><span class="token T_WHITESPACE">		</span><span class="token T_FOREACH">foreach</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$alldirs</span><span class="token T_WHITESPACE"> </span><span class="token T_AS">as</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$curdir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3223"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3224"><pre><span class="token T_WHITESPACE">            </span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$curdir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3225"><pre><span class="token T_WHITESPACE">            </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3226"><pre><span class="token T_WHITESPACE">                </span><span class="token T_CONTINUE">continue</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3227"><pre><span class="token T_WHITESPACE">            </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3228"><br/></div><div id="line3229"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$check</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$previousDir</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$curdir</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3230"><br/></div><div id="line3231"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">is_dir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$check</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3232"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3233"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// Proactively try to delete a file by the same name</span></pre></div><div id="line3234"><pre><span class="token T_WHITESPACE">                </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ssh2_sftp_unlink</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$check</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3235"><br/></div><div id="line3236"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ssh2_sftp_mkdir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$check</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_IDENTICAL">===</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3237"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3238"><pre><span class="token T_WHITESPACE">					</span><span class="token T_COMMENT">// If we couldn't create the directory, attempt to fix the permissions in the PHP level and retry!</span></pre></div><div id="line3239"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fixPermissions</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$check</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3240"><br/></div><div id="line3241"><pre><span class="token T_WHITESPACE">					</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ssh2_sftp_mkdir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$check</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_IDENTICAL">===</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3242"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3243"><pre><span class="token T_WHITESPACE">						</span><span class="token T_COMMENT">// Can we fall back to pure PHP mode, sire?</span></pre></div><div id="line3244"><pre><span class="token T_WHITESPACE">						</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">mkdir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$check</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3245"><pre><span class="token T_WHITESPACE">						</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3246"><pre><span class="token T_WHITESPACE">							</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">sprintf</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'FTP_CANT_CREATE_DIR'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$check</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3247"><pre><span class="token T_WHITESPACE">							</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3248"><pre><span class="token T_WHITESPACE">						</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3249"><pre><span class="token T_WHITESPACE">						</span><span class="token T_ELSE">else</span></pre></div><div id="line3250"><pre><span class="token T_WHITESPACE">						</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3251"><pre><span class="token T_WHITESPACE">							</span><span class="token T_COMMENT">// Since the directory was built by PHP, change its permissions</span></pre></div><div id="line3252"><pre><span class="token T_WHITESPACE">							</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">chmod</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$check</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">"0777"</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3253"><pre><span class="token T_WHITESPACE">							</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3254"><pre><span class="token T_WHITESPACE">						</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3255"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3256"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3257"><br/></div><div id="line3258"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ssh2_sftp_chmod</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$check</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$perms</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3259"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3260"><br/></div><div id="line3261"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$previousDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$check</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3262"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3263"><br/></div><div id="line3264"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3265"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3266"><br/></div><div id="line3267"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">close</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3268"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3269"><pre><span class="token T_WHITESPACE">		</span><span class="token T_UNSET">unset</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">_connection</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3270"><pre><span class="token T_WHITESPACE">		</span><span class="token T_UNSET">unset</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3271"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3272"><br/></div><div id="line3273"><pre><span class="token T_WHITESPACE">	</span><span class="token T_COMMENT">/*</span></pre></div><div id="line3274"><pre><span class="token T_COMMENT">	 * Tries to fix directory/file permissions in the PHP level, so that</span></pre></div><div id="line3275"><pre><span class="token T_COMMENT">	 * the FTP operation doesn't fail.</span></pre></div><div id="line3276"><pre><span class="token T_COMMENT">	 * @param $path string The full path to a directory or file</span></pre></div><div id="line3277"><pre><span class="token T_COMMENT">	 */</span></pre></div><div id="line3278"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PRIVATE">private</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">fixPermissions</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$path</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3279"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3280"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Turn off error reporting</span></pre></div><div id="line3281"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">defined</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'KSDEBUG'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3282"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$oldErrorReporting</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">error_reporting</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">E_NONE</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3283"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3284"><br/></div><div id="line3285"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Get UNIX style paths</span></pre></div><div id="line3286"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$relPath</span><span class="token T_WHITESPACE">  </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">str_replace</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'\\'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_VARIABLE">$path</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3287"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$basePath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">rtrim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">str_replace</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'\\'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_STRING">KSROOTDIR</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3288"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$basePath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">rtrim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$basePath</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3289"><br/></div><div id="line3290"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$basePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3291"><pre><span class="token T_WHITESPACE">        </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3292"><pre><span class="token T_WHITESPACE">            </span><span class="token T_VARIABLE">$basePath</span><span class="token T_WHITESPACE"> </span><span class="token T_CONCAT_EQUAL">.=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3293"><pre><span class="token T_WHITESPACE">        </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3294"><br/></div><div id="line3295"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Remove the leading relative root</span></pre></div><div id="line3296"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$relPath</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$basePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$basePath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3297"><pre><span class="token T_WHITESPACE">        </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3298"><pre><span class="token T_WHITESPACE">            </span><span class="token T_VARIABLE">$relPath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$relPath</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$basePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3299"><pre><span class="token T_WHITESPACE">        </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3300"><br/></div><div id="line3301"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$dirArray</span><span class="token T_WHITESPACE">  </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">explode</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$relPath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3302"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$pathBuilt</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">rtrim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$basePath</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3303"><br/></div><div id="line3304"><pre><span class="token T_WHITESPACE">		</span><span class="token T_FOREACH">foreach</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$dirArray</span><span class="token T_WHITESPACE"> </span><span class="token T_AS">as</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$dir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3305"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3306"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$dir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3307"><pre><span class="token T_WHITESPACE">            </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3308"><pre><span class="token T_WHITESPACE">                </span><span class="token T_CONTINUE">continue</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3309"><pre><span class="token T_WHITESPACE">            </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3310"><br/></div><div id="line3311"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$oldPath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$pathBuilt</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3312"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$pathBuilt</span><span class="token T_WHITESPACE"> </span><span class="token T_CONCAT_EQUAL">.=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$dir</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3313"><br/></div><div id="line3314"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">is_dir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$oldPath</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$dir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3315"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3316"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">chmod</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$oldPath</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$dir</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0777</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3317"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3318"><pre><span class="token T_WHITESPACE">			</span><span class="token T_ELSE">else</span></pre></div><div id="line3319"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3320"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">chmod</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$oldPath</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$dir</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0777</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_IDENTICAL">===</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3321"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3322"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">unlink</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$oldPath</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$dir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3323"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3324"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3325"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3326"><br/></div><div id="line3327"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Restore error reporting</span></pre></div><div id="line3328"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">defined</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'KSDEBUG'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3329"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">error_reporting</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$oldErrorReporting</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3330"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3331"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3332"><br/></div><div id="line3333"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">chmod</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$file</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$perms</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3334"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3335"><pre><span class="token T_WHITESPACE">        </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ssh2_sftp_chmod</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$file</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$perms</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3336"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3337"><br/></div><div id="line3338"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PRIVATE">private</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">is_dir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$dir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3339"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3340"><pre><span class="token T_WHITESPACE">        </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">sftp_chdir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$dir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3341"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3342"><br/></div><div id="line3343"><pre><span class="token T_WHITESPACE">    </span><span class="token T_PRIVATE">private</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">write</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$local</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$remote</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3344"><pre><span class="token T_WHITESPACE">    </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3345"><pre><span class="token T_WHITESPACE">        </span><span class="token T_VARIABLE">$fp</span><span class="token T_WHITESPACE">      </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">fopen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_DOUBLE_QUOTES">"</span><span class="token T_ENCAPSED_AND_WHITESPACE">ssh2.sftp://</span><span class="token T_CURLY_OPEN">{</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_VARIABLE">$remote</span><span class="token T_PHPDOX_DOUBLE_QUOTES">"</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'w'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3346"><pre><span class="token T_WHITESPACE">        </span><span class="token T_VARIABLE">$localfp</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">fopen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$local</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'rb'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3347"><br/></div><div id="line3348"><pre><span class="token T_WHITESPACE">        </span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$fp</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_IDENTICAL">===</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3349"><pre><span class="token T_WHITESPACE">        </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3350"><pre><span class="token T_WHITESPACE">            </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3351"><pre><span class="token T_WHITESPACE">        </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3352"><br/></div><div id="line3353"><pre><span class="token T_WHITESPACE">        </span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$localfp</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_IDENTICAL">===</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3354"><pre><span class="token T_WHITESPACE">        </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3355"><pre><span class="token T_WHITESPACE">            </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">fclose</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$fp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3356"><pre><span class="token T_WHITESPACE">            </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3357"><pre><span class="token T_WHITESPACE">        </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3358"><br/></div><div id="line3359"><pre><span class="token T_WHITESPACE">        </span><span class="token T_VARIABLE">$res</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3360"><br/></div><div id="line3361"><pre><span class="token T_WHITESPACE">        </span><span class="token T_WHILE">while</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">feof</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$localfp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$res</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_NOT_IDENTICAL">!==</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3362"><pre><span class="token T_WHITESPACE">        </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3363"><pre><span class="token T_WHITESPACE">            </span><span class="token T_VARIABLE">$buffer</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">fread</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$localfp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">65567</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3364"><pre><span class="token T_WHITESPACE">            </span><span class="token T_VARIABLE">$res</span><span class="token T_WHITESPACE">    </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">fwrite</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$buffer</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3365"><pre><span class="token T_WHITESPACE">        </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3366"><br/></div><div id="line3367"><pre><span class="token T_WHITESPACE">        </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">fclose</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$fp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3368"><pre><span class="token T_WHITESPACE">        </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">fclose</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$localfp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3369"><br/></div><div id="line3370"><pre><span class="token T_WHITESPACE">        </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$res</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3371"><pre><span class="token T_WHITESPACE">    </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3372"><br/></div><div id="line3373"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">unlink</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$file</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3374"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3375"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$check</span><span class="token T_WHITESPACE">    </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">dir</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$file</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3376"><br/></div><div id="line3377"><pre><span class="token T_WHITESPACE">        </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ssh2_sftp_unlink</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$check</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3378"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3379"><br/></div><div id="line3380"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">rmdir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$directory</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3381"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3382"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$check</span><span class="token T_WHITESPACE">    </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">dir</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$directory</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3383"><br/></div><div id="line3384"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ssh2_sftp_rmdir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$check</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3385"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3386"><br/></div><div id="line3387"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">rename</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$from</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$to</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3388"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3389"><pre><span class="token T_WHITESPACE">        </span><span class="token T_VARIABLE">$from</span><span class="token T_WHITESPACE">     </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">dir</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$from</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3390"><pre><span class="token T_WHITESPACE">        </span><span class="token T_VARIABLE">$to</span><span class="token T_WHITESPACE">       </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">dir</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$to</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3391"><br/></div><div id="line3392"><pre><span class="token T_WHITESPACE">        </span><span class="token T_VARIABLE">$result</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE">  </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ssh2_sftp_rename</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$from</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$to</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3393"><br/></div><div id="line3394"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$result</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_NOT_IDENTICAL">!==</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3395"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3396"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">rename</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$from</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$to</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3397"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3398"><pre><span class="token T_WHITESPACE">		</span><span class="token T_ELSE">else</span></pre></div><div id="line3399"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3400"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3401"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3402"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3403"><br/></div><div id="line3404"><pre><span class="token T_WHITESPACE">    </span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line3405"><pre><span class="token T_DOC_COMMENT">     * Changes to the requested directory in the remote server. You give only the</span></pre></div><div id="line3406"><pre><span class="token T_DOC_COMMENT">     * path relative to the initial directory and it does all the rest by itself,</span></pre></div><div id="line3407"><pre><span class="token T_DOC_COMMENT">     * including doing nothing if the remote directory is the one we want.</span></pre></div><div id="line3408"><pre><span class="token T_DOC_COMMENT">     *</span></pre></div><div id="line3409"><pre><span class="token T_DOC_COMMENT">     * @param   string  $dir    The (realtive) remote directory</span></pre></div><div id="line3410"><pre><span class="token T_DOC_COMMENT">     *</span></pre></div><div id="line3411"><pre><span class="token T_DOC_COMMENT">     * @return  bool True if successful, false otherwise.</span></pre></div><div id="line3412"><pre><span class="token T_DOC_COMMENT">     */</span></pre></div><div id="line3413"><pre><span class="token T_WHITESPACE">    </span><span class="token T_PRIVATE">private</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">sftp_chdir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$dir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3414"><pre><span class="token T_WHITESPACE">    </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3415"><pre><span class="token T_WHITESPACE">        </span><span class="token T_COMMENT">// Strip absolute filesystem path to website's root</span></pre></div><div id="line3416"><pre><span class="token T_WHITESPACE">        </span><span class="token T_VARIABLE">$removePath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.destdir'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3417"><pre><span class="token T_WHITESPACE">        </span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3418"><pre><span class="token T_WHITESPACE">        </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3419"><pre><span class="token T_WHITESPACE">            </span><span class="token T_COMMENT">// UNIXize the paths</span></pre></div><div id="line3420"><pre><span class="token T_WHITESPACE">            </span><span class="token T_VARIABLE">$removePath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">str_replace</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'\\'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3421"><pre><span class="token T_WHITESPACE">            </span><span class="token T_VARIABLE">$dir</span><span class="token T_WHITESPACE">        </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">str_replace</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'\\'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_VARIABLE">$dir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3422"><br/></div><div id="line3423"><pre><span class="token T_WHITESPACE">            </span><span class="token T_COMMENT">// Make sure they both end in a slash</span></pre></div><div id="line3424"><pre><span class="token T_WHITESPACE">            </span><span class="token T_VARIABLE">$removePath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">rtrim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/\\'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3425"><pre><span class="token T_WHITESPACE">            </span><span class="token T_VARIABLE">$dir</span><span class="token T_WHITESPACE">        </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">rtrim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$dir</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/\\'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3426"><br/></div><div id="line3427"><pre><span class="token T_WHITESPACE">            </span><span class="token T_COMMENT">// Process the path removal</span></pre></div><div id="line3428"><pre><span class="token T_WHITESPACE">            </span><span class="token T_VARIABLE">$left</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$dir</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3429"><br/></div><div id="line3430"><pre><span class="token T_WHITESPACE">            </span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$left</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3431"><pre><span class="token T_WHITESPACE">            </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3432"><pre><span class="token T_WHITESPACE">                </span><span class="token T_VARIABLE">$dir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$dir</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3433"><pre><span class="token T_WHITESPACE">            </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3434"><pre><span class="token T_WHITESPACE">        </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3435"><br/></div><div id="line3436"><pre><span class="token T_WHITESPACE">        </span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$dir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3437"><pre><span class="token T_WHITESPACE">        </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3438"><pre><span class="token T_WHITESPACE">            </span><span class="token T_COMMENT">// Because the substr() above may return FALSE.</span></pre></div><div id="line3439"><pre><span class="token T_WHITESPACE">            </span><span class="token T_VARIABLE">$dir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3440"><pre><span class="token T_WHITESPACE">        </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3441"><br/></div><div id="line3442"><pre><span class="token T_WHITESPACE">        </span><span class="token T_COMMENT">// Calculate "real" (absolute) SFTP path</span></pre></div><div id="line3443"><pre><span class="token T_WHITESPACE">        </span><span class="token T_VARIABLE">$realdir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">dir</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_QUESTION_MARK">?</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">dir</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">dir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_COLON">:</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">dir</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3444"><pre><span class="token T_WHITESPACE">        </span><span class="token T_VARIABLE">$realdir</span><span class="token T_WHITESPACE"> </span><span class="token T_CONCAT_EQUAL">.=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$dir</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3445"><pre><span class="token T_WHITESPACE">        </span><span class="token T_VARIABLE">$realdir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$realdir</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_QUESTION_MARK">?</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$realdir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_COLON">:</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$realdir</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3446"><br/></div><div id="line3447"><pre><span class="token T_WHITESPACE">        </span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">_currentdir</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$realdir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3448"><pre><span class="token T_WHITESPACE">        </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3449"><pre><span class="token T_WHITESPACE">            </span><span class="token T_COMMENT">// Already there, do nothing</span></pre></div><div id="line3450"><pre><span class="token T_WHITESPACE">            </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3451"><pre><span class="token T_WHITESPACE">        </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3452"><br/></div><div id="line3453"><pre><span class="token T_WHITESPACE">        </span><span class="token T_VARIABLE">$result</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ssh2_sftp_stat</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$realdir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3454"><br/></div><div id="line3455"><pre><span class="token T_WHITESPACE">        </span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$result</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_IDENTICAL">===</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3456"><pre><span class="token T_WHITESPACE">        </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3457"><pre><span class="token T_WHITESPACE">            </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3458"><pre><span class="token T_WHITESPACE">        </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3459"><pre><span class="token T_WHITESPACE">        </span><span class="token T_ELSE">else</span></pre></div><div id="line3460"><pre><span class="token T_WHITESPACE">        </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3461"><pre><span class="token T_WHITESPACE">            </span><span class="token T_COMMENT">// Update the private "current remote directory" variable</span></pre></div><div id="line3462"><pre><span class="token T_WHITESPACE">            </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">_currentdir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$realdir</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3463"><br/></div><div id="line3464"><pre><span class="token T_WHITESPACE">            </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3465"><pre><span class="token T_WHITESPACE">        </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3466"><pre><span class="token T_WHITESPACE">    </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3467"><br/></div><div id="line3468"><pre><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3469"><br/></div><div id="line3470"><br/></div><div id="line3471"><pre><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line3472"><pre><span class="token T_DOC_COMMENT"> * Akeeba Restore</span></pre></div><div id="line3473"><pre><span class="token T_DOC_COMMENT"> * A JSON-powered JPA, JPS and ZIP archive extraction library</span></pre></div><div id="line3474"><pre><span class="token T_DOC_COMMENT"> *</span></pre></div><div id="line3475"><pre><span class="token T_DOC_COMMENT"> * @copyright   2010-2014 Nicholas K. Dionysopoulos / Akeeba Ltd.</span></pre></div><div id="line3476"><pre><span class="token T_DOC_COMMENT"> * @license     GNU GPL v2 or - at your option - any later version</span></pre></div><div id="line3477"><pre><span class="token T_DOC_COMMENT"> * @package     akeebabackup</span></pre></div><div id="line3478"><pre><span class="token T_DOC_COMMENT"> * @subpackage  kickstart</span></pre></div><div id="line3479"><pre><span class="token T_DOC_COMMENT"> */</span></pre></div><div id="line3480"><br/></div><div id="line3481"><pre><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line3482"><pre><span class="token T_DOC_COMMENT"> * Hybrid direct / FTP mode file writer</span></pre></div><div id="line3483"><pre><span class="token T_DOC_COMMENT"> */</span></pre></div><div id="line3484"><pre><span class="token T_CLASS">class</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKPostprocHybrid</span><span class="token T_WHITESPACE"> </span><span class="token T_EXTENDS">extends</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKAbstractPostproc</span></pre></div><div id="line3485"><pre><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3486"><br/></div><div id="line3487"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var bool Should I use the FTP layer? */</span></pre></div><div id="line3488"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$useFTP</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3489"><br/></div><div id="line3490"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var bool Should I use FTP over implicit SSL? */</span></pre></div><div id="line3491"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$useSSL</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3492"><br/></div><div id="line3493"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var bool use Passive mode? */</span></pre></div><div id="line3494"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$passive</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3495"><br/></div><div id="line3496"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var string FTP host name */</span></pre></div><div id="line3497"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$host</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3498"><br/></div><div id="line3499"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var int FTP port */</span></pre></div><div id="line3500"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$port</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">21</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3501"><br/></div><div id="line3502"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var string FTP user name */</span></pre></div><div id="line3503"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$user</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3504"><br/></div><div id="line3505"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var string FTP password */</span></pre></div><div id="line3506"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$pass</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3507"><br/></div><div id="line3508"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var string FTP initial directory */</span></pre></div><div id="line3509"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$dir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3510"><br/></div><div id="line3511"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var resource The FTP handle */</span></pre></div><div id="line3512"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PRIVATE">private</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$handle</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3513"><br/></div><div id="line3514"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var string The temporary directory where the data will be stored */</span></pre></div><div id="line3515"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PRIVATE">private</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$tempDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3516"><br/></div><div id="line3517"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var null The FTP connection handle */</span></pre></div><div id="line3518"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PRIVATE">private</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$_handle</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3519"><br/></div><div id="line3520"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line3521"><pre><span class="token T_DOC_COMMENT">	 * Public constructor. Tries to connect to the FTP server.</span></pre></div><div id="line3522"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line3523"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">__construct</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3524"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3525"><pre><span class="token T_WHITESPACE">		</span><span class="token T_STRING">parent</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">__construct</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3526"><br/></div><div id="line3527"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">useFTP</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3528"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">useSSL</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.ftp.ssl'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3529"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">passive</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.ftp.passive'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3530"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">host</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.ftp.host'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3531"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">port</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.ftp.port'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">21</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3532"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">user</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.ftp.user'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3533"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">pass</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.ftp.pass'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3534"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">dir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.ftp.dir'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3535"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.ftp.tempdir'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3536"><br/></div><div id="line3537"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">port</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3538"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3539"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">port</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">21</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3540"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3541"><br/></div><div id="line3542"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// If FTP is not configured, skip it altogether</span></pre></div><div id="line3543"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">host</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_OR">||</span><span class="token T_WHITESPACE"> </span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">user</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_OR">||</span><span class="token T_WHITESPACE"> </span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">pass</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3544"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3545"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">useFTP</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3546"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3547"><br/></div><div id="line3548"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Try to connect to the FTP server</span></pre></div><div id="line3549"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$connected</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">connect</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3550"><br/></div><div id="line3551"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// If the connection fails, skip FTP altogether</span></pre></div><div id="line3552"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$connected</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3553"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3554"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">useFTP</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3555"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3556"><br/></div><div id="line3557"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$connected</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3558"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3559"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempDir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3560"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3561"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">rtrim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempDir</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/\\'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3562"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$writable</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isDirWritable</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3563"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3564"><pre><span class="token T_WHITESPACE">			</span><span class="token T_ELSE">else</span></pre></div><div id="line3565"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3566"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3567"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$writable</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3568"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3569"><br/></div><div id="line3570"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$writable</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3571"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3572"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// Default temporary directory is the current root</span></pre></div><div id="line3573"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">KSROOTDIR</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3574"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3575"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3576"><pre><span class="token T_WHITESPACE">					</span><span class="token T_COMMENT">// Oh, we have no directory reported!</span></pre></div><div id="line3577"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'.'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3578"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3579"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$absoluteDirToHere</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$tempDir</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3580"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">rtrim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">str_replace</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'\\'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$tempDir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3581"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3582"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3583"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_WHITESPACE"> </span><span class="token T_CONCAT_EQUAL">.=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3584"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3585"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$tempDir</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3586"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// Is this directory writable?</span></pre></div><div id="line3587"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$writable</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isDirWritable</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3588"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3589"><br/></div><div id="line3590"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$writable</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3591"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3592"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// Nope. Let's try creating a temporary directory in the site's root.</span></pre></div><div id="line3593"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$absoluteDirToHere</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/kicktemp'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3594"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">createDirRecursive</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0777</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3595"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// Try making it writable...</span></pre></div><div id="line3596"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fixPermissions</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3597"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$writable</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isDirWritable</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3598"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3599"><br/></div><div id="line3600"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Was the new directory writable?</span></pre></div><div id="line3601"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$writable</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3602"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3603"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// Let's see if the user has specified one</span></pre></div><div id="line3604"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$userdir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.ftp.tempdir'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3605"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$userdir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3606"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3607"><pre><span class="token T_WHITESPACE">					</span><span class="token T_COMMENT">// Is it an absolute or a relative directory?</span></pre></div><div id="line3608"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$absolute</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3609"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$absolute</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$absolute</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_OR">||</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$userdir</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3610"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$absolute</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$absolute</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_OR">||</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$userdir</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">':'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3611"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$absolute</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$absolute</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_OR">||</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$userdir</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">2</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">':'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3612"><pre><span class="token T_WHITESPACE">					</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$absolute</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3613"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3614"><pre><span class="token T_WHITESPACE">						</span><span class="token T_COMMENT">// Make absolute</span></pre></div><div id="line3615"><pre><span class="token T_WHITESPACE">						</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$absoluteDirToHere</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$userdir</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3616"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3617"><pre><span class="token T_WHITESPACE">					</span><span class="token T_ELSE">else</span></pre></div><div id="line3618"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3619"><pre><span class="token T_WHITESPACE">						</span><span class="token T_COMMENT">// it's already absolute</span></pre></div><div id="line3620"><pre><span class="token T_WHITESPACE">						</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$userdir</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3621"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3622"><pre><span class="token T_WHITESPACE">					</span><span class="token T_COMMENT">// Does the directory exist?</span></pre></div><div id="line3623"><pre><span class="token T_WHITESPACE">					</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">is_dir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3624"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3625"><pre><span class="token T_WHITESPACE">						</span><span class="token T_COMMENT">// Yeah. Is it writable?</span></pre></div><div id="line3626"><pre><span class="token T_WHITESPACE">						</span><span class="token T_VARIABLE">$writable</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isDirWritable</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$tempDir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3627"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3628"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3629"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3630"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$tempDir</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3631"><br/></div><div id="line3632"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$writable</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3633"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3634"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// No writable directory found!!!</span></pre></div><div id="line3635"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">_</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'FTP_TEMPDIR_NOT_WRITABLE'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3636"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3637"><pre><span class="token T_WHITESPACE">			</span><span class="token T_ELSE">else</span></pre></div><div id="line3638"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3639"><pre><span class="token T_WHITESPACE">				</span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">set</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.ftp.tempdir'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$tempDir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3640"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$tempDir</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3641"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3642"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3643"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3644"><br/></div><div id="line3645"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line3646"><pre><span class="token T_DOC_COMMENT">	 * Called after unserialisation, tries to reconnect to FTP</span></pre></div><div id="line3647"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line3648"><pre><span class="token T_WHITESPACE">	</span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">__wakeup</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3649"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3650"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">useFTP</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3651"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3652"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">connect</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3653"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3654"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3655"><br/></div><div id="line3656"><pre><span class="token T_WHITESPACE">	</span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">__destruct</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3657"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3658"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">useFTP</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3659"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3660"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftp_close</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3661"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3662"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3663"><br/></div><div id="line3664"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line3665"><pre><span class="token T_DOC_COMMENT">	 * Tries to connect to the FTP server</span></pre></div><div id="line3666"><pre><span class="token T_DOC_COMMENT">	 *</span></pre></div><div id="line3667"><pre><span class="token T_DOC_COMMENT">	 * @return bool</span></pre></div><div id="line3668"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line3669"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">connect</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3670"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3671"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">useFTP</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3672"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3673"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3674"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3675"><br/></div><div id="line3676"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Connect to server, using SSL if so required</span></pre></div><div id="line3677"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">useSSL</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3678"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3679"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftp_ssl_connect</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">host</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">port</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3680"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3681"><pre><span class="token T_WHITESPACE">		</span><span class="token T_ELSE">else</span></pre></div><div id="line3682"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3683"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftp_connect</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">host</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">port</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3684"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3685"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_IDENTICAL">===</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3686"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3687"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">_</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'WRONG_FTP_HOST'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3688"><br/></div><div id="line3689"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3690"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3691"><br/></div><div id="line3692"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Login</span></pre></div><div id="line3693"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftp_login</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">user</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">pass</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3694"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3695"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">_</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'WRONG_FTP_USER'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3696"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftp_close</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3697"><br/></div><div id="line3698"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3699"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3700"><br/></div><div id="line3701"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Change to initial directory</span></pre></div><div id="line3702"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftp_chdir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">dir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3703"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3704"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">_</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'WRONG_FTP_PATH1'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3705"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftp_close</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3706"><br/></div><div id="line3707"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3708"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3709"><br/></div><div id="line3710"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Enable passive mode if the user requested it</span></pre></div><div id="line3711"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">passive</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3712"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3713"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftp_pasv</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3714"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3715"><pre><span class="token T_WHITESPACE">		</span><span class="token T_ELSE">else</span></pre></div><div id="line3716"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3717"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftp_pasv</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3718"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3719"><br/></div><div id="line3720"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Try to download ourselves</span></pre></div><div id="line3721"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$testFilename</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">defined</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'KSSELFNAME'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_QUESTION_MARK">?</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">KSSELFNAME</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_COLON">:</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">basename</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_FILE">__FILE__</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3722"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$tempHandle</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">fopen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'php://temp'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'r+'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3723"><br/></div><div id="line3724"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftp_fget</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$tempHandle</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$testFilename</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">FTP_ASCII</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_IDENTICAL">===</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3725"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3726"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">_</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'WRONG_FTP_PATH2'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3727"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftp_close</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3728"><pre><span class="token T_WHITESPACE">			</span><span class="token T_STRING">fclose</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$tempHandle</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3729"><br/></div><div id="line3730"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3731"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3732"><br/></div><div id="line3733"><pre><span class="token T_WHITESPACE">		</span><span class="token T_STRING">fclose</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$tempHandle</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3734"><br/></div><div id="line3735"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3736"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3737"><br/></div><div id="line3738"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line3739"><pre><span class="token T_DOC_COMMENT">	 * Post-process an extracted file, using FTP or direct file writes to move it</span></pre></div><div id="line3740"><pre><span class="token T_DOC_COMMENT">	 *</span></pre></div><div id="line3741"><pre><span class="token T_DOC_COMMENT">	 * @return bool</span></pre></div><div id="line3742"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line3743"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">process</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3744"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3745"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">is_null</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempFilename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3746"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3747"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// If an empty filename is passed, it means that we shouldn't do any post processing, i.e.</span></pre></div><div id="line3748"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// the entity was a directory or symlink</span></pre></div><div id="line3749"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3750"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3751"><br/></div><div id="line3752"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$remotePath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">dirname</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">filename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3753"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$removePath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.destdir'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3754"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$root</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">rtrim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/\\'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3755"><br/></div><div id="line3756"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3757"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3758"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$removePath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">ltrim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">"/"</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3759"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$remotePath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">ltrim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$remotePath</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">"/"</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3760"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$left</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$remotePath</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3761"><br/></div><div id="line3762"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$left</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3763"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3764"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$remotePath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$remotePath</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3765"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3766"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3767"><br/></div><div id="line3768"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$absoluteFSPath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">dirname</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">filename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3769"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$relativeFTPPath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$remotePath</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3770"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$absoluteFTPPath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">dir</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$remotePath</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3771"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$onlyFilename</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">basename</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">filename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3772"><br/></div><div id="line3773"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$remoteName</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$absoluteFTPPath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$onlyFilename</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3774"><br/></div><div id="line3775"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Does the directory exist?</span></pre></div><div id="line3776"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">is_dir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$root</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$absoluteFSPath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3777"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3778"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">createDirRecursive</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$absoluteFSPath</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0755</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3779"><br/></div><div id="line3780"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_IDENTICAL">===</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">useFTP</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3781"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3782"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftp_chdir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$absoluteFTPPath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3783"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3784"><br/></div><div id="line3785"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_IDENTICAL">===</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3786"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3787"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">sprintf</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'FTP_COULDNT_UPLOAD'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">filename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3788"><br/></div><div id="line3789"><pre><span class="token T_WHITESPACE">				</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3790"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3791"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3792"><br/></div><div id="line3793"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">useFTP</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3794"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3795"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftp_chdir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$absoluteFTPPath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3796"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3797"><br/></div><div id="line3798"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Try copying directly</span></pre></div><div id="line3799"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">copy</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempFilename</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$root</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">filename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3800"><br/></div><div id="line3801"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_IDENTICAL">===</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3802"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3803"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fixPermissions</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">filename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3804"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">unlink</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">filename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3805"><br/></div><div id="line3806"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">copy</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempFilename</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$root</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">filename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3807"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3808"><br/></div><div id="line3809"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">useFTP</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_IDENTICAL">===</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3810"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3811"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftp_put</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$remoteName</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempFilename</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">FTP_BINARY</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3812"><br/></div><div id="line3813"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_IDENTICAL">===</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3814"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3815"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// If we couldn't create the file, attempt to fix the permissions in the PHP level and retry!</span></pre></div><div id="line3816"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fixPermissions</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">filename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3817"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">unlink</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">filename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3818"><br/></div><div id="line3819"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$fp</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">fopen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempFilename</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'rb'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3820"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$fp</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_NOT_IDENTICAL">!==</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3821"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3822"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftp_fput</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$remoteName</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">FTP_BINARY</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3823"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">fclose</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$fp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3824"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3825"><pre><span class="token T_WHITESPACE">				</span><span class="token T_ELSE">else</span></pre></div><div id="line3826"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3827"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3828"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3829"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3830"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3831"><br/></div><div id="line3832"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">unlink</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempFilename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3833"><br/></div><div id="line3834"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_IDENTICAL">===</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3835"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3836"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">sprintf</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'FTP_COULDNT_UPLOAD'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">filename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3837"><br/></div><div id="line3838"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3839"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3840"><br/></div><div id="line3841"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$restorePerms</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.restoreperms'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3842"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$perms</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$restorePerms</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_QUESTION_MARK">?</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">perms</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_COLON">:</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0644</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3843"><br/></div><div id="line3844"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">chmod</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$root</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">filename</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$perms</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3845"><br/></div><div id="line3846"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">useFTP</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_IDENTICAL">===</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3847"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3848"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftp_chmod</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">_handle</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$perms</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$remoteName</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3849"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3850"><br/></div><div id="line3851"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3852"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3853"><br/></div><div id="line3854"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line3855"><pre><span class="token T_DOC_COMMENT">	 * Create a temporary filename</span></pre></div><div id="line3856"><pre><span class="token T_DOC_COMMENT">	 *</span></pre></div><div id="line3857"><pre><span class="token T_DOC_COMMENT">	 * @param string $filename The original filename</span></pre></div><div id="line3858"><pre><span class="token T_DOC_COMMENT">	 * @param int    $perms    The file permissions</span></pre></div><div id="line3859"><pre><span class="token T_DOC_COMMENT">	 *</span></pre></div><div id="line3860"><pre><span class="token T_DOC_COMMENT">	 * @return string</span></pre></div><div id="line3861"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line3862"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">processFilename</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$filename</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$perms</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0755</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3863"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3864"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Catch some error conditions...</span></pre></div><div id="line3865"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">getError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3866"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3867"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3868"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3869"><br/></div><div id="line3870"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// If a null filename is passed, it means that we shouldn't do any post processing, i.e.</span></pre></div><div id="line3871"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// the entity was a directory or symlink</span></pre></div><div id="line3872"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">is_null</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$filename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3873"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3874"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">filename</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3875"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempFilename</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3876"><br/></div><div id="line3877"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3878"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3879"><br/></div><div id="line3880"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Strip absolute filesystem path to website's root</span></pre></div><div id="line3881"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$removePath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.destdir'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3882"><br/></div><div id="line3883"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3884"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3885"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$left</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$filename</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3886"><br/></div><div id="line3887"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$left</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3888"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3889"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$filename</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$filename</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3890"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3891"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3892"><br/></div><div id="line3893"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Trim slash on the left</span></pre></div><div id="line3894"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$filename</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">ltrim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$filename</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3895"><br/></div><div id="line3896"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">filename</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$filename</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3897"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempFilename</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">tempnam</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempDir</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart-'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3898"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">perms</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$perms</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3899"><br/></div><div id="line3900"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempFilename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3901"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3902"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Oops! Let's try something different</span></pre></div><div id="line3903"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempFilename</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/kickstart-'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">time</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'.dat'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3904"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3905"><br/></div><div id="line3906"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tempFilename</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3907"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3908"><br/></div><div id="line3909"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line3910"><pre><span class="token T_DOC_COMMENT">	 * Is the directory writeable?</span></pre></div><div id="line3911"><pre><span class="token T_DOC_COMMENT">	 *</span></pre></div><div id="line3912"><pre><span class="token T_DOC_COMMENT">	 * @param string $dir The directory ti check</span></pre></div><div id="line3913"><pre><span class="token T_DOC_COMMENT">	 *</span></pre></div><div id="line3914"><pre><span class="token T_DOC_COMMENT">	 * @return bool</span></pre></div><div id="line3915"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line3916"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PRIVATE">private</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">isDirWritable</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$dir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3917"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3918"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$fp</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">fopen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$dir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/kickstart.dat'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'wb'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3919"><br/></div><div id="line3920"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$fp</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_IDENTICAL">===</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3921"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3922"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3923"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3924"><br/></div><div id="line3925"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">fclose</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$fp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3926"><pre><span class="token T_WHITESPACE">		</span><span class="token T_STRING">unlink</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$dir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/kickstart.dat'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3927"><br/></div><div id="line3928"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3929"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3930"><br/></div><div id="line3931"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line3932"><pre><span class="token T_DOC_COMMENT">	 * Create a directory, recursively</span></pre></div><div id="line3933"><pre><span class="token T_DOC_COMMENT">	 *</span></pre></div><div id="line3934"><pre><span class="token T_DOC_COMMENT">	 * @param string $dirName The directory to create</span></pre></div><div id="line3935"><pre><span class="token T_DOC_COMMENT">	 * @param int    $perms   The permissions to give to the directory</span></pre></div><div id="line3936"><pre><span class="token T_DOC_COMMENT">	 *</span></pre></div><div id="line3937"><pre><span class="token T_DOC_COMMENT">	 * @return bool</span></pre></div><div id="line3938"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line3939"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">createDirRecursive</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$dirName</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$perms</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3940"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3941"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Strip absolute filesystem path to website's root</span></pre></div><div id="line3942"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$removePath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.destdir'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3943"><br/></div><div id="line3944"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3945"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3946"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// UNIXize the paths</span></pre></div><div id="line3947"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$removePath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">str_replace</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'\\'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3948"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$dirName</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">str_replace</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'\\'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$dirName</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3949"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Make sure they both end in a slash</span></pre></div><div id="line3950"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$removePath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">rtrim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/\\'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3951"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$dirName</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">rtrim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$dirName</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/\\'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3952"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Process the path removal</span></pre></div><div id="line3953"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$left</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$dirName</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3954"><br/></div><div id="line3955"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$left</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3956"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3957"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$dirName</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$dirName</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3958"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3959"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3960"><br/></div><div id="line3961"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// 'cause the substr() above may return FALSE.</span></pre></div><div id="line3962"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$dirName</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3963"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3964"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$dirName</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3965"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3966"><br/></div><div id="line3967"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$check</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">dir</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$dirName</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3968"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$checkFS</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$removePath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$dirName</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3969"><br/></div><div id="line3970"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">is_dir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$check</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3971"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3972"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3973"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3974"><br/></div><div id="line3975"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$alldirs</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">explode</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$dirName</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3976"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$previousDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">dir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3977"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$previousDirFS</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">rtrim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/\\'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3978"><br/></div><div id="line3979"><pre><span class="token T_WHITESPACE">		</span><span class="token T_FOREACH">foreach</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$alldirs</span><span class="token T_WHITESPACE"> </span><span class="token T_AS">as</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$curdir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3980"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3981"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$check</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$previousDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$curdir</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3982"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$checkFS</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$previousDirFS</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$curdir</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3983"><br/></div><div id="line3984"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">is_dir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$checkFS</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">is_dir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$check</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3985"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3986"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// Proactively try to delete a file by the same name</span></pre></div><div id="line3987"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">unlink</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$checkFS</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">useFTP</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3988"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3989"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftp_delete</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$check</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3990"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3991"><br/></div><div id="line3992"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$createdDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">mkdir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$checkFS</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0755</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3993"><br/></div><div id="line3994"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$createdDir</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">useFTP</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line3995"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line3996"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$createdDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftp_mkdir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$check</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line3997"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line3998"><br/></div><div id="line3999"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$createdDir</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_IDENTICAL">===</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4000"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4001"><pre><span class="token T_WHITESPACE">					</span><span class="token T_COMMENT">// If we couldn't create the directory, attempt to fix the permissions in the PHP level and retry!</span></pre></div><div id="line4002"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fixPermissions</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$checkFS</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4003"><br/></div><div id="line4004"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$createdDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">mkdir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$checkFS</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0755</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4005"><pre><span class="token T_WHITESPACE">					</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$createdDir</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">useFTP</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4006"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4007"><pre><span class="token T_WHITESPACE">						</span><span class="token T_VARIABLE">$createdDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftp_mkdir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$check</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4008"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4009"><br/></div><div id="line4010"><pre><span class="token T_WHITESPACE">					</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$createdDir</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_IDENTICAL">===</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4011"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4012"><pre><span class="token T_WHITESPACE">						</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">sprintf</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'FTP_CANT_CREATE_DIR'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$check</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4013"><br/></div><div id="line4014"><pre><span class="token T_WHITESPACE">						</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4015"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4016"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4017"><br/></div><div id="line4018"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">chmod</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$checkFS</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$perms</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">useFTP</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4019"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4020"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftp_chmod</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$perms</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$check</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4021"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4022"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4023"><br/></div><div id="line4024"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$previousDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$check</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4025"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$previousDirFS</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$checkFS</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4026"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4027"><br/></div><div id="line4028"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4029"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4030"><br/></div><div id="line4031"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line4032"><pre><span class="token T_DOC_COMMENT">	 * Closes the FTP connection</span></pre></div><div id="line4033"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line4034"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">close</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4035"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4036"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">useFTP</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4037"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4038"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftp_close</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4039"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4040"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4041"><br/></div><div id="line4042"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line4043"><pre><span class="token T_DOC_COMMENT">	 * Tries to fix directory/file permissions in the PHP level, so that</span></pre></div><div id="line4044"><pre><span class="token T_DOC_COMMENT">	 * the FTP operation doesn't fail.</span></pre></div><div id="line4045"><pre><span class="token T_DOC_COMMENT">	 *</span></pre></div><div id="line4046"><pre><span class="token T_DOC_COMMENT">	 * @param $path string The full path to a directory or file</span></pre></div><div id="line4047"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line4048"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PRIVATE">private</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">fixPermissions</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$path</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4049"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4050"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Turn off error reporting</span></pre></div><div id="line4051"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">defined</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'KSDEBUG'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4052"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4053"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$oldErrorReporting</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">error_reporting</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">E_NONE</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4054"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4055"><br/></div><div id="line4056"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Get UNIX style paths</span></pre></div><div id="line4057"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$relPath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">str_replace</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'\\'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$path</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4058"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$basePath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">rtrim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">str_replace</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'\\'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">KSROOTDIR</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4059"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$basePath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">rtrim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$basePath</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4060"><br/></div><div id="line4061"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$basePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4062"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4063"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$basePath</span><span class="token T_WHITESPACE"> </span><span class="token T_CONCAT_EQUAL">.=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4064"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4065"><br/></div><div id="line4066"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Remove the leading relative root</span></pre></div><div id="line4067"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$relPath</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$basePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$basePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4068"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4069"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$relPath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$relPath</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$basePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4070"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4071"><br/></div><div id="line4072"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$dirArray</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">explode</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$relPath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4073"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$pathBuilt</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">rtrim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$basePath</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4074"><br/></div><div id="line4075"><pre><span class="token T_WHITESPACE">		</span><span class="token T_FOREACH">foreach</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$dirArray</span><span class="token T_WHITESPACE"> </span><span class="token T_AS">as</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$dir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4076"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4077"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$dir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4078"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4079"><pre><span class="token T_WHITESPACE">				</span><span class="token T_CONTINUE">continue</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4080"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4081"><br/></div><div id="line4082"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$oldPath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$pathBuilt</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4083"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$pathBuilt</span><span class="token T_WHITESPACE"> </span><span class="token T_CONCAT_EQUAL">.=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$dir</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4084"><br/></div><div id="line4085"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">is_dir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$oldPath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$dir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4086"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4087"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">chmod</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$oldPath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$dir</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0777</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4088"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4089"><pre><span class="token T_WHITESPACE">			</span><span class="token T_ELSE">else</span></pre></div><div id="line4090"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4091"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">chmod</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$oldPath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$dir</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0777</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_IDENTICAL">===</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4092"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4093"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">unlink</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$oldPath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$dir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4094"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4095"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4096"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4097"><br/></div><div id="line4098"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Restore error reporting</span></pre></div><div id="line4099"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">defined</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'KSDEBUG'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4100"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4101"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">error_reporting</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$oldErrorReporting</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4102"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4103"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4104"><br/></div><div id="line4105"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">chmod</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$file</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$perms</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4106"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4107"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.dryrun'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'0'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4108"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4109"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4110"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4111"><br/></div><div id="line4112"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">chmod</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$file</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$perms</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4113"><br/></div><div id="line4114"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">useFTP</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4115"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4116"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Strip absolute filesystem path to website's root</span></pre></div><div id="line4117"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$removePath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.destdir'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4118"><br/></div><div id="line4119"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4120"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4121"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$left</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$file</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4122"><br/></div><div id="line4123"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$left</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4124"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4125"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$file</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$file</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4126"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4127"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4128"><br/></div><div id="line4129"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Trim slash on the left</span></pre></div><div id="line4130"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$file</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">ltrim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$file</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4131"><br/></div><div id="line4132"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftp_chmod</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$perms</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$file</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4133"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4134"><br/></div><div id="line4135"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$ret</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4136"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4137"><br/></div><div id="line4138"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PRIVATE">private</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">is_dir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$dir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4139"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4140"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">useFTP</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4141"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4142"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftp_chdir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$dir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4143"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4144"><br/></div><div id="line4145"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4146"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4147"><br/></div><div id="line4148"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">unlink</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$file</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4149"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4150"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">unlink</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$file</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4151"><br/></div><div id="line4152"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">useFTP</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4153"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4154"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$removePath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.destdir'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4155"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4156"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4157"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$left</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$file</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4158"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$left</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4159"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4160"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$file</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$file</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4161"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4162"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4163"><br/></div><div id="line4164"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$check</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">dir</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$file</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4165"><br/></div><div id="line4166"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftp_delete</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$check</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4167"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4168"><br/></div><div id="line4169"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$ret</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4170"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4171"><br/></div><div id="line4172"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">rmdir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$directory</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4173"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4174"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">rmdir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$directory</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4175"><br/></div><div id="line4176"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">useFTP</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4177"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4178"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$removePath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.destdir'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4179"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4180"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4181"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$left</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$directory</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4182"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$left</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4183"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4184"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$directory</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$directory</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4185"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4186"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4187"><br/></div><div id="line4188"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$check</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">dir</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$directory</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4189"><br/></div><div id="line4190"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftp_rmdir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$check</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4191"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4192"><br/></div><div id="line4193"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$ret</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4194"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4195"><br/></div><div id="line4196"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">rename</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$from</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$to</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4197"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4198"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">rename</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$from</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$to</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4199"><br/></div><div id="line4200"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">useFTP</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4201"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4202"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$originalFrom</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$from</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4203"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$originalTo</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$to</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4204"><br/></div><div id="line4205"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$removePath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.destdir'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4206"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4207"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4208"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$left</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$from</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4209"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$left</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4210"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4211"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$from</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$from</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4212"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4213"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4214"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$from</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">dir</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$from</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4215"><br/></div><div id="line4216"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4217"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4218"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$left</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$to</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4219"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$left</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4220"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4221"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$to</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$to</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$removePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4222"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4223"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4224"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$to</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">dir</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$to</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4225"><br/></div><div id="line4226"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftp_rename</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">handle</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$from</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$to</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4227"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4228"><br/></div><div id="line4229"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$ret</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4230"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4231"><pre><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4232"><br/></div><div id="line4233"><pre><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line4234"><pre><span class="token T_DOC_COMMENT"> * Akeeba Restore</span></pre></div><div id="line4235"><pre><span class="token T_DOC_COMMENT"> * A JSON-powered JPA, JPS and ZIP archive extraction library</span></pre></div><div id="line4236"><pre><span class="token T_DOC_COMMENT"> *</span></pre></div><div id="line4237"><pre><span class="token T_DOC_COMMENT"> * @copyright   2010-2014 Nicholas K. Dionysopoulos / Akeeba Ltd.</span></pre></div><div id="line4238"><pre><span class="token T_DOC_COMMENT"> * @license     GNU GPL v2 or - at your option - any later version</span></pre></div><div id="line4239"><pre><span class="token T_DOC_COMMENT"> * @package     akeebabackup</span></pre></div><div id="line4240"><pre><span class="token T_DOC_COMMENT"> * @subpackage  kickstart</span></pre></div><div id="line4241"><pre><span class="token T_DOC_COMMENT"> */</span></pre></div><div id="line4242"><br/></div><div id="line4243"><pre><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line4244"><pre><span class="token T_DOC_COMMENT"> * JPA archive extraction class</span></pre></div><div id="line4245"><pre><span class="token T_DOC_COMMENT"> */</span></pre></div><div id="line4246"><pre><span class="token T_CLASS">class</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKUnarchiverJPA</span><span class="token T_WHITESPACE"> </span><span class="token T_EXTENDS">extends</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKAbstractUnarchiver</span></pre></div><div id="line4247"><pre><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4248"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$archiveHeaderData</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4249"><br/></div><div id="line4250"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">readArchiveHeader</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4251"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4252"><pre><span class="token T_WHITESPACE">		</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Preparing to read archive header'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4253"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Initialize header data array</span></pre></div><div id="line4254"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">archiveHeaderData</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_NEW">new</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">stdClass</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4255"><br/></div><div id="line4256"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Open the first part</span></pre></div><div id="line4257"><pre><span class="token T_WHITESPACE">		</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Opening the first part'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4258"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">nextFile</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4259"><br/></div><div id="line4260"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Fail for unreadable files</span></pre></div><div id="line4261"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_IDENTICAL">===</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4262"><pre><span class="token T_WHITESPACE">			</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Could not open the first part'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4263"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4264"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4265"><br/></div><div id="line4266"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Read the signature</span></pre></div><div id="line4267"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$sig</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">fread</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">3</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4268"><br/></div><div id="line4269"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$sig</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_NOT_EQUAL">!=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'JPA'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4270"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4271"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Not a JPA file</span></pre></div><div id="line4272"><pre><span class="token T_WHITESPACE">			</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Invalid archive signature'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4273"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">_</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'ERR_NOT_A_JPA_FILE'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4274"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4275"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4276"><br/></div><div id="line4277"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Read and parse header length</span></pre></div><div id="line4278"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$header_length_array</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">unpack</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'v'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">fread</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">2</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4279"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$header_length</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$header_length_array</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4280"><br/></div><div id="line4281"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Read and parse the known portion of header data (14 bytes)</span></pre></div><div id="line4282"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$bin_data</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">fread</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">14</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4283"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$header_data</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">unpack</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Cmajor/Cminor/Vcount/Vuncsize/Vcsize'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$bin_data</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4284"><br/></div><div id="line4285"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Load any remaining header data (forward compatibility)</span></pre></div><div id="line4286"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$rest_length</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$header_length</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">19</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4287"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$rest_length</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_GT">&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4288"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$junk</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">fread</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$rest_length</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4289"><pre><span class="token T_WHITESPACE">		</span><span class="token T_ELSE">else</span></pre></div><div id="line4290"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$junk</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4291"><br/></div><div id="line4292"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Temporary array with all the data we read</span></pre></div><div id="line4293"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$temp</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span></pre></div><div id="line4294"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CONSTANT_ENCAPSED_STRING">'signature'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> 			</span><span class="token T_VARIABLE">$sig</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line4295"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CONSTANT_ENCAPSED_STRING">'length'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> 			</span><span class="token T_VARIABLE">$header_length</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line4296"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CONSTANT_ENCAPSED_STRING">'major'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> 				</span><span class="token T_VARIABLE">$header_data</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'major'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line4297"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CONSTANT_ENCAPSED_STRING">'minor'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> 				</span><span class="token T_VARIABLE">$header_data</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'minor'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line4298"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CONSTANT_ENCAPSED_STRING">'filecount'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> 			</span><span class="token T_VARIABLE">$header_data</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'count'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line4299"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CONSTANT_ENCAPSED_STRING">'uncompressedsize'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> 	</span><span class="token T_VARIABLE">$header_data</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'uncsize'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line4300"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CONSTANT_ENCAPSED_STRING">'compressedsize'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> 	</span><span class="token T_VARIABLE">$header_data</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'csize'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line4301"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CONSTANT_ENCAPSED_STRING">'unknowndata'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> 		</span><span class="token T_VARIABLE">$junk</span></pre></div><div id="line4302"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4303"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Array-to-object conversion</span></pre></div><div id="line4304"><pre><span class="token T_WHITESPACE">		</span><span class="token T_FOREACH">foreach</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$temp</span><span class="token T_WHITESPACE"> </span><span class="token T_AS">as</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$key</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4305"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4306"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">archiveHeaderData</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_VARIABLE">$key</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4307"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4308"><br/></div><div id="line4309"><pre><span class="token T_WHITESPACE">		</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Header data:'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4310"><pre><span class="token T_WHITESPACE">		</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Length              : '</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$header_length</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4311"><pre><span class="token T_WHITESPACE">		</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Major               : '</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$header_data</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'major'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4312"><pre><span class="token T_WHITESPACE">		</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Minor               : '</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$header_data</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'minor'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4313"><pre><span class="token T_WHITESPACE">		</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'File count          : '</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$header_data</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'count'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4314"><pre><span class="token T_WHITESPACE">		</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Uncompressed size   : '</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$header_data</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'uncsize'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4315"><pre><span class="token T_WHITESPACE">		</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Compressed size	  : '</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$header_data</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'csize'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4316"><br/></div><div id="line4317"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">currentPartOffset</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftell</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4318"><br/></div><div id="line4319"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">dataReadLength</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4320"><br/></div><div id="line4321"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4322"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4323"><br/></div><div id="line4324"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line4325"><pre><span class="token T_DOC_COMMENT">	 * Concrete classes must use this method to read the file header</span></pre></div><div id="line4326"><pre><span class="token T_DOC_COMMENT">	 * @return bool True if reading the file was successful, false if an error occured or we reached end of archive</span></pre></div><div id="line4327"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line4328"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">readFileHeader</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4329"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4330"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// If the current part is over, proceed to the next part please</span></pre></div><div id="line4331"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isEOF</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">true</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4332"><pre><span class="token T_WHITESPACE">			</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Archive part EOF; moving to next file'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4333"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">nextFile</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4334"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4335"><br/></div><div id="line4336"><pre><span class="token T_WHITESPACE">		</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Reading file signature'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4337"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Get and decode Entity Description Block</span></pre></div><div id="line4338"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$signature</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">fread</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">3</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4339"><br/></div><div id="line4340"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_NEW">new</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">stdClass</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4341"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">timestamp</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4342"><br/></div><div id="line4343"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Check signature</span></pre></div><div id="line4344"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$signature</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_NOT_EQUAL">!=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'JPF'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4345"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4346"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isEOF</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">true</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4347"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4348"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// This file is finished; make sure it's the last one</span></pre></div><div id="line4349"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">nextFile</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4350"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isEOF</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4351"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4352"><pre><span class="token T_WHITESPACE">					</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Invalid file signature before end of archive encountered'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4353"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">sprintf</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'INVALID_FILE_HEADER'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">currentPartNumber</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">currentPartOffset</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4354"><pre><span class="token T_WHITESPACE">					</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4355"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4356"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// We're just finished</span></pre></div><div id="line4357"><pre><span class="token T_WHITESPACE">				</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4358"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4359"><pre><span class="token T_WHITESPACE">			</span><span class="token T_ELSE">else</span></pre></div><div id="line4360"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4361"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$screwed</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4362"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.ignoreerrors'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4363"><pre><span class="token T_WHITESPACE">					</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Invalid file block signature; launching heuristic file block signature scanner'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4364"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$screwed</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">heuristicFileHeaderLocator</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4365"><pre><span class="token T_WHITESPACE">					</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$screwed</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4366"><pre><span class="token T_WHITESPACE">						</span><span class="token T_VARIABLE">$signature</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'JPF'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4367"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_ELSE">else</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4368"><pre><span class="token T_WHITESPACE">						</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Heuristics failed. Brace yourself for the imminent crash.'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4369"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4370"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4371"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$screwed</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4372"><pre><span class="token T_WHITESPACE">					</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Invalid file block signature'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4373"><pre><span class="token T_WHITESPACE">					</span><span class="token T_COMMENT">// This is not a file block! The archive is corrupt.</span></pre></div><div id="line4374"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">sprintf</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'INVALID_FILE_HEADER'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">currentPartNumber</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">currentPartOffset</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4375"><pre><span class="token T_WHITESPACE">					</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4376"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4377"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4378"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4379"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// This a JPA Entity Block. Process the header.</span></pre></div><div id="line4380"><br/></div><div id="line4381"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$isBannedFile</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4382"><br/></div><div id="line4383"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Read length of EDB and of the Entity Path Data</span></pre></div><div id="line4384"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$length_array</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">unpack</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'vblocksize/vpathsize'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">fread</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4385"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Read the path data</span></pre></div><div id="line4386"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$length_array</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'pathsize'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_GT">&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4387"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$file</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">fread</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$length_array</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'pathsize'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4388"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_ELSE">else</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4389"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$file</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4390"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4391"><br/></div><div id="line4392"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Handle file renaming</span></pre></div><div id="line4393"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$isRenamed</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4394"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">is_array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">renameFiles</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">count</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">renameFiles</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_GT">&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4395"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4396"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">array_key_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$file</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">renameFiles</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4397"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4398"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$file</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">renameFiles</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$file</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4399"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$isRenamed</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4400"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4401"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4402"><br/></div><div id="line4403"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Handle directory renaming</span></pre></div><div id="line4404"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$isDirRenamed</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4405"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">is_array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">renameDirs</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">count</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">renameDirs</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_GT">&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4406"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">array_key_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">dirname</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$file</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">renameDirs</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4407"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$file</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">rtrim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">renameDirs</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_STRING">dirname</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$file</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_STRING">basename</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$file</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4408"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$isRenamed</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4409"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$isDirRenamed</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4410"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4411"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4412"><br/></div><div id="line4413"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Read and parse the known data portion</span></pre></div><div id="line4414"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$bin_data</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">fread</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">14</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4415"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$header_data</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">unpack</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Ctype/Ccompression/Vcompsize/Vuncompsize/Vperms'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$bin_data</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4416"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Read any unknown data</span></pre></div><div id="line4417"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$restBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$length_array</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'blocksize'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_LNUMBER">21</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_PLUS">+</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$length_array</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'pathsize'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4418"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$restBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_GT">&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4419"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4420"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Start reading the extra fields</span></pre></div><div id="line4421"><pre><span class="token T_WHITESPACE">			</span><span class="token T_WHILE">while</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$restBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_GREATER_OR_EQUAL">&gt;=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4422"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4423"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$extra_header_data</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">fread</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4424"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$extra_header</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">unpack</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'vsignature/vlength'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$extra_header_data</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4425"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$restBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_MINUS_EQUAL">-=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4426"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$extra_header</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'length'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_MINUS_EQUAL">-=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4427"><pre><span class="token T_WHITESPACE">				</span><span class="token T_SWITCH">switch</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$extra_header</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'signature'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4428"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4429"><pre><span class="token T_WHITESPACE">					</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">256</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line4430"><pre><span class="token T_WHITESPACE">						</span><span class="token T_COMMENT">// File modified timestamp</span></pre></div><div id="line4431"><pre><span class="token T_WHITESPACE">						</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$extra_header</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'length'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_GT">&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4432"><pre><span class="token T_WHITESPACE">						</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4433"><pre><span class="token T_WHITESPACE">							</span><span class="token T_VARIABLE">$bindata</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">fread</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$extra_header</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'length'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4434"><pre><span class="token T_WHITESPACE">							</span><span class="token T_VARIABLE">$restBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_MINUS_EQUAL">-=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$extra_header</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'length'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4435"><pre><span class="token T_WHITESPACE">							</span><span class="token T_VARIABLE">$timestamps</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">unpack</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Vmodified'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$bindata</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4436"><pre><span class="token T_WHITESPACE">							</span><span class="token T_VARIABLE">$filectime</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$timestamps</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'modified'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4437"><pre><span class="token T_WHITESPACE">							</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">timestamp</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$filectime</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4438"><pre><span class="token T_WHITESPACE">						</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4439"><pre><span class="token T_WHITESPACE">						</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4440"><br/></div><div id="line4441"><pre><span class="token T_WHITESPACE">					</span><span class="token T_DEFAULT">default</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line4442"><pre><span class="token T_WHITESPACE">						</span><span class="token T_COMMENT">// Unknown field</span></pre></div><div id="line4443"><pre><span class="token T_WHITESPACE">						</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$extra_header</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'length'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_GT">&gt;</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4444"><pre><span class="token T_WHITESPACE">							</span><span class="token T_VARIABLE">$junk</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">fread</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$extra_header</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'length'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4445"><pre><span class="token T_WHITESPACE">							</span><span class="token T_VARIABLE">$restBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_MINUS_EQUAL">-=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$extra_header</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'length'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4446"><pre><span class="token T_WHITESPACE">						</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4447"><pre><span class="token T_WHITESPACE">						</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4448"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4449"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4450"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$restBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_GT">&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$junk</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">fread</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$restBytes</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4451"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4452"><br/></div><div id="line4453"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$compressionType</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$header_data</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'compression'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4454"><br/></div><div id="line4455"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Populate the return array</span></pre></div><div id="line4456"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$file</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4457"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">compressed</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$header_data</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'compsize'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4458"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">uncompressed</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$header_data</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'uncompsize'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4459"><pre><span class="token T_WHITESPACE">		</span><span class="token T_SWITCH">switch</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$header_data</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'type'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4460"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4461"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line4462"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">type</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'dir'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4463"><pre><span class="token T_WHITESPACE">				</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4464"><br/></div><div id="line4465"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line4466"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">type</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'file'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4467"><pre><span class="token T_WHITESPACE">				</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4468"><br/></div><div id="line4469"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">2</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line4470"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">type</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'link'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4471"><pre><span class="token T_WHITESPACE">				</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4472"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4473"><pre><span class="token T_WHITESPACE">		</span><span class="token T_SWITCH">switch</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$compressionType</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4474"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4475"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line4476"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">compression</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'none'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4477"><pre><span class="token T_WHITESPACE">				</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4478"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line4479"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">compression</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'gzip'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4480"><pre><span class="token T_WHITESPACE">				</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4481"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">2</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line4482"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">compression</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'bzip2'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4483"><pre><span class="token T_WHITESPACE">				</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4484"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4485"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">permissions</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$header_data</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'perms'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4486"><br/></div><div id="line4487"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Find hard-coded banned files</span></pre></div><div id="line4488"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">basename</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">"."</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_OR">||</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">basename</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">".."</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4489"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4490"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$isBannedFile</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4491"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4492"><br/></div><div id="line4493"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Also try to find banned files passed in class configuration</span></pre></div><div id="line4494"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">count</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">skipFiles</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_GT">&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$isRenamed</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4495"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4496"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">in_array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">skipFiles</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4497"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4498"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$isBannedFile</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4499"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4500"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4501"><br/></div><div id="line4502"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// If we have a banned file, let's skip it</span></pre></div><div id="line4503"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$isBannedFile</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4504"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4505"><pre><span class="token T_WHITESPACE">			</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Skipping file '</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4506"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Advance the file pointer, skipping exactly the size of the compressed data</span></pre></div><div id="line4507"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$seekleft</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">compressed</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4508"><pre><span class="token T_WHITESPACE">			</span><span class="token T_WHILE">while</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$seekleft</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_GT">&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4509"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4510"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// Ensure that we can seek past archive part boundaries</span></pre></div><div id="line4511"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$curSize</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">filesize</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">archiveList</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">currentPartNumber</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4512"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$curPos</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftell</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4513"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$canSeek</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$curSize</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$curPos</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4514"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$canSeek</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_GT">&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$seekleft</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$canSeek</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$seekleft</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4515"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">fseek</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$canSeek</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">SEEK_CUR</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4516"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$seekleft</span><span class="token T_WHITESPACE"> </span><span class="token T_MINUS_EQUAL">-=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$canSeek</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4517"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$seekleft</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">nextFile</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4518"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4519"><br/></div><div id="line4520"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">currentPartOffset</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftell</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4521"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">runState</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AK_STATE_DONE</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4522"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4523"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4524"><br/></div><div id="line4525"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Last chance to prepend a path to the filename</span></pre></div><div id="line4526"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">addPath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$isDirRenamed</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4527"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4528"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">addPath</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4529"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4530"><br/></div><div id="line4531"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Get the translated path name</span></pre></div><div id="line4532"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$restorePerms</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.restoreperms'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4533"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">type</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'file'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4534"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4535"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Regular file; ask the postproc engine to process its filename</span></pre></div><div id="line4536"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$restorePerms</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4537"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4538"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">realFile</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">postProcEngine</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">processFilename</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">permissions</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4539"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4540"><pre><span class="token T_WHITESPACE">			</span><span class="token T_ELSE">else</span></pre></div><div id="line4541"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4542"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">realFile</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">postProcEngine</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">processFilename</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4543"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4544"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4545"><pre><span class="token T_WHITESPACE">		</span><span class="token T_ELSEIF">elseif</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">type</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'dir'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4546"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4547"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$dir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4548"><br/></div><div id="line4549"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Directory; just create it</span></pre></div><div id="line4550"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$restorePerms</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4551"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4552"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">postProcEngine</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">createDirRecursive</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">permissions</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4553"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4554"><pre><span class="token T_WHITESPACE">			</span><span class="token T_ELSE">else</span></pre></div><div id="line4555"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4556"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">postProcEngine</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">createDirRecursive</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0755</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4557"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4558"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">postProcEngine</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">processFilename</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">null</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4559"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4560"><pre><span class="token T_WHITESPACE">		</span><span class="token T_ELSE">else</span></pre></div><div id="line4561"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4562"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Symlink; do not post-process</span></pre></div><div id="line4563"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">postProcEngine</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">processFilename</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">null</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4564"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4565"><br/></div><div id="line4566"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">createDirectory</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4567"><br/></div><div id="line4568"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Header is read</span></pre></div><div id="line4569"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">runState</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AK_STATE_HEADER</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4570"><br/></div><div id="line4571"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">dataReadLength</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4572"><br/></div><div id="line4573"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4574"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4575"><br/></div><div id="line4576"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line4577"><pre><span class="token T_DOC_COMMENT">	 * Concrete classes must use this method to process file data. It must set $runState to AK_STATE_DATAREAD when</span></pre></div><div id="line4578"><pre><span class="token T_DOC_COMMENT">	 * it's finished processing the file data.</span></pre></div><div id="line4579"><pre><span class="token T_DOC_COMMENT">	 * @return bool True if processing the file data was successful, false if an error occured</span></pre></div><div id="line4580"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line4581"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">processFileData</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4582"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4583"><pre><span class="token T_WHITESPACE">		</span><span class="token T_SWITCH">switch</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">type</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4584"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4585"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'dir'</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line4586"><pre><span class="token T_WHITESPACE">				</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">processTypeDir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4587"><pre><span class="token T_WHITESPACE">				</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4588"><br/></div><div id="line4589"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'link'</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line4590"><pre><span class="token T_WHITESPACE">				</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">processTypeLink</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4591"><pre><span class="token T_WHITESPACE">				</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4592"><br/></div><div id="line4593"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'file'</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line4594"><pre><span class="token T_WHITESPACE">				</span><span class="token T_SWITCH">switch</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">compression</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4595"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4596"><pre><span class="token T_WHITESPACE">					</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'none'</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line4597"><pre><span class="token T_WHITESPACE">						</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">processTypeFileUncompressed</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4598"><pre><span class="token T_WHITESPACE">						</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4599"><br/></div><div id="line4600"><pre><span class="token T_WHITESPACE">					</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'gzip'</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line4601"><pre><span class="token T_WHITESPACE">					</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'bzip2'</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line4602"><pre><span class="token T_WHITESPACE">						</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">processTypeFileCompressedSimple</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4603"><pre><span class="token T_WHITESPACE">						</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4604"><br/></div><div id="line4605"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4606"><pre><span class="token T_WHITESPACE">				</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4607"><br/></div><div id="line4608"><pre><span class="token T_WHITESPACE">			</span><span class="token T_DEFAULT">default</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line4609"><pre><span class="token T_WHITESPACE">				</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Unknown file type '</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">type</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4610"><pre><span class="token T_WHITESPACE">				</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4611"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4612"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4613"><br/></div><div id="line4614"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PRIVATE">private</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">processTypeFileUncompressed</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4615"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4616"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Uncompressed files are being processed in small chunks, to avoid timeouts</span></pre></div><div id="line4617"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">dataReadLength</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.dryrun'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'0'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4618"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4619"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Before processing file data, ensure permissions are adequate</span></pre></div><div id="line4620"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setCorrectPermissions</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4621"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4622"><br/></div><div id="line4623"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Open the output file</span></pre></div><div id="line4624"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.dryrun'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'0'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4625"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4626"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$ignore</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.ignoreerrors'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_OR">||</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isIgnoredDirectory</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4627"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">dataReadLength</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4628"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$outfp</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">fopen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">realFile</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'wb'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4629"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_ELSE">else</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4630"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$outfp</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">fopen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">realFile</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'ab'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4631"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4632"><br/></div><div id="line4633"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Can we write to the file?</span></pre></div><div id="line4634"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$outfp</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_IDENTICAL">===</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$ignore</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4635"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// An error occured</span></pre></div><div id="line4636"><pre><span class="token T_WHITESPACE">				</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Could not write to output file'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4637"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">sprintf</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'COULDNT_WRITE_FILE'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">realFile</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4638"><pre><span class="token T_WHITESPACE">				</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4639"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4640"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4641"><br/></div><div id="line4642"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Does the file have any data, at all?</span></pre></div><div id="line4643"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">compressed</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4644"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4645"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// No file data!</span></pre></div><div id="line4646"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.dryrun'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'0'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">is_resource</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$outfp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">fclose</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$outfp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4647"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">runState</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AK_STATE_DATAREAD</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4648"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4649"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4650"><br/></div><div id="line4651"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Reference to the global timer</span></pre></div><div id="line4652"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$timer</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">getTimer</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4653"><br/></div><div id="line4654"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$toReadBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4655"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$leftBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">compressed</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">dataReadLength</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4656"><br/></div><div id="line4657"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Loop while there's data to read and enough time to do it</span></pre></div><div id="line4658"><pre><span class="token T_WHITESPACE">		</span><span class="token T_WHILE">while</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$leftBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_GT">&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$timer</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">getTimeLeft</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_GT">&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4659"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4660"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$toReadBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$leftBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_GT">&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">chunkSize</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_QUESTION_MARK">?</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">chunkSize</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_COLON">:</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$leftBytes</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4661"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$data</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fread</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$toReadBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4662"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$reallyReadBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">akstringlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$data</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4663"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$leftBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_MINUS_EQUAL">-=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$reallyReadBytes</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4664"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">dataReadLength</span><span class="token T_WHITESPACE"> </span><span class="token T_PLUS_EQUAL">+=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$reallyReadBytes</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4665"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$reallyReadBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$toReadBytes</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4666"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4667"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// We read less than requested! Why? Did we hit local EOF?</span></pre></div><div id="line4668"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isEOF</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">true</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isEOF</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4669"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4670"><pre><span class="token T_WHITESPACE">					</span><span class="token T_COMMENT">// Yeap. Let's go to the next file</span></pre></div><div id="line4671"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">nextFile</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4672"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4673"><pre><span class="token T_WHITESPACE">				</span><span class="token T_ELSE">else</span></pre></div><div id="line4674"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4675"><pre><span class="token T_WHITESPACE">					</span><span class="token T_COMMENT">// Nope. The archive is corrupt</span></pre></div><div id="line4676"><pre><span class="token T_WHITESPACE">					</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Not enough data in file. The archive is truncated or corrupt.'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4677"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">_</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'ERR_CORRUPT_ARCHIVE'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4678"><pre><span class="token T_WHITESPACE">					</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4679"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4680"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4681"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.dryrun'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'0'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4682"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">is_resource</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$outfp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">fwrite</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$outfp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$data</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4683"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4684"><br/></div><div id="line4685"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Close the file pointer</span></pre></div><div id="line4686"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.dryrun'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'0'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4687"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">is_resource</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$outfp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">fclose</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$outfp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4688"><br/></div><div id="line4689"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Was this a pre-timeout bail out?</span></pre></div><div id="line4690"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$leftBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_GT">&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4691"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4692"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">runState</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AK_STATE_DATA</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4693"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4694"><pre><span class="token T_WHITESPACE">		</span><span class="token T_ELSE">else</span></pre></div><div id="line4695"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4696"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Oh! We just finished!</span></pre></div><div id="line4697"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">runState</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AK_STATE_DATAREAD</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4698"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">dataReadLength</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4699"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4700"><br/></div><div id="line4701"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4702"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4703"><br/></div><div id="line4704"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PRIVATE">private</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">processTypeFileCompressedSimple</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4705"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4706"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.dryrun'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'0'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4707"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4708"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Before processing file data, ensure permissions are adequate</span></pre></div><div id="line4709"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setCorrectPermissions</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4710"><br/></div><div id="line4711"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Open the output file</span></pre></div><div id="line4712"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$outfp</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">fopen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">realFile</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'wb'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4713"><br/></div><div id="line4714"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Can we write to the file?</span></pre></div><div id="line4715"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$ignore</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.ignoreerrors'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_OR">||</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isIgnoredDirectory</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4716"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$outfp</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_IDENTICAL">===</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$ignore</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4717"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// An error occured</span></pre></div><div id="line4718"><pre><span class="token T_WHITESPACE">				</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Could not write to output file'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4719"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">sprintf</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'COULDNT_WRITE_FILE'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">realFile</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4720"><pre><span class="token T_WHITESPACE">				</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4721"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4722"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4723"><br/></div><div id="line4724"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Does the file have any data, at all?</span></pre></div><div id="line4725"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">compressed</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4726"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4727"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// No file data!</span></pre></div><div id="line4728"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.dryrun'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'0'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4729"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">is_resource</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$outfp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">fclose</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$outfp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4730"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">runState</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AK_STATE_DATAREAD</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4731"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4732"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4733"><br/></div><div id="line4734"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Simple compressed files are processed as a whole; we can't do chunk processing</span></pre></div><div id="line4735"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$zipData</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fread</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">compressed</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4736"><pre><span class="token T_WHITESPACE">		</span><span class="token T_WHILE">while</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">akstringlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$zipData</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">compressed</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4737"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4738"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// End of local file before reading all data, but have more archive parts?</span></pre></div><div id="line4739"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isEOF</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">true</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isEOF</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4740"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4741"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// Yeap. Read from the next file</span></pre></div><div id="line4742"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">nextFile</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4743"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$bytes_left</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">compressed</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">akstringlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$zipData</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4744"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$zipData</span><span class="token T_WHITESPACE"> </span><span class="token T_CONCAT_EQUAL">.=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fread</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$bytes_left</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4745"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4746"><pre><span class="token T_WHITESPACE">			</span><span class="token T_ELSE">else</span></pre></div><div id="line4747"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4748"><pre><span class="token T_WHITESPACE">				</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'End of local file before reading all data with no more parts left. The archive is corrupt or truncated.'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4749"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">_</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'ERR_CORRUPT_ARCHIVE'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4750"><pre><span class="token T_WHITESPACE">				</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4751"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4752"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4753"><br/></div><div id="line4754"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">compression</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'gzip'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4755"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4756"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$unzipData</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">gzinflate</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$zipData</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4757"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4758"><pre><span class="token T_WHITESPACE">		</span><span class="token T_ELSEIF">elseif</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">compression</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'bzip2'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4759"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4760"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$unzipData</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">bzdecompress</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$zipData</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4761"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4762"><pre><span class="token T_WHITESPACE">		</span><span class="token T_UNSET">unset</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$zipData</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4763"><br/></div><div id="line4764"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Write to the file.</span></pre></div><div id="line4765"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.dryrun'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'0'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">is_resource</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$outfp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4766"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4767"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">fwrite</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$outfp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$unzipData</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">uncompressed</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4768"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">fclose</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$outfp</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4769"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4770"><pre><span class="token T_WHITESPACE">		</span><span class="token T_UNSET">unset</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$unzipData</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4771"><br/></div><div id="line4772"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">runState</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AK_STATE_DATAREAD</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4773"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4774"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4775"><br/></div><div id="line4776"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line4777"><pre><span class="token T_DOC_COMMENT">	 * Process the file data of a link entry</span></pre></div><div id="line4778"><pre><span class="token T_DOC_COMMENT">	 * @return bool</span></pre></div><div id="line4779"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line4780"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PRIVATE">private</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">processTypeLink</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4781"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4782"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$readBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4783"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$toReadBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4784"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$leftBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">compressed</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4785"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$data</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4786"><br/></div><div id="line4787"><pre><span class="token T_WHITESPACE">		</span><span class="token T_WHILE">while</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$leftBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_GT">&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4788"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4789"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$toReadBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$leftBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_GT">&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">chunkSize</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_QUESTION_MARK">?</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">chunkSize</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_COLON">:</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$leftBytes</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4790"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$mydata</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fread</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$toReadBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4791"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$reallyReadBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">akstringlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$mydata</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4792"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$data</span><span class="token T_WHITESPACE"> </span><span class="token T_CONCAT_EQUAL">.=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$mydata</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4793"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$leftBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_MINUS_EQUAL">-=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$reallyReadBytes</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4794"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$reallyReadBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$toReadBytes</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4795"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4796"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// We read less than requested! Why? Did we hit local EOF?</span></pre></div><div id="line4797"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isEOF</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">true</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isEOF</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4798"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4799"><pre><span class="token T_WHITESPACE">					</span><span class="token T_COMMENT">// Yeap. Let's go to the next file</span></pre></div><div id="line4800"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">nextFile</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4801"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4802"><pre><span class="token T_WHITESPACE">				</span><span class="token T_ELSE">else</span></pre></div><div id="line4803"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4804"><pre><span class="token T_WHITESPACE">					</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'End of local file before reading all data with no more parts left. The archive is corrupt or truncated.'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4805"><pre><span class="token T_WHITESPACE">					</span><span class="token T_COMMENT">// Nope. The archive is corrupt</span></pre></div><div id="line4806"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">_</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'ERR_CORRUPT_ARCHIVE'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4807"><pre><span class="token T_WHITESPACE">					</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4808"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4809"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4810"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4811"><br/></div><div id="line4812"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Try to remove an existing file or directory by the same name</span></pre></div><div id="line4813"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">file_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">realFile</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">unlink</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">realFile</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">rmdir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">realFile</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4814"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Remove any trailing slash</span></pre></div><div id="line4815"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">realFile</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">realFile</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">realFile</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4816"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Create the symlink - only possible within PHP context. There's no support built in the FTP protocol, so no postproc use is possible here :(</span></pre></div><div id="line4817"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.dryrun'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'0'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4818"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">symlink</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$data</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">realFile</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4819"><br/></div><div id="line4820"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">runState</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AK_STATE_DATAREAD</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4821"><br/></div><div id="line4822"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_COMMENT">// No matter if the link was created!</span></pre></div><div id="line4823"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4824"><br/></div><div id="line4825"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line4826"><pre><span class="token T_DOC_COMMENT">	 * Process the file data of a directory entry</span></pre></div><div id="line4827"><pre><span class="token T_DOC_COMMENT">	 * @return bool</span></pre></div><div id="line4828"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line4829"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PRIVATE">private</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">processTypeDir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4830"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4831"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Directory entries in the JPA do not have file data, therefore we're done processing the entry</span></pre></div><div id="line4832"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">runState</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AK_STATE_DATAREAD</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4833"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4834"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4835"><br/></div><div id="line4836"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line4837"><pre><span class="token T_DOC_COMMENT">	 * Creates the directory this file points to</span></pre></div><div id="line4838"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line4839"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">createDirectory</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4840"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4841"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.dryrun'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'0'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4842"><br/></div><div id="line4843"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Do we need to create a directory?</span></pre></div><div id="line4844"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">realFile</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">realFile</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4845"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$lastSlash</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strrpos</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">realFile</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4846"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$dirName</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">realFile</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$lastSlash</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4847"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$perms</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">flagRestorePermissions</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_QUESTION_MARK">?</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">permissions</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_COLON">:</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0755</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4848"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$ignore</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.ignoreerrors'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_OR">||</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isIgnoredDirectory</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$dirName</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4849"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">postProcEngine</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">createDirRecursive</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$dirName</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$perms</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$ignore</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4850"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">sprintf</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'COULDNT_CREATE_DIR'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$dirName</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4851"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4852"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4853"><pre><span class="token T_WHITESPACE">		</span><span class="token T_ELSE">else</span></pre></div><div id="line4854"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4855"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4856"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4857"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4858"><br/></div><div id="line4859"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">heuristicFileHeaderLocator</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4860"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4861"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4862"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$fullEOF</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4863"><br/></div><div id="line4864"><pre><span class="token T_WHITESPACE">		</span><span class="token T_WHILE">while</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$fullEOF</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4865"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">currentPartOffset</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftell</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4866"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isEOF</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">true</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4867"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">nextFile</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4868"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4869"><br/></div><div id="line4870"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isEOF</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4871"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$fullEOF</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4872"><pre><span class="token T_WHITESPACE">				</span><span class="token T_CONTINUE">continue</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4873"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4874"><br/></div><div id="line4875"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Read 512Kb</span></pre></div><div id="line4876"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$chunk</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">fread</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">524288</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4877"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$size_read</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">mb_strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$chunk</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'8bit'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4878"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">//$pos = strpos($chunk, 'JPF');</span></pre></div><div id="line4879"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$pos</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">mb_strpos</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$chunk</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'JPF'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'8bit'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4880"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$pos</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_NOT_IDENTICAL">!==</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4881"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// We found it!</span></pre></div><div id="line4882"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">currentPartOffset</span><span class="token T_WHITESPACE"> </span><span class="token T_PLUS_EQUAL">+=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$pos</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_PLUS">+</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">3</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4883"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">fseek</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">currentPartOffset</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">SEEK_SET</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4884"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4885"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_ELSE">else</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4886"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// Not yet found :(</span></pre></div><div id="line4887"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">currentPartOffset</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftell</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4888"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4889"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4890"><br/></div><div id="line4891"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$ret</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4892"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4893"><pre><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4894"><br/></div><div id="line4895"><pre><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line4896"><pre><span class="token T_DOC_COMMENT"> * Akeeba Restore</span></pre></div><div id="line4897"><pre><span class="token T_DOC_COMMENT"> * A JSON-powered JPA, JPS and ZIP archive extraction library</span></pre></div><div id="line4898"><pre><span class="token T_DOC_COMMENT"> *</span></pre></div><div id="line4899"><pre><span class="token T_DOC_COMMENT"> * @copyright   2010-2014 Nicholas K. Dionysopoulos / Akeeba Ltd.</span></pre></div><div id="line4900"><pre><span class="token T_DOC_COMMENT"> * @license     GNU GPL v2 or - at your option - any later version</span></pre></div><div id="line4901"><pre><span class="token T_DOC_COMMENT"> * @package     akeebabackup</span></pre></div><div id="line4902"><pre><span class="token T_DOC_COMMENT"> * @subpackage  kickstart</span></pre></div><div id="line4903"><pre><span class="token T_DOC_COMMENT"> */</span></pre></div><div id="line4904"><br/></div><div id="line4905"><pre><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line4906"><pre><span class="token T_DOC_COMMENT"> * ZIP archive extraction class</span></pre></div><div id="line4907"><pre><span class="token T_DOC_COMMENT"> *</span></pre></div><div id="line4908"><pre><span class="token T_DOC_COMMENT"> * Since the file data portion of ZIP and JPA are similarly structured (it's empty for dirs,</span></pre></div><div id="line4909"><pre><span class="token T_DOC_COMMENT"> * linked node name for symlinks, dumped binary data for no compressions and dumped gzipped</span></pre></div><div id="line4910"><pre><span class="token T_DOC_COMMENT"> * binary data for gzip compression) we just have to subclass AKUnarchiverJPA and change the</span></pre></div><div id="line4911"><pre><span class="token T_DOC_COMMENT"> * header reading bits. Reusable code ;)</span></pre></div><div id="line4912"><pre><span class="token T_DOC_COMMENT"> */</span></pre></div><div id="line4913"><pre><span class="token T_CLASS">class</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKUnarchiverZIP</span><span class="token T_WHITESPACE"> </span><span class="token T_EXTENDS">extends</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKUnarchiverJPA</span></pre></div><div id="line4914"><pre><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4915"><pre><span class="token T_WHITESPACE">	</span><span class="token T_VAR">var</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$expectDataDescriptor</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4916"><br/></div><div id="line4917"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">readArchiveHeader</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4918"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4919"><pre><span class="token T_WHITESPACE">		</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Preparing to read archive header'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4920"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Initialize header data array</span></pre></div><div id="line4921"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">archiveHeaderData</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_NEW">new</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">stdClass</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4922"><br/></div><div id="line4923"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Open the first part</span></pre></div><div id="line4924"><pre><span class="token T_WHITESPACE">		</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Opening the first part'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4925"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">nextFile</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4926"><br/></div><div id="line4927"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Fail for unreadable files</span></pre></div><div id="line4928"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_IDENTICAL">===</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4929"><pre><span class="token T_WHITESPACE">			</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'The first part is not readable'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4930"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4931"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4932"><br/></div><div id="line4933"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Read a possible multipart signature</span></pre></div><div id="line4934"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$sigBinary</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">fread</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">4</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4935"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$headerData</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">unpack</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Vsig'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$sigBinary</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4936"><br/></div><div id="line4937"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Roll back if it's not a multipart archive</span></pre></div><div id="line4938"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$headerData</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'sig'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x04034b50</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4939"><pre><span class="token T_WHITESPACE">			</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'The archive is not multipart'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4940"><pre><span class="token T_WHITESPACE">			</span><span class="token T_STRING">fseek</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">SEEK_CUR</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4941"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_ELSE">else</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4942"><pre><span class="token T_WHITESPACE">			</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'The archive is multipart'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4943"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4944"><br/></div><div id="line4945"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$multiPartSigs</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span></pre></div><div id="line4946"><pre><span class="token T_WHITESPACE">			</span><span class="token T_LNUMBER">0x08074b50</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Multi-part ZIP</span></pre></div><div id="line4947"><pre><span class="token T_WHITESPACE">			</span><span class="token T_LNUMBER">0x30304b50</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Multi-part ZIP (alternate)</span></pre></div><div id="line4948"><pre><span class="token T_WHITESPACE">			</span><span class="token T_LNUMBER">0x04034b50</span><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Single file</span></pre></div><div id="line4949"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4950"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">in_array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$headerData</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'sig'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$multiPartSigs</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4951"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4952"><pre><span class="token T_WHITESPACE">			</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Invalid header signature '</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_STRING">dechex</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$headerData</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'sig'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4953"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">_</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'ERR_CORRUPT_ARCHIVE'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4954"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4955"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4956"><br/></div><div id="line4957"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">currentPartOffset</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftell</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4958"><pre><span class="token T_WHITESPACE">		</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Current part offset after reading header: '</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">currentPartOffset</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4959"><br/></div><div id="line4960"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">dataReadLength</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4961"><br/></div><div id="line4962"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4963"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4964"><br/></div><div id="line4965"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line4966"><pre><span class="token T_DOC_COMMENT">	 * Concrete classes must use this method to read the file header</span></pre></div><div id="line4967"><pre><span class="token T_DOC_COMMENT">	 * @return bool True if reading the file was successful, false if an error occured or we reached end of archive</span></pre></div><div id="line4968"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line4969"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">readFileHeader</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4970"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4971"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// If the current part is over, proceed to the next part please</span></pre></div><div id="line4972"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isEOF</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">true</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4973"><pre><span class="token T_WHITESPACE">			</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Opening next archive part'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4974"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">nextFile</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4975"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4976"><br/></div><div id="line4977"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">expectDataDescriptor</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line4978"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4979"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// The last file had bit 3 of the general purpose bit flag set. This means that we have a</span></pre></div><div id="line4980"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// 12 byte data descriptor we need to skip. To make things worse, there might also be a 4</span></pre></div><div id="line4981"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// byte optional data descriptor header (0x08074b50).</span></pre></div><div id="line4982"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$junk</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">fread</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4983"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$junk</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">unpack</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Vsig'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$junk</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4984"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$junk</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'sig'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x08074b50</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4985"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// Yes, there was a signature</span></pre></div><div id="line4986"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$junk</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">fread</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">12</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4987"><pre><span class="token T_WHITESPACE">				</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Data descriptor (w/ header) skipped at '</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">ftell</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_LNUMBER">12</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4988"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_ELSE">else</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4989"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// No, there was no signature, just read another 8 bytes</span></pre></div><div id="line4990"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$junk</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">fread</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">8</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4991"><pre><span class="token T_WHITESPACE">				</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Data descriptor (w/out header) skipped at '</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">ftell</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_LNUMBER">8</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4992"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line4993"><br/></div><div id="line4994"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// And check for EOF, too</span></pre></div><div id="line4995"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isEOF</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">true</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line4996"><pre><span class="token T_WHITESPACE">				</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'EOF before reading header'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4997"><br/></div><div id="line4998"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">nextFile</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line4999"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5000"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5001"><br/></div><div id="line5002"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Get and decode Local File Header</span></pre></div><div id="line5003"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$headerBinary</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">fread</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">30</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5004"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$headerData</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">unpack</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Vsig/C2ver/vbitflag/vcompmethod/vlastmodtime/vlastmoddate/Vcrc/Vcompsize/Vuncomp/vfnamelen/veflen'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$headerBinary</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5005"><br/></div><div id="line5006"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Check signature</span></pre></div><div id="line5007"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$headerData</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'sig'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x04034b50</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5008"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5009"><pre><span class="token T_WHITESPACE">			</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Not a file signature at '</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">ftell</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5010"><br/></div><div id="line5011"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// The signature is not the one used for files. Is this a central directory record (i.e. we're done)?</span></pre></div><div id="line5012"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$headerData</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'sig'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x02014b50</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5013"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5014"><pre><span class="token T_WHITESPACE">				</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'EOCD signature at '</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">ftell</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5015"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// End of ZIP file detected. We'll just skip to the end of file...</span></pre></div><div id="line5016"><pre><span class="token T_WHITESPACE">				</span><span class="token T_WHILE">while</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">nextFile</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5017"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">fseek</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">SEEK_END</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_COMMENT">// Go to EOF</span></pre></div><div id="line5018"><pre><span class="token T_WHITESPACE">				</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5019"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5020"><pre><span class="token T_WHITESPACE">			</span><span class="token T_ELSE">else</span></pre></div><div id="line5021"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5022"><pre><span class="token T_WHITESPACE">				</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Invalid signature '</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">dechex</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$headerData</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'sig'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">' at '</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_STRING">ftell</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5023"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">_</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'ERR_CORRUPT_ARCHIVE'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5024"><pre><span class="token T_WHITESPACE">				</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5025"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5026"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5027"><br/></div><div id="line5028"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// If bit 3 of the bitflag is set, expectDataDescriptor is true</span></pre></div><div id="line5029"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">expectDataDescriptor</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$headerData</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'bitflag'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5030"><br/></div><div id="line5031"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_NEW">new</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">stdClass</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5032"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">timestamp</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5033"><br/></div><div id="line5034"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Read the last modified data and time</span></pre></div><div id="line5035"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$lastmodtime</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$headerData</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'lastmodtime'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5036"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$lastmoddate</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$headerData</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'lastmoddate'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5037"><br/></div><div id="line5038"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$lastmoddate</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$lastmodtime</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5039"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5040"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// ----- Extract time</span></pre></div><div id="line5041"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$v_hour</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$lastmodtime</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0xF800</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_SR">&gt;&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">11</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5042"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$v_minute</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$lastmodtime</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x07E0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_SR">&gt;&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">5</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5043"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$v_seconde</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$lastmodtime</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x001F</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_MULT">*</span><span class="token T_LNUMBER">2</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5044"><br/></div><div id="line5045"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// ----- Extract date</span></pre></div><div id="line5046"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$v_year</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$lastmoddate</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0xFE00</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_SR">&gt;&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">9</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_PLUS">+</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">1980</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5047"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$v_month</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$lastmoddate</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x01E0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_SR">&gt;&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">5</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5048"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$v_day</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$lastmoddate</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x001F</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5049"><br/></div><div id="line5050"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// ----- Get UNIX date format</span></pre></div><div id="line5051"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">timestamp</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">mktime</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$v_hour</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$v_minute</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$v_seconde</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$v_month</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$v_day</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$v_year</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5052"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5053"><br/></div><div id="line5054"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$isBannedFile</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5055"><br/></div><div id="line5056"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">compressed</span><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$headerData</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'compsize'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5057"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">uncompressed</span><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$headerData</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'uncomp'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5058"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$nameFieldLength</span><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$headerData</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'fnamelen'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5059"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$extraFieldLength</span><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$headerData</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'eflen'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5060"><br/></div><div id="line5061"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Read filename field</span></pre></div><div id="line5062"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">fread</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$nameFieldLength</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5063"><br/></div><div id="line5064"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Handle file renaming</span></pre></div><div id="line5065"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$isRenamed</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5066"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">is_array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">renameFiles</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">count</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">renameFiles</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_GT">&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5067"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5068"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">array_key_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">renameFiles</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5069"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5070"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">renameFiles</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5071"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$isRenamed</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5072"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5073"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5074"><br/></div><div id="line5075"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Handle directory renaming</span></pre></div><div id="line5076"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$isDirRenamed</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5077"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">is_array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">renameDirs</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">count</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">renameDirs</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_GT">&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5078"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">array_key_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">dirname</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">renameDirs</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5079"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$file</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">rtrim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">renameDirs</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_STRING">dirname</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_STRING">basename</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5080"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$isRenamed</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5081"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$isDirRenamed</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5082"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5083"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5084"><br/></div><div id="line5085"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Read extra field if present</span></pre></div><div id="line5086"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$extraFieldLength</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_GT">&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5087"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$extrafield</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">fread</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$extraFieldLength</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5088"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5089"><br/></div><div id="line5090"><pre><span class="token T_WHITESPACE">		</span><span class="token T_STRING">debugMsg</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'*'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_STRING">ftell</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">' IS START OF '</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">' ('</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">compressed</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">' bytes)'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5091"><br/></div><div id="line5092"><br/></div><div id="line5093"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Decide filetype -- Check for directories</span></pre></div><div id="line5094"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">type</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'file'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5095"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strrpos</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">1</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">type</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'dir'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5096"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Decide filetype -- Check for symbolic links</span></pre></div><div id="line5097"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$headerData</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'ver1'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">10</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$headerData</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'ver2'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">3</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">type</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'link'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5098"><br/></div><div id="line5099"><pre><span class="token T_WHITESPACE">		</span><span class="token T_SWITCH">switch</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$headerData</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'compmethod'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5100"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5101"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line5102"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">compression</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'none'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5103"><pre><span class="token T_WHITESPACE">				</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5104"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">8</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line5105"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">compression</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'gzip'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5106"><pre><span class="token T_WHITESPACE">				</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5107"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5108"><br/></div><div id="line5109"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Find hard-coded banned files</span></pre></div><div id="line5110"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">basename</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">"."</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_OR">||</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">basename</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">".."</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5111"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5112"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$isBannedFile</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5113"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5114"><br/></div><div id="line5115"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Also try to find banned files passed in class configuration</span></pre></div><div id="line5116"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">count</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">skipFiles</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_GT">&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$isRenamed</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5117"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5118"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">in_array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">skipFiles</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5119"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5120"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$isBannedFile</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5121"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5122"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5123"><br/></div><div id="line5124"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// If we have a banned file, let's skip it</span></pre></div><div id="line5125"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$isBannedFile</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5126"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5127"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Advance the file pointer, skipping exactly the size of the compressed data</span></pre></div><div id="line5128"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$seekleft</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">compressed</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5129"><pre><span class="token T_WHITESPACE">			</span><span class="token T_WHILE">while</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$seekleft</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_GT">&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5130"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5131"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// Ensure that we can seek past archive part boundaries</span></pre></div><div id="line5132"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$curSize</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">filesize</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">archiveList</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">currentPartNumber</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5133"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$curPos</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftell</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5134"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$canSeek</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$curSize</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$curPos</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5135"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$canSeek</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_GT">&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$seekleft</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$canSeek</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$seekleft</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5136"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">fseek</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$canSeek</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">SEEK_CUR</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5137"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$seekleft</span><span class="token T_WHITESPACE"> </span><span class="token T_MINUS_EQUAL">-=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$canSeek</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5138"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$seekleft</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">nextFile</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5139"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5140"><br/></div><div id="line5141"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">currentPartOffset</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftell</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5142"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">runState</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AK_STATE_DONE</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5143"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5144"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5145"><br/></div><div id="line5146"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Last chance to prepend a path to the filename</span></pre></div><div id="line5147"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">addPath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$isDirRenamed</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5148"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5149"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">addPath</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5150"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5151"><br/></div><div id="line5152"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Get the translated path name</span></pre></div><div id="line5153"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">type</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'file'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5154"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5155"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">realFile</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">postProcEngine</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">processFilename</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5156"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5157"><pre><span class="token T_WHITESPACE">		</span><span class="token T_ELSEIF">elseif</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">type</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'dir'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5158"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5159"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">timestamp</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5160"><br/></div><div id="line5161"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$dir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5162"><br/></div><div id="line5163"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">postProcEngine</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">createDirRecursive</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0755</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5164"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">postProcEngine</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">processFilename</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">null</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5165"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5166"><pre><span class="token T_WHITESPACE">		</span><span class="token T_ELSE">else</span></pre></div><div id="line5167"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5168"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Symlink; do not post-process</span></pre></div><div id="line5169"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">timestamp</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5170"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">postProcEngine</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">processFilename</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">null</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5171"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5172"><br/></div><div id="line5173"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">createDirectory</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5174"><br/></div><div id="line5175"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Header is read</span></pre></div><div id="line5176"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">runState</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AK_STATE_HEADER</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5177"><br/></div><div id="line5178"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5179"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5180"><br/></div><div id="line5181"><pre><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5182"><br/></div><div id="line5183"><pre><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line5184"><pre><span class="token T_DOC_COMMENT"> * Akeeba Restore</span></pre></div><div id="line5185"><pre><span class="token T_DOC_COMMENT"> * A JSON-powered JPA, JPS and ZIP archive extraction library</span></pre></div><div id="line5186"><pre><span class="token T_DOC_COMMENT"> *</span></pre></div><div id="line5187"><pre><span class="token T_DOC_COMMENT"> * @copyright   2010-2014 Nicholas K. Dionysopoulos / Akeeba Ltd.</span></pre></div><div id="line5188"><pre><span class="token T_DOC_COMMENT"> * @license     GNU GPL v2 or - at your option - any later version</span></pre></div><div id="line5189"><pre><span class="token T_DOC_COMMENT"> * @package     akeebabackup</span></pre></div><div id="line5190"><pre><span class="token T_DOC_COMMENT"> * @subpackage  kickstart</span></pre></div><div id="line5191"><pre><span class="token T_DOC_COMMENT"> */</span></pre></div><div id="line5192"><br/></div><div id="line5193"><pre><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line5194"><pre><span class="token T_DOC_COMMENT"> * JPS archive extraction class</span></pre></div><div id="line5195"><pre><span class="token T_DOC_COMMENT"> */</span></pre></div><div id="line5196"><pre><span class="token T_CLASS">class</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKUnarchiverJPS</span><span class="token T_WHITESPACE"> </span><span class="token T_EXTENDS">extends</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKUnarchiverJPA</span></pre></div><div id="line5197"><pre><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5198"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$archiveHeaderData</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5199"><br/></div><div id="line5200"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$password</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5201"><br/></div><div id="line5202"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">__construct</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5203"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5204"><pre><span class="token T_WHITESPACE">		</span><span class="token T_STRING">parent</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">__construct</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5205"><br/></div><div id="line5206"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">password</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.jps.password'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5207"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5208"><br/></div><div id="line5209"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">readArchiveHeader</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5210"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5211"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Initialize header data array</span></pre></div><div id="line5212"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">archiveHeaderData</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_NEW">new</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">stdClass</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5213"><br/></div><div id="line5214"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Open the first part</span></pre></div><div id="line5215"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">nextFile</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5216"><br/></div><div id="line5217"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Fail for unreadable files</span></pre></div><div id="line5218"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_IDENTICAL">===</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5219"><br/></div><div id="line5220"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Read the signature</span></pre></div><div id="line5221"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$sig</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">fread</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">3</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5222"><br/></div><div id="line5223"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$sig</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_NOT_EQUAL">!=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'JPS'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5224"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5225"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Not a JPA file</span></pre></div><div id="line5226"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">_</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'ERR_NOT_A_JPS_FILE'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5227"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5228"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5229"><br/></div><div id="line5230"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Read and parse the known portion of header data (5 bytes)</span></pre></div><div id="line5231"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$bin_data</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">fread</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">5</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5232"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$header_data</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">unpack</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Cmajor/Cminor/cspanned/vextra'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$bin_data</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5233"><br/></div><div id="line5234"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Load any remaining header data (forward compatibility)</span></pre></div><div id="line5235"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$rest_length</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$header_data</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'extra'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5236"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$rest_length</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_GT">&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5237"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$junk</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">fread</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$rest_length</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5238"><pre><span class="token T_WHITESPACE">		</span><span class="token T_ELSE">else</span></pre></div><div id="line5239"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$junk</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5240"><br/></div><div id="line5241"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Temporary array with all the data we read</span></pre></div><div id="line5242"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$temp</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span></pre></div><div id="line5243"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CONSTANT_ENCAPSED_STRING">'signature'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> 			</span><span class="token T_VARIABLE">$sig</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line5244"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CONSTANT_ENCAPSED_STRING">'major'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> 				</span><span class="token T_VARIABLE">$header_data</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'major'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line5245"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CONSTANT_ENCAPSED_STRING">'minor'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> 				</span><span class="token T_VARIABLE">$header_data</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'minor'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line5246"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CONSTANT_ENCAPSED_STRING">'spanned'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> 			</span><span class="token T_VARIABLE">$header_data</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'spanned'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span></pre></div><div id="line5247"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5248"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Array-to-object conversion</span></pre></div><div id="line5249"><pre><span class="token T_WHITESPACE">		</span><span class="token T_FOREACH">foreach</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$temp</span><span class="token T_WHITESPACE"> </span><span class="token T_AS">as</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$key</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5250"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5251"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">archiveHeaderData</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_VARIABLE">$key</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5252"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5253"><br/></div><div id="line5254"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">currentPartOffset</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftell</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5255"><br/></div><div id="line5256"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">dataReadLength</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5257"><br/></div><div id="line5258"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5259"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5260"><br/></div><div id="line5261"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line5262"><pre><span class="token T_DOC_COMMENT">	 * Concrete classes must use this method to read the file header</span></pre></div><div id="line5263"><pre><span class="token T_DOC_COMMENT">	 * @return bool True if reading the file was successful, false if an error occured or we reached end of archive</span></pre></div><div id="line5264"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line5265"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">readFileHeader</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5266"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5267"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// If the current part is over, proceed to the next part please</span></pre></div><div id="line5268"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isEOF</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">true</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5269"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">nextFile</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5270"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5271"><br/></div><div id="line5272"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Get and decode Entity Description Block</span></pre></div><div id="line5273"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$signature</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">fread</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">3</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5274"><br/></div><div id="line5275"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Check for end-of-archive siganture</span></pre></div><div id="line5276"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$signature</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'JPE'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5277"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5278"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setState</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'postrun'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5279"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5280"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5281"><br/></div><div id="line5282"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_NEW">new</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">stdClass</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5283"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">timestamp</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5284"><br/></div><div id="line5285"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Check signature</span></pre></div><div id="line5286"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$signature</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_NOT_EQUAL">!=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'JPF'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5287"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5288"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isEOF</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">true</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5289"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5290"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// This file is finished; make sure it's the last one</span></pre></div><div id="line5291"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">nextFile</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5292"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isEOF</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5293"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5294"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">sprintf</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'INVALID_FILE_HEADER'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">currentPartNumber</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">currentPartOffset</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5295"><pre><span class="token T_WHITESPACE">					</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5296"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5297"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// We're just finished</span></pre></div><div id="line5298"><pre><span class="token T_WHITESPACE">				</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5299"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5300"><pre><span class="token T_WHITESPACE">			</span><span class="token T_ELSE">else</span></pre></div><div id="line5301"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5302"><pre><span class="token T_WHITESPACE">				</span><span class="token T_STRING">fseek</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_LNUMBER">6</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">SEEK_CUR</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5303"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$signature</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">fread</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">3</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5304"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$signature</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'JPE'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5305"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5306"><pre><span class="token T_WHITESPACE">					</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5307"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5308"><br/></div><div id="line5309"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">sprintf</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'INVALID_FILE_HEADER'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">currentPartNumber</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">currentPartOffset</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5310"><pre><span class="token T_WHITESPACE">				</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5311"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5312"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5313"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// This a JPA Entity Block. Process the header.</span></pre></div><div id="line5314"><br/></div><div id="line5315"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$isBannedFile</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5316"><br/></div><div id="line5317"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Read and decrypt the header</span></pre></div><div id="line5318"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$edbhData</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">fread</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5319"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$edbh</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">unpack</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'vencsize/vdecsize'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$edbhData</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5320"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$bin_data</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">fread</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$edbh</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'encsize'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5321"><br/></div><div id="line5322"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Decrypt and truncate</span></pre></div><div id="line5323"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$bin_data</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKEncryptionAES</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">AESDecryptCBC</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$bin_data</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">password</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">128</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5324"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$bin_data</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$bin_data</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_VARIABLE">$edbh</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'decsize'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5325"><br/></div><div id="line5326"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Read length of EDB and of the Entity Path Data</span></pre></div><div id="line5327"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$length_array</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">unpack</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'vpathsize'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$bin_data</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">2</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5328"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Read the path data</span></pre></div><div id="line5329"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$file</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$bin_data</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">2</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_VARIABLE">$length_array</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'pathsize'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5330"><br/></div><div id="line5331"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Handle file renaming</span></pre></div><div id="line5332"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$isRenamed</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5333"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">is_array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">renameFiles</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">count</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">renameFiles</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_GT">&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5334"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5335"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">array_key_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$file</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">renameFiles</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5336"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5337"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$file</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">renameFiles</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$file</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5338"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$isRenamed</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5339"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5340"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5341"><br/></div><div id="line5342"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Handle directory renaming</span></pre></div><div id="line5343"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$isDirRenamed</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5344"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">is_array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">renameDirs</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">count</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">renameDirs</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_GT">&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5345"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">array_key_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">dirname</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$file</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">renameDirs</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5346"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$file</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">rtrim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">renameDirs</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_STRING">dirname</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$file</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_STRING">basename</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$file</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5347"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$isRenamed</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5348"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$isDirRenamed</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5349"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5350"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5351"><br/></div><div id="line5352"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Read and parse the known data portion</span></pre></div><div id="line5353"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$bin_data</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$bin_data</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">2</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_PLUS">+</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$length_array</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'pathsize'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5354"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$header_data</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">unpack</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Ctype/Ccompression/Vuncompsize/Vperms/Vfilectime'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$bin_data</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5355"><br/></div><div id="line5356"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">timestamp</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$header_data</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'filectime'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5357"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$compressionType</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$header_data</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'compression'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5358"><br/></div><div id="line5359"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Populate the return array</span></pre></div><div id="line5360"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$file</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5361"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">uncompressed</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$header_data</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'uncompsize'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5362"><pre><span class="token T_WHITESPACE">		</span><span class="token T_SWITCH">switch</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$header_data</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'type'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5363"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5364"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line5365"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">type</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'dir'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5366"><pre><span class="token T_WHITESPACE">				</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5367"><br/></div><div id="line5368"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line5369"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">type</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'file'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5370"><pre><span class="token T_WHITESPACE">				</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5371"><br/></div><div id="line5372"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">2</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line5373"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">type</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'link'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5374"><pre><span class="token T_WHITESPACE">				</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5375"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5376"><pre><span class="token T_WHITESPACE">		</span><span class="token T_SWITCH">switch</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$compressionType</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5377"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5378"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line5379"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">compression</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'none'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5380"><pre><span class="token T_WHITESPACE">				</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5381"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line5382"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">compression</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'gzip'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5383"><pre><span class="token T_WHITESPACE">				</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5384"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">2</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line5385"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">compression</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'bzip2'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5386"><pre><span class="token T_WHITESPACE">				</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5387"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5388"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">permissions</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$header_data</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'perms'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5389"><br/></div><div id="line5390"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Find hard-coded banned files</span></pre></div><div id="line5391"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">basename</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">"."</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_OR">||</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">basename</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">".."</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5392"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5393"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$isBannedFile</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5394"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5395"><br/></div><div id="line5396"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Also try to find banned files passed in class configuration</span></pre></div><div id="line5397"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">count</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">skipFiles</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_GT">&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$isRenamed</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5398"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5399"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">in_array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">skipFiles</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5400"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5401"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$isBannedFile</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5402"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5403"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5404"><br/></div><div id="line5405"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// If we have a banned file, let's skip it</span></pre></div><div id="line5406"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$isBannedFile</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5407"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5408"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$done</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5409"><pre><span class="token T_WHITESPACE">			</span><span class="token T_WHILE">while</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$done</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5410"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5411"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// Read the Data Chunk Block header</span></pre></div><div id="line5412"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$binMiniHead</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">fread</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">8</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5413"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">in_array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$binMiniHead</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">3</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'JPF'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'JPE'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5414"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5415"><pre><span class="token T_WHITESPACE">					</span><span class="token T_COMMENT">// Not a Data Chunk Block header, I am done skipping the file</span></pre></div><div id="line5416"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">fseek</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_LNUMBER">8</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_STRING">SEEK_CUR</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_COMMENT">// Roll back the file pointer</span></pre></div><div id="line5417"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$done</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_COMMENT">// Mark as done</span></pre></div><div id="line5418"><pre><span class="token T_WHITESPACE">					</span><span class="token T_CONTINUE">continue</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_COMMENT">// Exit loop</span></pre></div><div id="line5419"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5420"><pre><span class="token T_WHITESPACE">				</span><span class="token T_ELSE">else</span></pre></div><div id="line5421"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5422"><pre><span class="token T_WHITESPACE">					</span><span class="token T_COMMENT">// Skip forward by the amount of compressed data</span></pre></div><div id="line5423"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$miniHead</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">unpack</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Vencsize/Vdecsize'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$binMiniHead</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5424"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">fseek</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$miniHead</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'encsize'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">SEEK_CUR</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5425"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5426"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5427"><br/></div><div id="line5428"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">currentPartOffset</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ftell</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5429"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">runState</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AK_STATE_DONE</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5430"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5431"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5432"><br/></div><div id="line5433"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Last chance to prepend a path to the filename</span></pre></div><div id="line5434"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">addPath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$isDirRenamed</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5435"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5436"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">addPath</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5437"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5438"><br/></div><div id="line5439"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Get the translated path name</span></pre></div><div id="line5440"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$restorePerms</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.restoreperms'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5441"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">type</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'file'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5442"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5443"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Regular file; ask the postproc engine to process its filename</span></pre></div><div id="line5444"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$restorePerms</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5445"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5446"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">realFile</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">postProcEngine</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">processFilename</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">permissions</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5447"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5448"><pre><span class="token T_WHITESPACE">			</span><span class="token T_ELSE">else</span></pre></div><div id="line5449"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5450"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">realFile</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">postProcEngine</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">processFilename</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5451"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5452"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5453"><pre><span class="token T_WHITESPACE">		</span><span class="token T_ELSEIF">elseif</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">type</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'dir'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5454"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5455"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$dir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5456"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">realFile</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$dir</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5457"><br/></div><div id="line5458"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Directory; just create it</span></pre></div><div id="line5459"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$restorePerms</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5460"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5461"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">postProcEngine</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">createDirRecursive</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">permissions</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5462"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5463"><pre><span class="token T_WHITESPACE">			</span><span class="token T_ELSE">else</span></pre></div><div id="line5464"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5465"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">postProcEngine</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">createDirRecursive</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0755</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5466"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5467"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">postProcEngine</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">processFilename</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">null</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5468"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5469"><pre><span class="token T_WHITESPACE">		</span><span class="token T_ELSE">else</span></pre></div><div id="line5470"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5471"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Symlink; do not post-process</span></pre></div><div id="line5472"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">postProcEngine</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">processFilename</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">null</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5473"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5474"><br/></div><div id="line5475"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">createDirectory</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5476"><br/></div><div id="line5477"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Header is read</span></pre></div><div id="line5478"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">runState</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AK_STATE_HEADER</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5479"><br/></div><div id="line5480"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">dataReadLength</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5481"><br/></div><div id="line5482"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5483"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5484"><br/></div><div id="line5485"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line5486"><pre><span class="token T_DOC_COMMENT">	 * Concrete classes must use this method to process file data. It must set $runState to AK_STATE_DATAREAD when</span></pre></div><div id="line5487"><pre><span class="token T_DOC_COMMENT">	 * it's finished processing the file data.</span></pre></div><div id="line5488"><pre><span class="token T_DOC_COMMENT">	 * @return bool True if processing the file data was successful, false if an error occured</span></pre></div><div id="line5489"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line5490"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">processFileData</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5491"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5492"><pre><span class="token T_WHITESPACE">		</span><span class="token T_SWITCH">switch</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">type</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5493"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5494"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'dir'</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line5495"><pre><span class="token T_WHITESPACE">				</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">processTypeDir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5496"><pre><span class="token T_WHITESPACE">				</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5497"><br/></div><div id="line5498"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'link'</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line5499"><pre><span class="token T_WHITESPACE">				</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">processTypeLink</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5500"><pre><span class="token T_WHITESPACE">				</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5501"><br/></div><div id="line5502"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'file'</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line5503"><pre><span class="token T_WHITESPACE">				</span><span class="token T_SWITCH">switch</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">compression</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5504"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5505"><pre><span class="token T_WHITESPACE">					</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'none'</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line5506"><pre><span class="token T_WHITESPACE">						</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">processTypeFileUncompressed</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5507"><pre><span class="token T_WHITESPACE">						</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5508"><br/></div><div id="line5509"><pre><span class="token T_WHITESPACE">					</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'gzip'</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line5510"><pre><span class="token T_WHITESPACE">					</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'bzip2'</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line5511"><pre><span class="token T_WHITESPACE">						</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">processTypeFileCompressedSimple</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5512"><pre><span class="token T_WHITESPACE">						</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5513"><br/></div><div id="line5514"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5515"><pre><span class="token T_WHITESPACE">				</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5516"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5517"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5518"><br/></div><div id="line5519"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PRIVATE">private</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">processTypeFileUncompressed</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5520"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5521"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Uncompressed files are being processed in small chunks, to avoid timeouts</span></pre></div><div id="line5522"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">dataReadLength</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.dryrun'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'0'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5523"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5524"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Before processing file data, ensure permissions are adequate</span></pre></div><div id="line5525"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setCorrectPermissions</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5526"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5527"><br/></div><div id="line5528"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Open the output file</span></pre></div><div id="line5529"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.dryrun'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'0'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5530"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5531"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$ignore</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.ignoreerrors'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_OR">||</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isIgnoredDirectory</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5532"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">dataReadLength</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5533"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$outfp</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">fopen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">realFile</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'wb'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5534"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_ELSE">else</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5535"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$outfp</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">fopen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">realFile</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'ab'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5536"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5537"><br/></div><div id="line5538"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Can we write to the file?</span></pre></div><div id="line5539"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$outfp</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_IDENTICAL">===</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$ignore</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5540"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// An error occured</span></pre></div><div id="line5541"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">sprintf</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'COULDNT_WRITE_FILE'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">realFile</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5542"><pre><span class="token T_WHITESPACE">				</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5543"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5544"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5545"><br/></div><div id="line5546"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Does the file have any data, at all?</span></pre></div><div id="line5547"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">uncompressed</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5548"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5549"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// No file data!</span></pre></div><div id="line5550"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.dryrun'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'0'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">is_resource</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$outfp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">fclose</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$outfp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5551"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">runState</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AK_STATE_DATAREAD</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5552"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5553"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5554"><pre><span class="token T_WHITESPACE">		</span><span class="token T_ELSE">else</span></pre></div><div id="line5555"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5556"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'An uncompressed file was detected; this is not supported by this archive extraction utility'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5557"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5558"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5559"><br/></div><div id="line5560"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5561"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5562"><br/></div><div id="line5563"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PRIVATE">private</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">processTypeFileCompressedSimple</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5564"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5565"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$timer</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">getTimer</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5566"><br/></div><div id="line5567"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Files are being processed in small chunks, to avoid timeouts</span></pre></div><div id="line5568"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">dataReadLength</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.dryrun'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'0'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5569"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5570"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Before processing file data, ensure permissions are adequate</span></pre></div><div id="line5571"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setCorrectPermissions</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5572"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5573"><br/></div><div id="line5574"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Open the output file</span></pre></div><div id="line5575"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.dryrun'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'0'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5576"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5577"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Open the output file</span></pre></div><div id="line5578"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$outfp</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">fopen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">realFile</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'wb'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5579"><br/></div><div id="line5580"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Can we write to the file?</span></pre></div><div id="line5581"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$ignore</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.ignoreerrors'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_OR">||</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isIgnoredDirectory</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5582"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$outfp</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_IDENTICAL">===</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$ignore</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5583"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// An error occured</span></pre></div><div id="line5584"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">sprintf</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'COULDNT_WRITE_FILE'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">realFile</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5585"><pre><span class="token T_WHITESPACE">				</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5586"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5587"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5588"><br/></div><div id="line5589"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Does the file have any data, at all?</span></pre></div><div id="line5590"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">uncompressed</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5591"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5592"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// No file data!</span></pre></div><div id="line5593"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.dryrun'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'0'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5594"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">is_resource</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$outfp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">fclose</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$outfp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5595"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">runState</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AK_STATE_DATAREAD</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5596"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5597"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5598"><br/></div><div id="line5599"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$leftBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">uncompressed</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">dataReadLength</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5600"><br/></div><div id="line5601"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Loop while there's data to write and enough time to do it</span></pre></div><div id="line5602"><pre><span class="token T_WHITESPACE">		</span><span class="token T_WHILE">while</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$leftBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_GT">&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$timer</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">getTimeLeft</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_GT">&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5603"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5604"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Read the mini header</span></pre></div><div id="line5605"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$binMiniHeader</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">fread</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">8</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5606"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$reallyReadBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">akstringlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$binMiniHeader</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5607"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$reallyReadBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">8</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5608"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5609"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// We read less than requested! Why? Did we hit local EOF?</span></pre></div><div id="line5610"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isEOF</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">true</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isEOF</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5611"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5612"><pre><span class="token T_WHITESPACE">					</span><span class="token T_COMMENT">// Yeap. Let's go to the next file</span></pre></div><div id="line5613"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">nextFile</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5614"><pre><span class="token T_WHITESPACE">					</span><span class="token T_COMMENT">// Retry reading the header</span></pre></div><div id="line5615"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$binMiniHeader</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">fread</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">8</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5616"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$reallyReadBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">akstringlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$binMiniHeader</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5617"><pre><span class="token T_WHITESPACE">					</span><span class="token T_COMMENT">// Still not enough data? If so, the archive is corrupt or missing parts.</span></pre></div><div id="line5618"><pre><span class="token T_WHITESPACE">					</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$reallyReadBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">8</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5619"><pre><span class="token T_WHITESPACE">						</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">_</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'ERR_CORRUPT_ARCHIVE'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5620"><pre><span class="token T_WHITESPACE">						</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5621"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5622"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5623"><pre><span class="token T_WHITESPACE">				</span><span class="token T_ELSE">else</span></pre></div><div id="line5624"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5625"><pre><span class="token T_WHITESPACE">					</span><span class="token T_COMMENT">// Nope. The archive is corrupt</span></pre></div><div id="line5626"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">_</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'ERR_CORRUPT_ARCHIVE'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5627"><pre><span class="token T_WHITESPACE">					</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5628"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5629"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5630"><br/></div><div id="line5631"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Read the encrypted data</span></pre></div><div id="line5632"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$miniHeader</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">unpack</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Vencsize/Vdecsize'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$binMiniHeader</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5633"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$toReadBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$miniHeader</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'encsize'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5634"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$data</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fread</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$toReadBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5635"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$reallyReadBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">akstringlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$data</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5636"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$reallyReadBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$toReadBytes</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5637"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5638"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// We read less than requested! Why? Did we hit local EOF?</span></pre></div><div id="line5639"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isEOF</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">true</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isEOF</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5640"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5641"><pre><span class="token T_WHITESPACE">					</span><span class="token T_COMMENT">// Yeap. Let's go to the next file</span></pre></div><div id="line5642"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">nextFile</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5643"><pre><span class="token T_WHITESPACE">					</span><span class="token T_COMMENT">// Read the rest of the data</span></pre></div><div id="line5644"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$toReadBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_MINUS_EQUAL">-=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$reallyReadBytes</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5645"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$restData</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fread</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$toReadBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5646"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$reallyReadBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">akstringlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$restData</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5647"><pre><span class="token T_WHITESPACE">					</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$reallyReadBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$toReadBytes</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5648"><pre><span class="token T_WHITESPACE">						</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">_</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'ERR_CORRUPT_ARCHIVE'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5649"><pre><span class="token T_WHITESPACE">						</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5650"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5651"><pre><span class="token T_WHITESPACE">					</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">akstringlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$data</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5652"><pre><span class="token T_WHITESPACE">						</span><span class="token T_VARIABLE">$data</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$restData</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5653"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_ELSE">else</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5654"><pre><span class="token T_WHITESPACE">						</span><span class="token T_VARIABLE">$data</span><span class="token T_WHITESPACE"> </span><span class="token T_CONCAT_EQUAL">.=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$restData</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5655"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5656"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5657"><pre><span class="token T_WHITESPACE">				</span><span class="token T_ELSE">else</span></pre></div><div id="line5658"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5659"><pre><span class="token T_WHITESPACE">					</span><span class="token T_COMMENT">// Nope. The archive is corrupt</span></pre></div><div id="line5660"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">_</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'ERR_CORRUPT_ARCHIVE'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5661"><pre><span class="token T_WHITESPACE">					</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5662"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5663"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5664"><br/></div><div id="line5665"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Decrypt the data</span></pre></div><div id="line5666"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$data</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKEncryptionAES</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">AESDecryptCBC</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$data</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">password</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">128</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5667"><br/></div><div id="line5668"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Is the length of the decrypted data less than expected?</span></pre></div><div id="line5669"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$data_length</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">akstringlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$data</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5670"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$data_length</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$miniHeader</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'decsize'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5671"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">_</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'ERR_INVALID_JPS_PASSWORD'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5672"><pre><span class="token T_WHITESPACE">				</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5673"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5674"><br/></div><div id="line5675"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Trim the data</span></pre></div><div id="line5676"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$data</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$data</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_VARIABLE">$miniHeader</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'decsize'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5677"><br/></div><div id="line5678"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Decompress</span></pre></div><div id="line5679"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$data</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">gzinflate</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$data</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5680"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$unc_len</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">akstringlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$data</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5681"><br/></div><div id="line5682"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Write the decrypted data</span></pre></div><div id="line5683"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.dryrun'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'0'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5684"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">is_resource</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$outfp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">fwrite</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$outfp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$data</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">akstringlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$data</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5685"><br/></div><div id="line5686"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Update the read length</span></pre></div><div id="line5687"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">dataReadLength</span><span class="token T_WHITESPACE"> </span><span class="token T_PLUS_EQUAL">+=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$unc_len</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5688"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$leftBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">uncompressed</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">dataReadLength</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5689"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5690"><br/></div><div id="line5691"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Close the file pointer</span></pre></div><div id="line5692"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.dryrun'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'0'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5693"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">is_resource</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$outfp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">fclose</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$outfp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5694"><br/></div><div id="line5695"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Was this a pre-timeout bail out?</span></pre></div><div id="line5696"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$leftBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_GT">&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5697"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5698"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">runState</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AK_STATE_DATA</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5699"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5700"><pre><span class="token T_WHITESPACE">		</span><span class="token T_ELSE">else</span></pre></div><div id="line5701"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5702"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Oh! We just finished!</span></pre></div><div id="line5703"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">runState</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AK_STATE_DATAREAD</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5704"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">dataReadLength</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5705"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5706"><br/></div><div id="line5707"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5708"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5709"><br/></div><div id="line5710"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line5711"><pre><span class="token T_DOC_COMMENT">	 * Process the file data of a link entry</span></pre></div><div id="line5712"><pre><span class="token T_DOC_COMMENT">	 * @return bool</span></pre></div><div id="line5713"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line5714"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PRIVATE">private</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">processTypeLink</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5715"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5716"><br/></div><div id="line5717"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Does the file have any data, at all?</span></pre></div><div id="line5718"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">uncompressed</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5719"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5720"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// No file data!</span></pre></div><div id="line5721"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">runState</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AK_STATE_DATAREAD</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5722"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5723"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5724"><br/></div><div id="line5725"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Read the mini header</span></pre></div><div id="line5726"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$binMiniHeader</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">fread</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">8</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5727"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$reallyReadBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">akstringlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$binMiniHeader</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5728"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$reallyReadBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">8</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5729"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5730"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// We read less than requested! Why? Did we hit local EOF?</span></pre></div><div id="line5731"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isEOF</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">true</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isEOF</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5732"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5733"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// Yeap. Let's go to the next file</span></pre></div><div id="line5734"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">nextFile</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5735"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// Retry reading the header</span></pre></div><div id="line5736"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$binMiniHeader</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">fread</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">8</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5737"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$reallyReadBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">akstringlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$binMiniHeader</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5738"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// Still not enough data? If so, the archive is corrupt or missing parts.</span></pre></div><div id="line5739"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$reallyReadBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">8</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5740"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">_</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'ERR_CORRUPT_ARCHIVE'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5741"><pre><span class="token T_WHITESPACE">					</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5742"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5743"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5744"><pre><span class="token T_WHITESPACE">			</span><span class="token T_ELSE">else</span></pre></div><div id="line5745"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5746"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// Nope. The archive is corrupt</span></pre></div><div id="line5747"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">_</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'ERR_CORRUPT_ARCHIVE'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5748"><pre><span class="token T_WHITESPACE">				</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5749"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5750"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5751"><br/></div><div id="line5752"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Read the encrypted data</span></pre></div><div id="line5753"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$miniHeader</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">unpack</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Vencsize/Vdecsize'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$binMiniHeader</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5754"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$toReadBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$miniHeader</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'encsize'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5755"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$data</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fread</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$toReadBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5756"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$reallyReadBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">akstringlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$data</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5757"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$reallyReadBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$toReadBytes</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5758"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5759"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// We read less than requested! Why? Did we hit local EOF?</span></pre></div><div id="line5760"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isEOF</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">true</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isEOF</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5761"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5762"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// Yeap. Let's go to the next file</span></pre></div><div id="line5763"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">nextFile</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5764"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// Read the rest of the data</span></pre></div><div id="line5765"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$toReadBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_MINUS_EQUAL">-=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$reallyReadBytes</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5766"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$restData</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fread</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fp</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$toReadBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5767"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$reallyReadBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">akstringlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$data</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5768"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$reallyReadBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$toReadBytes</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5769"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">_</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'ERR_CORRUPT_ARCHIVE'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5770"><pre><span class="token T_WHITESPACE">					</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5771"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5772"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$data</span><span class="token T_WHITESPACE"> </span><span class="token T_CONCAT_EQUAL">.=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$restData</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5773"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5774"><pre><span class="token T_WHITESPACE">			</span><span class="token T_ELSE">else</span></pre></div><div id="line5775"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5776"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// Nope. The archive is corrupt</span></pre></div><div id="line5777"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">_</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'ERR_CORRUPT_ARCHIVE'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5778"><pre><span class="token T_WHITESPACE">				</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5779"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5780"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5781"><br/></div><div id="line5782"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Decrypt the data</span></pre></div><div id="line5783"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$data</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKEncryptionAES</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">AESDecryptCBC</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$data</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">password</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">128</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5784"><br/></div><div id="line5785"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Is the length of the decrypted data less than expected?</span></pre></div><div id="line5786"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$data_length</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">akstringlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$data</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5787"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$data_length</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$miniHeader</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'decsize'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5788"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">_</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'ERR_INVALID_JPS_PASSWORD'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5789"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5790"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5791"><br/></div><div id="line5792"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Trim the data</span></pre></div><div id="line5793"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$data</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$data</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_VARIABLE">$miniHeader</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'decsize'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5794"><br/></div><div id="line5795"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Try to remove an existing file or directory by the same name</span></pre></div><div id="line5796"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">file_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">unlink</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">rmdir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5797"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Remove any trailing slash</span></pre></div><div id="line5798"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5799"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Create the symlink - only possible within PHP context. There's no support built in the FTP protocol, so no postproc use is possible here :(</span></pre></div><div id="line5800"><br/></div><div id="line5801"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.dryrun'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'0'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5802"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5803"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">symlink</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$data</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">file</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5804"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5805"><br/></div><div id="line5806"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">runState</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AK_STATE_DATAREAD</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5807"><br/></div><div id="line5808"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_COMMENT">// No matter if the link was created!</span></pre></div><div id="line5809"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5810"><br/></div><div id="line5811"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line5812"><pre><span class="token T_DOC_COMMENT">	 * Process the file data of a directory entry</span></pre></div><div id="line5813"><pre><span class="token T_DOC_COMMENT">	 * @return bool</span></pre></div><div id="line5814"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line5815"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PRIVATE">private</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">processTypeDir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5816"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5817"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Directory entries in the JPA do not have file data, therefore we're done processing the entry</span></pre></div><div id="line5818"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">runState</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AK_STATE_DATAREAD</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5819"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5820"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5821"><br/></div><div id="line5822"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line5823"><pre><span class="token T_DOC_COMMENT">	 * Creates the directory this file points to</span></pre></div><div id="line5824"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line5825"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">createDirectory</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5826"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5827"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.dryrun'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'0'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5828"><br/></div><div id="line5829"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Do we need to create a directory?</span></pre></div><div id="line5830"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$lastSlash</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strrpos</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">realFile</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5831"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$dirName</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">fileHeader</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">realFile</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$lastSlash</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5832"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$perms</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">flagRestorePermissions</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_QUESTION_MARK">?</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$retArray</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'permissions'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_COLON">:</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0755</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5833"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$ignore</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.ignoreerrors'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_OR">||</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">isIgnoredDirectory</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$dirName</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5834"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">postProcEngine</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">createDirRecursive</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$dirName</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$perms</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$ignore</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5835"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setError</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">sprintf</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'COULDNT_CREATE_DIR'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$dirName</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5836"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5837"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5838"><pre><span class="token T_WHITESPACE">		</span><span class="token T_ELSE">else</span></pre></div><div id="line5839"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5840"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5841"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5842"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5843"><pre><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5844"><br/></div><div id="line5845"><pre><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line5846"><pre><span class="token T_DOC_COMMENT"> * Akeeba Restore</span></pre></div><div id="line5847"><pre><span class="token T_DOC_COMMENT"> * A JSON-powered JPA, JPS and ZIP archive extraction library</span></pre></div><div id="line5848"><pre><span class="token T_DOC_COMMENT"> *</span></pre></div><div id="line5849"><pre><span class="token T_DOC_COMMENT"> * @copyright   2010-2014 Nicholas K. Dionysopoulos / Akeeba Ltd.</span></pre></div><div id="line5850"><pre><span class="token T_DOC_COMMENT"> * @license     GNU GPL v2 or - at your option - any later version</span></pre></div><div id="line5851"><pre><span class="token T_DOC_COMMENT"> * @package     akeebabackup</span></pre></div><div id="line5852"><pre><span class="token T_DOC_COMMENT"> * @subpackage  kickstart</span></pre></div><div id="line5853"><pre><span class="token T_DOC_COMMENT"> */</span></pre></div><div id="line5854"><br/></div><div id="line5855"><pre><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line5856"><pre><span class="token T_DOC_COMMENT"> * Timer class</span></pre></div><div id="line5857"><pre><span class="token T_DOC_COMMENT"> */</span></pre></div><div id="line5858"><pre><span class="token T_CLASS">class</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKCoreTimer</span><span class="token T_WHITESPACE"> </span><span class="token T_EXTENDS">extends</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKAbstractObject</span></pre></div><div id="line5859"><pre><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5860"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var int Maximum execution time allowance per step */</span></pre></div><div id="line5861"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PRIVATE">private</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$max_exec_time</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5862"><br/></div><div id="line5863"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var int Timestamp of execution start */</span></pre></div><div id="line5864"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PRIVATE">private</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$start_time</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5865"><br/></div><div id="line5866"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line5867"><pre><span class="token T_DOC_COMMENT">	 * Public constructor, creates the timer object and calculates the execution time limits</span></pre></div><div id="line5868"><pre><span class="token T_DOC_COMMENT">	 * @return AECoreTimer</span></pre></div><div id="line5869"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line5870"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">__construct</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5871"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5872"><pre><span class="token T_WHITESPACE">		</span><span class="token T_STRING">parent</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">__construct</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5873"><br/></div><div id="line5874"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Initialize start time</span></pre></div><div id="line5875"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">start_time</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">microtime_float</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5876"><br/></div><div id="line5877"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Get configured max time per step and bias</span></pre></div><div id="line5878"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$config_max_exec_time</span><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.tuning.max_exec_time'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">14</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5879"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$bias</span><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.tuning.run_time_bias'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">75</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_DIV">/</span><span class="token T_LNUMBER">100</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5880"><br/></div><div id="line5881"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Get PHP's maximum execution time (our upper limit)</span></pre></div><div id="line5882"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">function_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'ini_get'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5883"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5884"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$php_max_exec_time</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ini_get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">"maximum_execution_time"</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5885"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">is_numeric</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$php_max_exec_time</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_OR">||</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$php_max_exec_time</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5886"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// If we have no time limit, set a hard limit of about 10 seconds</span></pre></div><div id="line5887"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// (safe for Apache and IIS timeouts, verbose enough for users)</span></pre></div><div id="line5888"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$php_max_exec_time</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">14</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5889"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5890"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5891"><pre><span class="token T_WHITESPACE">		</span><span class="token T_ELSE">else</span></pre></div><div id="line5892"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5893"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// If ini_get is not available, use a rough default</span></pre></div><div id="line5894"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$php_max_exec_time</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">14</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5895"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5896"><br/></div><div id="line5897"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Apply an arbitrary correction to counter CMS load time</span></pre></div><div id="line5898"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$php_max_exec_time</span><span class="token T_DEC">--</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5899"><br/></div><div id="line5900"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Apply bias</span></pre></div><div id="line5901"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$php_max_exec_time</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$php_max_exec_time</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_MULT">*</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$bias</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5902"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$config_max_exec_time</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$config_max_exec_time</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_MULT">*</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$bias</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5903"><br/></div><div id="line5904"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Use the most appropriate time limit value</span></pre></div><div id="line5905"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$config_max_exec_time</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_GT">&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$php_max_exec_time</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5906"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5907"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">max_exec_time</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$php_max_exec_time</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5908"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5909"><pre><span class="token T_WHITESPACE">		</span><span class="token T_ELSE">else</span></pre></div><div id="line5910"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5911"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">max_exec_time</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$config_max_exec_time</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5912"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5913"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5914"><br/></div><div id="line5915"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line5916"><pre><span class="token T_DOC_COMMENT">	 * Wake-up function to reset internal timer when we get unserialized</span></pre></div><div id="line5917"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line5918"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">__wakeup</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5919"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5920"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Re-initialize start time on wake-up</span></pre></div><div id="line5921"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">start_time</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">microtime_float</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5922"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5923"><br/></div><div id="line5924"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line5925"><pre><span class="token T_DOC_COMMENT">	 * Gets the number of seconds left, before we hit the "must break" threshold</span></pre></div><div id="line5926"><pre><span class="token T_DOC_COMMENT">	 * @return float</span></pre></div><div id="line5927"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line5928"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">getTimeLeft</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5929"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5930"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">max_exec_time</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">getRunningTime</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5931"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5932"><br/></div><div id="line5933"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line5934"><pre><span class="token T_DOC_COMMENT">	 * Gets the time elapsed since object creation/unserialization, effectively how</span></pre></div><div id="line5935"><pre><span class="token T_DOC_COMMENT">	 * long Akeeba Engine has been processing data</span></pre></div><div id="line5936"><pre><span class="token T_DOC_COMMENT">	 * @return float</span></pre></div><div id="line5937"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line5938"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">getRunningTime</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5939"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5940"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">microtime_float</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">start_time</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5941"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5942"><br/></div><div id="line5943"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line5944"><pre><span class="token T_DOC_COMMENT">	 * Returns the current timestampt in decimal seconds</span></pre></div><div id="line5945"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line5946"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PRIVATE">private</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">microtime_float</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5947"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5948"><pre><span class="token T_WHITESPACE">		</span><span class="token T_LIST">list</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$usec</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$sec</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">explode</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">" "</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">microtime</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5949"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_DOUBLE_CAST">(float)</span><span class="token T_VARIABLE">$usec</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_PLUS">+</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_CAST">(float)</span><span class="token T_VARIABLE">$sec</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5950"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5951"><br/></div><div id="line5952"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line5953"><pre><span class="token T_DOC_COMMENT">	 * Enforce the minimum execution time</span></pre></div><div id="line5954"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line5955"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">enforce_min_exec_time</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5956"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5957"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Try to get a sane value for PHP's maximum_execution_time INI parameter</span></pre></div><div id="line5958"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">function_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'ini_get'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5959"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5960"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$php_max_exec</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">ini_get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">"maximum_execution_time"</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5961"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5962"><pre><span class="token T_WHITESPACE">		</span><span class="token T_ELSE">else</span></pre></div><div id="line5963"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5964"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$php_max_exec</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">10</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5965"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5966"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$php_max_exec</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">""</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_OR">||</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$php_max_exec</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5967"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$php_max_exec</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">10</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5968"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5969"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Decrease $php_max_exec time by 500 msec we need (approx.) to tear down</span></pre></div><div id="line5970"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// the application, as well as another 500msec added for rounding</span></pre></div><div id="line5971"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// error purposes. Also make sure this is never gonna be less than 0.</span></pre></div><div id="line5972"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$php_max_exec</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">max</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$php_max_exec</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_MULT">*</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">1000</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">1000</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5973"><br/></div><div id="line5974"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Get the "minimum execution time per step" Akeeba Backup configuration variable</span></pre></div><div id="line5975"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$minexectime</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.tuning.min_exec_time'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5976"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">is_numeric</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$minexectime</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$minexectime</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5977"><br/></div><div id="line5978"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Make sure we are not over PHP's time limit!</span></pre></div><div id="line5979"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$minexectime</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_GT">&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$php_max_exec</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$minexectime</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$php_max_exec</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5980"><br/></div><div id="line5981"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Get current running time</span></pre></div><div id="line5982"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$elapsed_time</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">getRunningTime</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_MULT">*</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">1000</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5983"><br/></div><div id="line5984"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Only run a sleep delay if we haven't reached the minexectime execution time</span></pre></div><div id="line5985"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$minexectime</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_GT">&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$elapsed_time</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$elapsed_time</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_GT">&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5986"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5987"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$sleep_msec</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$minexectime</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$elapsed_time</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5988"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">function_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'usleep'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5989"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5990"><pre><span class="token T_WHITESPACE">				</span><span class="token T_STRING">usleep</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_LNUMBER">1000</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_MULT">*</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$sleep_msec</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5991"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5992"><pre><span class="token T_WHITESPACE">			</span><span class="token T_ELSEIF">elseif</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">function_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'time_nanosleep'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5993"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line5994"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$sleep_sec</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">floor</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$sleep_msec</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DIV">/</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">1000</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5995"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$sleep_nsec</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">1000000</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_MULT">*</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$sleep_msec</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$sleep_sec</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_MULT">*</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">1000</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5996"><pre><span class="token T_WHITESPACE">				</span><span class="token T_STRING">time_nanosleep</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$sleep_sec</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$sleep_nsec</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line5997"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line5998"><pre><span class="token T_WHITESPACE">			</span><span class="token T_ELSEIF">elseif</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">function_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'time_sleep_until'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line5999"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6000"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$until_timestamp</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">time</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_PLUS">+</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$sleep_msec</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DIV">/</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">1000</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6001"><pre><span class="token T_WHITESPACE">				</span><span class="token T_STRING">time_sleep_until</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$until_timestamp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6002"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6003"><pre><span class="token T_WHITESPACE">			</span><span class="token T_ELSEIF">elseif</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">function_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'sleep'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6004"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6005"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$sleep_sec</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">ceil</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$sleep_msec</span><span class="token T_PHPDOX_DIV">/</span><span class="token T_LNUMBER">1000</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6006"><pre><span class="token T_WHITESPACE">				</span><span class="token T_STRING">sleep</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$sleep_sec</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6007"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6008"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6009"><pre><span class="token T_WHITESPACE">		</span><span class="token T_ELSEIF">elseif</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$elapsed_time</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_GT">&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6010"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6011"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// No sleep required, even if user configured us to be able to do so.</span></pre></div><div id="line6012"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6013"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6014"><br/></div><div id="line6015"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line6016"><pre><span class="token T_DOC_COMMENT">	 * Reset the timer. It should only be used in CLI mode!</span></pre></div><div id="line6017"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line6018"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">resetTime</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6019"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6020"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">start_time</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">microtime_float</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6021"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6022"><pre><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6023"><br/></div><div id="line6024"><pre><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line6025"><pre><span class="token T_DOC_COMMENT"> * Akeeba Restore</span></pre></div><div id="line6026"><pre><span class="token T_DOC_COMMENT"> * A JSON-powered JPA, JPS and ZIP archive extraction library</span></pre></div><div id="line6027"><pre><span class="token T_DOC_COMMENT"> *</span></pre></div><div id="line6028"><pre><span class="token T_DOC_COMMENT"> * @copyright   2010-2014 Nicholas K. Dionysopoulos / Akeeba Ltd.</span></pre></div><div id="line6029"><pre><span class="token T_DOC_COMMENT"> * @license     GNU GPL v2 or - at your option - any later version</span></pre></div><div id="line6030"><pre><span class="token T_DOC_COMMENT"> * @package     akeebabackup</span></pre></div><div id="line6031"><pre><span class="token T_DOC_COMMENT"> * @subpackage  kickstart</span></pre></div><div id="line6032"><pre><span class="token T_DOC_COMMENT"> */</span></pre></div><div id="line6033"><br/></div><div id="line6034"><pre><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line6035"><pre><span class="token T_DOC_COMMENT"> * A filesystem scanner which uses opendir()</span></pre></div><div id="line6036"><pre><span class="token T_DOC_COMMENT"> */</span></pre></div><div id="line6037"><pre><span class="token T_CLASS">class</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKUtilsLister</span><span class="token T_WHITESPACE"> </span><span class="token T_EXTENDS">extends</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKAbstractObject</span></pre></div><div id="line6038"><pre><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6039"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_STRING">getFiles</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$folder</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$pattern</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'*'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6040"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6041"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Initialize variables</span></pre></div><div id="line6042"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$arr</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6043"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$false</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6044"><br/></div><div id="line6045"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">is_dir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$folder</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6046"><br/></div><div id="line6047"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$handle</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">opendir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$folder</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6048"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// If directory is not accessible, just return FALSE</span></pre></div><div id="line6049"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$handle</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_IDENTICAL">===</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">FALSE</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6050"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setWarning</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Unreadable directory '</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$folder</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6051"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6052"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6053"><br/></div><div id="line6054"><pre><span class="token T_WHITESPACE">		</span><span class="token T_WHILE">while</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$file</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">readdir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$handle</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_NOT_IDENTICAL">!==</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6055"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6056"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">fnmatch</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$pattern</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$file</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_CONTINUE">continue</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6057"><br/></div><div id="line6058"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$file</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_NOT_EQUAL">!=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'.'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$file</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_NOT_EQUAL">!=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'..'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6059"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6060"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$ds</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$folder</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_OR">||</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$folder</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_OR">||</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$folder</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_OR">||</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$folder</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">DIRECTORY_SEPARATOR</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_QUESTION_MARK">?</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_COLON">:</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">DIRECTORY_SEPARATOR</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6061"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$dir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$folder</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$ds</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$file</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6062"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$isDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">is_dir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$dir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6063"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$isDir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6064"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$arr</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$dir</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6065"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6066"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6067"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6068"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">closedir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$handle</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6069"><br/></div><div id="line6070"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$arr</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6071"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6072"><br/></div><div id="line6073"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_STRING">getFolders</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$folder</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$pattern</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'*'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6074"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6075"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Initialize variables</span></pre></div><div id="line6076"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$arr</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6077"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$false</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6078"><br/></div><div id="line6079"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">is_dir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$folder</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6080"><br/></div><div id="line6081"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$handle</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">opendir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$folder</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6082"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// If directory is not accessible, just return FALSE</span></pre></div><div id="line6083"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$handle</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_IDENTICAL">===</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">FALSE</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6084"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setWarning</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Unreadable directory '</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$folder</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6085"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6086"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6087"><br/></div><div id="line6088"><pre><span class="token T_WHITESPACE">		</span><span class="token T_WHILE">while</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$file</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">readdir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$handle</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_NOT_IDENTICAL">!==</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6089"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6090"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">fnmatch</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$pattern</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$file</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_CONTINUE">continue</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6091"><br/></div><div id="line6092"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$file</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_NOT_EQUAL">!=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'.'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$file</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_NOT_EQUAL">!=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'..'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6093"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6094"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$ds</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$folder</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_OR">||</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$folder</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_OR">||</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$folder</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_OR">||</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$folder</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">DIRECTORY_SEPARATOR</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_QUESTION_MARK">?</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_COLON">:</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">DIRECTORY_SEPARATOR</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6095"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$dir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$folder</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$ds</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$file</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6096"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$isDir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">is_dir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$dir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6097"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$isDir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6098"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$arr</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$dir</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6099"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6100"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6101"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6102"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">closedir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$handle</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6103"><br/></div><div id="line6104"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$arr</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6105"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6106"><pre><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6107"><br/></div><div id="line6108"><pre><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line6109"><pre><span class="token T_DOC_COMMENT"> * Akeeba Restore</span></pre></div><div id="line6110"><pre><span class="token T_DOC_COMMENT"> * A JSON-powered JPA, JPS and ZIP archive extraction library</span></pre></div><div id="line6111"><pre><span class="token T_DOC_COMMENT"> *</span></pre></div><div id="line6112"><pre><span class="token T_DOC_COMMENT"> * @copyright   2010-2014 Nicholas K. Dionysopoulos / Akeeba Ltd.</span></pre></div><div id="line6113"><pre><span class="token T_DOC_COMMENT"> * @license     GNU GPL v2 or - at your option - any later version</span></pre></div><div id="line6114"><pre><span class="token T_DOC_COMMENT"> * @package     akeebabackup</span></pre></div><div id="line6115"><pre><span class="token T_DOC_COMMENT"> * @subpackage  kickstart</span></pre></div><div id="line6116"><pre><span class="token T_DOC_COMMENT"> */</span></pre></div><div id="line6117"><br/></div><div id="line6118"><pre><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line6119"><pre><span class="token T_DOC_COMMENT"> * A simple INI-based i18n engine</span></pre></div><div id="line6120"><pre><span class="token T_DOC_COMMENT"> */</span></pre></div><div id="line6121"><br/></div><div id="line6122"><pre><span class="token T_CLASS">class</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKText</span><span class="token T_WHITESPACE"> </span><span class="token T_EXTENDS">extends</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKAbstractObject</span></pre></div><div id="line6123"><pre><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6124"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line6125"><pre><span class="token T_DOC_COMMENT">	 * The default (en_GB) translation used when no other translation is available</span></pre></div><div id="line6126"><pre><span class="token T_DOC_COMMENT">	 * @var array</span></pre></div><div id="line6127"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line6128"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PRIVATE">private</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$default_translation</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span></pre></div><div id="line6129"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'AUTOMODEON'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Auto-mode enabled'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6130"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'ERR_NOT_A_JPA_FILE'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'The file is not a JPA archive'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6131"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'ERR_CORRUPT_ARCHIVE'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'The archive file is corrupt, truncated or archive parts are missing'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6132"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'ERR_INVALID_LOGIN'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Invalid login'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6133"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'COULDNT_CREATE_DIR'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Could not create %s folder'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6134"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'COULDNT_WRITE_FILE'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Could not open %s for writing.'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6135"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'WRONG_FTP_HOST'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Wrong FTP host or port'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6136"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'WRONG_FTP_USER'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Wrong FTP username or password'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6137"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'WRONG_FTP_PATH1'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Wrong FTP initial directory - the directory doesn\'t exist'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6138"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'FTP_CANT_CREATE_DIR'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Could not create directory %s'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6139"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'FTP_TEMPDIR_NOT_WRITABLE'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Could not find or create a writable temporary directory'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6140"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'SFTP_TEMPDIR_NOT_WRITABLE'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Could not find or create a writable temporary directory'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6141"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'FTP_COULDNT_UPLOAD'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Could not upload %s'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6142"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'THINGS_HEADER'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Things you should know about Akeeba Kickstart'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6143"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'THINGS_01'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Kickstart is not an installer. It is an archive extraction tool. The actual installer was put inside the archive file at backup time.'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6144"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'THINGS_02'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Kickstart is not the only way to extract the backup archive. You can use Akeeba eXtract Wizard and upload the extracted files using FTP instead.'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6145"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'THINGS_03'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Kickstart is bound by your server\'s configuration. As such, it may not work at all.'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6146"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'THINGS_04'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'You should download and upload your archive files using FTP in Binary transfer mode. Any other method could lead to a corrupt backup archive and restoration failure.'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6147"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'THINGS_05'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Post-restoration site load errors are usually caused by .htaccess or php.ini directives. You should understand that blank pages, 404 and 500 errors can usually be worked around by editing the aforementioned files. It is not our job to mess with your configuration files, because this could be dangerous for your site.'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6148"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'THINGS_06'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Kickstart overwrites files without a warning. If you are not sure that you are OK with that do not continue.'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6149"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'THINGS_07'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Trying to restore to the temporary URL of a cPanel host (e.g. http://1.2.3.4/~username) will lead to restoration failure and your site will appear to be not working. This is normal and it\'s just how your server and CMS software work.'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6150"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'THINGS_08'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'You are supposed to read the documentation before using this software. Most issues can be avoided, or easily worked around, by understanding how this software works.'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6151"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'THINGS_09'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'This text does not imply that there is a problem detected. It is standard text displayed every time you launch Kickstart.'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6152"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'CLOSE_LIGHTBOX'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Click here or press ESC to close this message'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6153"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'SELECT_ARCHIVE'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Select a backup archive'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6154"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'ARCHIVE_FILE'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Archive file:'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6155"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'SELECT_EXTRACTION'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Select an extraction method'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6156"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'WRITE_TO_FILES'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Write to files:'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6157"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'WRITE_HYBRID'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Hybrid (use FTP only if needed)'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6158"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'WRITE_DIRECTLY'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Directly'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6159"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'WRITE_FTP'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Use FTP for all files'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6160"><pre><span class="token T_WHITESPACE">        </span><span class="token T_CONSTANT_ENCAPSED_STRING">'WRITE_SFTP'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Use SFTP for all files'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6161"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'FTP_HOST'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'(S)FTP host name:'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6162"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'FTP_PORT'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'(S)FTP port:'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6163"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'FTP_FTPS'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Use FTP over SSL (FTPS)'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6164"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'FTP_PASSIVE'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Use FTP Passive Mode'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6165"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'FTP_USER'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'(S)FTP user name:'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6166"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'FTP_PASS'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'(S)FTP password:'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6167"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'FTP_DIR'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'(S)FTP directory:'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6168"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'FTP_TEMPDIR'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Temporary directory:'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6169"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'FTP_CONNECTION_OK'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'FTP Connection Established'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6170"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'SFTP_CONNECTION_OK'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'SFTP Connection Established'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6171"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'FTP_CONNECTION_FAILURE'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'The FTP Connection Failed'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6172"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'SFTP_CONNECTION_FAILURE'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'The SFTP Connection Failed'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6173"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'FTP_TEMPDIR_WRITABLE'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'The temporary directory is writable.'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6174"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'FTP_TEMPDIR_UNWRITABLE'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'The temporary directory is not writable. Please check the permissions.'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6175"><pre><span class="token T_WHITESPACE">        </span><span class="token T_CONSTANT_ENCAPSED_STRING">'FTPBROWSER_ERROR_HOSTNAME'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">"Invalid FTP host or port"</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6176"><pre><span class="token T_WHITESPACE">        </span><span class="token T_CONSTANT_ENCAPSED_STRING">'FTPBROWSER_ERROR_USERPASS'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">"Invalid FTP username or password"</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6177"><pre><span class="token T_WHITESPACE">        </span><span class="token T_CONSTANT_ENCAPSED_STRING">'FTPBROWSER_ERROR_NOACCESS'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">"Directory doesn't exist or you don't have enough permissions to access it"</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6178"><pre><span class="token T_WHITESPACE">        </span><span class="token T_CONSTANT_ENCAPSED_STRING">'FTPBROWSER_ERROR_UNSUPPORTED'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">"Sorry, your FTP server doesn't support our FTP directory browser."</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6179"><pre><span class="token T_WHITESPACE">        </span><span class="token T_CONSTANT_ENCAPSED_STRING">'FTPBROWSER_LBL_GOPARENT'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">"&amp;lt;up one level&amp;gt;"</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6180"><pre><span class="token T_WHITESPACE">        </span><span class="token T_CONSTANT_ENCAPSED_STRING">'FTPBROWSER_LBL_INSTRUCTIONS'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Click on a directory to navigate into it. Click on OK to select that directory, Cancel to abort the procedure.'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6181"><pre><span class="token T_WHITESPACE">        </span><span class="token T_CONSTANT_ENCAPSED_STRING">'FTPBROWSER_LBL_ERROR'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'An error occurred'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6182"><pre><span class="token T_WHITESPACE">        </span><span class="token T_CONSTANT_ENCAPSED_STRING">'SFTP_NO_SSH2'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Your web server does not have the SSH2 PHP module, therefore can not connect to SFTP servers.'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6183"><pre><span class="token T_WHITESPACE">        </span><span class="token T_CONSTANT_ENCAPSED_STRING">'SFTP_NO_FTP_SUPPORT'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Your SSH server does not allow SFTP connections'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6184"><pre><span class="token T_WHITESPACE">        </span><span class="token T_CONSTANT_ENCAPSED_STRING">'SFTP_WRONG_USER'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Wrong SFTP username or password'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6185"><pre><span class="token T_WHITESPACE">        </span><span class="token T_CONSTANT_ENCAPSED_STRING">'SFTP_WRONG_STARTING_DIR'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'You must supply a valid absolute path'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6186"><pre><span class="token T_WHITESPACE">        </span><span class="token T_CONSTANT_ENCAPSED_STRING">'SFTPBROWSER_ERROR_NOACCESS'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">"Directory doesn't exist or you don't have enough permissions to access it"</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6187"><pre><span class="token T_WHITESPACE">        </span><span class="token T_CONSTANT_ENCAPSED_STRING">'SFTP_COULDNT_UPLOAD'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Could not upload %s'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6188"><pre><span class="token T_WHITESPACE">        </span><span class="token T_CONSTANT_ENCAPSED_STRING">'SFTP_CANT_CREATE_DIR'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Could not create directory %s'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6189"><pre><span class="token T_WHITESPACE">        </span><span class="token T_CONSTANT_ENCAPSED_STRING">'UI-ROOT'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'&amp;lt;root&amp;gt;'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6190"><pre><span class="token T_WHITESPACE">        </span><span class="token T_CONSTANT_ENCAPSED_STRING">'CONFIG_UI_FTPBROWSER_TITLE'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'FTP Directory Browser'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6191"><pre><span class="token T_WHITESPACE">        </span><span class="token T_CONSTANT_ENCAPSED_STRING">'FTP_BROWSE'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Browse'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6192"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'BTN_CHECK'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Check'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6193"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'BTN_RESET'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Reset'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6194"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'BTN_TESTFTPCON'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Test FTP connection'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6195"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'BTN_TESTSFTPCON'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Test SFTP connection'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6196"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'BTN_GOTOSTART'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Start over'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6197"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'FINE_TUNE'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Fine tune'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6198"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'MIN_EXEC_TIME'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Minimum execution time:'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6199"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'MAX_EXEC_TIME'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Maximum execution time:'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6200"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'SECONDS_PER_STEP'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'seconds per step'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6201"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'EXTRACT_FILES'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Extract files'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6202"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'BTN_START'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Start'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6203"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'EXTRACTING'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Extracting'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6204"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'DO_NOT_CLOSE_EXTRACT'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Do not close this window while the extraction is in progress'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6205"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'RESTACLEANUP'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Restoration and Clean Up'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6206"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'BTN_RUNINSTALLER'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Run the Installer'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6207"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'BTN_CLEANUP'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Clean Up'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6208"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'BTN_SITEFE'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Visit your site\'s front-end'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6209"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'BTN_SITEBE'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Visit your site\'s back-end'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6210"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'WARNINGS'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Extraction Warnings'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6211"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'ERROR_OCCURED'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'An error occured'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6212"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'STEALTH_MODE'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Stealth mode'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6213"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'STEALTH_URL'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'HTML file to show to web visitors'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6214"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'ERR_NOT_A_JPS_FILE'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'The file is not a JPA archive'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6215"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'ERR_INVALID_JPS_PASSWORD'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'The password you gave is wrong or the archive is corrupt'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6216"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'JPS_PASSWORD'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Archive Password (for JPS files)'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6217"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'INVALID_FILE_HEADER'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Invalid header in archive file, part %s, offset %s'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6218"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'NEEDSOMEHELPKS'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Want some help to use this tool? Read this first:'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6219"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'QUICKSTART'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Quick Start Guide'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6220"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'CANTGETITTOWORK'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Can\'t get it to work? Click me!'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6221"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'NOARCHIVESCLICKHERE'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'No archives detected. Click here for troubleshooting instructions.'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6222"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'POSTRESTORATIONTROUBLESHOOTING'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Something not working after the restoration? Click here for troubleshooting instructions.'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6223"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'UPDATE_HEADER'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'An updated version of Akeeba Kickstart (&lt;span id="update-version"&gt;unknown&lt;/span&gt;) is available!'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6224"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'UPDATE_NOTICE'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'You are advised to always use the latest version of Akeeba Kickstart available. Older versions may be subject to bugs and will not be supported.'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6225"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'UPDATE_DLNOW'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Download now'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6226"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'UPDATE_MOREINFO'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'More information'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6227"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'IGNORE_MOST_ERRORS'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Ignore most errors'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6228"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'WRONG_FTP_PATH2'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Wrong FTP initial directory - the directory doesn\'t correspond to your site\'s web root'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6229"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'ARCHIVE_DIRECTORY'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Archive directory:'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6230"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'RELOAD_ARCHIVES'</span><span class="token T_WHITESPACE">	</span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'Reload'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6231"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'CONFIG_UI_SFTPBROWSER_TITLE'</span><span class="token T_WHITESPACE">	</span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'SFTP Directory Browser'</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6232"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6233"><br/></div><div id="line6234"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line6235"><pre><span class="token T_DOC_COMMENT">	 * The array holding the translation keys</span></pre></div><div id="line6236"><pre><span class="token T_DOC_COMMENT">	 * @var array</span></pre></div><div id="line6237"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line6238"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PRIVATE">private</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$strings</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6239"><br/></div><div id="line6240"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line6241"><pre><span class="token T_DOC_COMMENT">	 * The currently detected language (ISO code)</span></pre></div><div id="line6242"><pre><span class="token T_DOC_COMMENT">	 * @var string</span></pre></div><div id="line6243"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line6244"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PRIVATE">private</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$language</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6245"><br/></div><div id="line6246"><pre><span class="token T_WHITESPACE">	</span><span class="token T_COMMENT">/*</span></pre></div><div id="line6247"><pre><span class="token T_COMMENT">	 * Initializes the translation engine</span></pre></div><div id="line6248"><pre><span class="token T_COMMENT">	 * @return AKText</span></pre></div><div id="line6249"><pre><span class="token T_COMMENT">	 */</span></pre></div><div id="line6250"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">__construct</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6251"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6252"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Start with the default translation</span></pre></div><div id="line6253"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">strings</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">default_translation</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6254"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Try loading the translation file in English, if it exists</span></pre></div><div id="line6255"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">loadTranslation</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'en-GB'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6256"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Try loading the translation file in the browser's preferred language, if it exists</span></pre></div><div id="line6257"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">getBrowserLanguage</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6258"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">is_null</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">language</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6259"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6260"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">loadTranslation</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6261"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6262"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6263"><br/></div><div id="line6264"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line6265"><pre><span class="token T_DOC_COMMENT">	 * Singleton pattern for Language</span></pre></div><div id="line6266"><pre><span class="token T_DOC_COMMENT">	 * @return AKText The global AKText instance</span></pre></div><div id="line6267"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line6268"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_STATIC">static</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_STRING">getInstance</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6269"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6270"><pre><span class="token T_WHITESPACE">		</span><span class="token T_STATIC">static</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$instance</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6271"><br/></div><div id="line6272"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">is_object</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$instance</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6273"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6274"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$instance</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_NEW">new</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKText</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6275"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6276"><br/></div><div id="line6277"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$instance</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6278"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6279"><br/></div><div id="line6280"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_STATIC">static</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">_</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$string</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6281"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6282"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$text</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">getInstance</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6283"><br/></div><div id="line6284"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$key</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strtoupper</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$string</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6285"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$key</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$key</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'_'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_QUESTION_MARK">?</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$key</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_COLON">:</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$key</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6286"><br/></div><div id="line6287"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_ISSET">isset</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$text</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">strings</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$key</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6288"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6289"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$string</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$text</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">strings</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$key</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6290"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6291"><pre><span class="token T_WHITESPACE">		</span><span class="token T_ELSE">else</span></pre></div><div id="line6292"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6293"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">defined</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$string</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6294"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6295"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$string</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">constant</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$string</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6296"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6297"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6298"><br/></div><div id="line6299"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$string</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6300"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6301"><br/></div><div id="line6302"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_STATIC">static</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">sprintf</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$key</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6303"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6304"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$text</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">getInstance</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6305"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$args</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">func_get_args</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6306"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">count</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$args</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_GT">&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6307"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$args</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$text</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">_</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$args</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6308"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">call_user_func_array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'sprintf'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$args</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6309"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6310"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6311"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6312"><br/></div><div id="line6313"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">dumpLanguage</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6314"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6315"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$out</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6316"><pre><span class="token T_WHITESPACE">		</span><span class="token T_FOREACH">foreach</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">strings</span><span class="token T_WHITESPACE"> </span><span class="token T_AS">as</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$key</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6317"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6318"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$out</span><span class="token T_WHITESPACE"> </span><span class="token T_CONCAT_EQUAL">.=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOUBLE_QUOTES">"</span><span class="token T_VARIABLE">$key</span><span class="token T_ENCAPSED_AND_WHITESPACE">=</span><span class="token T_VARIABLE">$value</span><span class="token T_ENCAPSED_AND_WHITESPACE">\n</span><span class="token T_PHPDOX_DOUBLE_QUOTES">"</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6319"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6320"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$out</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6321"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6322"><br/></div><div id="line6323"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">asJavascript</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6324"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6325"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$out</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6326"><pre><span class="token T_WHITESPACE">		</span><span class="token T_FOREACH">foreach</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">strings</span><span class="token T_WHITESPACE"> </span><span class="token T_AS">as</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$key</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6327"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6328"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$key</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">addcslashes</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$key</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'\\\'"'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6329"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$value</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">addcslashes</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'\\\'"'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6330"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$out</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$out</span><span class="token T_WHITESPACE"> </span><span class="token T_CONCAT_EQUAL">.=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">",\n"</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6331"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$out</span><span class="token T_WHITESPACE"> </span><span class="token T_CONCAT_EQUAL">.=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOUBLE_QUOTES">"</span><span class="token T_ENCAPSED_AND_WHITESPACE">'</span><span class="token T_VARIABLE">$key</span><span class="token T_ENCAPSED_AND_WHITESPACE">':\t'</span><span class="token T_VARIABLE">$value</span><span class="token T_ENCAPSED_AND_WHITESPACE">'</span><span class="token T_PHPDOX_DOUBLE_QUOTES">"</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6332"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6333"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$out</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6334"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6335"><br/></div><div id="line6336"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">resetTranslation</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6337"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6338"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">strings</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">default_translation</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6339"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6340"><br/></div><div id="line6341"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">getBrowserLanguage</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6342"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6343"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Detection code from Full Operating system language detection, by Harald Hope</span></pre></div><div id="line6344"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Retrieved from http://techpatterns.com/downloads/php_language_detection.php</span></pre></div><div id="line6345"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$user_languages</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6346"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">//check to see if language is set</span></pre></div><div id="line6347"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_ISSET">isset</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$_SERVER</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">"HTTP_ACCEPT_LANGUAGE"</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6348"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6349"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$languages</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strtolower</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$_SERVER</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">"HTTP_ACCEPT_LANGUAGE"</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6350"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// $languages = ' fr-ch;q=0.3, da, en-us;q=0.8, en;q=0.5, fr;q=0.3';</span></pre></div><div id="line6351"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// need to remove spaces from strings to avoid error</span></pre></div><div id="line6352"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$languages</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">str_replace</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">' '</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$languages</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6353"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$languages</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">explode</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">","</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$languages</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6354"><br/></div><div id="line6355"><pre><span class="token T_WHITESPACE">			</span><span class="token T_FOREACH">foreach</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$languages</span><span class="token T_WHITESPACE"> </span><span class="token T_AS">as</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$language_list</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6356"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6357"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// pull out the language, place languages into array of full and primary</span></pre></div><div id="line6358"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// string structure:</span></pre></div><div id="line6359"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$temp_array</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6360"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// slice out the part before ; on first step, the part before - on second, place into array</span></pre></div><div id="line6361"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$temp_array</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$language_list</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strcspn</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$language_list</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">';'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_COMMENT">//full language</span></pre></div><div id="line6362"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$temp_array</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$language_list</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">2</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_COMMENT">// cut out primary language</span></pre></div><div id="line6363"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$temp_array</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">5</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$temp_array</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">2</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'-'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_OR">||</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$temp_array</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">2</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'_'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6364"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6365"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$langLocation</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strtoupper</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$temp_array</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">3</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">2</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6366"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$temp_array</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$temp_array</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'-'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$langLocation</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6367"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6368"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">//place this array into main $user_languages language array</span></pre></div><div id="line6369"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$user_languages</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$temp_array</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6370"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6371"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6372"><pre><span class="token T_WHITESPACE">		</span><span class="token T_ELSE">else</span><span class="token T_COMMENT">// if no languages found</span></pre></div><div id="line6373"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6374"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$user_languages</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_COMMENT">//return blank array.</span></pre></div><div id="line6375"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6376"><br/></div><div id="line6377"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">language</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6378"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$basename</span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_STRING">basename</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_FILE">__FILE__</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'.php'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'.ini'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6379"><br/></div><div id="line6380"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Try to match main language part of the filename, irrespective of the location, e.g. de_DE will do if de_CH doesn't exist.</span></pre></div><div id="line6381"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">class_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'AKUtilsLister'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6382"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6383"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$fs</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_NEW">new</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKUtilsLister</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6384"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$iniFiles</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$fs</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">getFiles</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">KSROOTDIR</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'*.'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$basename</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6385"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$iniFiles</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$basename</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_NOT_EQUAL">!=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.ini'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6386"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$basename</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.ini'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6387"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$iniFiles</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$fs</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">getFiles</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">KSROOTDIR</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'*.'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$basename</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6388"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6389"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6390"><pre><span class="token T_WHITESPACE">		</span><span class="token T_ELSE">else</span></pre></div><div id="line6391"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6392"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$iniFiles</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6393"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6394"><br/></div><div id="line6395"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">is_array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$iniFiles</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6396"><pre><span class="token T_WHITESPACE">			</span><span class="token T_FOREACH">foreach</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$user_languages</span><span class="token T_WHITESPACE"> </span><span class="token T_AS">as</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$languageStruct</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6397"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6398"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">is_null</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">language</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6399"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6400"><pre><span class="token T_WHITESPACE">					</span><span class="token T_COMMENT">// Get files matching the main lang part</span></pre></div><div id="line6401"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$iniFiles</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$fs</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">getFiles</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">KSROOTDIR</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$languageStruct</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'-??.'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$basename</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6402"><pre><span class="token T_WHITESPACE">					</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">count</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$iniFiles</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_GT">&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6403"><pre><span class="token T_WHITESPACE">						</span><span class="token T_VARIABLE">$filename</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$iniFiles</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6404"><pre><span class="token T_WHITESPACE">						</span><span class="token T_VARIABLE">$filename</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$filename</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">KSROOTDIR</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_PLUS">+</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6405"><pre><span class="token T_WHITESPACE">						</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">language</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$filename</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">5</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6406"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_ELSE">else</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6407"><pre><span class="token T_WHITESPACE">						</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">language</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6408"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6409"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6410"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6411"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6412"><br/></div><div id="line6413"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">is_null</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">language</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6414"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Try to find a full language match</span></pre></div><div id="line6415"><pre><span class="token T_WHITESPACE">			</span><span class="token T_FOREACH">foreach</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$user_languages</span><span class="token T_WHITESPACE"> </span><span class="token T_AS">as</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$languageStruct</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6416"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6417"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">file_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$languageStruct</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'.'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$basename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">is_null</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">language</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6418"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">language</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$languageStruct</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6419"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_ELSE">else</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6420"><br/></div><div id="line6421"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6422"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6423"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_ELSE">else</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6424"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Do we have an exact match?</span></pre></div><div id="line6425"><pre><span class="token T_WHITESPACE">			</span><span class="token T_FOREACH">foreach</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$user_languages</span><span class="token T_WHITESPACE"> </span><span class="token T_AS">as</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$languageStruct</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6426"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6427"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">language</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$languageStruct</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$languageStruct</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6428"><pre><span class="token T_WHITESPACE">					</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">file_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$languageStruct</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'.'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$basename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6429"><pre><span class="token T_WHITESPACE">						</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">language</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$languageStruct</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6430"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6431"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6432"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6433"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6434"><br/></div><div id="line6435"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Now, scan for full language based on the partial match</span></pre></div><div id="line6436"><br/></div><div id="line6437"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6438"><br/></div><div id="line6439"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PRIVATE">private</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">loadTranslation</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$lang</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6440"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6441"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">defined</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'KSLANGDIR'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6442"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6443"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$dirname</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">KSLANGDIR</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6444"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6445"><pre><span class="token T_WHITESPACE">		</span><span class="token T_ELSE">else</span></pre></div><div id="line6446"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6447"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$dirname</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">KSROOTDIR</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6448"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6449"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$basename</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">basename</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_FILE">__FILE__</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'.php'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'.ini'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6450"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$lang</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$lang</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">language</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6451"><br/></div><div id="line6452"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$translationFilename</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$dirname</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_STRING">DIRECTORY_SEPARATOR</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$lang</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'.'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$basename</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6453"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">file_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$translationFilename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$basename</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_NOT_EQUAL">!=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.ini'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6454"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$basename</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.ini'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6455"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$translationFilename</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$dirname</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_STRING">DIRECTORY_SEPARATOR</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$lang</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'.'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$basename</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6456"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6457"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">file_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$translationFilename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_RETURN">return</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6458"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$temp</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">parse_ini_file</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$translationFilename</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6459"><br/></div><div id="line6460"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">is_array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">strings</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">strings</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6461"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$temp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6462"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">strings</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">array_merge</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">default_translation</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">strings</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6463"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_ELSE">else</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6464"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">strings</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">array_merge</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">strings</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$temp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6465"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6466"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6467"><br/></div><div id="line6468"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">addDefaultLanguageStrings</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$stringList</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6469"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6470"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">is_array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$stringList</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_RETURN">return</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6471"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$stringList</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_RETURN">return</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6472"><br/></div><div id="line6473"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">strings</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">array_merge</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$stringList</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">strings</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6474"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6475"><br/></div><div id="line6476"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line6477"><pre><span class="token T_DOC_COMMENT">	 * A PHP based INI file parser.</span></pre></div><div id="line6478"><pre><span class="token T_DOC_COMMENT">	 *</span></pre></div><div id="line6479"><pre><span class="token T_DOC_COMMENT">	 * Thanks to asohn ~at~ aircanopy ~dot~ net for posting this handy function on</span></pre></div><div id="line6480"><pre><span class="token T_DOC_COMMENT">	 * the parse_ini_file page on http://gr.php.net/parse_ini_file</span></pre></div><div id="line6481"><pre><span class="token T_DOC_COMMENT">	 *</span></pre></div><div id="line6482"><pre><span class="token T_DOC_COMMENT">	 * @param string $file Filename to process</span></pre></div><div id="line6483"><pre><span class="token T_DOC_COMMENT">	 * @param bool $process_sections True to also process INI sections</span></pre></div><div id="line6484"><pre><span class="token T_DOC_COMMENT">	 * @return array An associative array of sections, keys and values</span></pre></div><div id="line6485"><pre><span class="token T_DOC_COMMENT">	 * @access private</span></pre></div><div id="line6486"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line6487"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_STATIC">static</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">parse_ini_file</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$file</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$process_sections</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$raw_data</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6488"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6489"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$process_sections</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$process_sections</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_NOT_IDENTICAL">!==</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_QUESTION_MARK">?</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_COLON">:</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6490"><br/></div><div id="line6491"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$raw_data</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6492"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6493"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$ini</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AT">@</span><span class="token T_STRING">file</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$file</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6494"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6495"><pre><span class="token T_WHITESPACE">		</span><span class="token T_ELSE">else</span></pre></div><div id="line6496"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6497"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$ini</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$file</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6498"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6499"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">count</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$ini</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6500"><br/></div><div id="line6501"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$sections</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6502"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$values</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6503"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$result</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6504"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$globals</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6505"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$i</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6506"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$ini</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_FOREACH">foreach</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$ini</span><span class="token T_WHITESPACE"> </span><span class="token T_AS">as</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$line</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6507"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$line</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$line</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6508"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$line</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">str_replace</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">"\t"</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">" "</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$line</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6509"><br/></div><div id="line6510"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Comments</span></pre></div><div id="line6511"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">preg_match</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/^[a-zA-Z0-9[]/'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$line</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_CONTINUE">continue</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6512"><br/></div><div id="line6513"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Sections</span></pre></div><div id="line6514"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$line</span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'['</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6515"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$tmp</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">explode</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">']'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$line</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6516"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$sections</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$tmp</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6517"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$i</span><span class="token T_INC">++</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6518"><pre><span class="token T_WHITESPACE">				</span><span class="token T_CONTINUE">continue</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6519"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6520"><br/></div><div id="line6521"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Key-value pair</span></pre></div><div id="line6522"><pre><span class="token T_WHITESPACE">			</span><span class="token T_LIST">list</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$key</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">explode</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'='</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$line</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">2</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6523"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$key</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$key</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6524"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$value</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6525"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">strstr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">";"</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6526"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$tmp</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">explode</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">';'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6527"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">count</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$tmp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">2</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6528"><pre><span class="token T_WHITESPACE">					</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_NOT_EQUAL">!=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'"'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_NOT_EQUAL">!=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">"'"</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_OR">||</span></pre></div><div id="line6529"><pre><span class="token T_WHITESPACE">					</span><span class="token T_STRING">preg_match</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/^".*"\s*;/'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_OR">||</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">preg_match</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/^".*;[^"]*$/'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_OR">||</span></pre></div><div id="line6530"><pre><span class="token T_WHITESPACE">					</span><span class="token T_STRING">preg_match</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">"/^'.*'\s*;/"</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_OR">||</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">preg_match</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">"/^'.*;[^']*$/"</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6531"><pre><span class="token T_WHITESPACE">						</span><span class="token T_VARIABLE">$value</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$tmp</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6532"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6533"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_ELSE">else</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6534"><pre><span class="token T_WHITESPACE">					</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'"'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6535"><pre><span class="token T_WHITESPACE">						</span><span class="token T_VARIABLE">$value</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">preg_replace</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/^"(.*)".*/'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'$1'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6536"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_ELSEIF">elseif</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">"'"</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6537"><pre><span class="token T_WHITESPACE">						</span><span class="token T_VARIABLE">$value</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">preg_replace</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">"/^'(.*)'.*/"</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'$1'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6538"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_ELSE">else</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6539"><pre><span class="token T_WHITESPACE">						</span><span class="token T_VARIABLE">$value</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$tmp</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6540"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6541"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6542"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6543"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$value</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6544"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$value</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">trim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">"'\""</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6545"><br/></div><div id="line6546"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$i</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6547"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$line</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">2</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'[]'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6548"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$globals</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$key</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6549"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_ELSE">else</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6550"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$globals</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$key</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6551"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6552"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_ELSE">else</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6553"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$line</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">2</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'[]'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6554"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$values</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$key</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6555"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_ELSE">else</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6556"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$values</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$key</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6557"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6558"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6559"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6560"><br/></div><div id="line6561"><pre><span class="token T_WHITESPACE">		</span><span class="token T_FOR">for</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$j</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$j</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$j</span><span class="token T_INC">++</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6562"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$process_sections</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_IDENTICAL">===</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6563"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$result</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$sections</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$j</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$values</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$j</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6564"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_ELSE">else</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6565"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$result</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$values</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$j</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6566"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6567"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6568"><br/></div><div id="line6569"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$result</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_PLUS">+</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$globals</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6570"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6571"><pre><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6572"><br/></div><div id="line6573"><pre><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line6574"><pre><span class="token T_DOC_COMMENT"> * Akeeba Restore</span></pre></div><div id="line6575"><pre><span class="token T_DOC_COMMENT"> * A JSON-powered JPA, JPS and ZIP archive extraction library</span></pre></div><div id="line6576"><pre><span class="token T_DOC_COMMENT"> *</span></pre></div><div id="line6577"><pre><span class="token T_DOC_COMMENT"> * @copyright   2010-2014 Nicholas K. Dionysopoulos / Akeeba Ltd.</span></pre></div><div id="line6578"><pre><span class="token T_DOC_COMMENT"> * @license     GNU GPL v2 or - at your option - any later version</span></pre></div><div id="line6579"><pre><span class="token T_DOC_COMMENT"> * @package     akeebabackup</span></pre></div><div id="line6580"><pre><span class="token T_DOC_COMMENT"> * @subpackage  kickstart</span></pre></div><div id="line6581"><pre><span class="token T_DOC_COMMENT"> */</span></pre></div><div id="line6582"><br/></div><div id="line6583"><pre><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line6584"><pre><span class="token T_DOC_COMMENT"> * The Akeeba Kickstart Factory class</span></pre></div><div id="line6585"><pre><span class="token T_DOC_COMMENT"> * This class is reponssible for instanciating all Akeeba Kicsktart classes</span></pre></div><div id="line6586"><pre><span class="token T_DOC_COMMENT"> */</span></pre></div><div id="line6587"><pre><span class="token T_CLASS">class</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6588"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var array A list of instantiated objects */</span></pre></div><div id="line6589"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PRIVATE">private</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$objectlist</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6590"><br/></div><div id="line6591"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** @var array Simple hash data storage */</span></pre></div><div id="line6592"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PRIVATE">private</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$varlist</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6593"><br/></div><div id="line6594"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/** Private constructor makes sure we can't directly instanciate the class */</span></pre></div><div id="line6595"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PRIVATE">private</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">__construct</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6596"><br/></div><div id="line6597"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line6598"><pre><span class="token T_DOC_COMMENT">	 * Gets a single, internally used instance of the Factory</span></pre></div><div id="line6599"><pre><span class="token T_DOC_COMMENT">	 * @param string $serialized_data [optional] Serialized data to spawn the instance from</span></pre></div><div id="line6600"><pre><span class="token T_DOC_COMMENT">	 * @return AKFactory A reference to the unique Factory object instance</span></pre></div><div id="line6601"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line6602"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_STATIC">static</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_STRING">getInstance</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$serialized_data</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6603"><pre><span class="token T_WHITESPACE">		</span><span class="token T_STATIC">static</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$myInstance</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6604"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">is_object</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$myInstance</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_OR">||</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">is_null</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$serialized_data</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6605"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">is_null</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$serialized_data</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6606"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6607"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$myInstance</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">unserialize</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$serialized_data</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6608"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6609"><pre><span class="token T_WHITESPACE">			</span><span class="token T_ELSE">else</span></pre></div><div id="line6610"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6611"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$myInstance</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_NEW">new</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6612"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6613"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$myInstance</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6614"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6615"><br/></div><div id="line6616"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line6617"><pre><span class="token T_DOC_COMMENT">	 * Internal function which instanciates a class named $class_name.</span></pre></div><div id="line6618"><pre><span class="token T_DOC_COMMENT">	 * The autoloader</span></pre></div><div id="line6619"><pre><span class="token T_DOC_COMMENT">	 * @param object $class_name</span></pre></div><div id="line6620"><pre><span class="token T_DOC_COMMENT">	 * @return</span></pre></div><div id="line6621"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line6622"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_STATIC">static</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_STRING">getClassInstance</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$class_name</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6623"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$self</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">getInstance</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6624"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_ISSET">isset</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$self</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">objectlist</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$class_name</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6625"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6626"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$self</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">objectlist</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$class_name</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_NEW">new</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$class_name</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6627"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6628"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$self</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">objectlist</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$class_name</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6629"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6630"><br/></div><div id="line6631"><pre><span class="token T_WHITESPACE">	</span><span class="token T_COMMENT">// ========================================================================</span></pre></div><div id="line6632"><pre><span class="token T_WHITESPACE">	</span><span class="token T_COMMENT">// Public factory interface</span></pre></div><div id="line6633"><pre><span class="token T_WHITESPACE">	</span><span class="token T_COMMENT">// ========================================================================</span></pre></div><div id="line6634"><br/></div><div id="line6635"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line6636"><pre><span class="token T_DOC_COMMENT">	 * Gets a serialized snapshot of the Factory for safekeeping (hibernate)</span></pre></div><div id="line6637"><pre><span class="token T_DOC_COMMENT">	 * @return string The serialized snapshot of the Factory</span></pre></div><div id="line6638"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line6639"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_STATIC">static</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">serialize</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6640"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$engine</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">getUnarchiver</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6641"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$engine</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">shutdown</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6642"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$serialized</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">serialize</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">getInstance</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6643"><br/></div><div id="line6644"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">function_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'base64_encode'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">function_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'base64_decode'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6645"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6646"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$serialized</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">base64_encode</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$serialized</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6647"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6648"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$serialized</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6649"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6650"><br/></div><div id="line6651"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line6652"><pre><span class="token T_DOC_COMMENT">	 * Regenerates the full Factory state from a serialized snapshot (resume)</span></pre></div><div id="line6653"><pre><span class="token T_DOC_COMMENT">	 * @param string $serialized_data The serialized snapshot to resume from</span></pre></div><div id="line6654"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line6655"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_STATIC">static</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">unserialize</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$serialized_data</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6656"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">function_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'base64_encode'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">function_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'base64_decode'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6657"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6658"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$serialized_data</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">base64_decode</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$serialized_data</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6659"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6660"><pre><span class="token T_WHITESPACE">		</span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">getInstance</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$serialized_data</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6661"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6662"><br/></div><div id="line6663"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line6664"><pre><span class="token T_DOC_COMMENT">	 * Reset the internal factory state, freeing all previously created objects</span></pre></div><div id="line6665"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line6666"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_STATIC">static</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">nuke</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6667"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6668"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$self</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">getInstance</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6669"><pre><span class="token T_WHITESPACE">		</span><span class="token T_FOREACH">foreach</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$self</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">objectlist</span><span class="token T_WHITESPACE"> </span><span class="token T_AS">as</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$key</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$object</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6670"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6671"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$self</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">objectlist</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$key</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6672"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6673"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$self</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">objectlist</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6674"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6675"><br/></div><div id="line6676"><pre><span class="token T_WHITESPACE">	</span><span class="token T_COMMENT">// ========================================================================</span></pre></div><div id="line6677"><pre><span class="token T_WHITESPACE">	</span><span class="token T_COMMENT">// Public hash data storage interface</span></pre></div><div id="line6678"><pre><span class="token T_WHITESPACE">	</span><span class="token T_COMMENT">// ========================================================================</span></pre></div><div id="line6679"><br/></div><div id="line6680"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_STATIC">static</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">set</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$key</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6681"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6682"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$self</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">getInstance</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6683"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$self</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">varlist</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$key</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6684"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6685"><br/></div><div id="line6686"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_STATIC">static</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$key</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$default</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6687"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6688"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$self</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">getInstance</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6689"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">array_key_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$key</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$self</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">varlist</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6690"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6691"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$self</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">varlist</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$key</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6692"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6693"><pre><span class="token T_WHITESPACE">		</span><span class="token T_ELSE">else</span></pre></div><div id="line6694"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6695"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$default</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6696"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6697"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6698"><br/></div><div id="line6699"><pre><span class="token T_WHITESPACE">	</span><span class="token T_COMMENT">// ========================================================================</span></pre></div><div id="line6700"><pre><span class="token T_WHITESPACE">	</span><span class="token T_COMMENT">// Akeeba Kickstart classes</span></pre></div><div id="line6701"><pre><span class="token T_WHITESPACE">	</span><span class="token T_COMMENT">// ========================================================================</span></pre></div><div id="line6702"><br/></div><div id="line6703"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line6704"><pre><span class="token T_DOC_COMMENT">	 * Gets the post processing engine</span></pre></div><div id="line6705"><pre><span class="token T_DOC_COMMENT">	 * @param string $proc_engine</span></pre></div><div id="line6706"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line6707"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_STATIC">static</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_STRING">getPostProc</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$proc_engine</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6708"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6709"><pre><span class="token T_WHITESPACE">		</span><span class="token T_STATIC">static</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$class_name</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6710"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$class_name</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6711"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6712"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$proc_engine</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6713"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6714"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$proc_engine</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.procengine'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'direct'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6715"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6716"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$class_name</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'AKPostproc'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_STRING">ucfirst</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$proc_engine</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6717"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6718"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">getClassInstance</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$class_name</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6719"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6720"><br/></div><div id="line6721"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line6722"><pre><span class="token T_DOC_COMMENT">	 * Gets the unarchiver engine</span></pre></div><div id="line6723"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line6724"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_STATIC">static</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_STRING">getUnarchiver</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$configOverride</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6725"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6726"><pre><span class="token T_WHITESPACE">		</span><span class="token T_STATIC">static</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$class_name</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6727"><br/></div><div id="line6728"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$configOverride</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6729"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6730"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$configOverride</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'reset'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6731"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$class_name</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6732"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6733"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6734"><br/></div><div id="line6735"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$class_name</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6736"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6737"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$filetype</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.filetype'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6738"><br/></div><div id="line6739"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$filetype</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6740"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6741"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$filename</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.sourcefile'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6742"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$basename</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">basename</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$filename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6743"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$baseextension</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">strtoupper</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$basename</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_LNUMBER">3</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6744"><pre><span class="token T_WHITESPACE">				</span><span class="token T_SWITCH">switch</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$baseextension</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6745"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6746"><pre><span class="token T_WHITESPACE">					</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'JPA'</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line6747"><pre><span class="token T_WHITESPACE">						</span><span class="token T_VARIABLE">$filetype</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'JPA'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6748"><pre><span class="token T_WHITESPACE">						</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6749"><br/></div><div id="line6750"><pre><span class="token T_WHITESPACE">					</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'JPS'</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line6751"><pre><span class="token T_WHITESPACE">						</span><span class="token T_VARIABLE">$filetype</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'JPS'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6752"><pre><span class="token T_WHITESPACE">						</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6753"><br/></div><div id="line6754"><pre><span class="token T_WHITESPACE">					</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'ZIP'</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line6755"><pre><span class="token T_WHITESPACE">						</span><span class="token T_VARIABLE">$filetype</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'ZIP'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6756"><pre><span class="token T_WHITESPACE">						</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6757"><br/></div><div id="line6758"><pre><span class="token T_WHITESPACE">					</span><span class="token T_DEFAULT">default</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line6759"><pre><span class="token T_WHITESPACE">						</span><span class="token T_EXIT">die</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Invalid archive type or extension in file '</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$filename</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6760"><pre><span class="token T_WHITESPACE">						</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6761"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6762"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6763"><br/></div><div id="line6764"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$class_name</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'AKUnarchiver'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_STRING">ucfirst</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$filetype</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6765"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6766"><br/></div><div id="line6767"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$destdir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.destdir'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6768"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$destdir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6769"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6770"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$destdir</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">KSROOTDIR</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6771"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6772"><br/></div><div id="line6773"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$object</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">getClassInstance</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$class_name</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6774"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$object</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">getState</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'init'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6775"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6776"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$sourcePath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.sourcepath'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6777"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$sourceFile</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.sourcefile'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6778"><br/></div><div id="line6779"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$sourcePath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6780"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6781"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$sourceFile</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">rtrim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$sourcePath</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/\\'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$sourceFile</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6782"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6783"><br/></div><div id="line6784"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Initialize the object</span></pre></div><div id="line6785"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$config</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span></pre></div><div id="line6786"><pre><span class="token T_WHITESPACE">				</span><span class="token T_CONSTANT_ENCAPSED_STRING">'filename'</span><span class="token T_WHITESPACE">				</span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$sourceFile</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6787"><pre><span class="token T_WHITESPACE">				</span><span class="token T_CONSTANT_ENCAPSED_STRING">'restore_permissions'</span><span class="token T_WHITESPACE">	</span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.restoreperms'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6788"><pre><span class="token T_WHITESPACE">				</span><span class="token T_CONSTANT_ENCAPSED_STRING">'post_proc'</span><span class="token T_WHITESPACE">				</span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.procengine'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'direct'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6789"><pre><span class="token T_WHITESPACE">				</span><span class="token T_CONSTANT_ENCAPSED_STRING">'add_path'</span><span class="token T_WHITESPACE">				</span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.targetpath'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$destdir</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6790"><pre><span class="token T_WHITESPACE">				</span><span class="token T_CONSTANT_ENCAPSED_STRING">'rename_files'</span><span class="token T_WHITESPACE">			</span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'.htaccess'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'htaccess.bak'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'php.ini'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'php.ini.bak'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'web.config'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'web.config.bak'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6791"><pre><span class="token T_WHITESPACE">				</span><span class="token T_CONSTANT_ENCAPSED_STRING">'skip_files'</span><span class="token T_WHITESPACE">			</span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">basename</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_FILE">__FILE__</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.php'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'abiautomation.ini'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'htaccess.bak'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'php.ini.bak'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'cacert.pem'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6792"><pre><span class="token T_WHITESPACE">				</span><span class="token T_CONSTANT_ENCAPSED_STRING">'ignoredirectories'</span><span class="token T_WHITESPACE">		</span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'tmp'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'log'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'logs'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6793"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6794"><br/></div><div id="line6795"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">defined</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'KICKSTART'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6796"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6797"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// In restore.php mode we have to exclude some more files</span></pre></div><div id="line6798"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$config</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'skip_files'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'administrator/components/com_akeeba/restore.php'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6799"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$config</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'skip_files'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'administrator/components/com_akeeba/restoration.php'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6800"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6801"><br/></div><div id="line6802"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$configOverride</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6803"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6804"><pre><span class="token T_WHITESPACE">				</span><span class="token T_FOREACH">foreach</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$configOverride</span><span class="token T_WHITESPACE"> </span><span class="token T_AS">as</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$key</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6805"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6806"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$config</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$key</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6807"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6808"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6809"><br/></div><div id="line6810"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$object</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">setup</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$config</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6811"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6812"><br/></div><div id="line6813"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$object</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6814"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6815"><br/></div><div id="line6816"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line6817"><pre><span class="token T_DOC_COMMENT">	 * Get the a reference to the Akeeba Engine's timer</span></pre></div><div id="line6818"><pre><span class="token T_DOC_COMMENT">	 * @return AKCoreTimer</span></pre></div><div id="line6819"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line6820"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_STATIC">static</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_STRING">getTimer</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line6821"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6822"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">getClassInstance</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'AKCoreTimer'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6823"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6824"><br/></div><div id="line6825"><pre><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6826"><br/></div><div id="line6827"><pre><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line6828"><pre><span class="token T_DOC_COMMENT"> * Akeeba Restore</span></pre></div><div id="line6829"><pre><span class="token T_DOC_COMMENT"> * A JSON-powered JPA, JPS and ZIP archive extraction library</span></pre></div><div id="line6830"><pre><span class="token T_DOC_COMMENT"> *</span></pre></div><div id="line6831"><pre><span class="token T_DOC_COMMENT"> * @copyright   2010-2014 Nicholas K. Dionysopoulos / Akeeba Ltd.</span></pre></div><div id="line6832"><pre><span class="token T_DOC_COMMENT"> * @license     GNU GPL v2 or - at your option - any later version</span></pre></div><div id="line6833"><pre><span class="token T_DOC_COMMENT"> * @package     akeebabackup</span></pre></div><div id="line6834"><pre><span class="token T_DOC_COMMENT"> * @subpackage  kickstart</span></pre></div><div id="line6835"><pre><span class="token T_DOC_COMMENT"> */</span></pre></div><div id="line6836"><br/></div><div id="line6837"><pre><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line6838"><pre><span class="token T_DOC_COMMENT"> * AES implementation in PHP (c) Chris Veness 2005-2013.</span></pre></div><div id="line6839"><pre><span class="token T_DOC_COMMENT"> * Right to use and adapt is granted for under a simple creative commons attribution</span></pre></div><div id="line6840"><pre><span class="token T_DOC_COMMENT"> * licence. No warranty of any form is offered.</span></pre></div><div id="line6841"><pre><span class="token T_DOC_COMMENT"> *</span></pre></div><div id="line6842"><pre><span class="token T_DOC_COMMENT"> * Modified for Akeeba Backup by Nicholas K. Dionysopoulos</span></pre></div><div id="line6843"><pre><span class="token T_DOC_COMMENT"> */</span></pre></div><div id="line6844"><pre><span class="token T_CLASS">class</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKEncryptionAES</span></pre></div><div id="line6845"><pre><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6846"><pre><span class="token T_WHITESPACE">	</span><span class="token T_COMMENT">// Sbox is pre-computed multiplicative inverse in GF(2^8) used in SubBytes and KeyExpansion [&#xFFFD;5.1.1]</span></pre></div><div id="line6847"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_STATIC">static</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$Sbox</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span></pre></div><div id="line6848"><pre><span class="token T_WHITESPACE">			 </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_LNUMBER">0x63</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x7c</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x77</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x7b</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xf2</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x6b</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x6f</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xc5</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x30</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x01</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x67</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x2b</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xfe</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xd7</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xab</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x76</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6849"><pre><span class="token T_WHITESPACE">	               </span><span class="token T_LNUMBER">0xca</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x82</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xc9</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x7d</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xfa</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x59</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x47</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xf0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xad</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xd4</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xa2</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xaf</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x9c</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xa4</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x72</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xc0</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6850"><pre><span class="token T_WHITESPACE">	               </span><span class="token T_LNUMBER">0xb7</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xfd</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x93</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x26</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x36</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x3f</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xf7</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xcc</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x34</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xa5</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xe5</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xf1</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x71</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xd8</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x31</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x15</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6851"><pre><span class="token T_WHITESPACE">	               </span><span class="token T_LNUMBER">0x04</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xc7</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x23</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xc3</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x18</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x96</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x05</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x9a</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x07</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x12</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x80</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xe2</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xeb</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x27</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xb2</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x75</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6852"><pre><span class="token T_WHITESPACE">	               </span><span class="token T_LNUMBER">0x09</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x83</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x2c</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x1a</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x1b</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x6e</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x5a</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xa0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x52</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x3b</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xd6</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xb3</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x29</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xe3</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x2f</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x84</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6853"><pre><span class="token T_WHITESPACE">	               </span><span class="token T_LNUMBER">0x53</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xd1</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x00</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xed</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x20</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xfc</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xb1</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x5b</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x6a</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xcb</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xbe</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x39</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x4a</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x4c</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x58</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xcf</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6854"><pre><span class="token T_WHITESPACE">	               </span><span class="token T_LNUMBER">0xd0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xef</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xaa</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xfb</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x43</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x4d</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x33</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x85</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x45</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xf9</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x02</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x7f</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x50</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x3c</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x9f</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xa8</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6855"><pre><span class="token T_WHITESPACE">	               </span><span class="token T_LNUMBER">0x51</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xa3</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x40</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x8f</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x92</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x9d</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x38</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xf5</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xbc</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xb6</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xda</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x21</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x10</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xff</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xf3</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xd2</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6856"><pre><span class="token T_WHITESPACE">	               </span><span class="token T_LNUMBER">0xcd</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x0c</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x13</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xec</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x5f</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x97</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x44</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x17</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xc4</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xa7</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x7e</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x3d</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x64</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x5d</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x19</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x73</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6857"><pre><span class="token T_WHITESPACE">	               </span><span class="token T_LNUMBER">0x60</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x81</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x4f</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xdc</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x22</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x2a</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x90</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x88</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x46</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xee</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xb8</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x14</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xde</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x5e</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x0b</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xdb</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6858"><pre><span class="token T_WHITESPACE">	               </span><span class="token T_LNUMBER">0xe0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x32</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x3a</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x0a</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x49</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x06</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x24</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x5c</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xc2</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xd3</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xac</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x62</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x91</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x95</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xe4</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x79</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6859"><pre><span class="token T_WHITESPACE">	               </span><span class="token T_LNUMBER">0xe7</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xc8</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x37</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x6d</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x8d</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xd5</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x4e</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xa9</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x6c</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x56</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xf4</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xea</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x65</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x7a</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xae</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x08</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6860"><pre><span class="token T_WHITESPACE">	               </span><span class="token T_LNUMBER">0xba</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x78</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x25</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x2e</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x1c</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xa6</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xb4</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xc6</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xe8</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xdd</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x74</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x1f</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x4b</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xbd</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x8b</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x8a</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6861"><pre><span class="token T_WHITESPACE">	               </span><span class="token T_LNUMBER">0x70</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x3e</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xb5</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x66</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x48</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x03</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xf6</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x0e</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x61</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x35</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x57</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xb9</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x86</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xc1</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x1d</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x9e</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6862"><pre><span class="token T_WHITESPACE">	               </span><span class="token T_LNUMBER">0xe1</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xf8</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x98</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x11</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x69</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xd9</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x8e</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x94</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x9b</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x1e</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x87</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xe9</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xce</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x55</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x28</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xdf</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6863"><pre><span class="token T_WHITESPACE">	               </span><span class="token T_LNUMBER">0x8c</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xa1</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x89</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x0d</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xbf</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xe6</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x42</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x68</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x41</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x99</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x2d</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x0f</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xb0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x54</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0xbb</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0x16</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6864"><br/></div><div id="line6865"><pre><span class="token T_WHITESPACE">	</span><span class="token T_COMMENT">// Rcon is Round Constant used for the Key Expansion [1st col is 2^(r-1) in GF(2^8)] [&#xFFFD;5.2]</span></pre></div><div id="line6866"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_STATIC">static</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$Rcon</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span></pre></div><div id="line6867"><pre><span class="token T_WHITESPACE">				   </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_LNUMBER">0x00</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x00</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x00</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x00</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6868"><pre><span class="token T_WHITESPACE">	               </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_LNUMBER">0x01</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x00</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x00</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x00</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6869"><pre><span class="token T_WHITESPACE">	               </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_LNUMBER">0x02</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x00</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x00</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x00</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6870"><pre><span class="token T_WHITESPACE">	               </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_LNUMBER">0x04</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x00</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x00</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x00</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6871"><pre><span class="token T_WHITESPACE">	               </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_LNUMBER">0x08</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x00</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x00</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x00</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6872"><pre><span class="token T_WHITESPACE">	               </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_LNUMBER">0x10</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x00</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x00</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x00</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6873"><pre><span class="token T_WHITESPACE">	               </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_LNUMBER">0x20</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x00</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x00</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x00</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6874"><pre><span class="token T_WHITESPACE">	               </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_LNUMBER">0x40</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x00</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x00</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x00</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6875"><pre><span class="token T_WHITESPACE">	               </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_LNUMBER">0x80</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x00</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x00</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x00</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6876"><pre><span class="token T_WHITESPACE">	               </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_LNUMBER">0x1b</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x00</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x00</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x00</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line6877"><pre><span class="token T_WHITESPACE">	               </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_LNUMBER">0x36</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x00</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x00</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x00</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6878"><br/></div><div id="line6879"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_STATIC">static</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$passwords</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6880"><br/></div><div id="line6881"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line6882"><pre><span class="token T_DOC_COMMENT">	 * AES Cipher function: encrypt 'input' with Rijndael algorithm</span></pre></div><div id="line6883"><pre><span class="token T_DOC_COMMENT">	 *</span></pre></div><div id="line6884"><pre><span class="token T_DOC_COMMENT">	 * @param input message as byte-array (16 bytes)</span></pre></div><div id="line6885"><pre><span class="token T_DOC_COMMENT">	 * @param w     key schedule as 2D byte-array (Nr+1 x Nb bytes) -</span></pre></div><div id="line6886"><pre><span class="token T_DOC_COMMENT">	 *              generated from the cipher key by KeyExpansion()</span></pre></div><div id="line6887"><pre><span class="token T_DOC_COMMENT">	 * @return      ciphertext as byte-array (16 bytes)</span></pre></div><div id="line6888"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line6889"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_STATIC">static</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">Cipher</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$input</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$w</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_WHITESPACE">    </span><span class="token T_COMMENT">// main Cipher function [&#xFFFD;5.1]</span></pre></div><div id="line6890"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_VARIABLE">$Nb</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE">                 </span><span class="token T_COMMENT">// block size (in words): no of columns in state (fixed at 4 for AES)</span></pre></div><div id="line6891"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_VARIABLE">$Nr</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">count</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$w</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_DIV">/</span><span class="token T_VARIABLE">$Nb</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_COMMENT">// no of rounds: 10/12/14 for 128/192/256-bit keys</span></pre></div><div id="line6892"><br/></div><div id="line6893"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_VARIABLE">$state</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE">  </span><span class="token T_COMMENT">// initialise 4xNb byte-array 'state' with input [&#xFFFD;3.4]</span></pre></div><div id="line6894"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_FOR">for</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_MULT">*</span><span class="token T_VARIABLE">$Nb</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$i</span><span class="token T_INC">++</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$state</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_PERCENT">%</span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_STRING">floor</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_DIV">/</span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$input</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6895"><br/></div><div id="line6896"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_VARIABLE">$state</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">AddRoundKey</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$state</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$w</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$Nb</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6897"><br/></div><div id="line6898"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_FOR">for</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$round</span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$round</span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_VARIABLE">$Nr</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$round</span><span class="token T_INC">++</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_WHITESPACE">  </span><span class="token T_COMMENT">// apply Nr rounds</span></pre></div><div id="line6899"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_VARIABLE">$state</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">SubBytes</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$state</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$Nb</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6900"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_VARIABLE">$state</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">ShiftRows</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$state</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$Nb</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6901"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_VARIABLE">$state</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">MixColumns</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$state</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$Nb</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6902"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_VARIABLE">$state</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">AddRoundKey</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$state</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$w</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$round</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$Nb</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6903"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6904"><br/></div><div id="line6905"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_VARIABLE">$state</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">SubBytes</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$state</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$Nb</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6906"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_VARIABLE">$state</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">ShiftRows</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$state</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$Nb</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6907"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_VARIABLE">$state</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">AddRoundKey</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$state</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$w</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$Nr</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$Nb</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6908"><br/></div><div id="line6909"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_VARIABLE">$output</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_MULT">*</span><span class="token T_VARIABLE">$Nb</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE">  </span><span class="token T_COMMENT">// convert state to 1-d array before returning [&#xFFFD;3.4]</span></pre></div><div id="line6910"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_FOR">for</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_MULT">*</span><span class="token T_VARIABLE">$Nb</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$i</span><span class="token T_INC">++</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$output</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$state</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_PERCENT">%</span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_STRING">floor</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_DIV">/</span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6911"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$output</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6912"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6913"><br/></div><div id="line6914"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_STATIC">static</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AddRoundKey</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$state</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$w</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$rnd</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$Nb</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_WHITESPACE">  </span><span class="token T_COMMENT">// xor Round Key into state S [&#xFFFD;5.1.4]</span></pre></div><div id="line6915"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_FOR">for</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$r</span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$r</span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$r</span><span class="token T_INC">++</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6916"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_FOR">for</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_VARIABLE">$Nb</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$c</span><span class="token T_INC">++</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$state</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$r</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_XOR_EQUAL">^=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$w</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$rnd</span><span class="token T_PHPDOX_MULT">*</span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_PLUS">+</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$r</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6917"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6918"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$state</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6919"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6920"><br/></div><div id="line6921"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_STATIC">static</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">SubBytes</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$s</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$Nb</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_WHITESPACE">    </span><span class="token T_COMMENT">// apply SBox to state S [&#xFFFD;5.1.1]</span></pre></div><div id="line6922"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_FOR">for</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$r</span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$r</span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$r</span><span class="token T_INC">++</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6923"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_FOR">for</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_VARIABLE">$Nb</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$c</span><span class="token T_INC">++</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$s</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$r</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_VARIABLE">$Sbox</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$s</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$r</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6924"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6925"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$s</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6926"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6927"><br/></div><div id="line6928"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_STATIC">static</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">ShiftRows</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$s</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$Nb</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_WHITESPACE">    </span><span class="token T_COMMENT">// shift row r of state S left by r bytes [&#xFFFD;5.1.2]</span></pre></div><div id="line6929"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_VARIABLE">$t</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6930"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_FOR">for</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$r</span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$r</span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$r</span><span class="token T_INC">++</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6931"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_FOR">for</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$c</span><span class="token T_INC">++</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$t</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$s</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$r</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_PLUS">+</span><span class="token T_VARIABLE">$r</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_PERCENT">%</span><span class="token T_VARIABLE">$Nb</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE">  </span><span class="token T_COMMENT">// shift into temp copy</span></pre></div><div id="line6932"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_FOR">for</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$c</span><span class="token T_INC">++</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$s</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$r</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$t</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE">         </span><span class="token T_COMMENT">// and copy back</span></pre></div><div id="line6933"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE">          </span><span class="token T_COMMENT">// note that this will work for Nb=4,5,6, but not 7,8 (always 4 for AES):</span></pre></div><div id="line6934"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$s</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE">  </span><span class="token T_COMMENT">// see fp.gladman.plus.com/cryptography_technology/rijndael/aes.spec.311.pdf</span></pre></div><div id="line6935"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6936"><br/></div><div id="line6937"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_STATIC">static</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">MixColumns</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$s</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$Nb</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_WHITESPACE">   </span><span class="token T_COMMENT">// combine bytes of each col of state S [&#xFFFD;5.1.3]</span></pre></div><div id="line6938"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_FOR">for</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$c</span><span class="token T_INC">++</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6939"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_VARIABLE">$a</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE">  </span><span class="token T_COMMENT">// 'a' is a copy of the current column from 's'</span></pre></div><div id="line6940"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_VARIABLE">$b</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE">  </span><span class="token T_COMMENT">// 'b' is a&#xFFFD;{02} in GF(2^8)</span></pre></div><div id="line6941"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_FOR">for</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$i</span><span class="token T_INC">++</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6942"><pre><span class="token T_WHITESPACE">	      </span><span class="token T_VARIABLE">$a</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$s</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6943"><pre><span class="token T_WHITESPACE">	      </span><span class="token T_VARIABLE">$b</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$s</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_LNUMBER">0x80</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_QUESTION_MARK">?</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$s</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_SL">&lt;&lt;</span><span class="token T_LNUMBER">1</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CARET">^</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x011b</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_COLON">:</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$s</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_SL">&lt;&lt;</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6944"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6945"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_COMMENT">// a[n] ^ b[n] is a&#xFFFD;{03} in GF(2^8)</span></pre></div><div id="line6946"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_VARIABLE">$s</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$b</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CARET">^</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$a</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CARET">^</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$b</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CARET">^</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$a</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">2</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CARET">^</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$a</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">3</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_COMMENT">// 2*a0 + 3*a1 + a2 + a3</span></pre></div><div id="line6947"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_VARIABLE">$s</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$a</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CARET">^</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$b</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CARET">^</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$a</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">2</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CARET">^</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$b</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">2</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CARET">^</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$a</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">3</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_COMMENT">// a0 * 2*a1 + 3*a2 + a3</span></pre></div><div id="line6948"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_VARIABLE">$s</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">2</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$a</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CARET">^</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$a</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CARET">^</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$b</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">2</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CARET">^</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$a</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">3</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CARET">^</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$b</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">3</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_COMMENT">// a0 + a1 + 2*a2 + 3*a3</span></pre></div><div id="line6949"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_VARIABLE">$s</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">3</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$a</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CARET">^</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$b</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CARET">^</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$a</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CARET">^</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$a</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">2</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CARET">^</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$b</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">3</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_COMMENT">// 3*a0 + a1 + a2 + 2*a3</span></pre></div><div id="line6950"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6951"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$s</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6952"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6953"><br/></div><div id="line6954"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line6955"><pre><span class="token T_DOC_COMMENT">	 * Key expansion for Rijndael Cipher(): performs key expansion on cipher key</span></pre></div><div id="line6956"><pre><span class="token T_DOC_COMMENT">	 * to generate a key schedule</span></pre></div><div id="line6957"><pre><span class="token T_DOC_COMMENT">	 *</span></pre></div><div id="line6958"><pre><span class="token T_DOC_COMMENT">	 * @param key cipher key byte-array (16 bytes)</span></pre></div><div id="line6959"><pre><span class="token T_DOC_COMMENT">	 * @return    key schedule as 2D byte-array (Nr+1 x Nb bytes)</span></pre></div><div id="line6960"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line6961"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_STATIC">static</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">KeyExpansion</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$key</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_WHITESPACE">  </span><span class="token T_COMMENT">// generate Key Schedule from Cipher Key [&#xFFFD;5.2]</span></pre></div><div id="line6962"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_VARIABLE">$Nb</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE">              </span><span class="token T_COMMENT">// block size (in words): no of columns in state (fixed at 4 for AES)</span></pre></div><div id="line6963"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_VARIABLE">$Nk</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">count</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$key</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_DIV">/</span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE">  </span><span class="token T_COMMENT">// key length (in words): 4/6/8 for 128/192/256-bit keys</span></pre></div><div id="line6964"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_VARIABLE">$Nr</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$Nk</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_PLUS">+</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">6</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE">        </span><span class="token T_COMMENT">// no of rounds: 10/12/14 for 128/192/256-bit keys</span></pre></div><div id="line6965"><br/></div><div id="line6966"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_VARIABLE">$w</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6967"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_VARIABLE">$temp</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6968"><br/></div><div id="line6969"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_FOR">for</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_VARIABLE">$Nk</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$i</span><span class="token T_INC">++</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6970"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_VARIABLE">$r</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$key</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_MULT">*</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$key</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_MULT">*</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_PLUS">+</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$key</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_MULT">*</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_PLUS">+</span><span class="token T_LNUMBER">2</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$key</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_MULT">*</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_PLUS">+</span><span class="token T_LNUMBER">3</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6971"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_VARIABLE">$w</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$r</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6972"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6973"><br/></div><div id="line6974"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_FOR">for</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_VARIABLE">$Nk</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$Nb</span><span class="token T_PHPDOX_MULT">*</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$Nr</span><span class="token T_PHPDOX_PLUS">+</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$i</span><span class="token T_INC">++</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6975"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_VARIABLE">$w</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6976"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_FOR">for</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$t</span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$t</span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$t</span><span class="token T_INC">++</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$temp</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$t</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$w</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$t</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6977"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$i</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_PERCENT">%</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$Nk</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6978"><pre><span class="token T_WHITESPACE">	      </span><span class="token T_VARIABLE">$temp</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">SubWord</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">RotWord</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$temp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6979"><pre><span class="token T_WHITESPACE">	      </span><span class="token T_FOR">for</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$t</span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$t</span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$t</span><span class="token T_INC">++</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$temp</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$t</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_XOR_EQUAL">^=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_VARIABLE">$Rcon</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_DIV">/</span><span class="token T_VARIABLE">$Nk</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$t</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6980"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_ELSE">else</span><span class="token T_WHITESPACE"> </span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$Nk</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_GT">&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">6</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_PERCENT">%</span><span class="token T_VARIABLE">$Nk</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line6981"><pre><span class="token T_WHITESPACE">	      </span><span class="token T_VARIABLE">$temp</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">SubWord</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$temp</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6982"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6983"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_FOR">for</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$t</span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$t</span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$t</span><span class="token T_INC">++</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$w</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$t</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$w</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_VARIABLE">$Nk</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$t</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CARET">^</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$temp</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$t</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6984"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6985"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$w</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6986"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6987"><br/></div><div id="line6988"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_STATIC">static</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">SubWord</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$w</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_WHITESPACE">    </span><span class="token T_COMMENT">// apply SBox to 4-byte word w</span></pre></div><div id="line6989"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_FOR">for</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$i</span><span class="token T_INC">++</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$w</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_VARIABLE">$Sbox</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$w</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6990"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$w</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6991"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6992"><br/></div><div id="line6993"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_STATIC">static</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">RotWord</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$w</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_WHITESPACE">    </span><span class="token T_COMMENT">// rotate 4-byte word w left by one byte</span></pre></div><div id="line6994"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_VARIABLE">$tmp</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$w</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6995"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_FOR">for</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_LNUMBER">3</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$i</span><span class="token T_INC">++</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$w</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$w</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_PLUS">+</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6996"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_VARIABLE">$w</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">3</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$tmp</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6997"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$w</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line6998"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line6999"><br/></div><div id="line7000"><pre><span class="token T_WHITESPACE">	</span><span class="token T_COMMENT">/*</span></pre></div><div id="line7001"><pre><span class="token T_COMMENT">	 * Unsigned right shift function, since PHP has neither &gt;&gt;&gt; operator nor unsigned ints</span></pre></div><div id="line7002"><pre><span class="token T_COMMENT">	 *</span></pre></div><div id="line7003"><pre><span class="token T_COMMENT">	 * @param a  number to be shifted (32-bit integer)</span></pre></div><div id="line7004"><pre><span class="token T_COMMENT">	 * @param b  number of bits to shift a to the right (0..31)</span></pre></div><div id="line7005"><pre><span class="token T_COMMENT">	 * @return   a right-shifted and zero-filled by b bits</span></pre></div><div id="line7006"><pre><span class="token T_COMMENT">	 */</span></pre></div><div id="line7007"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PROTECTED">protected</span><span class="token T_WHITESPACE"> </span><span class="token T_STATIC">static</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">urs</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$a</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$b</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7008"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_VARIABLE">$a</span><span class="token T_WHITESPACE"> </span><span class="token T_AND_EQUAL">&amp;=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0xffffffff</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$b</span><span class="token T_WHITESPACE"> </span><span class="token T_AND_EQUAL">&amp;=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x1f</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE">  </span><span class="token T_COMMENT">// (bounds check)</span></pre></div><div id="line7009"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$a</span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_LNUMBER">0x80000000</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$b</span><span class="token T_PHPDOX_GT">&gt;</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_WHITESPACE">   </span><span class="token T_COMMENT">// if left-most bit set</span></pre></div><div id="line7010"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_VARIABLE">$a</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$a</span><span class="token T_SR">&gt;&gt;</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0x7fffffff</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE">   </span><span class="token T_COMMENT">//   right-shift one bit &amp; clear left-most bit</span></pre></div><div id="line7011"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_VARIABLE">$a</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$a</span><span class="token T_WHITESPACE"> </span><span class="token T_SR">&gt;&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$b</span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE">           </span><span class="token T_COMMENT">//   remaining right-shifts</span></pre></div><div id="line7012"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_WHITESPACE"> </span><span class="token T_ELSE">else</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_WHITESPACE">                       </span><span class="token T_COMMENT">// otherwise</span></pre></div><div id="line7013"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_VARIABLE">$a</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$a</span><span class="token T_SR">&gt;&gt;</span><span class="token T_VARIABLE">$b</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE">               </span><span class="token T_COMMENT">//   use normal right-shift</span></pre></div><div id="line7014"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7015"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$a</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7016"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7017"><br/></div><div id="line7018"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line7019"><pre><span class="token T_DOC_COMMENT">	 * Encrypt a text using AES encryption in Counter mode of operation</span></pre></div><div id="line7020"><pre><span class="token T_DOC_COMMENT">	 *  - see http://csrc.nist.gov/publications/nistpubs/800-38a/sp800-38a.pdf</span></pre></div><div id="line7021"><pre><span class="token T_DOC_COMMENT">	 *</span></pre></div><div id="line7022"><pre><span class="token T_DOC_COMMENT">	 * Unicode multi-byte character safe</span></pre></div><div id="line7023"><pre><span class="token T_DOC_COMMENT">	 *</span></pre></div><div id="line7024"><pre><span class="token T_DOC_COMMENT">	 * @param plaintext source text to be encrypted</span></pre></div><div id="line7025"><pre><span class="token T_DOC_COMMENT">	 * @param password  the password to use to generate a key</span></pre></div><div id="line7026"><pre><span class="token T_DOC_COMMENT">	 * @param nBits     number of bits to be used in the key (128, 192, or 256)</span></pre></div><div id="line7027"><pre><span class="token T_DOC_COMMENT">	 * @return          encrypted text</span></pre></div><div id="line7028"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line7029"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_STATIC">static</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AESEncryptCtr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$plaintext</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$password</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$nBits</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7030"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_VARIABLE">$blockSize</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">16</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE">  </span><span class="token T_COMMENT">// block size fixed at 16 bytes / 128 bits (Nb=4) for AES</span></pre></div><div id="line7031"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$nBits</span><span class="token T_IS_EQUAL">==</span><span class="token T_LNUMBER">128</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_OR">||</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$nBits</span><span class="token T_IS_EQUAL">==</span><span class="token T_LNUMBER">192</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_OR">||</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$nBits</span><span class="token T_IS_EQUAL">==</span><span class="token T_LNUMBER">256</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE">  </span><span class="token T_COMMENT">// standard allows 128/192/256 bit keys</span></pre></div><div id="line7032"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_COMMENT">// note PHP (5) gives us plaintext and password in UTF8 encoding!</span></pre></div><div id="line7033"><br/></div><div id="line7034"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_COMMENT">// use AES itself to encrypt password to get cipher key (using plain password as source for</span></pre></div><div id="line7035"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_COMMENT">// key expansion) - gives us well encrypted key</span></pre></div><div id="line7036"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_VARIABLE">$nBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$nBits</span><span class="token T_PHPDOX_DIV">/</span><span class="token T_LNUMBER">8</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE">  </span><span class="token T_COMMENT">// no bytes in key</span></pre></div><div id="line7037"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_VARIABLE">$pwBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7038"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_FOR">for</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_VARIABLE">$nBytes</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$i</span><span class="token T_INC">++</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$pwBytes</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">ord</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$password</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0xff</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7039"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_VARIABLE">$key</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">Cipher</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$pwBytes</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">KeyExpansion</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$pwBytes</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7040"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_VARIABLE">$key</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">array_merge</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$key</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">array_slice</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$key</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$nBytes</span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_LNUMBER">16</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE">  </span><span class="token T_COMMENT">// expand key to 16/24/32 bytes long</span></pre></div><div id="line7041"><br/></div><div id="line7042"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_COMMENT">// initialise counter block (NIST SP800-38A &#xFFFD;B.2): millisecond time-stamp for nonce in</span></pre></div><div id="line7043"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_COMMENT">// 1st 8 bytes, block counter in 2nd 8 bytes</span></pre></div><div id="line7044"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_VARIABLE">$counterBlock</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7045"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_VARIABLE">$nonce</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">floor</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">microtime</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">true</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_MULT">*</span><span class="token T_LNUMBER">1000</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE">   </span><span class="token T_COMMENT">// timestamp: milliseconds since 1-Jan-1970</span></pre></div><div id="line7046"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_VARIABLE">$nonceSec</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">floor</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$nonce</span><span class="token T_PHPDOX_DIV">/</span><span class="token T_LNUMBER">1000</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7047"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_VARIABLE">$nonceMs</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$nonce</span><span class="token T_PHPDOX_PERCENT">%</span><span class="token T_LNUMBER">1000</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7048"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_COMMENT">// encode nonce with seconds in 1st 4 bytes, and (repeated) ms part filling 2nd 4 bytes</span></pre></div><div id="line7049"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_FOR">for</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$i</span><span class="token T_INC">++</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$counterBlock</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">urs</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$nonceSec</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_MULT">*</span><span class="token T_LNUMBER">8</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0xff</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7050"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_FOR">for</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$i</span><span class="token T_INC">++</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$counterBlock</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_PLUS">+</span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$nonceMs</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0xff</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7051"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_COMMENT">// and convert it to a string to go on the front of the ciphertext</span></pre></div><div id="line7052"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_VARIABLE">$ctrTxt</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7053"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_FOR">for</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_LNUMBER">8</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$i</span><span class="token T_INC">++</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$ctrTxt</span><span class="token T_WHITESPACE"> </span><span class="token T_CONCAT_EQUAL">.=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">chr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$counterBlock</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7054"><br/></div><div id="line7055"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_COMMENT">// generate key schedule - an expansion of the key into distinct Key Rounds for each round</span></pre></div><div id="line7056"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_VARIABLE">$keySchedule</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">KeyExpansion</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$key</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7057"><br/></div><div id="line7058"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_VARIABLE">$blockCount</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">ceil</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$plaintext</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_DIV">/</span><span class="token T_VARIABLE">$blockSize</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7059"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_VARIABLE">$ciphertxt</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE">  </span><span class="token T_COMMENT">// ciphertext as array of strings</span></pre></div><div id="line7060"><br/></div><div id="line7061"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_FOR">for</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$b</span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$b</span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_VARIABLE">$blockCount</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$b</span><span class="token T_INC">++</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7062"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_COMMENT">// set counter (block #) in last 8 bytes of counter block (leaving nonce in 1st 8 bytes)</span></pre></div><div id="line7063"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_COMMENT">// done in two stages for 32-bit ops: using two words allows us to go past 2^32 blocks (68GB)</span></pre></div><div id="line7064"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_FOR">for</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$c</span><span class="token T_INC">++</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$counterBlock</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">15</span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">urs</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$b</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_MULT">*</span><span class="token T_LNUMBER">8</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0xff</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7065"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_FOR">for</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$c</span><span class="token T_INC">++</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$counterBlock</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">15</span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">urs</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$b</span><span class="token T_PHPDOX_DIV">/</span><span class="token T_LNUMBER">0x100000000</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_MULT">*</span><span class="token T_LNUMBER">8</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7066"><br/></div><div id="line7067"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_VARIABLE">$cipherCntr</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">Cipher</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$counterBlock</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$keySchedule</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE">  </span><span class="token T_COMMENT">// -- encrypt counter block --</span></pre></div><div id="line7068"><br/></div><div id="line7069"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_COMMENT">// block size is reduced on final block</span></pre></div><div id="line7070"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_VARIABLE">$blockLength</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$b</span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_VARIABLE">$blockCount</span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_LNUMBER">1</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_QUESTION_MARK">?</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$blockSize</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_COLON">:</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$plaintext</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_PERCENT">%</span><span class="token T_VARIABLE">$blockSize</span><span class="token T_PHPDOX_PLUS">+</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7071"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_VARIABLE">$cipherByte</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7072"><br/></div><div id="line7073"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_FOR">for</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_VARIABLE">$blockLength</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$i</span><span class="token T_INC">++</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_WHITESPACE">  </span><span class="token T_COMMENT">// -- xor plaintext with ciphered counter byte-by-byte --</span></pre></div><div id="line7074"><pre><span class="token T_WHITESPACE">	      </span><span class="token T_VARIABLE">$cipherByte</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$cipherCntr</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CARET">^</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">ord</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$plaintext</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$b</span><span class="token T_PHPDOX_MULT">*</span><span class="token T_VARIABLE">$blockSize</span><span class="token T_PHPDOX_PLUS">+</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7075"><pre><span class="token T_WHITESPACE">	      </span><span class="token T_VARIABLE">$cipherByte</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">chr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$cipherByte</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7076"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7077"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_VARIABLE">$ciphertxt</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$b</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">implode</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$cipherByte</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE">  </span><span class="token T_COMMENT">// escape troublesome characters in ciphertext</span></pre></div><div id="line7078"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7079"><br/></div><div id="line7080"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_COMMENT">// implode is more efficient than repeated string concatenation</span></pre></div><div id="line7081"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_VARIABLE">$ciphertext</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$ctrTxt</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">implode</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$ciphertxt</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7082"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_VARIABLE">$ciphertext</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">base64_encode</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$ciphertext</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7083"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$ciphertext</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7084"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7085"><br/></div><div id="line7086"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line7087"><pre><span class="token T_DOC_COMMENT">	 * Decrypt a text encrypted by AES in counter mode of operation</span></pre></div><div id="line7088"><pre><span class="token T_DOC_COMMENT">	 *</span></pre></div><div id="line7089"><pre><span class="token T_DOC_COMMENT">	 * @param ciphertext source text to be decrypted</span></pre></div><div id="line7090"><pre><span class="token T_DOC_COMMENT">	 * @param password   the password to use to generate a key</span></pre></div><div id="line7091"><pre><span class="token T_DOC_COMMENT">	 * @param nBits      number of bits to be used in the key (128, 192, or 256)</span></pre></div><div id="line7092"><pre><span class="token T_DOC_COMMENT">	 * @return           decrypted text</span></pre></div><div id="line7093"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line7094"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_STATIC">static</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AESDecryptCtr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$ciphertext</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$password</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$nBits</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7095"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_VARIABLE">$blockSize</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">16</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE">  </span><span class="token T_COMMENT">// block size fixed at 16 bytes / 128 bits (Nb=4) for AES</span></pre></div><div id="line7096"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$nBits</span><span class="token T_IS_EQUAL">==</span><span class="token T_LNUMBER">128</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_OR">||</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$nBits</span><span class="token T_IS_EQUAL">==</span><span class="token T_LNUMBER">192</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_OR">||</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$nBits</span><span class="token T_IS_EQUAL">==</span><span class="token T_LNUMBER">256</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE">  </span><span class="token T_COMMENT">// standard allows 128/192/256 bit keys</span></pre></div><div id="line7097"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_VARIABLE">$ciphertext</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">base64_decode</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$ciphertext</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7098"><br/></div><div id="line7099"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_COMMENT">// use AES to encrypt password (mirroring encrypt routine)</span></pre></div><div id="line7100"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_VARIABLE">$nBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$nBits</span><span class="token T_PHPDOX_DIV">/</span><span class="token T_LNUMBER">8</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE">  </span><span class="token T_COMMENT">// no bytes in key</span></pre></div><div id="line7101"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_VARIABLE">$pwBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7102"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_FOR">for</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_VARIABLE">$nBytes</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$i</span><span class="token T_INC">++</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$pwBytes</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">ord</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$password</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0xff</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7103"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_VARIABLE">$key</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">Cipher</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$pwBytes</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">KeyExpansion</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$pwBytes</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7104"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_VARIABLE">$key</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">array_merge</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$key</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">array_slice</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$key</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$nBytes</span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_LNUMBER">16</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE">  </span><span class="token T_COMMENT">// expand key to 16/24/32 bytes long</span></pre></div><div id="line7105"><br/></div><div id="line7106"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_COMMENT">// recover nonce from 1st element of ciphertext</span></pre></div><div id="line7107"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_VARIABLE">$counterBlock</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7108"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_VARIABLE">$ctrTxt</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$ciphertext</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">8</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7109"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_FOR">for</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_LNUMBER">8</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$i</span><span class="token T_INC">++</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$counterBlock</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">ord</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$ctrTxt</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7110"><br/></div><div id="line7111"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_COMMENT">// generate key schedule</span></pre></div><div id="line7112"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_VARIABLE">$keySchedule</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">KeyExpansion</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$key</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7113"><br/></div><div id="line7114"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_COMMENT">// separate ciphertext into blocks (skipping past initial 8 bytes)</span></pre></div><div id="line7115"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_VARIABLE">$nBlocks</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">ceil</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$ciphertext</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_LNUMBER">8</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DIV">/</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$blockSize</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7116"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_VARIABLE">$ct</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7117"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_FOR">for</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$b</span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$b</span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_VARIABLE">$nBlocks</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$b</span><span class="token T_INC">++</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$ct</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$b</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$ciphertext</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">8</span><span class="token T_PHPDOX_PLUS">+</span><span class="token T_VARIABLE">$b</span><span class="token T_PHPDOX_MULT">*</span><span class="token T_VARIABLE">$blockSize</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">16</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7118"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_VARIABLE">$ciphertext</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$ct</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE">  </span><span class="token T_COMMENT">// ciphertext is now array of block-length strings</span></pre></div><div id="line7119"><br/></div><div id="line7120"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_COMMENT">// plaintext will get generated block-by-block into array of block-length strings</span></pre></div><div id="line7121"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_VARIABLE">$plaintxt</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7122"><br/></div><div id="line7123"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_FOR">for</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$b</span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$b</span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_VARIABLE">$nBlocks</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$b</span><span class="token T_INC">++</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7124"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_COMMENT">// set counter (block #) in last 8 bytes of counter block (leaving nonce in 1st 8 bytes)</span></pre></div><div id="line7125"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_FOR">for</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$c</span><span class="token T_INC">++</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$counterBlock</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">15</span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">urs</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$b</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_MULT">*</span><span class="token T_LNUMBER">8</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0xff</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7126"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_FOR">for</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$c</span><span class="token T_INC">++</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$counterBlock</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_LNUMBER">15</span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">urs</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$b</span><span class="token T_PHPDOX_PLUS">+</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_DIV">/</span><span class="token T_LNUMBER">0x100000000</span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$c</span><span class="token T_PHPDOX_MULT">*</span><span class="token T_LNUMBER">8</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0xff</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7127"><br/></div><div id="line7128"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_VARIABLE">$cipherCntr</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">Cipher</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$counterBlock</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$keySchedule</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE">  </span><span class="token T_COMMENT">// encrypt counter block</span></pre></div><div id="line7129"><br/></div><div id="line7130"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_VARIABLE">$plaintxtByte</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7131"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_FOR">for</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$ciphertext</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$b</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$i</span><span class="token T_INC">++</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7132"><pre><span class="token T_WHITESPACE">	      </span><span class="token T_COMMENT">// -- xor plaintext with ciphered counter byte-by-byte --</span></pre></div><div id="line7133"><pre><span class="token T_WHITESPACE">	      </span><span class="token T_VARIABLE">$plaintxtByte</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$cipherCntr</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CARET">^</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">ord</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$ciphertext</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$b</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7134"><pre><span class="token T_WHITESPACE">	      </span><span class="token T_VARIABLE">$plaintxtByte</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">chr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$plaintxtByte</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7135"><br/></div><div id="line7136"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7137"><pre><span class="token T_WHITESPACE">	    </span><span class="token T_VARIABLE">$plaintxt</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$b</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">implode</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$plaintxtByte</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7138"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7139"><br/></div><div id="line7140"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_COMMENT">// join array of blocks into single plaintext string</span></pre></div><div id="line7141"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_VARIABLE">$plaintext</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">implode</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_VARIABLE">$plaintxt</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7142"><br/></div><div id="line7143"><pre><span class="token T_WHITESPACE">	  </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$plaintext</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7144"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7145"><br/></div><div id="line7146"><pre><span class="token T_WHITESPACE">	</span><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line7147"><pre><span class="token T_DOC_COMMENT">	 * AES decryption in CBC mode. This is the standard mode (the CTR methods</span></pre></div><div id="line7148"><pre><span class="token T_DOC_COMMENT">	 * actually use Rijndael-128 in CTR mode, which - technically - isn't AES).</span></pre></div><div id="line7149"><pre><span class="token T_DOC_COMMENT">	 *</span></pre></div><div id="line7150"><pre><span class="token T_DOC_COMMENT">	 * Supports AES-128, AES-192 and AES-256. It supposes that the last 4 bytes</span></pre></div><div id="line7151"><pre><span class="token T_DOC_COMMENT">	 * contained a little-endian unsigned long integer representing the unpadded</span></pre></div><div id="line7152"><pre><span class="token T_DOC_COMMENT">	 * data length.</span></pre></div><div id="line7153"><pre><span class="token T_DOC_COMMENT">	 *</span></pre></div><div id="line7154"><pre><span class="token T_DOC_COMMENT">	 * @since 3.0.1</span></pre></div><div id="line7155"><pre><span class="token T_DOC_COMMENT">	 * @author Nicholas K. Dionysopoulos</span></pre></div><div id="line7156"><pre><span class="token T_DOC_COMMENT">	 *</span></pre></div><div id="line7157"><pre><span class="token T_DOC_COMMENT">	 * @param string $ciphertext The data to encrypt</span></pre></div><div id="line7158"><pre><span class="token T_DOC_COMMENT">	 * @param string $password Encryption password</span></pre></div><div id="line7159"><pre><span class="token T_DOC_COMMENT">	 * @param int $nBits Encryption key size. Can be 128, 192 or 256</span></pre></div><div id="line7160"><pre><span class="token T_DOC_COMMENT">	 * @return string The plaintext</span></pre></div><div id="line7161"><pre><span class="token T_DOC_COMMENT">	 */</span></pre></div><div id="line7162"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_STATIC">static</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AESDecryptCBC</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$ciphertext</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$password</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$nBits</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">128</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7163"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7164"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$nBits</span><span class="token T_IS_EQUAL">==</span><span class="token T_LNUMBER">128</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_OR">||</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$nBits</span><span class="token T_IS_EQUAL">==</span><span class="token T_LNUMBER">192</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_OR">||</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$nBits</span><span class="token T_IS_EQUAL">==</span><span class="token T_LNUMBER">256</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE">  </span><span class="token T_COMMENT">// standard allows 128/192/256 bit keys</span></pre></div><div id="line7165"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">function_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'mcrypt_module_open'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7166"><br/></div><div id="line7167"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Try to fetch cached key/iv or create them if they do not exist</span></pre></div><div id="line7168"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$lookupKey</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$password</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'-'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$nBits</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7169"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">array_key_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$lookupKey</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_VARIABLE">$passwords</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7170"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7171"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$key</span><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_VARIABLE">$passwords</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$lookupKey</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'key'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7172"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$iv</span><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_VARIABLE">$passwords</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$lookupKey</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'iv'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7173"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7174"><pre><span class="token T_WHITESPACE">		</span><span class="token T_ELSE">else</span></pre></div><div id="line7175"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7176"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// use AES itself to encrypt password to get cipher key (using plain password as source for</span></pre></div><div id="line7177"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// key expansion) - gives us well encrypted key</span></pre></div><div id="line7178"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$nBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$nBits</span><span class="token T_PHPDOX_DIV">/</span><span class="token T_LNUMBER">8</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE">  </span><span class="token T_COMMENT">// no bytes in key</span></pre></div><div id="line7179"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$pwBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7180"><pre><span class="token T_WHITESPACE">			</span><span class="token T_FOR">for</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_VARIABLE">$nBytes</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$i</span><span class="token T_INC">++</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$pwBytes</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">ord</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$password</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0xff</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7181"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$key</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">Cipher</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$pwBytes</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">KeyExpansion</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$pwBytes</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7182"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$key</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">array_merge</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$key</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">array_slice</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$key</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$nBytes</span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_LNUMBER">16</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE">  </span><span class="token T_COMMENT">// expand key to 16/24/32 bytes long</span></pre></div><div id="line7183"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$newKey</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7184"><pre><span class="token T_WHITESPACE">			</span><span class="token T_FOREACH">foreach</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$key</span><span class="token T_WHITESPACE"> </span><span class="token T_AS">as</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$int</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$newKey</span><span class="token T_WHITESPACE"> </span><span class="token T_CONCAT_EQUAL">.=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">chr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$int</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7185"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$key</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$newKey</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7186"><br/></div><div id="line7187"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Create an Initialization Vector (IV) based on the password, using the same technique as for the key</span></pre></div><div id="line7188"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$nBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">16</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE">  </span><span class="token T_COMMENT">// AES uses a 128 -bit (16 byte) block size, hence the IV size is always 16 bytes</span></pre></div><div id="line7189"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$pwBytes</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7190"><pre><span class="token T_WHITESPACE">			</span><span class="token T_FOR">for</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_LT">&lt;</span><span class="token T_VARIABLE">$nBytes</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$i</span><span class="token T_INC">++</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$pwBytes</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">ord</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$password</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_VARIABLE">$i</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_AMPERSAND">&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0xff</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7191"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$iv</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">Cipher</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$pwBytes</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">KeyExpansion</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$pwBytes</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7192"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$newIV</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7193"><pre><span class="token T_WHITESPACE">			</span><span class="token T_FOREACH">foreach</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$iv</span><span class="token T_WHITESPACE"> </span><span class="token T_AS">as</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$int</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_CURLY">{</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$newIV</span><span class="token T_WHITESPACE"> </span><span class="token T_CONCAT_EQUAL">.=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">chr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$int</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7194"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$iv</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$newIV</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7195"><br/></div><div id="line7196"><pre><span class="token T_WHITESPACE">			</span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_VARIABLE">$passwords</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$lookupKey</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'key'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$key</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7197"><pre><span class="token T_WHITESPACE">			</span><span class="token T_STRING">self</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_VARIABLE">$passwords</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$lookupKey</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'iv'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$iv</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7198"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7199"><br/></div><div id="line7200"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Read the data size</span></pre></div><div id="line7201"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$data_size</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">unpack</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'V'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$ciphertext</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7202"><br/></div><div id="line7203"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Decrypt</span></pre></div><div id="line7204"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$td</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">mcrypt_module_open</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">MCRYPT_RIJNDAEL_128</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">MCRYPT_MODE_CBC</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7205"><pre><span class="token T_WHITESPACE">		</span><span class="token T_STRING">mcrypt_generic_init</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$td</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$key</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$iv</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7206"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$plaintext</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">mdecrypt_generic</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$td</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$ciphertext</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_LNUMBER">4</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7207"><pre><span class="token T_WHITESPACE">		</span><span class="token T_STRING">mcrypt_generic_deinit</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$td</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7208"><br/></div><div id="line7209"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Trim padding, if necessary</span></pre></div><div id="line7210"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">strlen</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$plaintext</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_GT">&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$data_size</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7211"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7212"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$plaintext</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$plaintext</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$data_size</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7213"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7214"><br/></div><div id="line7215"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$plaintext</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7216"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7217"><pre><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7218"><br/></div><div id="line7219"><pre><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line7220"><pre><span class="token T_DOC_COMMENT"> * Akeeba Restore</span></pre></div><div id="line7221"><pre><span class="token T_DOC_COMMENT"> * A JSON-powered JPA, JPS and ZIP archive extraction library</span></pre></div><div id="line7222"><pre><span class="token T_DOC_COMMENT"> *</span></pre></div><div id="line7223"><pre><span class="token T_DOC_COMMENT"> * @copyright   2010-2014 Nicholas K. Dionysopoulos / Akeeba Ltd.</span></pre></div><div id="line7224"><pre><span class="token T_DOC_COMMENT"> * @license     GNU GPL v2 or - at your option - any later version</span></pre></div><div id="line7225"><pre><span class="token T_DOC_COMMENT"> * @package     akeebabackup</span></pre></div><div id="line7226"><pre><span class="token T_DOC_COMMENT"> * @subpackage  kickstart</span></pre></div><div id="line7227"><pre><span class="token T_DOC_COMMENT"> */</span></pre></div><div id="line7228"><br/></div><div id="line7229"><pre><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line7230"><pre><span class="token T_DOC_COMMENT"> * The Master Setup will read the configuration parameters from restoration.php or</span></pre></div><div id="line7231"><pre><span class="token T_DOC_COMMENT"> * the JSON-encoded "configuration" input variable and return the status.</span></pre></div><div id="line7232"><pre><span class="token T_DOC_COMMENT"> *</span></pre></div><div id="line7233"><pre><span class="token T_DOC_COMMENT"> * @return bool True if the master configuration was applied to the Factory object</span></pre></div><div id="line7234"><pre><span class="token T_DOC_COMMENT"> */</span></pre></div><div id="line7235"><pre><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">masterSetup</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7236"><pre><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7237"><pre><span class="token T_WHITESPACE">	</span><span class="token T_COMMENT">// ------------------------------------------------------------</span></pre></div><div id="line7238"><pre><span class="token T_WHITESPACE">	</span><span class="token T_COMMENT">// 1. Import basic setup parameters</span></pre></div><div id="line7239"><pre><span class="token T_WHITESPACE">	</span><span class="token T_COMMENT">// ------------------------------------------------------------</span></pre></div><div id="line7240"><br/></div><div id="line7241"><pre><span class="token T_WHITESPACE">	</span><span class="token T_VARIABLE">$ini_data</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7242"><br/></div><div id="line7243"><pre><span class="token T_WHITESPACE">	</span><span class="token T_COMMENT">// In restore.php mode, require restoration.php or fail</span></pre></div><div id="line7244"><pre><span class="token T_WHITESPACE">	</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">defined</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'KICKSTART'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7245"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7246"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// This is the standalone mode, used by Akeeba Backup Professional. It looks for a restoration.php</span></pre></div><div id="line7247"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// file to perform its magic. If the file is not there, we will abort.</span></pre></div><div id="line7248"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$setupFile</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'restoration.php'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7249"><br/></div><div id="line7250"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">file_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$setupFile</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7251"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7252"><pre><span class="token T_WHITESPACE">			</span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">set</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.enabled'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7253"><br/></div><div id="line7254"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7255"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7256"><br/></div><div id="line7257"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Load restoration.php. It creates a global variable named $restoration_setup</span></pre></div><div id="line7258"><pre><span class="token T_WHITESPACE">		</span><span class="token T_REQUIRE_ONCE">require_once</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$setupFile</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7259"><br/></div><div id="line7260"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$ini_data</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$restoration_setup</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7261"><br/></div><div id="line7262"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$ini_data</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7263"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7264"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// No parameters fetched. Darn, how am I supposed to work like that?!</span></pre></div><div id="line7265"><pre><span class="token T_WHITESPACE">			</span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">set</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.enabled'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7266"><br/></div><div id="line7267"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7268"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7269"><br/></div><div id="line7270"><pre><span class="token T_WHITESPACE">		</span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">set</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.enabled'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7271"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7272"><pre><span class="token T_WHITESPACE">	</span><span class="token T_ELSE">else</span></pre></div><div id="line7273"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7274"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Maybe we have $restoration_setup defined in the head of kickstart.php</span></pre></div><div id="line7275"><pre><span class="token T_WHITESPACE">		</span><span class="token T_GLOBAL">global</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$restoration_setup</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7276"><br/></div><div id="line7277"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$restoration_setup</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">is_array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$restoration_setup</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7278"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7279"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$ini_data</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">parse_ini_file</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$restoration_setup</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7280"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7281"><pre><span class="token T_WHITESPACE">		</span><span class="token T_ELSEIF">elseif</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">is_array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$restoration_setup</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7282"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7283"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$ini_data</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$restoration_setup</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7284"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7285"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7286"><br/></div><div id="line7287"><pre><span class="token T_WHITESPACE">	</span><span class="token T_COMMENT">// Import any data from $restoration_setup</span></pre></div><div id="line7288"><pre><span class="token T_WHITESPACE">	</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$ini_data</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7289"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7290"><pre><span class="token T_WHITESPACE">		</span><span class="token T_FOREACH">foreach</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$ini_data</span><span class="token T_WHITESPACE"> </span><span class="token T_AS">as</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$key</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7291"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7292"><pre><span class="token T_WHITESPACE">			</span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">set</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$key</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7293"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7294"><pre><span class="token T_WHITESPACE">		</span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">set</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.enabled'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7295"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7296"><br/></div><div id="line7297"><pre><span class="token T_WHITESPACE">	</span><span class="token T_COMMENT">// Reinitialize $ini_data</span></pre></div><div id="line7298"><pre><span class="token T_WHITESPACE">	</span><span class="token T_VARIABLE">$ini_data</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7299"><br/></div><div id="line7300"><pre><span class="token T_WHITESPACE">	</span><span class="token T_COMMENT">// ------------------------------------------------------------</span></pre></div><div id="line7301"><pre><span class="token T_WHITESPACE">	</span><span class="token T_COMMENT">// 2. Explode JSON parameters into $_REQUEST scope</span></pre></div><div id="line7302"><pre><span class="token T_WHITESPACE">	</span><span class="token T_COMMENT">// ------------------------------------------------------------</span></pre></div><div id="line7303"><br/></div><div id="line7304"><pre><span class="token T_WHITESPACE">	</span><span class="token T_COMMENT">// Detect a JSON string in the request variable and store it.</span></pre></div><div id="line7305"><pre><span class="token T_WHITESPACE">	</span><span class="token T_VARIABLE">$json</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">getQueryParam</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'json'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7306"><br/></div><div id="line7307"><pre><span class="token T_WHITESPACE">	</span><span class="token T_COMMENT">// Remove everything from the request, post and get arrays</span></pre></div><div id="line7308"><pre><span class="token T_WHITESPACE">	</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$_REQUEST</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7309"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7310"><pre><span class="token T_WHITESPACE">		</span><span class="token T_FOREACH">foreach</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$_REQUEST</span><span class="token T_WHITESPACE"> </span><span class="token T_AS">as</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$key</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7311"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7312"><pre><span class="token T_WHITESPACE">			</span><span class="token T_UNSET">unset</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$_REQUEST</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$key</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7313"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7314"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7315"><br/></div><div id="line7316"><pre><span class="token T_WHITESPACE">	</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$_POST</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7317"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7318"><pre><span class="token T_WHITESPACE">		</span><span class="token T_FOREACH">foreach</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$_POST</span><span class="token T_WHITESPACE"> </span><span class="token T_AS">as</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$key</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7319"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7320"><pre><span class="token T_WHITESPACE">			</span><span class="token T_UNSET">unset</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$_POST</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$key</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7321"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7322"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7323"><br/></div><div id="line7324"><pre><span class="token T_WHITESPACE">	</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$_GET</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7325"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7326"><pre><span class="token T_WHITESPACE">		</span><span class="token T_FOREACH">foreach</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$_GET</span><span class="token T_WHITESPACE"> </span><span class="token T_AS">as</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$key</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7327"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7328"><pre><span class="token T_WHITESPACE">			</span><span class="token T_UNSET">unset</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$_GET</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$key</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7329"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7330"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7331"><br/></div><div id="line7332"><pre><span class="token T_WHITESPACE">	</span><span class="token T_COMMENT">// Decrypt a possibly encrypted JSON string</span></pre></div><div id="line7333"><pre><span class="token T_WHITESPACE">	</span><span class="token T_VARIABLE">$password</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.security.password'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7334"><br/></div><div id="line7335"><pre><span class="token T_WHITESPACE">	</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$json</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7336"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7337"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$password</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7338"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7339"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$json</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKEncryptionAES</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">AESDecryptCtr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$json</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$password</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">128</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7340"><br/></div><div id="line7341"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$json</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7342"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7343"><pre><span class="token T_WHITESPACE">				</span><span class="token T_EXIT">die</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'###{"status":false,"message":"Invalid login"}###'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7344"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7345"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7346"><br/></div><div id="line7347"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Get the raw data</span></pre></div><div id="line7348"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$raw</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">json_decode</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$json</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7349"><br/></div><div id="line7350"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$password</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$raw</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7351"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7352"><pre><span class="token T_WHITESPACE">			</span><span class="token T_EXIT">die</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'###{"status":false,"message":"Invalid login"}###'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7353"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7354"><br/></div><div id="line7355"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Pass all JSON data to the request array</span></pre></div><div id="line7356"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$raw</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7357"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7358"><pre><span class="token T_WHITESPACE">			</span><span class="token T_FOREACH">foreach</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$raw</span><span class="token T_WHITESPACE"> </span><span class="token T_AS">as</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$key</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7359"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7360"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$_REQUEST</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_VARIABLE">$key</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7361"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7362"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7363"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7364"><pre><span class="token T_WHITESPACE">	</span><span class="token T_ELSEIF">elseif</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$password</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7365"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7366"><pre><span class="token T_WHITESPACE">		</span><span class="token T_EXIT">die</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'###{"status":false,"message":"Invalid login"}###'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7367"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7368"><br/></div><div id="line7369"><pre><span class="token T_WHITESPACE">	</span><span class="token T_COMMENT">// ------------------------------------------------------------</span></pre></div><div id="line7370"><pre><span class="token T_WHITESPACE">	</span><span class="token T_COMMENT">// 3. Try the "factory" variable</span></pre></div><div id="line7371"><pre><span class="token T_WHITESPACE">	</span><span class="token T_COMMENT">// ------------------------------------------------------------</span></pre></div><div id="line7372"><pre><span class="token T_WHITESPACE">	</span><span class="token T_COMMENT">// A "factory" variable will override all other settings.</span></pre></div><div id="line7373"><pre><span class="token T_WHITESPACE">	</span><span class="token T_VARIABLE">$serialized</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">getQueryParam</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'factory'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7374"><br/></div><div id="line7375"><pre><span class="token T_WHITESPACE">	</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">is_null</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$serialized</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7376"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7377"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Get the serialized factory</span></pre></div><div id="line7378"><pre><span class="token T_WHITESPACE">		</span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">unserialize</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$serialized</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7379"><pre><span class="token T_WHITESPACE">		</span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">set</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.enabled'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7380"><br/></div><div id="line7381"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7382"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7383"><br/></div><div id="line7384"><pre><span class="token T_WHITESPACE">	</span><span class="token T_COMMENT">// ------------------------------------------------------------</span></pre></div><div id="line7385"><pre><span class="token T_WHITESPACE">	</span><span class="token T_COMMENT">// 4. Try the configuration variable for Kickstart</span></pre></div><div id="line7386"><pre><span class="token T_WHITESPACE">	</span><span class="token T_COMMENT">// ------------------------------------------------------------</span></pre></div><div id="line7387"><pre><span class="token T_WHITESPACE">	</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">defined</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'KICKSTART'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7388"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7389"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$configuration</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">getQueryParam</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'configuration'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7390"><br/></div><div id="line7391"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">is_null</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$configuration</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7392"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7393"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Let's decode the configuration from JSON to array</span></pre></div><div id="line7394"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$ini_data</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">json_decode</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$configuration</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7395"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7396"><pre><span class="token T_WHITESPACE">		</span><span class="token T_ELSE">else</span></pre></div><div id="line7397"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7398"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// Neither exists. Enable Kickstart's interface anyway.</span></pre></div><div id="line7399"><pre><span class="token T_WHITESPACE">			</span><span class="token T_VARIABLE">$ini_data</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.enabled'</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7400"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7401"><br/></div><div id="line7402"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Import any INI data we might have from other sources</span></pre></div><div id="line7403"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$ini_data</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7404"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7405"><pre><span class="token T_WHITESPACE">			</span><span class="token T_FOREACH">foreach</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$ini_data</span><span class="token T_WHITESPACE"> </span><span class="token T_AS">as</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$key</span><span class="token T_WHITESPACE"> </span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7406"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7407"><pre><span class="token T_WHITESPACE">				</span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">set</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$key</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$value</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7408"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7409"><br/></div><div id="line7410"><pre><span class="token T_WHITESPACE">			</span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">set</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.enabled'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7411"><br/></div><div id="line7412"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7413"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7414"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7415"><pre><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7416"><br/></div><div id="line7417"><pre><span class="token T_DOC_COMMENT">/**</span></pre></div><div id="line7418"><pre><span class="token T_DOC_COMMENT"> * Akeeba Restore</span></pre></div><div id="line7419"><pre><span class="token T_DOC_COMMENT"> * A JSON-powered JPA, JPS and ZIP archive extraction library</span></pre></div><div id="line7420"><pre><span class="token T_DOC_COMMENT"> *</span></pre></div><div id="line7421"><pre><span class="token T_DOC_COMMENT"> * @copyright   2010-2014 Nicholas K. Dionysopoulos / Akeeba Ltd.</span></pre></div><div id="line7422"><pre><span class="token T_DOC_COMMENT"> * @license     GNU GPL v2 or - at your option - any later version</span></pre></div><div id="line7423"><pre><span class="token T_DOC_COMMENT"> * @package     akeebabackup</span></pre></div><div id="line7424"><pre><span class="token T_DOC_COMMENT"> * @subpackage  kickstart</span></pre></div><div id="line7425"><pre><span class="token T_DOC_COMMENT"> */</span></pre></div><div id="line7426"><br/></div><div id="line7427"><pre><span class="token T_COMMENT">// Mini-controller for restore.php</span></pre></div><div id="line7428"><pre><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">defined</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'KICKSTART'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7429"><pre><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7430"><pre><span class="token T_WHITESPACE">	</span><span class="token T_COMMENT">// The observer class, used to report number of files and bytes processed</span></pre></div><div id="line7431"><pre><span class="token T_WHITESPACE">	</span><span class="token T_CLASS">class</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">RestorationObserver</span><span class="token T_WHITESPACE"> </span><span class="token T_EXTENDS">extends</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKAbstractPartObserver</span></pre></div><div id="line7432"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7433"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$compressedTotal</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7434"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$uncompressedTotal</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7435"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$filesProcessed</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7436"><br/></div><div id="line7437"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">update</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$object</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$message</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7438"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7439"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">is_object</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$message</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_RETURN">return</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7440"><br/></div><div id="line7441"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">array_key_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'type'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">get_object_vars</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$message</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_RETURN">return</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7442"><br/></div><div id="line7443"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$message</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">type</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'startfile'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7444"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7445"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">filesProcessed</span><span class="token T_INC">++</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7446"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">compressedTotal</span><span class="token T_WHITESPACE"> </span><span class="token T_PLUS_EQUAL">+=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$message</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">content</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">compressed</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7447"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$this</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">uncompressedTotal</span><span class="token T_WHITESPACE"> </span><span class="token T_PLUS_EQUAL">+=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$message</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">content</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">uncompressed</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7448"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7449"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7450"><br/></div><div id="line7451"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PUBLIC">public</span><span class="token T_WHITESPACE"> </span><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">__toString</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7452"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7453"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_CLASS_C">__CLASS__</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7454"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7455"><br/></div><div id="line7456"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7457"><br/></div><div id="line7458"><pre><span class="token T_WHITESPACE">	</span><span class="token T_COMMENT">// Import configuration</span></pre></div><div id="line7459"><pre><span class="token T_WHITESPACE">	</span><span class="token T_STRING">masterSetup</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7460"><br/></div><div id="line7461"><pre><span class="token T_WHITESPACE">	</span><span class="token T_VARIABLE">$retArray</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_ARRAY">array</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span></pre></div><div id="line7462"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'status'</span><span class="token T_WHITESPACE">	</span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_COMMA">,</span></pre></div><div id="line7463"><pre><span class="token T_WHITESPACE">		</span><span class="token T_CONSTANT_ENCAPSED_STRING">'message'</span><span class="token T_WHITESPACE">	</span><span class="token T_DOUBLE_ARROW">=&gt;</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span></pre></div><div id="line7464"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7465"><br/></div><div id="line7466"><pre><span class="token T_WHITESPACE">	</span><span class="token T_VARIABLE">$enabled</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.enabled'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7467"><br/></div><div id="line7468"><pre><span class="token T_WHITESPACE">	</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$enabled</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7469"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7470"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$task</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">getQueryParam</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'task'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7471"><br/></div><div id="line7472"><pre><span class="token T_WHITESPACE">		</span><span class="token T_SWITCH">switch</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$task</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7473"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7474"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'ping'</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line7475"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// ping task - realy does nothing!</span></pre></div><div id="line7476"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$timer</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">getTimer</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7477"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$timer</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">enforce_min_exec_time</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7478"><pre><span class="token T_WHITESPACE">				</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7479"><br/></div><div id="line7480"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'startRestore'</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line7481"><pre><span class="token T_WHITESPACE">				</span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">nuke</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_COMMENT">// Reset the factory</span></pre></div><div id="line7482"><br/></div><div id="line7483"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// Let the control flow to the next step (the rest of the code is common!!)</span></pre></div><div id="line7484"><br/></div><div id="line7485"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'stepRestore'</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line7486"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$engine</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">getUnarchiver</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_COMMENT">// Get the engine</span></pre></div><div id="line7487"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$observer</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_NEW">new</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">RestorationObserver</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_COMMENT">// Create a new observer</span></pre></div><div id="line7488"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$engine</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">attach</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$observer</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span><span class="token T_WHITESPACE"> </span><span class="token T_COMMENT">// Attach the observer</span></pre></div><div id="line7489"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$engine</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">tick</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7490"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$ret</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$engine</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">getStatusArray</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7491"><br/></div><div id="line7492"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$ret</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Error'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_NOT_EQUAL">!=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">''</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7493"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7494"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$retArray</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'status'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7495"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$retArray</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'done'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7496"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$retArray</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'message'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$ret</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'Error'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7497"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7498"><pre><span class="token T_WHITESPACE">				</span><span class="token T_ELSEIF">elseif</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$ret</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'HasRun'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7499"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7500"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$retArray</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'files'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$observer</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">filesProcessed</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7501"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$retArray</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'bytesIn'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$observer</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">compressedTotal</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7502"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$retArray</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'bytesOut'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$observer</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">uncompressedTotal</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7503"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$retArray</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'status'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7504"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$retArray</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'done'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7505"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7506"><pre><span class="token T_WHITESPACE">				</span><span class="token T_ELSE">else</span></pre></div><div id="line7507"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7508"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$retArray</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'files'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$observer</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">filesProcessed</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7509"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$retArray</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'bytesIn'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$observer</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">compressedTotal</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7510"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$retArray</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'bytesOut'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$observer</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">uncompressedTotal</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7511"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$retArray</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'status'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">true</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7512"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$retArray</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'done'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7513"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$retArray</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'factory'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">serialize</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7514"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7515"><pre><span class="token T_WHITESPACE">				</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7516"><br/></div><div id="line7517"><pre><span class="token T_WHITESPACE">			</span><span class="token T_CASE">case</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'finalizeRestore'</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line7518"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$root</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.setup.destdir'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7519"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// Remove the installation directory</span></pre></div><div id="line7520"><pre><span class="token T_WHITESPACE">				</span><span class="token T_STRING">recursive_remove_directory</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$root</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/installation'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7521"><br/></div><div id="line7522"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$postproc</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">getPostProc</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7523"><br/></div><div id="line7524"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// Rename htaccess.bak to .htaccess</span></pre></div><div id="line7525"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">file_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$root</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/htaccess.bak'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7526"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7527"><pre><span class="token T_WHITESPACE">					</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">file_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$root</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/.htaccess'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE">  </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7528"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7529"><pre><span class="token T_WHITESPACE">						</span><span class="token T_VARIABLE">$postproc</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">unlink</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$root</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/.htaccess'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7530"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7531"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$postproc</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">rename</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$root</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/htaccess.bak'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$root</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/.htaccess'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7532"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7533"><br/></div><div id="line7534"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// Rename htaccess.bak to .htaccess</span></pre></div><div id="line7535"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">file_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$root</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/web.config.bak'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7536"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7537"><pre><span class="token T_WHITESPACE">					</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">file_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$root</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/web.config'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE">  </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7538"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7539"><pre><span class="token T_WHITESPACE">						</span><span class="token T_VARIABLE">$postproc</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">unlink</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$root</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/web.config'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7540"><pre><span class="token T_WHITESPACE">					</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7541"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$postproc</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">rename</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$root</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/web.config.bak'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$root</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/web.config'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7542"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7543"><br/></div><div id="line7544"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// Remove restoration.php</span></pre></div><div id="line7545"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$basepath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">KSROOTDIR</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7546"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$basepath</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">rtrim</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">str_replace</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'\\'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_VARIABLE">$basepath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7547"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$basepath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$basepath</span><span class="token T_WHITESPACE"> </span><span class="token T_CONCAT_EQUAL">.=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7548"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$postproc</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">unlink</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$basepath</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'restoration.php'</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7549"><br/></div><div id="line7550"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// Import a custom finalisation file</span></pre></div><div id="line7551"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">file_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">dirname</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_FILE">__FILE__</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/restore_finalisation.php'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7552"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7553"><pre><span class="token T_WHITESPACE">					</span><span class="token T_INCLUDE_ONCE">include_once</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">dirname</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_FILE">__FILE__</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOT">.</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/restore_finalisation.php'</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7554"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7555"><br/></div><div id="line7556"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// Run a custom finalisation script</span></pre></div><div id="line7557"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">function_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'finalizeRestore'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7558"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7559"><pre><span class="token T_WHITESPACE">					</span><span class="token T_STRING">finalizeRestore</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$root</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$basepath</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7560"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7561"><pre><span class="token T_WHITESPACE">				</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7562"><br/></div><div id="line7563"><pre><span class="token T_WHITESPACE">			</span><span class="token T_DEFAULT">default</span><span class="token T_PHPDOX_COLON">:</span></pre></div><div id="line7564"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// Invalid task!</span></pre></div><div id="line7565"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$enabled</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7566"><pre><span class="token T_WHITESPACE">				</span><span class="token T_BREAK">break</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7567"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7568"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7569"><br/></div><div id="line7570"><pre><span class="token T_WHITESPACE">	</span><span class="token T_COMMENT">// Maybe we weren't authorized or the task was invalid?</span></pre></div><div id="line7571"><pre><span class="token T_WHITESPACE">	</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$enabled</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7572"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7573"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// Maybe the user failed to enter any information</span></pre></div><div id="line7574"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$retArray</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'status'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">false</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7575"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$retArray</span><span class="token T_PHPDOX_OPEN_SQUARE">[</span><span class="token T_CONSTANT_ENCAPSED_STRING">'message'</span><span class="token T_PHPDOX_CLOSE_SQUARE">]</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKText</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">_</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'ERR_INVALID_LOGIN'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7576"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7577"><br/></div><div id="line7578"><pre><span class="token T_WHITESPACE">	</span><span class="token T_COMMENT">// JSON encode the message</span></pre></div><div id="line7579"><pre><span class="token T_WHITESPACE">	</span><span class="token T_VARIABLE">$json</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">json_encode</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$retArray</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7580"><pre><span class="token T_WHITESPACE">	</span><span class="token T_COMMENT">// Do I have to encrypt?</span></pre></div><div id="line7581"><pre><span class="token T_WHITESPACE">	</span><span class="token T_VARIABLE">$password</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">get</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_CONSTANT_ENCAPSED_STRING">'kickstart.security.password'</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">null</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7582"><pre><span class="token T_WHITESPACE">	</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_EMPTY">empty</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$password</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7583"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7584"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$json</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKEncryptionAES</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">AESEncryptCtr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$json</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$password</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_WHITESPACE"> </span><span class="token T_LNUMBER">128</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7585"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7586"><br/></div><div id="line7587"><pre><span class="token T_WHITESPACE">	</span><span class="token T_COMMENT">// Return the message</span></pre></div><div id="line7588"><pre><span class="token T_WHITESPACE">	</span><span class="token T_ECHO">echo</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_DOUBLE_QUOTES">"</span><span class="token T_ENCAPSED_AND_WHITESPACE">###</span><span class="token T_VARIABLE">$json</span><span class="token T_ENCAPSED_AND_WHITESPACE">###</span><span class="token T_PHPDOX_DOUBLE_QUOTES">"</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7589"><br/></div><div id="line7590"><pre><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7591"><br/></div><div id="line7592"><pre><span class="token T_COMMENT">// ------------ lixlpixel recursive PHP functions -------------</span></pre></div><div id="line7593"><pre><span class="token T_COMMENT">// recursive_remove_directory( directory to delete, empty )</span></pre></div><div id="line7594"><pre><span class="token T_COMMENT">// expects path to directory and optional TRUE / FALSE to empty</span></pre></div><div id="line7595"><pre><span class="token T_COMMENT">// of course PHP has to have the rights to delete the directory</span></pre></div><div id="line7596"><pre><span class="token T_COMMENT">// you specify and all files and folders inside the directory</span></pre></div><div id="line7597"><pre><span class="token T_COMMENT">// ------------------------------------------------------------</span></pre></div><div id="line7598"><pre><span class="token T_FUNCTION">function</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">recursive_remove_directory</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$directory</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7599"><pre><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7600"><pre><span class="token T_WHITESPACE">	</span><span class="token T_COMMENT">// if the path has a slash at the end we remove it here</span></pre></div><div id="line7601"><pre><span class="token T_WHITESPACE">	</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$directory</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_EQUAL">==</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7602"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7603"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$directory</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">substr</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$directory</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_LNUMBER">0</span><span class="token T_PHPDOX_COMMA">,</span><span class="token T_PHPDOX_MINUS">-</span><span class="token T_LNUMBER">1</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7604"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7605"><pre><span class="token T_WHITESPACE">	</span><span class="token T_COMMENT">// if the path is not valid or is not a directory ...</span></pre></div><div id="line7606"><pre><span class="token T_WHITESPACE">	</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">file_exists</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$directory</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_OR">||</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">is_dir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$directory</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7607"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7608"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// ... we return false and exit the function</span></pre></div><div id="line7609"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">FALSE</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7610"><pre><span class="token T_WHITESPACE">	</span><span class="token T_COMMENT">// ... if the path is not readable</span></pre></div><div id="line7611"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_ELSEIF">elseif</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_STRING">is_readable</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$directory</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7612"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7613"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// ... we return false and exit the function</span></pre></div><div id="line7614"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">FALSE</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7615"><pre><span class="token T_WHITESPACE">	</span><span class="token T_COMMENT">// ... else if the path is readable</span></pre></div><div id="line7616"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_ELSE">else</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7617"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// we open the directory</span></pre></div><div id="line7618"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$handle</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">opendir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$directory</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7619"><pre><span class="token T_WHITESPACE">		</span><span class="token T_VARIABLE">$postproc</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">AKFactory</span><span class="token T_DOUBLE_COLON">::</span><span class="token T_STRING">getPostProc</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7620"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// and scan through the items inside</span></pre></div><div id="line7621"><pre><span class="token T_WHITESPACE">		</span><span class="token T_WHILE">while</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">FALSE</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_NOT_IDENTICAL">!==</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$item</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">readdir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$handle</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7622"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7623"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// if the filepointer is not the current directory</span></pre></div><div id="line7624"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// or the parent directory</span></pre></div><div id="line7625"><pre><span class="token T_WHITESPACE">			</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$item</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_NOT_EQUAL">!=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'.'</span><span class="token T_WHITESPACE"> </span><span class="token T_BOOLEAN_AND">&amp;&amp;</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$item</span><span class="token T_WHITESPACE"> </span><span class="token T_IS_NOT_EQUAL">!=</span><span class="token T_WHITESPACE"> </span><span class="token T_CONSTANT_ENCAPSED_STRING">'..'</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7626"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7627"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// we build the new path to delete</span></pre></div><div id="line7628"><pre><span class="token T_WHITESPACE">				</span><span class="token T_VARIABLE">$path</span><span class="token T_WHITESPACE"> </span><span class="token T_PHPDOX_EQUAL">=</span><span class="token T_WHITESPACE"> </span><span class="token T_VARIABLE">$directory</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_CONSTANT_ENCAPSED_STRING">'/'</span><span class="token T_PHPDOX_DOT">.</span><span class="token T_VARIABLE">$item</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7629"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// if the new path is a directory</span></pre></div><div id="line7630"><pre><span class="token T_WHITESPACE">				</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_STRING">is_dir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$path</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7631"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7632"><pre><span class="token T_WHITESPACE">					</span><span class="token T_COMMENT">// we call this function with the new path</span></pre></div><div id="line7633"><pre><span class="token T_WHITESPACE">					</span><span class="token T_STRING">recursive_remove_directory</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$path</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7634"><pre><span class="token T_WHITESPACE">				</span><span class="token T_COMMENT">// if the new path is a file</span></pre></div><div id="line7635"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span><span class="token T_ELSE">else</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7636"><pre><span class="token T_WHITESPACE">					</span><span class="token T_COMMENT">// we remove the file</span></pre></div><div id="line7637"><pre><span class="token T_WHITESPACE">					</span><span class="token T_VARIABLE">$postproc</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">unlink</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$path</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7638"><pre><span class="token T_WHITESPACE">				</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7639"><pre><span class="token T_WHITESPACE">			</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7640"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7641"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// close the directory</span></pre></div><div id="line7642"><pre><span class="token T_WHITESPACE">		</span><span class="token T_STRING">closedir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$handle</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7643"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// try to delete the now empty directory</span></pre></div><div id="line7644"><pre><span class="token T_WHITESPACE">		</span><span class="token T_IF">if</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_PHPDOX_EXCLAMATION_MARK">!</span><span class="token T_VARIABLE">$postproc</span><span class="token T_OBJECT_OPERATOR">-&gt;</span><span class="token T_STRING">rmdir</span><span class="token T_PHPDOX_OPEN_BRACKET">(</span><span class="token T_VARIABLE">$directory</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span><span class="token T_PHPDOX_CLOSE_BRACKET">)</span></pre></div><div id="line7645"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_OPEN_CURLY">{</span></pre></div><div id="line7646"><pre><span class="token T_WHITESPACE">			</span><span class="token T_COMMENT">// return false if not possible</span></pre></div><div id="line7647"><pre><span class="token T_WHITESPACE">			</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">FALSE</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7648"><pre><span class="token T_WHITESPACE">		</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7649"><pre><span class="token T_WHITESPACE">		</span><span class="token T_COMMENT">// return success</span></pre></div><div id="line7650"><pre><span class="token T_WHITESPACE">		</span><span class="token T_RETURN">return</span><span class="token T_WHITESPACE"> </span><span class="token T_STRING">TRUE</span><span class="token T_PHPDOX_SEMICOLON">;</span></pre></div><div id="line7651"><pre><span class="token T_WHITESPACE">	</span><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7652"><pre><span class="token T_PHPDOX_CLOSE_CURLY">}</span></pre></div><div id="line7653"><br/></div></td></tr></table></section></div><footer><span>Generated using phpDox 0.8.0 - Copyright (C) 2010 - 2016 by Arne Blankerts</span></footer></body></html>
